$.root_=$("body"),$.navAsAjax=!1,$.sound_path="sound/",$.sound_on=!0;var root=this,debugState=!1,debugStyle="font-weight: bold; color: #00f;",debugStyle_green="font-weight: bold; font-style:italic; color: #46C246;",debugStyle_red="font-weight: bold; color: #ed1c24;",debugStyle_warning="background-color:yellow",debugStyle_success="background-color:green; font-weight:bold; color:#fff;",debugStyle_error="background-color:#ed1c24; font-weight:bold; color:#fff;",throttle_delay=350,menu_speed=235,menu_accordion=!0,enableJarvisWidgets=!0,localStorageJarvisWidgets=!0,sortableJarvisWidgets=!0,enableMobileWidgets=!1,fastClick=!1,boxList=[],showList=[],nameList=[],idList=[],chatbox_config={width:200,gap:35},ignore_key_elms=["#header, #left-panel, #right-panel, #main, div.page-footer, #shortcut, #divSmallBoxes, #divMiniIcons, #divbigBoxes, #voiceModal, script, .ui-chatbox"],voice_command=!0,voice_command_auto=!1,voice_command_lang="en-US",voice_localStorage=!0;if(voice_command)var commands={"show dashboard":function(){$('nav a[href="ajax/dashboard.html"]').trigger("click")},"show inbox":function(){$('nav a[href="ajax/inbox.html"]').trigger("click")},"show graphs":function(){$('nav a[href="ajax/flot.html"]').trigger("click")},"show flotchart":function(){$('nav a[href="ajax/flot.html"]').trigger("click")},"show morris chart":function(){$('nav a[href="ajax/morris.html"]').trigger("click")},"show inline chart":function(){$('nav a[href="ajax/inline-charts.html"]').trigger("click")},"show dygraphs":function(){$('nav a[href="ajax/dygraphs.html"]').trigger("click")},"show tables":function(){$('nav a[href="ajax/table.html"]').trigger("click")},"show data table":function(){$('nav a[href="ajax/datatables.html"]').trigger("click")},"show jquery grid":function(){$('nav a[href="ajax/jqgrid.html"]').trigger("click")},"show form":function(){$('nav a[href="ajax/form-elements.html"]').trigger("click")},"show form layouts":function(){$('nav a[href="ajax/form-templates.html"]').trigger("click")},"show form validation":function(){$('nav a[href="ajax/validation.html"]').trigger("click")},"show form elements":function(){$('nav a[href="ajax/bootstrap-forms.html"]').trigger("click")},"show form plugins":function(){$('nav a[href="ajax/plugins.html"]').trigger("click")},"show form wizards":function(){$('nav a[href="ajax/wizards.html"]').trigger("click")},"show bootstrap editor":function(){$('nav a[href="ajax/other-editors.html"]').trigger("click")},"show dropzone":function(){$('nav a[href="ajax/dropzone.html"]').trigger("click")},"show image cropping":function(){$('nav a[href="ajax/image-editor.html"]').trigger("click")},"show general elements":function(){$('nav a[href="ajax/general-elements.html"]').trigger("click")},"show buttons":function(){$('nav a[href="ajax/buttons.html"]').trigger("click")},"show fontawesome":function(){$('nav a[href="ajax/fa.html"]').trigger("click")},"show glyph icons":function(){$('nav a[href="ajax/glyph.html"]').trigger("click")},"show flags":function(){$('nav a[href="ajax/flags.html"]').trigger("click")},"show grid":function(){$('nav a[href="ajax/grid.html"]').trigger("click")},"show tree view":function(){$('nav a[href="ajax/treeview.html"]').trigger("click")},"show nestable lists":function(){$('nav a[href="ajax/nestable-list.html"]').trigger("click")},"show jquery U I":function(){$('nav a[href="ajax/jqui.html"]').trigger("click")},"show typography":function(){$('nav a[href="ajax/typography.html"]').trigger("click")},"show calendar":function(){$('nav a[href="ajax/calendar.html"]').trigger("click")},"show widgets":function(){$('nav a[href="ajax/widgets.html"]').trigger("click")},"show gallery":function(){$('nav a[href="ajax/gallery.html"]').trigger("click")},"show maps":function(){$('nav a[href="ajax/gmap-xml.html"]').trigger("click")},"show pricing tables":function(){$('nav a[href="ajax/pricing-table.html"]').trigger("click")},"show invoice":function(){$('nav a[href="ajax/invoice.html"]').trigger("click")},"show search":function(){$('nav a[href="ajax/search.html"]').trigger("click")},"go back":function(){history.back(1)},"scroll up":function(){$("html, body").animate({scrollTop:0},100)},"scroll down":function(){$("html, body").animate({scrollTop:$(document).height()},100)},"hide navigation":function(){$.root_.hasClass("container")&&!$.root_.hasClass("menu-on-top")?$("span.minifyme").trigger("click"):$("#hide-menu > span > a").trigger("click")},"show navigation":function(){$.root_.hasClass("container")&&!$.root_.hasClass("menu-on-top")?$("span.minifyme").trigger("click"):$("#hide-menu > span > a").trigger("click")},mute:function(){$.sound_on=!1,$.smallBox({title:"MUTE",content:"All sounds have been muted!",color:"#a90329",timeout:4e3,icon:"fa fa-volume-off"})},"sound on":function(){$.sound_on=!0,$.speechApp.playConfirmation(),$.smallBox({title:"UNMUTE",content:"All sounds have been turned on!",color:"#40ac2b",sound_file:"voice_alert",timeout:5e3,icon:"fa fa-volume-up"})},stop:function(){smartSpeechRecognition.abort(),$.root_.removeClass("voice-command-active"),$.smallBox({title:"VOICE COMMAND OFF",content:"Your voice commands has been successfully turned off. Click on the <i class='fa fa-microphone fa-lg fa-fw'></i> icon to turn it back on.",color:"#40ac2b",sound_file:"voice_off",timeout:8e3,icon:"fa fa-microphone-slash"}),$("#speech-btn .popover").is(":visible")&&$("#speech-btn .popover").fadeOut(250)},help:function(){$("#voiceModal").removeData("modal").modal({remote:"ajax/modal-content/modal-voicecommand.html",show:!0}),$("#speech-btn .popover").is(":visible")&&$("#speech-btn .popover").fadeOut(250)},"got it":function(){$("#voiceModal").modal("hide")},logout:function(){$.speechApp.stop(),window.location=$("#logout > span > a").attr("href")}};$.throttle_delay=350,$.menu_speed=235,$.navbar_height=49,$.root_=$("body"),$.left_panel=$("#left-panel"),$.shortcut_dropdown=$("#shortcut"),$.bread_crumb=$("#ribbon ol.breadcrumb"),$.device=null,$.navAsAjax=!1,$.enableJarvisWidgets=!0,$.enableMobileWidgets=!1;var ismobile=/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase());function nav_page_height(){var e=$("#main").height(),t=$(window).height()-$.navbar_height;e>t?($.left_panel.css("min-height",e+"px"),$.root_.css("min-height",e+$.navbar_height+"px")):($.left_panel.css("min-height",t+"px"),$.root_.css("min-height",t+"px"))}function check_if_mobile_width(){$(window).width()<979?$.root_.addClass("mobile-view-activated"):$.root_.hasClass("mobile-view-activated")&&$.root_.removeClass("mobile-view-activated")}ismobile?($.root_.addClass("mobile-detected"),$.device="mobile"):($.root_.addClass("desktop-detected"),$.device="desktop"),$(document).ready(function(){function e(){window.location=$.loginURL}function t(){$.shortcut_dropdown.animate({height:"hide"},300,"easeOutCirc"),$.root_.removeClass("shortcut-on")}$("[rel=tooltip]").length&&$("[rel=tooltip]").tooltip(),nav_page_height(),$("nav ul").jarvismenu({accordion:!0,speed:$.menu_speed,closedSign:'<em class="fal fa-plus"></em>',openedSign:'<em class="fal fa-minus"></em>'}),$(".minifyme").click(function(e){$("body").toggleClass("minified"),$(this).effect("highlight",{},500),e.preventDefault()}),$("#hide-menu >:first-child > a").click(function(e){$("body").toggleClass("hidden-menu"),e.preventDefault()}),$("#show-shortcut").click(function(e){$.shortcut_dropdown.is(":visible")?t():($.shortcut_dropdown.animate({height:"show"},200,"easeOutCirc"),$.root_.addClass("shortcut-on")),e.preventDefault()}),$("#search-mobile").click(function(){$.root_.addClass("search-mobile")}),$("#cancel-search-js").click(function(){$.root_.removeClass("search-mobile")}),$("#activity").click(function(e){var t=$(this);t.find(".badge").hasClass("bg-color-red")&&(t.find(".badge").removeClassPrefix("bg-color-"),t.find(".badge").text("0")),t.next(".ajax-dropdown").is(":visible")?(t.next(".ajax-dropdown").fadeOut(150),t.removeClass("active")):(t.next(".ajax-dropdown").fadeIn(150),t.addClass("active"));t.next(".ajax-dropdown").find(".btn-group > .active > input").attr("id");e.preventDefault()}),$('input[name="activity"]').change(function(){var e=$(this);url=e.attr("id"),container=$(".ajax-notifications"),loadURL(url,container)}),$(document).mouseup(function(e){$(".ajax-dropdown").is(e.target)||0!==$(".ajax-dropdown").has(e.target).length||($(".ajax-dropdown").fadeOut(150),$(".ajax-dropdown").prev().removeClass("active"))}),$("button[data-loading-text]").on("click",function(){var e=$(this);e.button("loading"),setTimeout(function(){e.button("reset")},3e3)}),$this=$("#activity > .badge"),parseInt($this.text())>0&&$this.addClass("bg-color-red bounceIn animated"),$("#refresh").click(function(e){$.SmartMessageBox({title:"<i class='fa fa-refresh' style='color:green'></i> Clear Local Storage",content:"Would you like to RESET all your saved widgets and clear LocalStorage?",buttons:"[No][Yes]"},function(e){"Yes"==e&&localStorage&&(localStorage.clear(),location.reload())}),e.preventDefault()}),$("#logout a").click(function(t){var i=$(this);$.loginURL=i.attr("href"),$.logoutMSG=i.data("logout-msg"),$.SmartMessageBox({title:"<i class='fa fa-sign-out txt-color-orangeDark'></i> Выйти <span class='txt-color-orangeDark'><strong>"+$("#show-shortcut").text()+"</strong></span> ?",content:$.logoutMSG||"Вы можете улучшить безопасность, закрыв этот браузер после выхода.",buttons:"[Нет][Да]"},function(t){"Да"==t&&($.root_.addClass("animated fadeOutUp"),setTimeout(e,1e3))}),t.preventDefault()}),$.shortcut_dropdown.find("a").click(function(e){e.preventDefault(),window.location=$(this).attr("href"),setTimeout(t,300)}),$(document).mouseup(function(e){$.shortcut_dropdown.is(e.target)||0!==$.shortcut_dropdown.has(e.target).length||t()})}),function(e,t,i){var n,s=e([]),o=e.resize=e.extend(e.resize,{}),r="setTimeout",a="resize",l=a+"-special-event",c="delay";o[c]=e.throttle_delay,o.throttleWindow=!0,e.event.special[a]={setup:function(){if(!o.throttleWindow&&this[r])return!1;var i=e(this);s=s.add(i),e.data(this,l,{w:i.width(),h:i.height()}),1===s.length&&function i(){n=t[r](function(){s.each(function(){var t=e(this),i=t.width(),n=t.height(),s=e.data(this,l);i===s.w&&n===s.h||t.trigger(a,[s.w=i,s.h=n])}),i()},o[c])}()},teardown:function(){if(!o.throttleWindow&&this[r])return!1;var t=e(this);s=s.not(t),t.removeData(l),s.length||clearTimeout(n)},add:function(t){if(!o.throttleWindow&&this[r])return!1;var n;function s(t,s,o){var r=e(this),a=e.data(this,l);a.w=s!==i?s:r.width(),a.h=o!==i?o:r.height(),n.apply(this,arguments)}if(e.isFunction(t))return n=t,s;n=t.handler,t.handler=s}}}(jQuery,this),$("#main").resize(function(){nav_page_height(),check_if_mobile_width()}),$("nav").resize(function(){nav_page_height()});var ie=function(){for(var e=3,t=document.createElement("div"),i=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",i[0];);return e>4?e:void 0}();function launchFullscreen(e){$.root_.hasClass("full-screen")?($.root_.removeClass("full-screen"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()):($.root_.addClass("full-screen"),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}function runAllForms(){$.fn.slider&&$(".slider").slider(),$.fn.select2&&$(".select2").each(function(){var e=$(this),t=e.attr("data-select-width")||"100%";e.select2({allowClear:!0,width:t})}),$.fn.mask&&$("[data-mask]").each(function(){var e=$(this),t=e.attr("data-mask")||"error...",i=e.attr("data-mask-placeholder")||"X";e.mask(t,{placeholder:i})}),$.fn.autocomplete&&$("[data-autocomplete]").each(function(){var e=$(this),t=e.data("autocomplete")||["The","Quick","Brown","Fox","Jumps","Over","Three","Lazy","Dogs"];e.autocomplete({source:t})}),$.fn.datepicker&&$(".datepicker").each(function(){var e=$(this),t=e.attr("data-dateformat")||"dd.mm.yy";e.datepicker({dateFormat:t,prevText:'<i class="fa fa-chevron-left"></i>',nextText:'<i class="fa fa-chevron-right"></i>'})}),$("button[data-loading-text]").on("click",function(){var e=$(this);e.button("loading"),setTimeout(function(){e.button("reset")},3e3)})}function runAllCharts(){$.fn.sparkline&&$(".sparkline").each(function(){var e=$(this),t=e.data("sparkline-type")||"bar";if("bar"==t){var i=e.data("sparkline-bar-color")||e.css("color")||"#0000f0",n=e.data("sparkline-height")||"26px",s=e.data("sparkline-barwidth")||5,o=e.data("sparkline-barspacing")||2,r=e.data("sparkline-negbar-color")||"#A90329",a=e.data("sparkline-barstacked-color")||["#A90329","#0099c6","#98AA56","#da532c","#4490B1","#6E9461","#990099","#B4CAD3"];e.sparkline("html",{type:"bar",barColor:i,type:t,height:n,barWidth:s,barSpacing:o,stackedBarColor:a,negBarColor:r,zeroAxis:"false"})}if("line"==t){n=e.data("sparkline-height")||"20px";var l=e.data("sparkline-width")||"90px",c=e.data("sparkline-line-color")||e.css("color")||"#0000f0",d=e.data("sparkline-line-width")||1,u=e.data("fill-color")||"#c0d0f0",h=e.data("sparkline-spot-color")||"#f08000",p=e.data("sparkline-minspot-color")||"#ed1c24",f=e.data("sparkline-maxspot-color")||"#f08000",m=e.data("sparkline-highlightspot-color")||"#50f050",g=e.data("sparkline-highlightline-color")||"f02020",v=e.data("sparkline-spotradius")||1.5;thisChartMinYRange=e.data("sparkline-min-y")||"undefined",thisChartMaxYRange=e.data("sparkline-max-y")||"undefined",thisChartMinXRange=e.data("sparkline-min-x")||"undefined",thisChartMaxXRange=e.data("sparkline-max-x")||"undefined",thisMinNormValue=e.data("min-val")||"undefined",thisMaxNormValue=e.data("max-val")||"undefined",thisNormColor=e.data("norm-color")||"#c0c0c0",thisDrawNormalOnTop=e.data("draw-normal")||!1,e.sparkline("html",{type:"line",width:l,height:n,lineWidth:d,lineColor:c,fillColor:u,spotColor:h,minSpotColor:p,maxSpotColor:f,highlightSpotColor:m,highlightLineColor:g,spotRadius:v,chartRangeMin:thisChartMinYRange,chartRangeMax:thisChartMaxYRange,chartRangeMinX:thisChartMinXRange,chartRangeMaxX:thisChartMaxXRange,normalRangeMin:thisMinNormValue,normalRangeMax:thisMaxNormValue,normalRangeColor:thisNormColor,drawNormalOnTop:thisDrawNormalOnTop})}if("pie"==t){var b=e.data("sparkline-piecolor")||["#B4CAD3","#4490B1","#98AA56","#da532c","#6E9461","#0099c6","#990099","#717D8A"],y=e.data("sparkline-piesize")||90,w=e.data("border-color")||"#45494C",x=e.data("sparkline-offset")||0;e.sparkline("html",{type:"pie",width:y,height:y,tooltipFormat:'<span style="color: {{color}}">&#9679;</span> ({{percent.1}}%)',sliceColors:b,offset:0,borderWidth:1,offset:x,borderColor:w})}if("box"==t){var C=e.data("sparkline-width")||"auto",E=e.data("sparkline-height")||"auto",T=e.data("sparkline-boxraw")||!1,k=e.data("sparkline-targetval")||"undefined",_=e.data("sparkline-min")||"undefined",S=e.data("sparkline-max")||"undefined",D=e.data("sparkline-showoutlier")||!0,M=e.data("sparkline-outlier-iqr")||1.5,A=e.data("sparkline-spotradius")||1.5,O=e.css("color")||"#000000",F=e.data("fill-color")||"#c0d0f0",N=e.data("sparkline-whis-color")||"#000000",L=e.data("sparkline-outline-color")||"#303030",R=e.data("sparkline-outlinefill-color")||"#f0f0f0",I=e.data("sparkline-outlinemedian-color")||"#f00000",P=e.data("sparkline-outlinetarget-color")||"#40a020";e.sparkline("html",{type:"box",width:C,height:E,raw:T,target:k,minValue:_,maxValue:S,showOutliers:D,outlierIQR:M,spotRadius:A,boxLineColor:O,boxFillColor:F,whiskerColor:N,outlierLineColor:L,outlierFillColor:R,medianColor:I,targetColor:P})}if("bullet"==t){var B=e.data("sparkline-height")||"auto",H=e.data("sparkline-width")||2,U=e.data("sparkline-bullet-color")||"#ed1c24",z=e.data("sparkline-performance-color")||"#3030f0",j=e.data("sparkline-bulletrange-color")||["#d3dafe","#a8b6ff","#7f94ff"];e.sparkline("html",{type:"bullet",height:B,targetWidth:H,targetColor:U,performanceColor:z,rangeColors:j})}if("discrete"==t){var K=e.data("sparkline-height")||26,W=e.data("sparkline-width")||50,V=e.css("color"),Y=e.data("sparkline-line-height")||5,q=e.data("sparkline-threshold")||"undefined",G=e.data("sparkline-threshold-color")||"#ed1c24";e.sparkline("html",{type:"discrete",width:W,height:K,lineColor:V,lineHeight:Y,thresholdValue:q,thresholdColor:G})}if("tristate"==t){var X=e.data("sparkline-height")||26,Q=(e.data("sparkline-posbar-color"),e.data("sparkline-negbar-color")||"#f04040"),Z=e.data("sparkline-zerobar-color")||"#909090",J=e.data("sparkline-barwidth")||5,ee=e.data("sparkline-barspacing")||2,te=e.data("sparkline-zeroaxis")||!1;e.sparkline("html",{type:"tristate",height:X,posBarColor:ie,negBarColor:Q,zeroBarColor:Z,barWidth:J,barSpacing:ee,zeroAxis:te})}if("compositebar"==t){n=e.data("sparkline-height")||"20px",l=e.data("sparkline-width")||"100%",s=e.data("sparkline-barwidth")||3,d=e.data("sparkline-line-width")||1,c=e.data("sparkline-color-top")||"#ed1c24";var ie=e.data("sparkline-color-bottom")||"#333333";e.sparkline(e.data("sparkline-bar-val"),{type:"bar",width:l,height:n,barColor:ie,barWidth:s}),e.sparkline(e.data("sparkline-line-val"),{width:l,height:n,lineColor:c,lineWidth:d,composite:!0,fillColor:!1})}if("compositeline"==t){n=e.data("sparkline-height")||"20px",l=e.data("sparkline-width")||"90px";var ne=e.data("sparkline-bar-val"),se=e.data("sparkline-bar-val-spots-top")||null,oe=e.data("sparkline-bar-val-spots-bottom")||null,re=e.data("sparkline-line-width-top")||1,ae=e.data("sparkline-line-width-bottom")||1,le=e.data("sparkline-color-top")||"#333333",ce=e.data("sparkline-color-bottom")||"#ed1c24",de=e.data("sparkline-spotradius-top")||1.5,ue=e.data("sparkline-spotradius-bottom")||de,he=(h=e.data("sparkline-spot-color")||"#f08000",e.data("sparkline-minspot-color-top")||"#ed1c24"),pe=e.data("sparkline-maxspot-color-top")||"#f08000",fe=e.data("sparkline-minspot-color-bottom")||he,me=e.data("sparkline-maxspot-color-bottom")||pe,ge=e.data("sparkline-highlightspot-color-top")||"#50f050",ve=e.data("sparkline-highlightline-color-top")||"#f02020",be=e.data("sparkline-highlightspot-color-bottom")||ge,ye=e.data("sparkline-highlightline-color-bottom")||ve,we=e.data("sparkline-fillcolor-top")||"transparent",xe=e.data("sparkline-fillcolor-bottom")||"transparent";e.sparkline(ne,{type:"line",spotRadius:de,spotColor:h,minSpotColor:he,maxSpotColor:pe,highlightSpotColor:ge,highlightLineColor:ve,valueSpots:se,lineWidth:re,width:l,height:n,lineColor:le,fillColor:we}),e.sparkline(e.data("sparkline-line-val"),{type:"line",spotRadius:ue,spotColor:h,minSpotColor:fe,maxSpotColor:me,highlightSpotColor:be,highlightLineColor:ye,valueSpots:oe,lineWidth:ae,width:l,height:n,lineColor:ce,composite:!0,fillColor:xe})}}),$.fn.easyPieChart&&$(".easy-pie-chart").each(function(){var e=$(this),t=e.css("color")||e.data("pie-color"),i=e.data("pie-track-color")||"#eeeeee",n=parseInt(e.data("pie-size"))||25;e.easyPieChart({barColor:t,trackColor:i,scaleColor:!1,lineCap:"butt",lineWidth:parseInt(n/8.5),animate:1500,rotate:-90,size:n,onStep:function(e){this.$el.find("span").text(~~e)}})})}function setup_widgets_desktop(){$.fn.jarvisWidgets&&$.enableJarvisWidgets&&$("#widget-grid").jarvisWidgets({grid:"article",widgets:".jarviswidget",localStorage:!0,deleteSettingsKey:"#deletesettingskey-options",settingsKeyLabel:"Reset settings?",deletePositionKey:"#deletepositionkey-options",positionKeyLabel:"Reset position?",sortable:!0,buttonsHidden:!1,toggleButton:!0,toggleClass:"fa fa-minus | fa fa-plus",toggleSpeed:200,onToggle:function(){},deleteButton:!0,deleteClass:"fa fa-times",deleteSpeed:200,onDelete:function(){},editButton:!0,editPlaceholder:".jarviswidget-editbox",editClass:"fa fa-cog | fa fa-save",editSpeed:200,onEdit:function(){},colorButton:!0,fullscreenButton:!0,fullscreenClass:"fa fa-resize-full | fa fa-resize-small",fullscreenDiff:3,onFullscreen:function(){},customButton:!1,customClass:"folder-10 | next-10",customStart:function(){alert("Hello you, this is a custom button...")},customEnd:function(){alert("bye, till next time...")},buttonOrder:"%refresh% %custom% %edit% %toggle% %fullscreen% %delete%",opacity:1,dragHandle:"> header",placeholderClass:"jarviswidget-placeholder",indicator:!0,indicatorTime:600,ajax:!0,timestampPlaceholder:".jarviswidget-timestamp",timestampFormat:"Last update: %m%/%d%/%y% %h%:%i%:%s%",refreshButton:!0,refreshButtonClass:"fa fa-refresh",labelError:"Sorry but there was a error:",labelUpdated:"Last Update:",labelRefresh:"Refresh",labelDelete:"Delete widget:",afterLoad:function(){},rtl:!1,onChange:function(){},onSave:function(){},ajaxnav:$.navAsAjax})}function setup_widgets_mobile(){$.enableMobileWidgets&&$.enableJarvisWidgets&&setup_widgets_desktop()}$.fn.extend({jarvismenu:function(e){var t=$.extend({accordion:"true",speed:200,closedSign:"[+]",openedSign:"[-]"},e),i=$(this);i.find("li").each(function(){0!=$(this).find("ul").size()&&($(this).find("a:first").append("<b class='collapse-sign'>"+t.closedSign+"</b>"),"#"==$(this).find("a:first").attr("href")&&$(this).find("a:first").click(function(){return!1}))}),i.find("li.active").each(function(){$(this).parents("ul").slideDown(t.speed),$(this).parents("ul").parent("li").find("b:first").html(t.openedSign),$(this).parents("ul").parent("li").addClass("open")}),i.find("li a").click(function(){0!=$(this).parent().find("ul").size()&&(t.accordion&&($(this).parent().find("ul").is(":visible")||(parents=$(this).parent().parents("ul"),visible=i.find("ul:visible"),visible.each(function(e){var i=!0;parents.each(function(t){if(parents[t]==visible[e])return i=!1,!1}),i&&$(this).parent().find("ul")!=visible[e]&&$(visible[e]).slideUp(t.speed,function(){$(this).parent("li").find("b:first").html(t.closedSign),$(this).parent("li").removeClass("open")})}))),$(this).parent().find("ul:first").is(":visible")&&!$(this).parent().find("ul:first").hasClass("active")?$(this).parent().find("ul:first").slideUp(t.speed,function(){$(this).parent("li").removeClass("open"),$(this).parent("li").find("b:first").delay(t.speed).html(t.closedSign)}):$(this).parent().find("ul:first").slideDown(t.speed,function(){$(this).parent("li").addClass("open"),$(this).parent("li").find("b:first").delay(t.speed).html(t.openedSign)}))})}}),jQuery.fn.doesExist=function(){return jQuery(this).length>0};var gMapsLoaded=!1;window.gMapsCallback=function(){gMapsLoaded=!0,$(window).trigger("gMapsLoaded")},window.loadGoogleMaps=function(){if(gMapsLoaded)return window.gMapsCallback();var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","http://maps.google.com/maps/api/js?sensor=false&callback=gMapsCallback"),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(e)};var jsArray={};function loadScript(e,t){if(jsArray[e])t&&t();else{jsArray[e]=!0;var i=document.getElementsByTagName("body")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t,i.appendChild(n)}}function checkURL(){var e=location.hash.replace(/^#/,"");if(container=$("#content"),e){$("nav li.active").removeClass("active"),$('nav li:has(a[href="'+e+'"])').addClass("active");var t=$('nav a[href="'+e+'"]').attr("title");document.title=t||document.title,loadURL(e+location.search,container)}else{var i=$('nav > ul > li:first-child > a[href!="#"]');window.location.hash=i.attr("href")}}function loadURL(e,t){$.ajax({type:"GET",url:e,dataType:"html",cache:!0,beforeSend:function(){t.html('<h1><i class="fa fa-cog fa-spin"></i> Loading...</h1>'),t[0]==$("#content")[0]&&(drawBreadCrumb(),$("html").animate({scrollTop:0},"fast"))},success:function(e){t.css({opacity:"0.0"}).html(e).delay(50).animate({opacity:"1.0"},300)},error:function(e,i,n){t.html('<h4 style="margin-top:10px; display:block; text-align:left"><i class="fa fa-warning txt-color-orangeDark"></i> Error 404! Page not found.</h4>')},async:!1})}function drawBreadCrumb(){var e=$("nav li.active > a"),t=e.length;$.bread_crumb.empty(),$.bread_crumb.append($("<li>Home</li>")),e.each(function(){$.bread_crumb.append($("<li></li>").html($.trim($(this).clone().children(".badge").remove().end().text()))),--t||(document.title=$.bread_crumb.find("li:last-child").text())})}function pageSetUp(){"desktop"===$.device?($("[rel=tooltip]").tooltip(),$("[rel=popover]").popover(),$("[rel=popover-hover]").popover({trigger:"hover"}),runAllCharts(),setup_widgets_desktop(),nav_page_height(),runAllForms()):($("[rel=popover]").popover(),$("[rel=popover-hover]").popover({trigger:"hover"}),runAllCharts(),setup_widgets_mobile(),nav_page_height(),runAllForms())}if($.navAsAjax&&($("nav").length&&checkURL(),$(document).on("click",'nav a[href!="#"]',function(e){e.preventDefault();var t=$(e.currentTarget);t.parent().hasClass("active")||t.attr("target")||($.root_.hasClass("mobile-view-activated")?($.root_.removeClass("hidden-menu"),window.setTimeout(function(){window.location.search?window.location.href=window.location.href.replace(window.location.search,"").replace(window.location.hash,"")+"#"+t.attr("href"):window.location.hash=t.attr("href")},150)):window.location.search?window.location.href=window.location.href.replace(window.location.search,"").replace(window.location.hash,"")+"#"+t.attr("href"):window.location.hash=t.attr("href"))}),$(document).on("click",'nav a[target="_blank"]',function(e){e.preventDefault();var t=$(e.currentTarget);window.open(t.attr("href"))}),$(document).on("click",'nav a[target="_top"]',function(e){e.preventDefault();var t=$(e.currentTarget);window.location=t.attr("href")}),$(document).on("click",'nav a[href="#"]',function(e){e.preventDefault()}),$(window).on("hashchange",function(){checkURL()})),$("body").on("click",function(e){$('[rel="popover"]').each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})}),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,n=e.ui.mouse.prototype,s=n._mouseInit;n._touchStart=function(e){!i&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,this._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},n._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},n._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},n._mouseInit=function(){var t=this;t.element.bind("touchstart",e.proxy(t,"_touchStart")).bind("touchmove",e.proxy(t,"_touchMove")).bind("touchend",e.proxy(t,"_touchEnd")),s.call(t)}}}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");function SmartUnLoading(){$(".divMessageBox").fadeOut(300,function(){$(this).remove()}),$(".LoadingBoxContainer").fadeOut(300,function(){$(this).remove()})}!function(e){"use strict";e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one("bsTransitionEnd",function(){i=!0});return setTimeout(function(){i||e(n).trigger(e.support.transition.end)},t),this},e(function(){e.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){return e(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),function(e){"use strict";var t='[data-dismiss="alert"]',i=function(i){e(i).on("click",t,this.close)};i.VERSION="3.2.0",i.prototype.close=function(t){function i(){o.detach().trigger("closed.bs.alert").remove()}var n=e(this),s=n.attr("data-target");s||(s=(s=n.attr("href"))&&s.replace(/.*(?=#[^\s]*$)/,""));var o=e(s);t&&t.preventDefault(),o.length||(o=n.hasClass("alert")?n:n.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(150):i())};var n=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var n=e(this),s=n.data("bs.alert");s||n.data("bs.alert",s=new i(this)),"string"==typeof t&&s[t].call(n)})},e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=n,this},e(document).on("click.bs.alert.data-api",t,i.prototype.close)}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),s=n.data("bs.button"),o="object"==typeof t&&t;s||n.data("bs.button",s=new i(this,o)),"toggle"==t?s.toggle():t&&s.setState(t)})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.2.0",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(t){var i="disabled",n=this.$element,s=n.is("input")?"val":"html",o=n.data();t+="Text",null==o.resetText&&n.data("resetText",n[s]()),n[s](null==o[t]?this.options[t]:o[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=t,e.fn.button.Constructor=i,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=e(i.target);n.hasClass("btn")||(n=n.closest(".btn")),t.call(n,"toggle"),i.preventDefault()})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),s=n.data("bs.carousel"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t),r="string"==typeof t?t:o.slide;s||n.data("bs.carousel",s=new i(this,o)),"number"==typeof t?s.to(t):r?s[r]():o.interval&&s.pause().cycle()})}var i=function(t,i){this.$element=e(t).on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};i.VERSION="3.2.0",i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},i.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},i.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},i.prototype.to=function(t){var i=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},i.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),s=i||n[t](),o=this.interval,r="next"==t?"left":"right",a="next"==t?"first":"last",l=this;if(!s.length){if(!this.options.wrap)return;s=this.$element.find(".item")[a]()}if(s.hasClass("active"))return this.sliding=!1;var c=s[0],d=e.Event("slide.bs.carousel",{relatedTarget:c,direction:r});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=e(this.$indicators.children()[this.getItemIndex(s)]);u&&u.addClass("active")}var h=e.Event("slid.bs.carousel",{relatedTarget:c,direction:r});return e.support.transition&&this.$element.hasClass("slide")?(s.addClass(t),s[0].offsetWidth,n.addClass(r),s.addClass(r),n.one("bsTransitionEnd",function(){s.removeClass([t,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(h)},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(h)),o&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=i,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(i){var n,s=e(this),o=e(s.attr("data-target")||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var r=e.extend({},o.data(),s.data()),a=s.attr("data-slide-to");a&&(r.interval=!1),t.call(o,r),a&&o.data("bs.carousel").to(a),i.preventDefault()}}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var i=e(this);t.call(i,i.data())})})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),s=n.data("bs.collapse"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!s&&o.toggle&&"show"==t&&(t=!t),s||n.data("bs.collapse",s=new i(this,o)),"string"==typeof t&&s[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.2.0",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var s=n.data("bs.collapse");if(s&&s.transitioning)return;t.call(n,"hide"),s||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return r.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(r,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?void this.$element[i](0).one("bsTransitionEnd",e.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=t,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,s=e(this),o=s.attr("data-target")||i.preventDefault()||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),r=e(o),a=r.data("bs.collapse"),l=a?"toggle":s.data(),c=s.attr("data-parent"),d=c&&e(c);a&&a.transitioning||(d&&d.find('[data-toggle="collapse"][data-parent="'+c+'"]').not(s).addClass("collapsed"),s[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(r,l)})}(jQuery),function(e){"use strict";function t(t){t&&3===t.which||(e(n).remove(),e(s).each(function(){var n=i(e(this)),s={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown",s)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",s))}))}function i(t){var i=t.attr("data-target");i||(i=(i=t.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}var n=".dropdown-backdrop",s='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.2.0",o.prototype.toggle=function(n){var s=e(this);if(!s.is(".disabled, :disabled")){var o=i(s),r=o.hasClass("open");if(t(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var a={relatedTarget:this};if(o.trigger(n=e.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;s.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var o=i(n),r=o.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&o.find(s).trigger("focus"),n.trigger("click");var a=" li:not(.divider):visible a",l=o.find('[role="menu"]'+a+', [role="listbox"]'+a);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",s,o.prototype.toggle).on("keydown.bs.dropdown.data-api",s+', [role="menu"], [role="listbox"]',o.prototype.keydown)}(jQuery),function(e){"use strict";function t(t,n){return this.each(function(){var s=e(this),o=s.data("bs.modal"),r=e.extend({},i.DEFAULTS,s.data(),"object"==typeof t&&t);o||s.data("bs.modal",o=new i(this,r)),"string"==typeof t?o[t](n):r.show&&o.show(n)})}var i=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.2.0",i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},i.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(s)}))},i.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},i.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},i.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(t){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){i.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(150):o()}else t&&t()},i.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},i.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var n=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=i,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=e(this),s=n.attr("href"),o=e(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),r=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(s)&&s},o.data(),n.data());n.is("a")&&i.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),t.call(o,r,this)})}(jQuery),function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.2.0",t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var s=this.options.trigger.split(" "),o=s.length;o--;){var r=s[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var i=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!i)return;var n=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,l=a.test(r);l&&(r=r.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var c=this.getPosition(),d=s[0].offsetWidth,u=s[0].offsetHeight;if(l){var h=r,p=this.$element.parent(),f=this.getPosition(p);r="bottom"==r&&c.top+c.height+u-f.scroll>f.height?"top":"top"==r&&c.top-f.scroll-u<0?"bottom":"right"==r&&c.right+d>f.width?"left":"left"==r&&c.left-d<f.left?"right":r,s.removeClass(h).addClass(r)}var m=this.getCalculatedOffset(r,c,d,u);this.applyPlacement(m,r);var g=function(){n.$element.trigger("shown.bs."+n.type),n.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},t.prototype.applyPlacement=function(t,i){var n=this.tip(),s=n[0].offsetWidth,o=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),t.top=t.top+r,t.left=t.left+a,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=o&&(t.top=t.top+o-c);var d=this.getViewportAdjustedDelta(i,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var u=d.left?2*d.left-s+l:2*d.top-o+c,h=d.left?"left":"top",p=d.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(u,n[0][p],h)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),s=e.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(s),s.isDefaultPrevented()?void 0:(n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){var i=(t=t||this.$element)[0],n="BODY"==i.tagName;return e.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?e(window).width():t.outerWidth(),height:n?e(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},t.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,i,n){var s={top:0,left:0};if(!this.$viewport)return s;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-o-r.scroll,l=t.top+o-r.scroll+n;a<r.top?s.top=r.top-a:l>r.top+r.height&&(s.top=r.top+r.height-l)}else{var c=t.left-o,d=t.left+o+i;c<r.left?s.left=r.left-c:d>r.width&&(s.left=r.left+r.width-d)}return s},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=this;t&&((i=e(t.currentTarget).data("bs."+this.type))||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),s=n.data("bs.tooltip"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.tooltip",s=new t(this,o)),"string"==typeof i&&s[i]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.2.0",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var n=e(this),s=n.data("bs.popover"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.popover",s=new t(this,o)),"string"==typeof i&&s[i]())})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(e){"use strict";function t(i,n){var s=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(e(i).is("body")?window:i),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",s),this.refresh(),this.process()}function i(i){return this.each(function(){var n=e(this),s=n.data("bs.scrollspy"),o="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new t(this,o)),"string"==typeof i&&s[i]()})}t.VERSION="3.2.0",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",i=0;e.isWindow(this.$scrollElement[0])||(t="position",i=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var n=this;this.$body.find(this.selector).map(function(){var n=e(this),s=n.data("target")||n.attr("href"),o=/^#./.test(s)&&e(s);return o&&o.length&&o.is(":visible")&&[[o[t]().top+i,s]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),s=this.offsets,o=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),t>=n)return r!=(e=o[o.length-1])&&this.activate(e);if(r&&t<=s[0])return r!=(e=o[0])&&this.activate(e);for(e=s.length;e--;)r!=o[e]&&t>=s[e]&&(!s[e+1]||t<=s[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=i,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new i(this)),"string"==typeof t&&s[t]()})}var i=function(t){this.element=e(t)};i.VERSION="3.2.0",i.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var s=i.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:s});if(t.trigger(o),!o.isDefaultPrevented()){var r=e(n);this.activate(t.closest("li"),i),this.activate(r,r.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:s})})}}},i.prototype.activate=function(t,i,n){function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var o=i.find("> .active"),r=n&&e.support.transition&&o.hasClass("fade");r?o.one("bsTransitionEnd",s).emulateTransitionEnd(150):s(),o.removeClass("in")};var n=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=i,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(i){i.preventDefault(),t.call(e(this),"show")})}(jQuery),function(e){"use strict";function t(t){return this.each(function(){var n=e(this),s=n.data("bs.affix"),o="object"==typeof t&&t;s||n.data("bs.affix",s=new i(this,o)),"string"==typeof t&&s[t]()})}var i=function(t,n){this.options=e.extend({},i.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.2.0",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},i.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=e(document).height(),n=this.$target.scrollTop(),s=this.$element.offset(),o=this.options.offset,r=o.top,a=o.bottom;"object"!=typeof o&&(a=r=o),"function"==typeof r&&(r=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var l=!(null!=this.unpin&&n+this.unpin<=s.top)&&(null!=a&&s.top+this.$element.height()>=t-a?"bottom":null!=r&&r>=n&&"top");if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),d=e.Event(c+".bs.affix");this.$element.trigger(d),d.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(c).trigger(e.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:t-this.$element.height()-a}))}}};var n=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=i,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var i=e(this),n=i.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.call(i,n)})})}(jQuery),$.sound_path="/packages/vis/builder/sound/",$(document).ready(function(){$("body").append("<div id='divSmallBoxes'></div>"),$("body").append("<div id='divMiniIcons'></div><div id='divbigBoxes'></div>")});var ExistMsg=0,SmartMSGboxCount=0,PrevTop=0;!function(e){e.SmartMessageBox=function(t,i){var n;t=e.extend({title:"",content:"",NormalButton:void 0,ActiveButton:void 0,buttons:void 0,input:void 0,inputValue:void 0,placeholder:"",options:void 0},t);if(1,0==isIE8orlower()){var s=document.createElement("audio");s.setAttribute("src",e.sound_path+"messagebox.mp3"),e.get(),s.addEventListener("load",function(){s.play()},!0),s.pause(),s.play()}SmartMSGboxCount+=1,0==ExistMsg&&(ExistMsg=1,"<div class='divMessageBox animated fadeIn fast' id='MsgBoxBack'></div>",e("body").append("<div class='divMessageBox animated fadeIn fast' id='MsgBoxBack'></div>"),1==isIE8orlower()&&e("#MsgBoxBack").addClass("MessageIE"));var o="",r=0;if(null!=t.input)switch(r=1,t.input=t.input.toLowerCase(),t.inputValue=t.inputValue?t.inputValue.replace(/'/g,"&#x27;"):"",t.input){case"text":o="<input class='form-control' type='"+t.input+"' id='txt"+SmartMSGboxCount+"' placeholder='"+t.placeholder+"' value='"+t.inputValue+"'/><br/><br/>";break;case"password":o="<input class='form-control' type='"+t.input+"' id='txt"+SmartMSGboxCount+"' placeholder='"+t.placeholder+"'/><br/><br/>";break;case"select":if(null==t.options)alert("For this type of input, the options parameter is required.");else{o="<select class='form-control' id='txt"+SmartMSGboxCount+"'>";for(var a=0;a<=t.options.length-1;a++)"["==t.options[a]?l="":"]"==t.options[a]?(c+=1,o+=l="<option>"+l+"</option>"):l+=t.options[a];o+="</select>"}break;default:alert("That type of input is not handled yet")}n="<div class='MessageBoxContainer animated fadeIn fast' id='Msg"+SmartMSGboxCount+"'>",n+="<div class='MessageBoxMiddle'>",n+="<span class='MsgTitle'>"+t.title+"</span class='MsgTitle'>",n+="<p class='pText'>"+t.content+"</p>",n+=o,n+="<div class='MessageBoxButtonSection'>",null==t.buttons&&(t.buttons="[Accept]"),t.buttons=e.trim(t.buttons),t.buttons=t.buttons.split("");var l="",c=0;null==t.NormalButton&&(t.NormalButton="#232323"),null==t.ActiveButton&&(t.ActiveButton="#ed145b");for(a=0;a<=t.buttons.length-1;a++)"["==t.buttons[a]?l="":"]"==t.buttons[a]?n+=l="<button id='bot"+(c+=1)+"-Msg"+SmartMSGboxCount+"' class='btn btn-default btn-sm botTempo'> "+l+"</button>":l+=t.buttons[a];n+="</div>",n+="</div>",n+="</div>",SmartMSGboxCount>1&&(e(".MessageBoxContainer").hide(),e(".MessageBoxContainer").css("z-index",99999)),e(".divMessageBox").append(n),1==r&&e("#txt"+SmartMSGboxCount).focus(),e(".botTempo").hover(function(){e(this).attr("id")},function(){e(this).attr("id")}),e(".botTempo").click(function(){var t=e(this).attr("id"),n=t.substr(t.indexOf("-")+1),s=e.trim(e(this).text());if(1==r){if("function"==typeof i){var o=n.replace("Msg",""),a=e("#txt"+o).val();i&&i(s,a)}}else"function"==typeof i&&i&&i(s);e("#"+n).addClass("animated fadeOut fast"),0==(SmartMSGboxCount-=1)&&e("#MsgBoxBack").removeClass("fadeIn").addClass("fadeOut").delay(300).queue(function(){ExistMsg=0,e(this).remove()})})}}(jQuery);var BigBoxes=0;!function(e){e.bigBox=function(t,i){var n;if(!0===(t=e.extend({title:"",content:"",icon:void 0,number:void 0,color:void 0,sound:!0,timeout:void 0,colortime:1500,colors:void 0},t)).sound&&0==isIE8orlower()){var s=document.createElement("audio");navigator.userAgent.match("Firefox/")?s.setAttribute("src",e.sound_path+"bigbox.ogg"):s.setAttribute("src",e.sound_path+"bigbox.mp3"),e.get(),s.addEventListener("load",function(){s.play()},!0),s.pause(),s.play()}n="<div id='bigBox"+(BigBoxes+=1)+"' class='bigBox animated fadeIn fast'><div id='bigBoxColor"+BigBoxes+"'><i class='botClose fa fa-times' id='botClose"+BigBoxes+"'></i>",n+="<span>"+t.title+"</span>",n+="<p>"+t.content+"</p>",n+="<div class='bigboxicon'>",null==t.icon&&(t.icon="fa fa-cloud"),n+="<i class='"+t.icon+"'></i>",n+="</div>",n+="<div class='bigboxnumber'>",null!=t.number&&(n+=t.number),n+="</div></div>",n+="</div>",e("#divbigBoxes").append(n),null==t.color&&(t.color="#004d60"),e("#bigBox"+BigBoxes).css("background-color",t.color),e("#divMiniIcons").append("<div id='miniIcon"+BigBoxes+"' class='cajita animated fadeIn' style='background-color: "+t.color+";'><i class='"+t.icon+"'/></i></div>"),e("#miniIcon"+BigBoxes).bind("click",function(){var t=e(this).attr("id"),i=t.replace("miniIcon","bigBox"),n=t.replace("miniIcon","bigBoxColor");e(".cajita").each(function(t){var i=e(this).attr("id").replace("miniIcon","bigBox");e("#"+i).css("z-index",9998)}),e("#"+i).css("z-index",9999),e("#"+n).removeClass("animated fadeIn").delay(1).queue(function(){e(this).show(),e(this).addClass("animated fadeIn"),e(this).clearQueue()})});var o,r=e("#botClose"+BigBoxes),a=e("#bigBox"+BigBoxes),l=e("#miniIcon"+BigBoxes);if(null!=t.colors&&t.colors.length>0&&(r.attr("colorcount","0"),o=setInterval(function(){var e=r.attr("colorcount");r.animate({backgroundColor:t.colors[e].color}),a.animate({backgroundColor:t.colors[e].color}),l.animate({backgroundColor:t.colors[e].color}),e<t.colors.length-1?r.attr("colorcount",1*e+1):r.attr("colorcount",0)},t.colortime)),r.bind("click",function(){clearInterval(o),"function"==typeof i&&i&&i();var t=e(this).attr("id"),n=t.replace("botClose","bigBox"),s=t.replace("botClose","miniIcon");e("#"+n).removeClass("fadeIn fast"),e("#"+n).addClass("fadeOut fast").delay(300).queue(function(){e(this).clearQueue(),e(this).remove()}),e("#"+s).removeClass("fadeIn fast"),e("#"+s).addClass("fadeOut fast").delay(300).queue(function(){e(this).clearQueue(),e(this).remove()})}),null!=t.timeout){var c=BigBoxes;setTimeout(function(){clearInterval(o),e("#bigBox"+c).removeClass("fadeIn fast"),e("#bigBox"+c).addClass("fadeOut fast").delay(300).queue(function(){e(this).clearQueue(),e(this).remove()}),e("#miniIcon"+c).removeClass("fadeIn fast"),e("#miniIcon"+c).addClass("fadeOut fast").delay(300).queue(function(){e(this).clearQueue(),e(this).remove()})},t.timeout)}}}(jQuery);var SmallBoxes=0,SmallCount=0,SmallBoxesAnchos=0;function getInternetExplorerVersion(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)&&(e=parseFloat(RegExp.$1))}return e}function checkVersion(){var e="You're not using Windows Internet Explorer.",t=getInternetExplorerVersion();t>-1&&(e=t>=8?"You're using a recent copy of Windows Internet Explorer.":"You should upgrade your copy of Windows Internet Explorer."),alert(e)}function isIE8orlower(){var e="0",t=getInternetExplorerVersion();return t>-1&&(e=t>=9?0:1),e}function FastClick(e){var t,i=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.lastTouchIdentifier=this.touchStartY=this.touchStartX=0,this.layer=e,!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(i,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(i,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(i,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(i,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(i,arguments)},FastClick.notNeeded(e)||(this.deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,i,n){var s=Node.prototype.removeEventListener;"click"===t?s.call(e,t,i.hijacked||i,n):s.call(e,t,i,n)},e.addEventListener=function(t,i,n){var s=Node.prototype.addEventListener;"click"===t?s.call(e,t,i.hijacked||(i.hijacked=function(e){e.propagationStopped||i(e)}),n):s.call(e,t,i,n)}),"function"==typeof e.onclick&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null))}!function(e){e.smallBox=function(t,i){var n;if(!0===(t=e.extend({title:"",content:"",icon:void 0,iconSmall:void 0,sound:!1,color:void 0,timeout:void 0,colortime:1500,colors:void 0},t)).sound&&0==isIE8orlower()){var s=document.createElement("audio");navigator.userAgent.match("Firefox/")?s.setAttribute("src",e.sound_path+"smallbox.ogg"):s.setAttribute("src",e.sound_path+"smallbox.mp3"),e.get(),s.addEventListener("load",function(){s.play()},!0),s.pause(),s.play()}n="";var o="",r="smallbox"+(SmallBoxes+=1);(o=null==t.iconSmall?"<div class='miniIcono'></div>":"<div class='miniIcono'><i class='miniPic "+t.iconSmall+"'></i></div>",n=null==t.icon?"<div id='smallbox"+SmallBoxes+"' class='SmallBox animated fadeInRight fast'><div class='textoFull'><span>"+t.title+"</span><p>"+t.content+"</p></div>"+o+"</div>":"<div id='smallbox"+SmallBoxes+"' class='SmallBox animated fadeInRight fast'><div class='foto'><i class='"+t.icon+"'></i></div><div class='textoFoto'><span>"+t.title+"</span><p>"+t.content+"</p></div>"+o+"</div>",1==SmallBoxes)?(e("#divSmallBoxes").append(n),SmallBoxesAnchos=e("#smallbox"+SmallBoxes).height()+40):0==e(".SmallBox").size()?(e("#divSmallBoxes").append(n),SmallBoxesAnchos=e("#smallbox"+SmallBoxes).height()+40):(e("#divSmallBoxes").append(n),e("#smallbox"+SmallBoxes).css("top",SmallBoxesAnchos),SmallBoxesAnchos=SmallBoxesAnchos+e("#smallbox"+SmallBoxes).height()+20,e(".SmallBox").each(function(t){0==t?(e(this).css("top",20),heightPrev=e(this).height()+40,SmallBoxesAnchos=e(this).height()+40):(e(this).css("top",heightPrev),heightPrev=heightPrev+e(this).height()+20,SmallBoxesAnchos=SmallBoxesAnchos+e(this).height()+20)}));var a,l=e("#smallbox"+SmallBoxes);null==t.color?l.css("background-color","#004d60"):l.css("background-color",t.color),null!=t.colors&&t.colors.length>0&&(l.attr("colorcount","0"),a=setInterval(function(){var e=l.attr("colorcount");l.animate({backgroundColor:t.colors[e].color}),e<t.colors.length-1?l.attr("colorcount",1*e+1):l.attr("colorcount",0)},t.colortime)),null!=t.timeout&&setTimeout(function(){clearInterval(a);var t=e(this).height()+20;e("#"+r).css("top");0!=e("#"+r+":hover").length?e("#"+r).on("mouseleave",function(){SmallBoxesAnchos-=t,e("#"+r).remove(),"function"==typeof i&&i&&i();var n=0;e(".SmallBox").each(function(t){0==t?(e(this).animate({top:20},300),n=e(this).height()+40,SmallBoxesAnchos=e(this).height()+40):(e(this).animate({top:n},350),n=n+e(this).height()+20,SmallBoxesAnchos=SmallBoxesAnchos+e(this).height()+20)})}):(clearInterval(a),SmallBoxesAnchos-=t,"function"==typeof i&&i&&i(),e("#"+r).removeClass().addClass("SmallBox").animate({opacity:0},300,function(){e(this).remove();var t=0;e(".SmallBox").each(function(i){0==i?(e(this).animate({top:20},300),t=e(this).height()+40,SmallBoxesAnchos=e(this).height()+40):(e(this).animate({top:t}),t=t+e(this).height()+20,SmallBoxesAnchos=SmallBoxesAnchos+e(this).height()+20)})}))},t.timeout),e("#smallbox"+SmallBoxes).bind("click",function(){clearInterval(a),"function"==typeof i&&i&&i();var t=e(this).height()+20;e(this).attr("id"),e(this).css("top");SmallBoxesAnchos-=t,e(this).removeClass().addClass("SmallBox").animate({opacity:0},300,function(){e(this).remove();var t=0;e(".SmallBox").each(function(i){0==i?(e(this).animate({top:20},300),t=e(this).height()+40,SmallBoxesAnchos=e(this).height()+40):(e(this).animate({top:t},350),t=t+e(this).height()+20,SmallBoxesAnchos=SmallBoxesAnchos+e(this).height()+20)})})})}}(jQuery),function(e,t,i,n){function s(t,i){this.obj=e(t),this.o=e.extend({},e.fn[o].defaults,i),this.objId=this.obj.attr("id"),this.pwCtrls=".jarviswidget-ctrls",this.widget=this.obj.find(this.o.widgets),this.toggleClass=this.o.toggleClass.split("|"),this.editClass=this.o.editClass.split("|"),this.fullscreenClass=this.o.fullscreenClass.split("|"),this.customClass=this.o.customClass.split("|"),this.storage={enabled:this.o.localStorage},this.initialized=!1,this.init()}var o="jarvisWidgets",r=("ontouchstart"in t||t.DocumentTouch&&i instanceof DocumentTouch?"touchstart":"click")+"."+o;s.prototype={_runLoaderWidget:function(e){var t=this;!0===t.o.indicator&&e.parents(t.o.widgets).find(".jarviswidget-loader:first").stop(!0,!0).fadeIn(100).delay(t.o.indicatorTime).fadeOut(100)},_getPastTimestamp:function(e){var t=new Date(e),i=t.getMonth()+1,n=t.getDate(),s=t.getFullYear(),o=t.getHours(),r=t.getMinutes(),a=t.getUTCSeconds();return 10>i&&(i="0"+i),10>n&&(n="0"+n),10>o&&(o="0"+o),10>r&&(r="0"+r),10>a&&(a="0"+a),this.o.timestampFormat.replace(/%d%/g,n).replace(/%m%/g,i).replace(/%y%/g,s).replace(/%h%/g,o).replace(/%i%/g,r).replace(/%s%/g,a)},_loadAjaxFile:function(t,i,n){var s=this;t.find(".widget-body").load(i,function(i,n,o){var r=e(this);if("error"==n&&r.html('<h4 class="alert alert-danger">'+s.o.labelError+"<b> "+o.status+" "+o.statusText+"</b></h4>"),"success"==n){var a=t.find(s.o.timestampPlaceholder);a.length&&a.html(s._getPastTimestamp(new Date)),"function"==typeof s.o.afterLoad&&s.o.afterLoad.call(this,t)}s=null}),this._runLoaderWidget(n)},_loadKeys:function(){var e=this;if(!0===e.o.ajaxnav){var t=location.hash.replace(/^#/,"");e.storage.keySettings="Plugin_settings_"+t+"_"+e.objId,e.storage.keyPosition="Plugin_position_"+t+"_"+e.objId}else if(!1===e.initialized){t=e.o.pageKey||location.pathname;e.storage.keySettings="jarvisWidgets_settings_"+t+"_"+e.objId,e.storage.keyPosition="jarvisWidgets_position_"+t+"_"+e.objId}},_saveSettingsWidget:function(){var t=this,i=t.storage;t._loadKeys();var n=t.obj.find(t.o.widgets).map(function(){var t={};return t.id=e(this).attr("id"),t.style=e(this).attr("data-widget-attstyle"),t.title=e(this).children("header").children("h2").text(),t.hidden="none"==e(this).css("display")?1:0,t.collapsed=e(this).hasClass("jarviswidget-collapsed")?1:0,t}).get(),s=JSON.stringify({widget:n});i.enabled&&i.getKeySettings!=s&&(localStorage.setItem(i.keySettings,s),i.getKeySettings=s),"function"==typeof t.o.onSave&&t.o.onSave.call(this,null,s,i.keySettings)},_savePositionWidget:function(){var t=this,i=t.storage;t._loadKeys();var n=t.obj.find(t.o.grid+".sortable-grid").map(function(){return{section:e(this).children(t.o.widgets).map(function(){return{id:e(this).attr("id")}}).get()}}).get(),s=JSON.stringify({grid:n});i.enabled&&i.getKeyPosition!=s&&(localStorage.setItem(i.keyPosition,s),i.getKeyPosition=s),"function"==typeof t.o.onSave&&t.o.onSave.call(this,s,i.keyPosition)},init:function(){var t=this;if(!t.initialized){if(t._initStorage(t.storage),e("#"+t.objId).length||alert("It looks like your using a class instead of an ID, dont do that!"),!0===t.o.rtl&&e("body").addClass("rtl"),e(t.o.grid).each(function(){e(this).find(t.o.widgets).length&&e(this).addClass("sortable-grid")}),t.storage.enabled&&t.storage.getKeyPosition){var i=JSON.parse(t.storage.getKeyPosition);for(var s in i.grid){var a=t.obj.find(t.o.grid+".sortable-grid").eq(s);for(var l in i.grid[s].section)a.append(e("#"+i.grid[s].section[l].id))}}if(t.storage.enabled&&t.storage.getKeySettings){var c=JSON.parse(t.storage.getKeySettings);for(var s in c.widget){var d=e("#"+c.widget[s].id);c.widget[s].style&&d.removeClassPrefix("jarviswidget-color-").addClass(c.widget[s].style).attr("data-widget-attstyle",""+c.widget[s].style),1==c.widget[s].hidden?d.hide(1):d.show(1).removeAttr("data-widget-hidden"),1==c.widget[s].collapsed&&d.addClass("jarviswidget-collapsed").children("div").hide(1),d.children("header").children("h2").text()!=c.widget[s].title&&d.children("header").children("h2").text(c.widget[s].title)}}if(t.widget.each(function(){var i,s,o,r,a,l,c,d=e(this),u=e(this).children("header");if(!u.parent().attr("role")){!0===d.data("widget-hidden")&&d.hide(),!0===d.data("widget-collapsed")&&d.addClass("jarviswidget-collapsed").children("div").hide(),i=!0===t.o.customButton&&d.data("widget-custombutton")===n&&0!==t.customClass[0].length?'<a href="javascript:void(0);" class="button-icon jarviswidget-custom-btn"><i class="'+t.customClass[0]+'"></i></a>':"",s=!0===t.o.deleteButton&&d.data("widget-deletebutton")===n?'<a href="javascript:void(0);" class="button-icon jarviswidget-delete-btn" rel="tooltip" title="Delete" data-placement="bottom"><i class="'+t.o.deleteClass+'"></i></a>':"",o=!0===t.o.editButton&&d.data("widget-editbutton")===n?'<a href="javascript:void(0);" class="button-icon jarviswidget-edit-btn" rel="tooltip" title="Edit" data-placement="bottom"><i class="'+t.editClass[0]+'"></i></a>':"",r=!0===t.o.fullscreenButton&&d.data("widget-fullscreenbutton")===n?'<a href="javascript:void(0);" class="button-icon jarviswidget-fullscreen-btn" rel="tooltip" title="Fullscreen" data-placement="bottom"><i class="'+t.fullscreenClass[0]+'"></i></a>':"",!0===t.o.colorButton&&d.data("widget-colorbutton")===n?(a='<a data-toggle="dropdown" class="dropdown-toggle color-box selector" href="javascript:void(0);"></a><ul class="dropdown-menu arrow-box-up-right color-select pull-right"><li><span class="bg-color-green" data-widget-setstyle="jarviswidget-color-green" rel="tooltip" data-placement="left" data-original-title="Green Grass"></span></li><li><span class="bg-color-greenDark" data-widget-setstyle="jarviswidget-color-greenDark" rel="tooltip" data-placement="top" data-original-title="Dark Green"></span></li><li><span class="bg-color-greenLight" data-widget-setstyle="jarviswidget-color-greenLight" rel="tooltip" data-placement="top" data-original-title="Light Green"></span></li><li><span class="bg-color-purple" data-widget-setstyle="jarviswidget-color-purple" rel="tooltip" data-placement="top" data-original-title="Purple"></span></li><li><span class="bg-color-magenta" data-widget-setstyle="jarviswidget-color-magenta" rel="tooltip" data-placement="top" data-original-title="Magenta"></span></li><li><span class="bg-color-pink" data-widget-setstyle="jarviswidget-color-pink" rel="tooltip" data-placement="right" data-original-title="Pink"></span></li><li><span class="bg-color-pinkDark" data-widget-setstyle="jarviswidget-color-pinkDark" rel="tooltip" data-placement="left" data-original-title="Fade Pink"></span></li><li><span class="bg-color-blueLight" data-widget-setstyle="jarviswidget-color-blueLight" rel="tooltip" data-placement="top" data-original-title="Light Blue"></span></li><li><span class="bg-color-teal" data-widget-setstyle="jarviswidget-color-teal" rel="tooltip" data-placement="top" data-original-title="Teal"></span></li><li><span class="bg-color-blue" data-widget-setstyle="jarviswidget-color-blue" rel="tooltip" data-placement="top" data-original-title="Ocean Blue"></span></li><li><span class="bg-color-blueDark" data-widget-setstyle="jarviswidget-color-blueDark" rel="tooltip" data-placement="top" data-original-title="Night Sky"></span></li><li><span class="bg-color-darken" data-widget-setstyle="jarviswidget-color-darken" rel="tooltip" data-placement="right" data-original-title="Night"></span></li><li><span class="bg-color-yellow" data-widget-setstyle="jarviswidget-color-yellow" rel="tooltip" data-placement="left" data-original-title="Day Light"></span></li><li><span class="bg-color-orange" data-widget-setstyle="jarviswidget-color-orange" rel="tooltip" data-placement="bottom" data-original-title="Orange"></span></li><li><span class="bg-color-orangeDark" data-widget-setstyle="jarviswidget-color-orangeDark" rel="tooltip" data-placement="bottom" data-original-title="Dark Orange"></span></li><li><span class="bg-color-red" data-widget-setstyle="jarviswidget-color-red" rel="tooltip" data-placement="bottom" data-original-title="Red Rose"></span></li><li><span class="bg-color-redLight" data-widget-setstyle="jarviswidget-color-redLight" rel="tooltip" data-placement="bottom" data-original-title="Light Red"></span></li><li><span class="bg-color-white" data-widget-setstyle="jarviswidget-color-white" rel="tooltip" data-placement="right" data-original-title="Purity"></span></li><li><a href="javascript:void(0);" class="jarviswidget-remove-colors" data-widget-setstyle="" rel="tooltip" data-placement="bottom" data-original-title="Reset widget color to default">Remove</a></li></ul>',u.prepend('<div class="widget-toolbar">'+a+"</div>")):a="",!0===t.o.toggleButton&&d.data("widget-togglebutton")===n?l='<a href="javascript:void(0);" class="button-icon jarviswidget-toggle-btn" rel="tooltip" title="Collapse" data-placement="bottom"><i class="'+(!0===d.data("widget-collapsed")||d.hasClass("jarviswidget-collapsed")?t.toggleClass[1]:t.toggleClass[0])+'"></i></a>':l="",c=!0===t.o.refreshButton&&!1!==d.data("widget-refreshbutton")&&d.data("widget-load")?'<a href="javascript:void(0);" class="button-icon jarviswidget-refresh-btn" data-loading-text="&nbsp;&nbsp;Loading...&nbsp;" rel="tooltip" title="Refresh" data-placement="bottom"><i class="'+t.o.refreshButtonClass+'"></i></a>':"";var h=t.o.buttonOrder.replace(/%refresh%/g,c).replace(/%delete%/g,s).replace(/%custom%/g,i).replace(/%fullscreen%/g,r).replace(/%edit%/g,o).replace(/%toggle%/g,l);(""!==c||""!==s||""!==i||""!==r||""!==o||""!==l)&&u.prepend('<div class="jarviswidget-ctrls">'+h+"</div>"),!0===t.o.sortable&&d.data("widget-sortable")===n&&d.addClass("jarviswidget-sortable"),d.find(t.o.editPlaceholder).length&&d.find(t.o.editPlaceholder).find("input").val(e.trim(u.children("h2").text())),u.append('<span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>'),d.attr("role","widget").children("div").attr("role","content").prev("header").attr("role","heading").children("div").attr("role","menu")}}),!0===t.o.buttonsHidden&&e(t.o.pwCtrls).hide(),e(".jarviswidget header [rel=tooltip]").tooltip(),t.obj.find("[data-widget-load]").each(function(){var i=e(this),n=i.children(),s=i.data("widget-load"),o=1e3*i.data("widget-refresh");i.children(),i.find(".jarviswidget-ajax-placeholder").length||(i.children("widget-body").append('<div class="jarviswidget-ajax-placeholder">'+t.o.loadingLabel+"</div>"),i.data("widget-refresh")>0?(t._loadAjaxFile(i,s,n),e.intervalArr.push(setInterval(function(){t._loadAjaxFile(i,s,n)},o))):t._loadAjaxFile(i,s,n))}),!0===t.o.sortable&&jQuery.ui){var u=t.obj.find(t.o.grid+".sortable-grid").not("[data-widget-excludegrid]");u.sortable({items:u.find(t.o.widgets+".jarviswidget-sortable"),connectWith:u,placeholder:t.o.placeholderClass,cursor:"move",revert:!0,opacity:t.o.opacity,delay:200,cancel:".button-icon, #jarviswidget-fullscreen-mode > div",zIndex:1e4,handle:t.o.dragHandle,forcePlaceholderSize:!0,forceHelperSize:!0,update:function(e,i){t._runLoaderWidget(i.item.children()),t._savePositionWidget(),"function"==typeof t.o.onChange&&t.o.onChange.call(this,i.item)}})}!0===t.o.buttonsHidden&&t.widget.children("header").on("mouseenter."+o,function(){e(this).children(t.o.pwCtrls).stop(!0,!0).fadeTo(100,1)}).on("mouseleave."+o,function(){e(this).children(t.o.pwCtrls).stop(!0,!0).fadeTo(100,0)}),t._clickEvents(),t.storage.enabled&&(e(t.o.deleteSettingsKey).on(r,this,function(e){confirm(t.o.settingsKeyLabel)&&localStorage.removeItem(keySettings),e.preventDefault()}),e(t.o.deletePositionKey).on(r,this,function(e){confirm(t.o.positionKeyLabel)&&localStorage.removeItem(keyPosition),e.preventDefault()})),initialized=!0}},_initStorage:function(e){e.enabled=e.enabled&&!!function(){var e,t=+new Date;try{return localStorage.setItem(t,t),e=localStorage.getItem(t)==t,localStorage.removeItem(t),e}catch(e){}}(),this._loadKeys(),e.enabled&&(e.getKeySettings=localStorage.getItem(e.keySettings),e.getKeyPosition=localStorage.getItem(e.keyPosition))},_clickEvents:function(){function i(){if(e("#jarviswidget-fullscreen-mode").length){var i=e(t).height(),s=e("#jarviswidget-fullscreen-mode").children(n.o.widgets).children("header").height();e("#jarviswidget-fullscreen-mode").children(n.o.widgets).children("div").height(i-s-15)}}var n=this,s=n.widget.children("header");s.on(r,".jarviswidget-toggle-btn",function(t){var i=e(this),s=i.parents(n.o.widgets);n._runLoaderWidget(i),s.hasClass("jarviswidget-collapsed")?i.children().removeClass(n.toggleClass[1]).addClass(n.toggleClass[0]).parents(n.o.widgets).removeClass("jarviswidget-collapsed").children("[role=content]").slideDown(n.o.toggleSpeed,function(){n._saveSettingsWidget()}):i.children().removeClass(n.toggleClass[0]).addClass(n.toggleClass[1]).parents(n.o.widgets).addClass("jarviswidget-collapsed").children("[role=content]").slideUp(n.o.toggleSpeed,function(){n._saveSettingsWidget()}),"function"==typeof n.o.onToggle&&n.o.onToggle.call(this,s),t.preventDefault()}),s.on(r,".jarviswidget-fullscreen-btn",function(t){var s=e(this).parents(n.o.widgets),o=s.children("div");n._runLoaderWidget(e(this)),e("#jarviswidget-fullscreen-mode").length?(e(".nooverflow").removeClass("nooverflow"),s.unwrap("<div>").children("div").removeAttr("style").end().find(".jarviswidget-fullscreen-btn:first").children().removeClass(n.fullscreenClass[1]).addClass(n.fullscreenClass[0]).parents(n.pwCtrls).children("a").show(),o.hasClass("jarviswidget-visible")&&o.hide().removeClass("jarviswidget-visible")):(e("body").addClass("nooverflow"),s.wrap('<div id="jarviswidget-fullscreen-mode"/>').parent().find(".jarviswidget-fullscreen-btn:first").children().removeClass(n.fullscreenClass[0]).addClass(n.fullscreenClass[1]).parents(n.pwCtrls).children("a:not(.jarviswidget-fullscreen-btn)").hide(),o.is(":hidden")&&o.show().addClass("jarviswidget-visible")),i(),"function"==typeof n.o.onFullscreen&&n.o.onFullscreen.call(this,s),t.preventDefault()}),e(t).on("resize."+o,function(){i()}),s.on(r,".jarviswidget-edit-btn",function(t){var i=e(this).parents(n.o.widgets);n._runLoaderWidget(e(this)),i.find(n.o.editPlaceholder).is(":visible")?e(this).children().removeClass(n.editClass[1]).addClass(n.editClass[0]).parents(n.o.widgets).find(n.o.editPlaceholder).slideUp(n.o.editSpeed,function(){n._saveSettingsWidget()}):e(this).children().removeClass(n.editClass[0]).addClass(n.editClass[1]).parents(n.o.widgets).find(n.o.editPlaceholder).slideDown(n.o.editSpeed),"function"==typeof n.o.onEdit&&n.o.onEdit.call(this,i),t.preventDefault()}),e(n.o.editPlaceholder).find("input").keyup(function(){e(this).parents(n.o.widgets).children("header").children("h2").text(e(this).val())}),s.on(r,"[data-widget-setstyle]",function(t){var i=e(this).data("widget-setstyle");e(this).parents(n.o.editPlaceholder).find("[data-widget-setstyle]").each(function(){e(this).data("widget-setstyle")+" "}),e(this).parents(n.o.widgets).attr("data-widget-attstyle",""+i).removeClassPrefix("jarviswidget-color-").addClass(i),n._runLoaderWidget(e(this)),n._saveSettingsWidget(),t.preventDefault()}),s.on(r,".jarviswidget-custom-btn",function(t){var i=e(this).parents(n.o.widgets);n._runLoaderWidget(e(this)),e(this).children("."+n.customClass[0]).length?(e(this).children().removeClass(n.customClass[0]).addClass(n.customClass[1]),"function"==typeof n.o.customStart&&n.o.customStart.call(this,i)):(e(this).children().removeClass(n.customClass[1]).addClass(n.customClass[0]),"function"==typeof n.o.customEnd&&n.o.customEnd.call(this,i)),n._saveSettingsWidget(),t.preventDefault()}),s.on(r,".jarviswidget-delete-btn",function(t){var i=e(this).parents(n.o.widgets),s=i.attr("id"),o=i.children("header").children("h2").text();e.SmartMessageBox?e.SmartMessageBox({title:"<i class='fa fa-times' style='color:#ed1c24'></i> "+n.o.labelDelete+' "'+o+'"',content:n.o.deleteMsg,buttons:"[No][Yes]"},function(t){"Yes"==t&&(n._runLoaderWidget(e(this)),e("#"+s).fadeOut(n.o.deleteSpeed,function(){e(this).remove(),"function"==typeof n.o.onDelete&&n.o.onDelete.call(this,i)}))}):e("#"+s).fadeOut(n.o.deleteSpeed,function(){e(this).remove(),"function"==typeof n.o.onDelete&&n.o.onDelete.call(this,i)}),t.preventDefault()}),s.on(r,".jarviswidget-refresh-btn",function(t){var i=e(this).parents(n.o.widgets),s=i.data("widget-load"),o=i.children(),r=e(this);r.button("loading"),o.addClass("widget-body-ajax-loading"),setTimeout(function(){r.button("reset"),o.removeClass("widget-body-ajax-loading"),n._loadAjaxFile(i,s,o)},1e3),t.preventDefault()}),s=null},destroy:function(){var i=this,n="."+o;i.obj.find(i.o.grid+".sortable-grid").not("[data-widget-excludegrid]").sortable("destroy"),i.widget.children("header").off(n),e(i.o.deleteSettingsKey).off(n),e(i.o.deletePositionKey).off(n),e(t).off(n),i.obj.removeData(o)}},e.fn[o]=function(t){return this.each(function(){var i=e(this),n=i.data(o);if(!n){var r="object"==typeof t&&t;i.data(o,n=new s(this,r))}"string"==typeof t&&n[t]()})},e.fn[o].defaults={grid:"section",widgets:".jarviswidget",localStorage:!0,deleteSettingsKey:"",settingsKeyLabel:"Reset settings?",deletePositionKey:"",positionKeyLabel:"Reset position?",sortable:!0,buttonsHidden:!1,toggleButton:!0,toggleClass:"min-10 | plus-10",toggleSpeed:200,onToggle:function(){},deleteButton:!0,deleteMsg:"Warning: This action cannot be undone",deleteClass:"trashcan-10",deleteSpeed:200,onDelete:function(){},editButton:!0,editPlaceholder:".jarviswidget-editbox",editClass:"pencil-10 | delete-10",editSpeed:200,onEdit:function(){},colorButton:!0,fullscreenButton:!0,fullscreenClass:"fullscreen-10 | normalscreen-10",fullscreenDiff:3,onFullscreen:function(){},customButton:!0,customClass:"",customStart:function(){},customEnd:function(){},buttonOrder:"%refresh% %delete% %custom% %edit% %fullscreen% %toggle%",opacity:1,dragHandle:"> header",placeholderClass:"jarviswidget-placeholder",indicator:!0,indicatorTime:600,ajax:!0,loadingLabel:"loading...",timestampPlaceholder:".jarviswidget-timestamp",timestampFormat:"Last update: %m%/%d%/%y% %h%:%i%:%s%",refreshButton:!0,refreshButtonClass:"refresh-10",labelError:"Sorry but there was a error:",labelUpdated:"Last Update:",labelRefresh:"Refresh",labelDelete:"Delete widget:",afterLoad:function(){},rtl:!1,onChange:function(){},onSave:function(){},ajaxnav:!0},e.fn.removeClassPrefix=function(t){return this.each(function(i,n){var s=n.className.split(" ").map(function(e){return 0===e.indexOf(t)?"":e});n.className=e.trim(s.join(" "))}),this}}(jQuery,window,document),function(e){e.extend(e.fn,{validate:function(t){if(this.length){var i=e.data(this[0],"validator");return i||(this.attr("novalidate","novalidate"),i=new e.validator(t,this[0]),e.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){i.settings.submitHandler&&(i.submitButton=t.target),e(t.target).hasClass("cancel")&&(i.cancelSubmit=!0)}),this.submit(function(t){function n(){var n;return!i.settings.submitHandler||(i.submitButton&&(n=e("<input type='hidden'/>").attr("name",i.submitButton.name).val(i.submitButton.value).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,t),i.submitButton&&n.remove(),!1)}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){if(e(this[0]).is("form"))return this.validate().form();var t=!0,i=e(this[0].form).validate();return this.each(function(){t&=i.element(this)}),t},removeAttrs:function(t){var i={},n=this;return e.each(t.split(/\s/),function(e,t){i[t]=n.attr(t),n.removeAttr(t)}),i},rules:function(t,i){var n=this[0];if(t){var s=e.data(n.form,"validator").settings,o=s.rules,r=e.validator.staticRules(n);switch(t){case"add":e.extend(r,e.validator.normalizeRule(i)),o[n.name]=r,i.messages&&(s.messages[n.name]=e.extend(s.messages[n.name],i.messages));break;case"remove":if(!i)return delete o[n.name],r;var a={};return e.each(i.split(/\s/),function(e,t){a[t]=r[t],delete r[t]}),a}}var l=e.validator.normalizeRules(e.extend({},e.validator.classRules(n),e.validator.attributeRules(n),e.validator.dataRules(n),e.validator.staticRules(n)),n);if(l.required){var c=l.required;delete l.required,l=e.extend({required:c},l)}return l}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+t.value)},filled:function(t){return!!e.trim(""+t.value)},unchecked:function(e){return!e.checked}}),e.validator=function(t,i){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=i,this.init()},e.validator.format=function(t,i){return 1===arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!==Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),e.each(i,function(e,i){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return i})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"invalid",validClass:"valid",errorElement:"em",focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e,t){(9!==t.which||""!==this.elementValue(e))&&(e.name in this.submitted||e===this.lastElement)&&this.element(e)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(n).parent().addClass("state-error").removeClass("state-success"):e(t).addClass(i).removeClass(n).parent().addClass("state-error").removeClass("state-success")},unhighlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(n).parent().addClass("state-success").removeClass("state-error"):e(t).removeClass(i).addClass(n).parent().addClass("state-success").removeClass("state-error")}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required",remote:"Please fix this field",email:"Please enter a valid email address",url:"Please enter a valid URL",date:"Please enter a valid date",dateISO:"Please enter a valid date (ISO)",number:"Please enter a valid number",digits:"Please enter only digits",creditcard:"Please enter a valid credit card number",equalTo:"Please enter the same value again",maxlength:e.validator.format("Please enter no more than {0} characters"),minlength:e.validator.format("Please enter at least {0} characters"),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long"),range:e.validator.format("Please enter a value between {0} and {1}"),max:e.validator.format("Please enter a value less than or equal to {0}"),min:e.validator.format("Please enter a value greater than or equal to {0}")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var i=e.data(this[0].form,"validator"),n="on"+t.type.replace(/^validate/,"");i.settings[n]&&i.settings[n].call(i,this[0],t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i=this.groups={};e.each(this.settings.groups,function(t,n){"string"==typeof n&&(n=n.split(/\s/)),e.each(n,function(e,n){i[n]=t})});var n=this.settings.rules;e.each(n,function(t,i){n[t]=e.validator.normalizeRule(i)}),e(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",t).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",t),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=e(t);var i=!1!==this.check(t);return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){for(var i in e.extend(this.errorMap,t),this.errorList=[],t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t=0;for(var i in e)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,i={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in i||!t.objectLength(e(this).rules()))&&(i[this.name]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return e(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var i=e(t).attr("type"),n=e(t).val();return"radio"===i||"checkbox"===i?e("input[name='"+e(t).attr("name")+"']:checked").val():"string"==typeof n?n.replace(/\r/g,""):n},check:function(t){t=this.validationTargetFor(this.clean(t));var i,n=e(t).rules(),s=!1,o=this.elementValue(t);for(var r in n){var a={method:r,parameters:n[r]};try{if("dependency-mismatch"===(i=e.validator.methods[r].call(this,o,t,a.parameters))){s=!0;continue}if(s=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!i)return this.formatAndAdd(t,a),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occured when checking element "+t.id+", check the '"+a.method+"' method.",e),e}}return s?void 0:(this.objectLength(n)&&this.successList.push(t),!0)},customDataMessage:function(t,i){return e(t).data("msg-"+i.toLowerCase())||t.attributes&&e(t).attr("data-msg-"+i.toLowerCase())},customMessage:function(e,t){var i=this.settings.messages[e];return i&&(i.constructor===String?i:i[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customDataMessage(t,i),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,i){var n=this.defaultMessage(t,i.method),s=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,i.parameters,t):s.test(n)&&(n=e.validator.format(n.replace(s,"{$1}"),i.parameters)),this.errorList.push({message:n,element:t}),this.errorMap[t.name]=n,this.submitted[t.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t;for(e=0;this.errorList[e];e++){var i=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var n=this.errorsFor(t);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.html(i)):(n=e("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,e(t)):n.insertAfter(t))),!i&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n,t)),this.toShow=this.toShow.add(n)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return e(this).attr("for")===i})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name).not(this.settings.ignore)[0]),e},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+t+"']")},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return e("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e){return e},string:function(t,i){return!!e(t,i.form).length},function:function(e,t){return e(t)}},optional:function(t){var i=this.elementValue(t);return!e.validator.methods.required.call(this,i,t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor===String?this.classRuleSettings[t]=i:e.extend(this.classRuleSettings,t)},classRules:function(t){var i={},n=e(t).attr("class");return n&&e.each(n.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(i,e.validator.classRuleSettings[this])}),i},attributeRules:function(t){var i={},n=e(t);for(var s in e.validator.methods){var o;"required"===s?(""===(o=n.get(0).getAttribute(s))&&(o=!0),o=!!o):o=n.attr(s),o?i[s]=o:n[0].getAttribute("type")===s&&(i[s]=!0)}return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},dataRules:function(t){var i,n,s={},o=e(t);for(i in e.validator.methods)void 0!==(n=o.data("rule-"+i.toLowerCase()))&&(s[i]=n);return s},staticRules:function(t){var i={},n=e.data(t.form,"validator");return n.settings.rules&&(i=e.validator.normalizeRule(n.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return e.each(t,function(n,s){if(!1!==s){if(s.param||s.depends){var o=!0;switch(typeof s.depends){case"string":o=!!e(s.depends,i.form).length;break;case"function":o=s.depends.call(i,i)}o?t[n]=void 0===s.param||s.param:delete t[n]}}else delete t[n]}),e.each(t,function(n,s){t[n]=e.isFunction(s)?s(i):s}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength"],function(){var i;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(i=t[this].split(/[\s,]+/),t[this]=[Number(i[0]),Number(i[1])]))}),e.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var i={};e.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,n){e.validator.methods[t]=i,e.validator.messages[t]=void 0!==n?n:e.validator.messages[t],i.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,i,n){if(!this.depend(n,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var s=e(i).val();return s&&s.length>0}return this.checkable(i)?this.getLength(t,i)>0:e.trim(t).length>0},remote:function(t,i,n){if(this.optional(i))return"dependency-mismatch";var s=this.previousValue(i);if(this.settings.messages[i.name]||(this.settings.messages[i.name]={}),s.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=s.message,n="string"==typeof n&&{url:n}||n,s.old===t)return s.valid;s.old=t;var o=this;this.startRequest(i);var r={};return r[i.name]=t,e.ajax(e.extend(!0,{url:n,mode:"abort",port:"validate"+i.name,dataType:"json",data:r,success:function(n){o.settings.messages[i.name].remote=s.originalMessage;var r=!0===n||"true"===n;if(r){var a=o.formSubmitted;o.prepareElement(i),o.formSubmitted=a,o.successList.push(i),delete o.invalid[i.name],o.showErrors()}else{var l={},c=n||o.defaultMessage(i,"remote");l[i.name]=s.message=e.isFunction(c)?c(t):c,o.invalid[i.name]=!0,o.showErrors(l)}s.valid=r,o.stopRequest(i,r)}},n)),"pending"},minlength:function(t,i,n){var s=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||s>=n},maxlength:function(t,i,n){var s=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||n>=s},rangelength:function(t,i,n){var s=e.isArray(t)?t.length:this.getLength(e.trim(t),i);return this.optional(i)||s>=n[0]&&s<=n[1]},min:function(e,t,i){return this.optional(t)||e>=i},max:function(e,t,i){return this.optional(t)||i>=e},range:function(e,t,i){return this.optional(t)||e>=i[0]&&e<=i[1]},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;for(var i=0,n=0,s=!1,o=(e=e.replace(/\D/g,"")).length-1;o>=0;o--){var r=e.charAt(o);n=parseInt(r,10),s&&(n*=2)>9&&(n-=9),i+=n,s=!s}return i%10==0},equalTo:function(t,i,n){var s=e(n);return this.settings.onfocusout&&s.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(i).valid()}),t===s.val()}}}),e.format=e.validator.format}(jQuery),function(e){var t={};if(e.ajaxPrefilter)e.ajaxPrefilter(function(e,i,n){var s=e.port;"abort"===e.mode&&(t[s]&&t[s].abort(),t[s]=n)});else{var i=e.ajax;e.ajax=function(n){var s=("mode"in n?n:e.ajaxSettings).mode,o=("port"in n?n:e.ajaxSettings).port;return"abort"===s?(t[o]&&t[o].abort(),t[o]=i.apply(this,arguments)):i.apply(this,arguments)}}}(jQuery),function(e){e.extend(e.fn,{validateDelegate:function(t,i,n){return this.bind(i,function(i){var s=e(i.target);return s.is(t)?n.apply(s,arguments):void 0})}})}(jQuery),function(e){var t,i=function(){var e=document.createElement("input"),t="onpaste";return e.setAttribute(t,""),"function"==typeof e[t]?"paste":"input"}()+".mask",n=navigator.userAgent,s=/iphone/i.test(n),o=/android/i.test(n);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var i;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((i=this.createTextRange()).collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(n,r){var a,l,c,d,u;return!n&&this.length>0?e(this[0]).data(e.mask.dataName)():(r=e.extend({placeholder:e.mask.placeholder,completed:null},r),a=e.mask.definitions,l=[],c=u=n.length,d=null,e.each(n.split(""),function(e,t){"?"==t?(u--,c=e):a[t]?(l.push(new RegExp(a[t])),null===d&&(d=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function h(e){for(;++e<u&&!l[e];);return e}function p(e,t){var i,n;if(!(0>e)){for(i=e,n=h(t);u>i;i++)if(l[i]){if(!(u>n&&l[i].test(b[n])))break;b[i]=b[n],b[n]=r.placeholder,n=h(n)}m(),v.caret(Math.max(d,e))}}function f(e,t){var i;for(i=e;t>i&&u>i;i++)l[i]&&(b[i]=r.placeholder)}function m(){v.val(b.join(""))}function g(e){var t,i,n=v.val(),s=-1;for(t=0,pos=0;u>t;t++)if(l[t]){for(b[t]=r.placeholder;pos++<n.length;)if(i=n.charAt(pos-1),l[t].test(i)){b[t]=i,s=t;break}if(pos>n.length)break}else b[t]===n.charAt(pos)&&t!==c&&(pos++,s=t);return e?m():c>s+1?(v.val(""),f(0,u)):(m(),v.val(v.val().substring(0,s+1))),c?t:d}var v=e(this),b=e.map(n.split(""),function(e){return"?"!=e?a[e]?r.placeholder:e:void 0}),y=v.val();v.data(e.mask.dataName,function(){return e.map(b,function(e,t){return l[t]&&e!=r.placeholder?e:null}).join("")}),v.attr("readonly")||v.one("unmask",function(){v.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){var e;clearTimeout(t),y=v.val(),e=g(),t=setTimeout(function(){m(),e==n.length?v.caret(0,e):v.caret(e)},10)}).bind("blur.mask",function(){g(),v.val()!=y&&v.change()}).bind("keydown.mask",function(e){var t,i,n,o=e.which;8===o||46===o||s&&127===o?(i=(t=v.caret()).begin,(n=t.end)-i==0&&(i=46!==o?function(e){for(;--e>=0&&!l[e];);return e}(i):n=h(i-1),n=46===o?h(n):n),f(i,n),p(i,n-1),e.preventDefault()):27==o&&(v.val(y),v.caret(0,g()),e.preventDefault())}).bind("keypress.mask",function(t){var i,n,s,a=t.which,c=v.caret();t.ctrlKey||t.altKey||t.metaKey||32>a||a&&(c.end-c.begin!=0&&(f(c.begin,c.end),p(c.begin,c.end-1)),i=h(c.begin-1),u>i&&(n=String.fromCharCode(a),l[i].test(n)&&(function(e){var t,i,n,s;for(t=e,i=r.placeholder;u>t;t++)if(l[t]){if(n=h(t),s=b[t],b[t]=i,!(u>n&&l[n].test(s)))break;i=s}}(i),b[i]=n,m(),s=h(i),o?setTimeout(e.proxy(e.fn.caret,v,s),0):v.caret(s),r.completed&&s>=u&&r.completed.call(v))),t.preventDefault())}).bind(i,function(){setTimeout(function(){var e=g(!0);v.caret(e),r.completed&&e==v.val().length&&r.completed.call(v)},0)}),g()}))}})}(jQuery),function(){function e(e){return document.createElementNS(l,e)}function t(e){return(10>e?"0":"")+e}function i(e){var t=++g+"";return e?e+t:t}function n(n,r){function l(e,t){var i=u.offset(),n=/^touch/.test(e.type),o=i.left+v,l=i.top+v,d=(n?e.originalEvent.touches[0]:e).pageX-o,h=(n?e.originalEvent.touches[0]:e).pageY-l,m=Math.sqrt(d*d+h*h),g=!1;if(!t||!(b-w>m||m>b+w)){e.preventDefault();var y=setTimeout(function(){s.addClass("clockpicker-moving")},200);c&&u.append(S.canvas),S.setHand(d,h,!t,!0),a.off(p).on(p,function(e){e.preventDefault();var t=/^touch/.test(e.type),i=(t?e.originalEvent.touches[0]:e).pageX-o,n=(t?e.originalEvent.touches[0]:e).pageY-l;(g||i!==d||n!==h)&&(g=!0,S.setHand(i,n,!1,!0))}),a.off(f).one(f,function(e){e.preventDefault();var i=/^touch/.test(e.type),n=(i?e.originalEvent.changedTouches[0]:e).pageX-o,c=(i?e.originalEvent.changedTouches[0]:e).pageY-l;(t||g)&&n===d&&c===h&&S.setHand(n,c),"hours"===S.currentView?S.toggleView("minutes",C/2):r.autoclose&&(S.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){S.done()},C/2)),u.prepend(N),clearTimeout(y),s.removeClass("clockpicker-moving"),a.off(p)})}}var d=o(E),u=d.find(".clockpicker-plate"),m=d.find(".clockpicker-hours"),g=d.find(".clockpicker-minutes"),T="INPUT"===n.prop("tagName"),k=T?n:n.find("input"),_=n.find(".input-group-addon"),S=this;this.id=i("cp"),this.element=n,this.options=r,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=T,this.input=k,this.addon=_,this.popover=d,this.plate=u,this.hoursView=m,this.minutesView=g,this.spanHours=d.find(".clockpicker-span-hours"),this.spanMinutes=d.find(".clockpicker-span-minutes"),r.autoclose||o('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+r.donetext+"</button>").click(o.proxy(this.done,this)).appendTo(d),"top"!==r.placement&&"bottom"!==r.placement||"top"!==r.align&&"bottom"!==r.align||(r.align="left"),"left"!==r.placement&&"right"!==r.placement||"left"!==r.align&&"right"!==r.align||(r.align="top"),d.addClass(r.placement),d.addClass("clockpicker-align-"+r.align),this.spanHours.click(o.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(o.proxy(this.toggleView,this,"minutes")),k.on("focus.clockpicker click.clockpicker",o.proxy(this.show,this)),_.on("click.clockpicker",o.proxy(this.toggle,this));var D,$,M,A=o('<div class="clockpicker-tick"></div>');for(D=0;24>D;D+=1){$=A.clone(),M=D/6*Math.PI;var O=D>0&&13>D,F=O?y:b;$.css({left:v+Math.sin(M)*F-w,top:v-Math.cos(M)*F-w}),O&&$.css("font-size","120%"),$.html(0===D?"00":D),m.append($),$.on(h,l)}for(D=0;60>D;D+=5)$=A.clone(),M=D/30*Math.PI,$.css({left:v+Math.sin(M)*b-w,top:v-Math.cos(M)*b-w}),$.css("font-size","120%"),$.html(t(D)),g.append($),$.on(h,l);if(u.on(h,function(e){0===o(e.target).closest(".clockpicker-tick").length&&l(e,!0)}),c){var N=d.find(".clockpicker-canvas"),L=e("svg");L.setAttribute("class","clockpicker-svg"),L.setAttribute("width",x),L.setAttribute("height",x);var R=e("g");R.setAttribute("transform","translate("+v+","+v+")");var I=e("circle");I.setAttribute("class","clockpicker-canvas-bearing"),I.setAttribute("cx",0),I.setAttribute("cy",0),I.setAttribute("r",2);var P=e("line");P.setAttribute("x1",0),P.setAttribute("y1",0);var B=e("circle");B.setAttribute("class","clockpicker-canvas-bg"),B.setAttribute("r",w);var H=e("circle");H.setAttribute("class","clockpicker-canvas-fg"),H.setAttribute("r",3.5),R.appendChild(P),R.appendChild(B),R.appendChild(H),R.appendChild(I),L.appendChild(R),N.append(L),this.hand=P,this.bg=B,this.fg=H,this.bearing=I,this.g=R,this.canvas=N}}var s,o=window.jQuery,r=o(window),a=o(document),l="http://www.w3.org/2000/svg",c="SVGAngle"in window&&function(){var e,t=document.createElement("div");return t.innerHTML="<svg/>",e=(t.firstChild&&t.firstChild.namespaceURI)==l,t.innerHTML="",e}(),d=function(){var e=document.createElement("div").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e}(),u="ontouchstart"in window,h="mousedown"+(u?" touchstart":""),p="mousemove.clockpicker"+(u?" touchmove.clockpicker":""),f="mouseup.clockpicker"+(u?" touchend.clockpicker":""),m=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,g=0,v=100,b=80,y=54,w=13,x=2*v,C=d?350:1,E=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>","</div>","</div>"].join("");n.DEFAULTS={default:"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:!1,vibrate:!0},n.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},n.prototype.locate=function(){var e=this.element,t=this.popover,i=e.offset(),n=e.outerWidth(),s=e.outerHeight(),o=this.options.placement,r=this.options.align,a={};switch(t.show(),o){case"bottom":a.top=i.top+s;break;case"right":a.left=i.left+n;break;case"top":a.top=i.top-t.outerHeight();break;case"left":a.left=i.left-t.outerWidth()}switch(r){case"left":a.left=i.left;break;case"right":a.left=i.left+n-t.outerWidth();break;case"top":a.top=i.top;break;case"bottom":a.top=i.top+s-t.outerHeight()}t.css(a)},n.prototype.show=function(){if(!this.isShown){var e=this;this.isAppended||(s=o(document.body).append(this.popover),r.on("resize.clockpicker"+this.id,function(){e.isShown&&e.locate()}),this.isAppended=!0);var i=((this.input.prop("value")||this.options.default||"")+"").split(":");if("now"===i[0]){var n=new Date(+new Date+this.options.fromnow);i=[n.getHours(),n.getMinutes()]}this.hours=+i[0]||0,this.minutes=+i[1]||0,this.spanHours.html(t(this.hours)),this.spanMinutes.html(t(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,a.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(t){var i=o(t.target);0===i.closest(e.popover).length&&0===i.closest(e.addon).length&&0===i.closest(e.input).length&&e.hide()}),a.on("keyup.clockpicker."+this.id,function(t){27===t.keyCode&&e.hide()})}},n.prototype.hide=function(){this.isShown=!1,a.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),a.off("keyup.clockpicker."+this.id),this.popover.hide()},n.prototype.toggleView=function(e,t){var i="hours"===e,n=i?this.hoursView:this.minutesView,s=i?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",i),this.spanMinutes.toggleClass("text-primary",!i),s.addClass("clockpicker-dial-out"),n.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(t),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){s.css("visibility","hidden")},C)},n.prototype.resetClock=function(e){var t=this.currentView,i=this[t],n="hours"===t,s=i*(Math.PI/(n?6:30)),o=n&&i>0&&13>i?y:b,r=Math.sin(s)*o,a=-Math.cos(s)*o,l=this;c&&e?(l.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){l.canvas.removeClass("clockpicker-canvas-out"),l.setHand(r,a)},e)):this.setHand(r,a)},n.prototype.setHand=function(e,i,n,s){var r,a=Math.atan2(e,-i),l="hours"===this.currentView,d=Math.PI/(l||n?6:30),u=Math.sqrt(e*e+i*i),h=(this.options,l&&(b+y)/2>u),p=h?y:b;if(0>a&&(a=2*Math.PI+a),a=(r=Math.round(a/d))*d,l?(12===r&&(r=0),r=h?0===r?12:r:0===r?0:r+12):(n&&(r*=5),60===r&&(r=0)),this[this.currentView]!==r&&m&&this.options.vibrate&&(this.vibrateTimer||(navigator[m](10),this.vibrateTimer=setTimeout(o.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=r,this[l?"spanHours":"spanMinutes"].html(t(r)),c){s||!l&&r%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var f=Math.sin(a)*p,g=-Math.cos(a)*p;this.hand.setAttribute("x2",f),this.hand.setAttribute("y2",g),this.bg.setAttribute("cx",f),this.bg.setAttribute("cy",g),this.fg.setAttribute("cx",f),this.fg.setAttribute("cy",g)}else this[l?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=o(this);e.toggleClass("active",r===+e.html())})},n.prototype.done=function(){this.hide();var e=this.input.prop("value"),i=t(this.hours)+":"+t(this.minutes);this.input.prop("value",i),i!==e&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change"))},n.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(r.off("resize.clockpicker"+this.id),this.popover.remove())},o.fn.clockpicker=function(e){var t=Array.prototype.slice.call(arguments,1);return this.each(function(){var i=o(this),s=i.data("clockpicker");if(s)"function"==typeof s[e]&&s[e].apply(s,t);else{var r=o.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);i.data("clockpicker",new n(i,r))}})}}(),function(e){var t=function(e){this.value={h:1,s:1,b:1,a:1},this.setColor(e)};t.prototype={constructor:t,setColor:function(t){t=t.toLowerCase();var i=this;e.each(n.stringParsers,function(e,s){var o=s.re.exec(t),r=o&&s.parse(o),a=s.space||"rgba";return r?(i.value="hsla"===a?n.RGBtoHSB.apply(null,n.HSLtoRGB.apply(null,r)):n.RGBtoHSB.apply(null,r),!1):void 0})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt(100*(1-e),10)/100},toRGB:function(e,t,i,n){var s,o,r,a,l;return e||(e=this.value.h,t=this.value.s,i=this.value.b),e=(e*=360)%360/60,s=o=r=i-(l=i*t),s+=[l,a=l*(1-Math.abs(e%2-1)),0,0,a,l][e=~~e],o+=[a,l,l,a,0,0][e],r+=[0,0,a,l,l,a][e],{r:Math.round(255*s),g:Math.round(255*o),b:Math.round(255*r),a:n||this.value.a}},toHex:function(e,t,i,n){var s=this.toRGB(e,t,i,n);return"#"+(1<<24|parseInt(s.r)<<16|parseInt(s.g)<<8|parseInt(s.b)).toString(16).substr(1)},toHSL:function(e,t,i,n){e||(e=this.value.h,t=this.value.s,i=this.value.b);var s=(2-t)*i,o=t*i;return(o/=s>0&&1>=s?s:2-s)>1&&(o=1),{h:e,s:o,l:s/=2,a:n||this.value.a}}};var i=function(t,i){this.element=e(t);var s=i.format||this.element.data("color-format")||"hex";this.format=n.translateFormats[s],this.isInput=this.element.is("input"),this.component=!!this.element.is(".color")&&this.element.find(".add-on"),this.picker=e(n.template).appendTo("body").on("mousedown",e.proxy(this.mousedown,this)),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on({click:e.proxy(this.show,this)}):this.element.on({click:e.proxy(this.show,this)}),("rgba"===s||"hsla"===s)&&(this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style),this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style,this.base=this.picker.find("div:first")[0].style,this.update()};i.prototype={constructor:i,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),this.isInput||t&&(t.stopPropagation(),t.preventDefault()),e(document).on({mousedown:e.proxy(this.hide,this)}),this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new t(this.isInput?this.element.prop("value"):this.element.data("color")),this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor()},setValue:function(e){this.color=new t(e),this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.isInput?this.element.prop("value",this.format.call(this)):(e(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this))),this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(e){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1),this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(t){t.stopPropagation(),t.preventDefault();var i=e(t.target).closest("div");if(!i.is(".colorpicker")){if(i.is(".colorpicker-saturation"))this.slider=e.extend({},n.sliders.saturation);else if(i.is(".colorpicker-hue"))this.slider=e.extend({},n.sliders.hue);else{if(!i.is(".colorpicker-alpha"))return!1;this.slider=e.extend({},n.sliders.alpha)}var s=i.offset();this.slider.knob=i.find("i")[0].style,this.slider.left=t.pageX-s.left,this.slider.top=t.pageY-s.top,this.pointer={left:t.pageX,top:t.pageY},e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left))),i=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));return this.slider.knob.left=t+"px",this.slider.knob.top=i+"px",this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,t/100),this.slider.callTop&&this.color[this.slider.callTop].call(this.color,i/100),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1}},e.fn.colorpicker=function(t,n){return this.each(function(){var s=e(this),o=s.data("colorpicker"),r="object"==typeof t&&t;o||s.data("colorpicker",o=new i(this,e.extend({},e.fn.colorpicker.defaults,r))),"string"==typeof t&&o[t](n)})},e.fn.colorpicker.defaults={},e.fn.colorpicker.Constructor=i;var n={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(e,t,i,n){var s,o;return e/=255,t/=255,i/=255,{h:((0===(o=(s=Math.max(e,t,i))-Math.min(e,t,i))?null:s==e?(t-i)/o:s==t?(i-e)/o+2:(e-t)/o+4)+360)%6*60/360||1,s:0===o?0:o/s,b:s,a:n||1}},HueToRGB:function(e,t,i){return 0>i?i+=1:i>1&&(i-=1),1>6*i?e+(t-e)*i*6:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e},HSLtoRGB:function(e,t,i,s){var o;0>t&&(t=0);var r=2*i-(o=.5>=i?i*(1+t):i+t-i*t),a=e+1/3,l=e,c=e-1/3;return[Math.round(255*n.HueToRGB(r,o,a)),Math.round(255*n.HueToRGB(r,o,l)),Math.round(255*n.HueToRGB(r,o,c)),s||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}(window.jQuery),function(e){void 0===e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var i=e([0]),n=-1,s=this.length;++n<s&&(i.context=i[0]=this[n])&&!1!==t.call(i[0],n,i););return this}})}(jQuery),function(e,t){"use strict";function i(t){var i=e(document.createTextNode(""));t.before(i),i.before(t),i.remove()}function n(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return L[e]||e})}function s(e,t){for(var i=0,n=t.length;n>i;i+=1)if(o(e,t[i]))return i;return-1}function o(e,i){return e===i||e!==t&&i!==t&&(null!==e&&null!==i&&(e.constructor===String?e+""==i+"":i.constructor===String&&i+""==e+""))}function r(t,i){var n,s,o;if(null===t||t.length<1)return[];for(s=0,o=(n=t.split(i)).length;o>s;s+=1)n[s]=e.trim(n[s]);return n}function a(e){return e.outerWidth(!1)-e.width()}function l(i){var n="keyup-change-value";i.on("keydown",function(){e.data(i,n)===t&&e.data(i,n,i.val())}),i.on("keyup",function(){var s=e.data(i,n);s!==t&&i.val()!==s&&(e.removeData(i,n),i.trigger("keyup-change"))})}function c(e,i,n){var s;return n=n||t,function(){var t=arguments;window.clearTimeout(s),s=window.setTimeout(function(){i.apply(n,t)},e)}}function d(e,t){var i=c(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){s(e.target,t.get())>=0&&i(e)})}function u(t){var i=0,n=0;if("selectionStart"in(t=e(t)[0]))i=t.selectionStart,n=t.selectionEnd-i;else if("selection"in document){t.focus();var s=document.selection.createRange();n=document.selection.createRange().text.length,s.moveStart("character",-t.value.length),i=s.text.length-n}return{offset:i,length:n}}function h(e){e.preventDefault(),e.stopPropagation()}function p(t){if(!$){var i=t[0].currentStyle||window.getComputedStyle(t[0],null);($=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),e("body").append($)}return $.text(t.val()),$.width()}function f(t,i,n){var s,o,r=[];(s=e.trim(t.attr("class")))&&e((s=""+s).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&r.push(this)}),(s=e.trim(i.attr("class")))&&e((s=""+s).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&((o=n(this))&&r.push(o))}),t.attr("class",r.join(" "))}function m(e,t,i,s){var o=n(e.toUpperCase()).indexOf(n(t.toUpperCase())),r=t.length;return 0>o?void i.push(s(e)):(i.push(s(e.substring(0,o))),i.push("<span class='select2-match'>"),i.push(s(e.substring(o,o+r))),i.push("</span>"),void i.push(s(e.substring(o+r,e.length))))}function g(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function v(i){var n,s=null,o=i.quietMillis||100,r=i.url,a=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=i.data,o=r,c=i.transport||e.fn.select2.ajaxDefaults.transport,d={type:i.type||"GET",cache:i.cache||!1,jsonpCallback:i.jsonpCallback||t,dataType:i.dataType||"json"},u=e.extend({},e.fn.select2.ajaxDefaults.params,d);n=n?n.call(a,l.term,l.page,l.context):null,o="function"==typeof o?o.call(a,l.term,l.page,l.context):o,s&&"function"==typeof s.abort&&s.abort(),i.params&&(e.isFunction(i.params)?e.extend(u,i.params.call(a)):e.extend(u,i.params)),e.extend(u,{url:o,dataType:i.dataType,data:n,success:function(e){var t=i.results(e,l.page,l);l.callback(t)},error:function(e,t,i){var n={hasError:!0,jqXHR:e,textStatus:t,errorThrown:i};l.callback(n)}}),s=c.call(a,u)},o)}}function b(t){var i,n,s=t,o=function(e){return""+e.text};e.isArray(s)&&(s={results:n=s}),!1===e.isFunction(s)&&(n=s,s=function(){return n});var r=s();return r.text&&(o=r.text,e.isFunction(o)||(i=r.text,o=function(e){return e[i]})),function(t){var i,n=t.term,r={results:[]};return""===n?void t.callback(s()):(i=function(s,r){var a,l;if((s=s[0]).children){for(l in a={},s)s.hasOwnProperty(l)&&(a[l]=s[l]);a.children=[],e(s.children).each2(function(e,t){i(t,a.children)}),(a.children.length||t.matcher(n,o(a),s))&&r.push(a)}else t.matcher(n,o(s),s)&&r.push(s)},e(s().results).each2(function(e,t){i(t,r.results)}),void t.callback(r))}}function y(i){var n=e.isFunction(i);return function(s){var o=s.term,r={results:[]},a=n?i(s):i;e.isArray(a)&&(e(a).each(function(){var e=this.text!==t,i=e?this.text:this;(""===o||s.matcher(o,i))&&r.results.push(e?this:{id:this,text:this})}),s.callback(r))}}function w(t,i){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(i+" must be a string, function, or falsy value")}function x(t,i){if(e.isFunction(t)){var n=Array.prototype.slice.call(arguments,2);return t.apply(i,n)}return t}function C(t){var i=0;return e.each(t,function(e,t){t.children?i+=C(t.children):i++}),i}function E(){var t=this;e.each(arguments,function(e,i){t[i].remove(),t[i]=null})}function T(t,i){var n=function(){};return(n.prototype=new t).constructor=n,n.prototype.parent=t.prototype,n.prototype=e.extend(n.prototype,i),n}if(window.Select2===t){var k,_,S,D,$,M,A,O={x:0,y:0},F={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case F.LEFT:case F.RIGHT:case F.UP:case F.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case F.SHIFT:case F.CTRL:case F.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&123>=e}},N="<div class='select2-measure-scrollbar'></div>",L={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};M=e(document),D=function(){var e=1;return function(){return e++}}(),k=T(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(i){var n,s,o=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==t&&null!==i.element.data("select2")&&i.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+D()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",i.element.attr("title")),this.body=e("body"),f(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",i.element.attr("style")),this.container.css(x(i.containerCss,this.opts.element)),this.container.addClass(x(i.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",h),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),f(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(x(i.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",h),this.results=n=this.container.find(o),this.search=s=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",h),function(i){i.on("mousemove",function(i){var n=O;(n===t||n.x!==i.pageX||n.y!==i.pageY)&&e(i.target).trigger("mousemove-filtered",i)})}(this.results),this.dropdown.on("mousemove-filtered",o,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",o,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",o,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",o,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),d(80,this.results),this.dropdown.on("scroll-debounced",o,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&n.mousewheel(function(e,t,i,s){var o=n.scrollTop();s>0&&0>=o-s?(n.scrollTop(0),h(e)):0>s&&n.get(0).scrollHeight-n.scrollTop()+s<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),h(e))}),l(s),s.on("keyup-change input paste",this.bind(this.updateResults)),s.on("focus",function(){s.addClass("select2-focused")}),s.on("blur",function(){s.removeClass("select2-focused")}),this.dropdown.on("mouseup",o,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==i.maximumInputLength&&this.search.attr("maxlength",i.maximumInputLength);var r=i.element.prop("disabled");r===t&&(r=!1),this.enable(!r);var a=i.element.prop("readonly");a===t&&(a=!1),this.readonly(a),A=A||function(){var t=e(N);t.appendTo("body");var i={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),i}(),this.autofocus=i.element.prop("autofocus"),i.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",i.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,i=e.data("select2"),n=this;this.close(),e.length&&e[0].detachEvent&&e.each(function(){this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,i!==t&&(i.container.remove(),i.liveRegion.remove(),i.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show()),E.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:o(e.attr("locked"),"locked")||o(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(i){var n,s,a,l,c=this;if("select"===(n=i.element).get(0).tagName.toLowerCase()&&(this.select=s=i.element),s&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),"function"!=typeof(i=e.extend({},{populateResults:function(n,s,o){var r,a=this.opts.id,l=this.liveRegion;(r=function(n,s,d){var u,h,p,f,m,g,v,b,y,w,x=[];for(u=0,h=(n=i.sortResults(n,s,o)).length;h>u;u+=1)f=!(m=!0===(p=n[u]).disabled)&&a(p)!==t,g=p.children&&p.children.length>0,(v=e("<li></li>")).addClass("select2-results-dept-"+d),v.addClass("select2-result"),v.addClass(f?"select2-result-selectable":"select2-result-unselectable"),m&&v.addClass("select2-disabled"),g&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(p)),v.attr("role","presentation"),(b=e(document.createElement("div"))).addClass("select2-result-label"),b.attr("id","select2-result-label-"+D()),b.attr("role","option"),(w=i.formatResult(p,b,o,c.opts.escapeMarkup))!==t&&(b.html(w),v.append(b)),g&&((y=e("<ul></ul>")).addClass("select2-result-sub"),r(p.children,y,d+1),v.append(y)),v.data("select2-data",p),x.push(v[0]);s.append(x),l.text(i.formatMatches(n.length))})(s,n,0)}},e.fn.select2.defaults,i)).id&&(a=i.id,i.id=function(e){return e[a]}),e.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(s?(i.query=this.bind(function(e){var i,s,o,r={results:[],more:!1},a=e.term;o=function(t,i){var n;t.is("option")?e.matcher(a,t.text(),t)&&i.push(c.optionToData(t)):t.is("optgroup")&&(n=c.optionToData(t),t.children().each2(function(e,t){o(t,n.children)}),n.children.length>0&&i.push(n))},i=n.children(),this.getPlaceholder()!==t&&i.length>0&&((s=this.getPlaceholderOption())&&(i=i.not(s))),i.each2(function(e,t){o(t,r.results)}),e.callback(r)}),i.id=function(e){return e.id}):"query"in i||("ajax"in i?((l=i.element.data("ajax-url"))&&l.length>0&&(i.ajax.url=l),i.query=v.call(i.element,i.ajax)):"data"in i?i.query=b(i.data):"tags"in i&&(i.query=y(i.tags),i.createSearchChoice===t&&(i.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),i.initSelection===t&&(i.initSelection=function(t,n){var s=[];e(r(t.val(),i.separator)).each(function(){var t={id:this,text:this},n=i.tags;e.isFunction(n)&&(n=n()),e(n).each(function(){return o(this.id,t.id)?(t=this,!1):void 0}),s.push(t)}),n(s)}))),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");if("top"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof i.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return i},monitorSource:function(){var i,n=this.opts.element,s=this;n.on("change.select2",this.bind(function(){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=n.prop("disabled");e===t&&(e=!1),this.enable(!e);var i=n.prop("readonly");i===t&&(i=!1),this.readonly(i),f(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(x(this.opts.containerCssClass,this.opts.element)),f(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(x(this.opts.dropdownCssClass,this.opts.element))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",s._sync)}),(i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new i(function(t){e.each(t,s._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var i=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,i,n,s,o,r=this.dropdown,a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),d=r.outerHeight(!1),u=e(window),h=u.width(),p=u.height(),f=u.scrollLeft()+h,m=u.scrollTop()+p,g=a.top+l,v=a.left,b=m>=g+d,y=a.top-d>=u.scrollTop(),w=r.outerWidth(!1),C=f>=v+w;r.hasClass("select2-drop-above")?(i=!0,!y&&b&&(n=!0,i=!1)):(i=!1,!b&&y&&(n=!0,i=!0)),n&&(r.hide(),a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),d=r.outerHeight(!1),f=u.scrollLeft()+h,m=u.scrollTop()+p,g=a.top+l,C=f>=(v=a.left)+(w=r.outerWidth(!1)),r.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=e(".select2-results",r)[0],r.addClass("select2-drop-auto-width"),r.css("width",""),(w=r.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:A.width))>c?c=w:w=c,d=r.outerHeight(!1),C=f>=v+w):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(g-=(t=this.body.offset()).top,v-=t.left),C||(v=a.left+this.container.outerWidth(!1)-w),s={left:v,width:c},i?(s.top=a.top-d,s.bottom="auto",this.container.addClass("select2-drop-above"),r.addClass("select2-drop-above")):(s.top=g,s.bottom="auto",this.container.removeClass("select2-drop-above"),r.removeClass("select2-drop-above")),s=e.extend(s,x(this.opts.dropdownCss,this.opts.element)),r.css(s)},shouldOpen:function(){var t;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),M.on("mousemove.select2Event",function(e){O.x=e.pageX,O.y=e.pageY}),!0)},opening:function(){var t,n=this.containerEventName,s="scroll."+n,o="resize."+n,r="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0==(t=e("#select2-drop-mask")).length&&((t=e(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body),t.on("mousedown touchstart click",function(n){i(t);var s,o=e("#select2-drop");o.length>0&&((s=o.data("select2")).opts.selectOnBlur&&s.selectHighlighted({noFocus:!0}),s.close(),n.preventDefault(),n.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){e(this).on(o+" "+s+" "+r,function(){a.opened()&&a.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerEventName,i="scroll."+t,n="resize."+t,s="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(i).off(n).off(s)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),M.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return x(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t,i,n,s,o,r,a,l,c=this.results;if(!(0>(i=this.highlight()))){if(0==i)return void c.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),s=(l=((n=e(t[i])).offset()||{}).top||0)+n.outerHeight(!0),i===t.length-1&&((a=c.find("li.select2-more-results")).length>0&&(s=a.offset().top+a.outerHeight(!0))),s>(o=c.offset().top+c.outerHeight(!0))&&c.scrollTop(c.scrollTop()+(s-o)),0>(r=l-c.offset().top)&&"none"!=n.css("display")&&c.scrollTop(c.scrollTop()+r)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){var s=e(i[n+=t]);if(s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")&&!s.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(t){var i,n,o=this.findHighlightableChoices();return 0===arguments.length?s(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.removeHighlight(),(i=e(o[t])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",i.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(i.text()),void((n=i.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var i=e(t.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),i=this.resultsPage+1,n=this,s=this.search.val(),o=this.context;0!==t.length&&(t.offset().top-e.offset().top-e.height()<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:i,context:o,matcher:this.opts.matcher,callback:this.bind(function(r){n.opened()&&(n.opts.populateResults.call(this,e,r.results,{term:s,page:i,context:o}),n.postprocessResults(r,!1,!1),!0===r.more?(t.detach().appendTo(e).text(x(n.opts.formatLoadMore,n.opts.element,i+1)),window.setTimeout(function(){n.loadMoreIfNeeded()},10)):t.remove(),n.positionDropdown(),n.resultsPage=i,n.context=r.context,this.opts.element.trigger({type:"select2-loaded",items:r}))})})))},tokenize:function(){},updateResults:function(i){function n(){c.removeClass("select2-active"),h.positionDropdown(),h.liveRegion.text(d.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?d.text():h.opts.formatMatches(d.find(".select2-result-selectable").length))}function s(e){d.html(e),n()}var r,a,l,c=this.search,d=this.results,u=this.opts,h=this,p=c.val(),f=e.data(this.container,"select2-last-term");if((!0===i||!f||!o(p,f))&&(e.data(this.container,"select2-last-term",p),!0===i||!1!==this.showSearchInput&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(r=this.data(),e.isArray(r)&&r.length>=m&&w(u.formatSelectionTooBig,"formatSelectionTooBig")))return void s("<li class='select2-selection-limit'>"+x(u.formatSelectionTooBig,u.element,m)+"</li>");if(c.val().length<u.minimumInputLength)return s(w(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+x(u.formatInputTooShort,u.element,c.val(),u.minimumInputLength)+"</li>":""),void(i&&this.showSearch&&this.showSearch(!0));if(u.maximumInputLength&&c.val().length>u.maximumInputLength)return void s(w(u.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+x(u.formatInputTooLong,u.element,c.val(),u.maximumInputLength)+"</li>":"");u.formatSearching&&0===this.findHighlightableChoices().length&&s("<li class='select2-searching'>"+x(u.formatSearching,u.element)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),(a=this.tokenize())!=t&&null!=a&&c.val(a),this.resultsPage=1,u.query({element:u.element,term:c.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(r){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(r.hasError!==t&&w(u.formatAjaxError,"formatAjaxError"))return void s("<li class='select2-ajax-error'>"+x(u.formatAjaxError,u.element,r.jqXHR,r.textStatus,r.errorThrown)+"</li>");if(this.context=r.context===t?null:r.context,this.opts.createSearchChoice&&""!==c.val()&&((a=this.opts.createSearchChoice.call(h,c.val(),r.results))!==t&&null!==a&&h.id(a)!==t&&null!==h.id(a)&&0===e(r.results).filter(function(){return o(h.id(this),h.id(a))}).length&&this.opts.createSearchChoicePosition(r.results,a)),0===r.results.length&&w(u.formatNoMatches,"formatNoMatches"))return void s("<li class='select2-no-results'>"+x(u.formatNoMatches,u.element,c.val())+"</li>");d.empty(),h.opts.populateResults.call(this,d,r.results,{term:c.val(),page:this.resultsPage,context:null}),!0===r.more&&w(u.formatLoadMore,"formatLoadMore")&&(d.append("<li class='select2-more-results'>"+u.escapeMarkup(x(u.formatLoadMore,u.element,this.resultsPage))+"</li>"),window.setTimeout(function(){h.loadMoreIfNeeded()},10)),this.postprocessResults(r,i),n(),this.opts.element.trigger({type:"select2-loaded",items:r})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var e;(e=this.search)[0]!==document.activeElement&&window.setTimeout(function(){var t,i=e[0],n=e.val().length;e.focus(),(i.offsetWidth>0||i.offsetHeight>0)&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&((t=i.createTextRange()).collapse(!1),t.select()))},0)},selectHighlighted:function(e){if(this._touchMoved)this.clearTouchMoved();else{var t=this.highlight(),i=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var i=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&i||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.trim(i.text())&&""===i.val())return i}},initContainerWidth:function(){var i=function(){var i,n,s,o,r;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if((i=this.opts.element.attr("style"))!==t)for(o=0,r=(n=i.split(";")).length;r>o;o+=1)if(null!==(s=n[o].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&s.length>=1)return s[1];return"resolve"===this.opts.width?(i=this.opts.element.css("width")).indexOf("%")>0?i:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==i&&this.container.css("width",i)}}),_=T(k,{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var i,n,s;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(i=this.search.get(0)).createTextRange?((n=i.createTextRange()).collapse(!1),n.select()):i.setSelectionRange&&(s=this.search.val().length,i.setSelectionRange(s,s))),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),E.call(this,"selection","focusser")},initContainer:function(){var t,n,s=this.container,o=this.dropdown,r=D();this.showSearch(!(this.opts.minimumResultsForSearch<0)),this.selection=t=s.find(".select2-choice"),this.focusser=s.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+r),this.focusser.attr("aria-labelledby","select2-chosen-"+r),this.results.attr("id","select2-results-"+r),this.search.attr("aria-owns","select2-results-"+r),this.focusser.attr("id","s2id_autogen"+r),n=e("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(n.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||n.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode){if(e.which===F.PAGE_UP||e.which===F.PAGE_DOWN)return void h(e);switch(e.which){case F.UP:case F.DOWN:return this.moveHighlight(e.which===F.UP?-1:1),void h(e);case F.ENTER:return this.selectHighlighted(),void h(e);case F.TAB:return void this.selectHighlighted({noFocus:!0});case F.ESC:return this.cancel(e),void h(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==F.TAB&&!F.isControl(e)&&!F.isFunctionKey(e)&&e.which!==F.ESC){if(!1===this.opts.openOnEnter&&e.which===F.ENTER)return void h(e);if(e.which==F.DOWN||e.which==F.UP||e.which==F.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void h(e)}return e.which==F.DELETE||e.which==F.BACKSPACE?(this.opts.allowClear&&this.clear(),void h(e)):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),function(e){e.preventDefault(),e.stopImmediatePropagation()}(e),this.close(),this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(n){i(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),h(n)})),o.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){h(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(t){var i=this.selection.data("select2-data");if(i){var n=e.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var s=this.getPlaceholderOption();this.opts.element.val(s?s.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==t&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.setPlaceholder(),e.nextSearchTerm=e.opts.nextSearchTerm(i,e.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==t&&((e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val())},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=e.find("option").filter(function(){return this.selected&&!this.disabled});t(i.optionToData(n))}:"data"in t&&(t.initSelection=t.initSelection||function(i,n){var s=i.val(),r=null;t.query({matcher:function(e,i,n){var a=o(s,t.id(n));return a&&(r=n),a},callback:e.isFunction(n)?function(){n(r)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,i){var n=0,s=this;if(this.findHighlightableChoices().each2(function(e,t){return o(s.id(t.data("select2-data")),s.opts.element.val())?(n=e,!1):void 0}),!1!==i&&this.highlight(!0===t&&n>=0?n:0),!0===t){var r=this.opts.minimumResultsForSearch;r>=0&&this.showSearch(C(e.results)>=r)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),o(i,this.id(e))||this.triggerChange({added:e,removed:n})}},updateSelection:function(e){var i,n,s=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),s.empty(),null!==e&&(i=this.opts.formatSelection(e,s,this.opts.escapeMarkup)),i!==t&&s.append(i),(n=this.opts.formatSelectionCssClass(e,s))!==t&&s.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,i=!1,n=null,s=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(i=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=s.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),i&&this.triggerChange({added:n,removed:o});else{if(!e&&0!==e)return void this.clear(i);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){s.opts.element.val(e?s.id(e):""),s.updateSelection(e),s.setPlaceholder(),i&&s.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var i,n=!1;return 0===arguments.length?((i=this.selection.data("select2-data"))==t&&(i=null),i):(arguments.length>1&&(n=arguments[1]),void(e?(i=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:i})):this.clear(n)))}}),S=T(k,{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){n.push(i.optionToData(t))}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(i,n){var s=r(i.val(),t.separator),a=[];t.query({matcher:function(i,n,r){var l=e.grep(s,function(e){return o(e,t.id(r))}).length;return l&&a.push(r),l},callback:e.isFunction(n)?function(){for(var e=[],i=0;i<s.length;i++)for(var r=s[i],l=0;l<a.length;l++){var c=a[l];if(o(r,t.id(c))){e.push(c),a.splice(l,1);break}}n(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),E.call(this,"searchContainer","selection")},initContainer:function(){var t,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(i);var n=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){n.search[0].focus(),n.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+D()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var i=t.find(".select2-search-choice-focus"),n=i.prev(".select2-search-choice:not(.select2-locked)"),s=i.next(".select2-search-choice:not(.select2-locked)"),o=u(this.search);if(i.length&&(e.which==F.LEFT||e.which==F.RIGHT||e.which==F.BACKSPACE||e.which==F.DELETE||e.which==F.ENTER)){var r=i;return e.which==F.LEFT&&n.length?r=n:e.which==F.RIGHT?r=s.length?s:null:e.which===F.BACKSPACE?this.unselect(i.first())&&(this.search.width(10),r=n.length?n:s):e.which==F.DELETE?this.unselect(i.first())&&(this.search.width(10),r=s.length?s:null):e.which==F.ENTER&&(r=null),this.selectChoice(r),h(e),void(r&&r.length||this.open())}if((e.which===F.BACKSPACE&&1==this.keydowns||e.which==F.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void h(e);if(this.selectChoice(null),this.opened())switch(e.which){case F.UP:case F.DOWN:return this.moveHighlight(e.which===F.UP?-1:1),void h(e);case F.ENTER:return this.selectHighlighted(),void h(e);case F.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case F.ESC:return this.cancel(e),void h(e)}if(e.which!==F.TAB&&!F.isControl(e)&&!F.isFunctionKey(e)&&e.which!==F.BACKSPACE&&e.which!==F.ESC){if(e.which===F.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===F.PAGE_UP||e.which===F.PAGE_DOWN)&&h(e),e.which===F.ENTER&&h(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",i,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",i,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),i=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(i>0?i:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],n=[],o=this;e(t).each(function(){s(o.id(this),i)<0&&(i.push(o.id(this)),n.push(this))}),t=n,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,i){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),i&&i.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(i){var n,s,o=!i.locked,r=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?r:a,c=this.id(i),d=this.getVal();(n=this.opts.formatSelection(i,l.find("div"),this.opts.escapeMarkup))!=t&&l.find("div").replaceWith("<div>"+n+"</div>"),(s=this.opts.formatSelectionCssClass(i,l.find("div")))!=t&&l.addClass(s),o&&l.find(".select2-search-choice-close").on("mousedown",h).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),h(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",i),l.insertBefore(this.searchContainer),d.push(c),this.setVal(d)},unselect:function(t){var i,n,o=this.getVal();if(0===(t=t.closest(".select2-search-choice")).length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(i=t.data("select2-data")){var r=e.Event("select2-removing");if(r.val=this.id(i),r.choice=i,this.opts.element.trigger(r),r.isDefaultPrevented())return!1;for(;(n=s(this.id(i),o))>=0;)o.splice(n,1),this.setVal(o),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}),!0}},postprocessResults:function(e,t,i){var n=this.getVal(),o=this.results.find(".select2-result"),r=this.results.find(".select2-result-with-children"),a=this;o.each2(function(e,t){s(a.id(t.data("select2-data")),n)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),r.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&!1!==i&&a.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&w(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+x(a.opts.formatNoMatches,a.opts.element,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-a(this.search)},resizeSearch:function(){var e,t,i,n,s=a(this.search);e=p(this.search)+10,t=this.search.offset().left,e>(n=(i=this.selection.width())-(t-this.selection.offset().left)-s)&&(n=i-s),40>n&&(n=i-s),0>=n&&(n=e),this.search.width(Math.floor(n))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:r(e=this.opts.element.val(),this.opts.separator)},setVal:function(t){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){s(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},buildChangeDetails:function(e,t){t=t.slice(0),e=e.slice(0);for(var i=0;i<t.length;i++)for(var n=0;n<e.length;n++)o(this.opts.id(t[i]),this.opts.id(e[n]))&&(t.splice(i,1),i>0&&i--,e.splice(n,1),n--);return{added:t,removed:e}},val:function(i,n){var s,o=this;if(0===arguments.length)return this.getVal();if((s=this.data()).length||(s=[]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:s}));if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(s,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var i=e.map(t,o.id);o.setVal(i),o.updateSelection(t),o.clearSearch(),n&&o.triggerChange(o.buildChangeDetails(s,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(i.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,i){var n,s,o=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(s=this.data(),t||(t=[]),n=e.map(t,function(e){return o.opts.id(e)}),this.setVal(n),this.updateSelection(t),this.clearSearch(),void(i&&this.triggerChange(this.buildChangeDetails(s,this.data()))))}}),e.fn.select2=function(){var i,n,o,r,a,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],d=["opened","isFocused","container","dropdown"],u=["val","data"],h={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])(i=0===l.length?{}:e.extend({},l[0])).element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?a=i.element.prop("multiple"):(a=i.multiple||!1,"tags"in i&&(i.multiple=a=!0)),(n=a?new window.Select2.class.multi:new window.Select2.class.single).init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(s(l[0],c)<0)throw"Unknown method: "+l[0];if(r=t,(n=e(this).data("select2"))===t)return;if("container"===(o=l[0])?r=n.container:"dropdown"===o?r=n.dropdown:(h[o]&&(o=h[o]),r=n[o].apply(n,l.slice(1))),s(l[0],d)>=0||s(l[0],u)>=0&&1==l.length)return!1}}),r===t?this:r},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,i,n){var s=[];return m(e.text,i.term,s,n),s.join("")},formatSelection:function(e,i,n){return e?n(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},matcher:function(e,t){return n(""+t).toUpperCase().indexOf(n(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:function(e,i,n,s){var r,a,l,c,d,u=e,h=!1;if(!s.createSearchChoice||!s.tokenSeparators||s.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,c=s.tokenSeparators.length;c>l&&(d=s.tokenSeparators[l],!((a=e.indexOf(d))>=0));l++);if(0>a)break;if(r=e.substring(0,a),e=e.substring(a+d.length),r.length>0&&(r=s.createSearchChoice.call(this,r,i))!==t&&null!==r&&s.id(r)!==t&&null!==s.id(r)){for(h=!1,l=0,c=i.length;c>l;l++)if(o(s.id(r),s.id(i[l]))){h=!0;break}h||n(r)}}return u!==e?e:void 0},escapeMarkup:g,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!(("ontouchstart"in window||navigator.msMaxTouchPoints>0)&&e.opts.minimumResultsForSearch<0)}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return""},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(){return"Loading failed"},formatInputTooShort:function(e,t){var i=t-e.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},formatInputTooLong:function(e,t){var i=e.length-t;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results…"},formatSearching:function(){return"Searching…"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:v,local:b,tags:y},util:{debounce:c,markMatch:m,escapeMarkup:g,stripDiacritics:n},class:{abstract:k,single:_,multi:S}}}}(jQuery),FastClick.prototype.deviceIsAndroid=0<navigator.userAgent.indexOf("Android"),FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){var i,n;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),n=t.changedTouches[0],(i=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,e.dispatchEvent(i)},FastClick.prototype.focus=function(e){var t;this.deviceIsIOS&&e.setSelectionRange?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,i;if(!(t=e.fastClickScrollParent)||!t.contains(e)){i=e;do{if(i.scrollHeight>i.offsetHeight){t=i,e.fastClickScrollParent=i;break}i=i.parentElement}while(i)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,i,n;if(1<e.targetTouches.length)return!0;if(t=this.getTargetElementFromEventTarget(e.target),i=e.targetTouches[0],this.deviceIsIOS){if((n=window.getSelection()).rangeCount&&!n.isCollapsed)return!0;if(!this.deviceIsIOS4){if(i.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=i.pageX,this.touchStartY=i.pageY,200>e.timeStamp-this.lastClickTime&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){return e=e.changedTouches[0],10<Math.abs(e.pageX-this.touchStartX)||10<Math.abs(e.pageY-this.touchStartY)},FastClick.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){var t,i,n;if(n=this.targetElement,this.touchHasMoved(e)&&(this.trackingClick=!1,this.targetElement=null),!this.trackingClick)return!0;if(200>e.timeStamp-this.lastClickTime)return this.cancelNextClick=!0;if(this.lastClickTime=e.timeStamp,t=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(n=e.changedTouches[0],n=document.elementFromPoint(n.pageX-window.pageXOffset,n.pageY-window.pageYOffset)),"label"===(i=n.tagName.toLowerCase())){if(t=this.findControl(n)){if(this.focus(n),this.deviceIsAndroid)return!1;n=t}}else if(this.needsFocus(n))return 100<e.timeStamp-t||this.deviceIsIOS&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(n),this.deviceIsIOS4&&"select"===i||(this.targetElement=null,e.preventDefault()),!1);return!(!this.deviceIsIOS||this.deviceIsIOS4||!(t=n.fastClickScrollParent)||t.fastClickLastScrollTop===t.scrollTop)||(this.needsClick(n)||(e.preventDefault(),this.sendClick(n,e)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return!(this.targetElement&&!e.forwardedTouchEvent&&e.cancelable)||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))},FastClick.prototype.onClick=function(e){return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail||((e=this.onMouse(e))||(this.targetElement=null),e)},FastClick.prototype.destroy=function(){var e=this.layer;this.deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t;if(void 0===window.ontouchstart)return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent)){if(!FastClick.prototype.deviceIsAndroid)return!0;if((t=document.querySelector("meta[name=viewport]"))&&-1!==t.content.indexOf("user-scalable=no"))return!0}return"none"===e.style.msTouchAction},FastClick.attach=function(e){return new FastClick(e)},"undefined"!=typeof define&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,$("#main").append('<div class="demo"><span id="demo-setting"><i class="fa fa-cog txt-color-blueDark"></i></span> <form><legend class="no-padding margin-bottom-10">Admin settings</legend><section><label><input name="subscription" id="smart-fixed-header" type="checkbox" class="checkbox style-0"><span>Fixed Header</span></label><label><input type="checkbox" name="terms" id="smart-fixed-navigation" class="checkbox style-0"><span>Fixed Navigation</span></label><label><input type="checkbox" name="terms" id="smart-fixed-ribbon" class="checkbox style-0"><span>Fixed Ribbon</span></label><label><input type="checkbox" name="terms" id="smart-fixed-footer" class="checkbox style-0"><span>Fixed Footer</span></label><label><input type="checkbox" name="terms" id="smart-fixed-container" class="checkbox style-0"><span>Inside <b>.container</b></span></label><label style="display:block;"><input type="checkbox" name="terms" id="smart-rtl" class="checkbox style-0"><span>RTL Support</span></label><label style="display:block;"><input type="checkbox" id="smart-topmenu" class="checkbox style-0"><span>Menu on <b>top</b></span></label> <label style="display:block;"><input type="checkbox" id="colorblind-friendly" class="checkbox style-0"><span>For Colorblind <div class="font-xs text-right">(experimental)</div></span></label><span id="smart-bgimages"></span></section><h6 class="margin-top-10 semi-bold margin-bottom-5">Admin Skins</h6><section id="smart-styles"><a href="javascript:void(0);" id="smart-style-0" data-skinlogo="/packages/vis/builder/img/logo.png" class="btn btn-block btn-xs txt-color-white margin-right-5" style="background-color:#4E463F;"><i class="fa fa-check fa-fw" id="skin-checked"></i>Smart Default</a><a href="javascript:void(0);" id="smart-style-1" data-skinlogo="/packages/vis/builder/img/logo-white.png" class="btn btn-block btn-xs txt-color-white" style="background:#3A4558;">Dark Elegance</a><a href="javascript:void(0);" id="smart-style-2" data-skinlogo="/packages/vis/builder/img/logo-blue.png" class="btn btn-xs btn-block txt-color-darken margin-top-5" style="background:#fff;">Ultra Light</a><a href="javascript:void(0);" id="smart-style-3" data-skinlogo="/packages/vis/builder/img/logo-pale.png" class="btn btn-xs btn-block txt-color-white margin-top-5" style="background:#f78c40">Google Skin</a><a href="javascript:void(0);" id="smart-style-4" data-skinlogo="/packages/vis/builder/img/logo-pale.png" class="btn btn-xs btn-block txt-color-white margin-top-5" style="background: #bbc0cf; border: 1px solid #59779E; color: #17273D !important;">PixelSmash</a> <a href="javascript:void(0);" id="smart-style-5" data-skinlogo="/packages/vis/builder/img/logo-pale.png" class="btn btn-xs btn-block txt-color-white margin-top-5" style="background: rgba(153, 179, 204, 0.2); border: 1px solid rgba(121, 161, 221, 0.8); color: #17273D !important;">Glass</a></section></form> </div>');var smartbgimage="<h6 class='margin-top-10 semi-bold'>Background</h6><img src='img/pattern/graphy-xs.png' data-htmlbg-url='img/pattern/graphy.png' width='22' height='22' class='margin-right-5 bordered cursor-pointer'><img src='img/pattern/tileable_wood_texture-xs.png' width='22' height='22' data-htmlbg-url='img/pattern/tileable_wood_texture.png' class='margin-right-5 bordered cursor-pointer'><img src='img/pattern/sneaker_mesh_fabric-xs.png' width='22' height='22' data-htmlbg-url='img/pattern/sneaker_mesh_fabric.png' class='margin-right-5 bordered cursor-pointer'><img src='img/pattern/nistri-xs.png' data-htmlbg-url='img/pattern/nistri.png' width='22' height='22' class='margin-right-5 bordered cursor-pointer'><img src='img/pattern/paper-xs.png' data-htmlbg-url='img/pattern/paper.png' width='22' height='22' class='bordered cursor-pointer'>";$("#smart-bgimages").fadeOut(),$("#demo-setting").click(function(){$(".demo").toggleClass("activate")}),$('input[type="checkbox"]#smart-fixed-header').click(function(){$(this).is(":checked")?$.root_.addClass("fixed-header"):($('input[type="checkbox"]#smart-fixed-ribbon').prop("checked",!1),$('input[type="checkbox"]#smart-fixed-navigation').prop("checked",!1),$.root_.removeClass("fixed-header"),$.root_.removeClass("fixed-navigation"),$.root_.removeClass("fixed-ribbon"))}),$('input[type="checkbox"]#smart-fixed-navigation').click(function(){$(this).is(":checked")?($('input[type="checkbox"]#smart-fixed-header').prop("checked",!0),$.root_.addClass("fixed-header"),$.root_.addClass("fixed-navigation"),$('input[type="checkbox"]#smart-fixed-container').prop("checked",!1),$.root_.removeClass("container")):($('input[type="checkbox"]#smart-fixed-ribbon').prop("checked",!1),$.root_.removeClass("fixed-navigation"),$.root_.removeClass("fixed-ribbon"))}),$('input[type="checkbox"]#smart-fixed-ribbon').click(function(){$(this).is(":checked")?($('input[type="checkbox"]#smart-fixed-header').prop("checked",!0),$('input[type="checkbox"]#smart-fixed-navigation').prop("checked",!0),$('input[type="checkbox"]#smart-fixed-ribbon').prop("checked",!0),$.root_.addClass("fixed-header"),$.root_.addClass("fixed-navigation"),$.root_.addClass("fixed-ribbon"),$('input[type="checkbox"]#smart-fixed-container').prop("checked",!1),$.root_.removeClass("container")):$.root_.removeClass("fixed-ribbon")}),$('input[type="checkbox"]#smart-fixed-footer').click(function(){$(this).is(":checked")?$.root_.addClass("fixed-page-footer"):$.root_.removeClass("fixed-page-footer")}),$('input[type="checkbox"]#smart-rtl').click(function(){$(this).is(":checked")?$.root_.addClass("smart-rtl"):$.root_.removeClass("smart-rtl")}),$("#smart-topmenu").on("change",function(){$(this).prop("checked")?(localStorage.setItem("sm-setmenu","top"),location.reload()):(localStorage.setItem("sm-setmenu","left"),location.reload())}),"top"==localStorage.getItem("sm-setmenu")?$("#smart-topmenu").prop("checked",!0):$("#smart-topmenu").prop("checked",!1),$('input[type="checkbox"]#colorblind-friendly').click(function(){$(this).is(":checked")?$.root_.addClass("colorblind-friendly"):$.root_.removeClass("colorblind-friendly")}),$('input[type="checkbox"]#smart-fixed-container').click(function(){$(this).is(":checked")?($.root_.addClass("container"),$('input[type="checkbox"]#smart-fixed-ribbon').prop("checked",!1),$.root_.removeClass("fixed-ribbon"),$('input[type="checkbox"]#smart-fixed-navigation').prop("checked",!1),$.root_.removeClass("fixed-navigation"),smartbgimage?($("#smart-bgimages").append(smartbgimage).fadeIn(1e3),$("#smart-bgimages img").bind("click",function(){var e=$(this),t=$("html");bgurl=e.data("htmlbg-url"),t.css("background-image","url("+bgurl+")")}),smartbgimage=null):$("#smart-bgimages").fadeIn(1e3)):($.root_.removeClass("container"),$("#smart-bgimages").fadeOut())}),$("#reset-smart-widget").bind("click",function(){return $("#refresh").click(),!1}),$("#smart-styles > a").on("click",function(){var e=$(this),t=$("#logo img");$.root_.removeClassPrefix("smart-style").addClass(e.attr("id")),t.attr("src",e.data("skinlogo")),$("#smart-styles > a #skin-checked").remove(),e.prepend("<i class='fa fa-check fa-fw' id='skin-checked'></i>")}),$("#smart-styles a").click(function(){$.post("/admin/change_skin",{skin:$(this).attr("id")},function(e){})}),$("#smart-styles a").click(function(){$.post("/admin/change_skin",{skin:$(this).attr("id")},function(e){})}),function(e){"use strict";var t=function(t,i){this.options=e.extend({},e.fn.editable2form.defaults,i),this.$div=e(t),this.options.scope||(this.options.scope=this)};t.prototype={constructor:t,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=e(e.fn.editable2form.template)},initButtons:function(){var t=this.$form.find(".editable2-buttons");t.append(e.fn.editable2form.buttons),"bottom"===this.options.showbuttons&&t.addClass("editable2-buttons-bottom")},render:function(){this.$loading=e(e.fn.editable2form.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(".editable2-buttons").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler("rendering"),this.initInput(),this.$form.find("div.editable2-input").append(this.input.$tpl),this.$div.append(this.$form),e.when(this.input.render()).then(e.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable2-cancel").click(e.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(".editable2-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(e){e.preventDefault()});else{this.error(!1),this.input.$input.removeAttr("disabled"),this.$form.find(".editable2-submit").removeAttr("disabled");var t=null===this.value||void 0===this.value||""===this.value?this.options.defaultValue:this.value;this.input.value2input(t),this.$form.submit(e.proxy(this.submit,this))}this.$div.triggerHandler("rendered"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var e,t;this.$form?(e=this.$form.outerWidth(),t=this.$form.outerHeight(),e&&this.$loading.width(e),t&&this.$loading.height(t),this.$form.hide()):(e=this.$loading.parent().width())&&this.$loading.width(e),this.$loading.show()},showForm:function(e){this.$loading.hide(),this.$form.show(),!1!==e&&this.input.activate(),this.$div.triggerHandler("show")},error:function(t){var i,n=this.$form.find(".control-group"),s=this.$form.find(".editable2-error-block");if(!1===t)n.removeClass(e.fn.editable2form.errorGroupClass),s.removeClass(e.fn.editable2form.errorBlockClass).empty().hide();else{if(t){i=t.split("\n");for(var o=0;o<i.length;o++)i[o]=e("<div>").text(i[o]).html();t=i.join("<br>")}n.addClass(e.fn.editable2form.errorGroupClass),s.addClass(e.fn.editable2form.errorBlockClass).html(t).show()}},submit:function(t){t.stopPropagation(),t.preventDefault();var i,n=this.input.input2value();if(i=this.validate(n))return this.error(i),void this.showForm();if(this.options.savenochange||this.input.value2str(n)!=this.input.value2str(this.value)){var s=this.input.value2submit(n);this.isSaving=!0,e.when(this.save(s)).done(e.proxy(function(e){this.isSaving=!1;var t="function"==typeof this.options.success?this.options.success.call(this.options.scope,e,n):null;return!1===t?(this.error(!1),void this.showForm(!1)):"string"==typeof t?(this.error(t),void this.showForm()):(t&&"object"==typeof t&&t.hasOwnProperty("newValue")&&(n=t.newValue),this.error(!1),this.value=n,void this.$div.triggerHandler("save",{newValue:n,submitValue:s,response:e}))},this)).fail(e.proxy(function(e){var t;this.isSaving=!1,t="function"==typeof this.options.error?this.options.error.call(this.options.scope,e,n):"string"==typeof e?e:e.responseText||e.statusText||"Unknown error!",this.error(t),this.showForm()},this))}else this.$div.triggerHandler("nochange")},save:function(t){this.options.pk=e.fn.editable2utils.tryParseJson(this.options.pk,!0);var i,n="function"==typeof this.options.pk?this.options.pk.call(this.options.scope):this.options.pk;return!!("function"==typeof this.options.url||this.options.url&&("always"===this.options.send||"auto"===this.options.send&&null!=n))?(this.showLoading(),i={name:this.options.name||"",value:t,pk:n},"function"==typeof this.options.params?i=this.options.params.call(this.options.scope,i):(this.options.params=e.fn.editable2utils.tryParseJson(this.options.params,!0),e.extend(i,this.options.params)),"function"==typeof this.options.url?this.options.url.call(this.options.scope,i):e.ajax(e.extend({url:this.options.url,data:i,type:"POST"},this.options.ajaxOptions))):void 0},validate:function(e){return void 0===e&&(e=this.value),"function"==typeof this.options.validate?this.options.validate.call(this.options.scope,e):void 0},option:function(e,t){e in this.options&&(this.options[e]=t),"value"===e&&this.setValue(t)},setValue:function(e,t){this.value=t?this.input.str2value(e):e,this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}},e.fn.editable2form=function(i){var n=arguments;return this.each(function(){var s=e(this),o=s.data("editable2form"),r="object"==typeof i&&i;o||s.data("editable2form",o=new t(this,r)),"string"==typeof i&&o[i].apply(o,Array.prototype.slice.call(n,1))})},e.fn.editable2form.Constructor=t,e.fn.editable2form.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},e.fn.editable2form.template='<form class="form-inline editable2form"><div class="control-group"><div><div class="editable2-input"></div><div class="editable2-buttons"></div></div><div class="editable2-error-block"></div></div></form>',e.fn.editable2form.loading='<div class="editable2form-loading"></div>',e.fn.editable2form.buttons='<button type="submit" class="editable2-submit">ok</button><button type="button" class="editable2-cancel">cancel</button>',e.fn.editable2form.errorGroupClass=null,e.fn.editable2form.errorBlockClass="editable2-error",e.fn.editable2form.engine="jquery"}(window.jQuery),function(e){"use strict";e.fn.editable2utils={inherit:function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.superclass=t.prototype},setCursorPosition:function(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},tryParseJson:function(e,t){if("string"==typeof e&&e.length&&e.match(/^[\{\[].*[\}\]]$/))if(t)try{e=new Function("return "+e)()}catch(e){}finally{return e}else e=new Function("return "+e)();return e},sliceObj:function(t,i,n){var s,o,r={};if(!e.isArray(i)||!i.length)return r;for(var a=0;a<i.length;a++)s=i[a],t.hasOwnProperty(s)&&(r[s]=t[s]),!0!==n&&(o=s.toLowerCase(),t.hasOwnProperty(o)&&(r[s]=t[o]));return r},getConfigData:function(t){var i={};return e.each(t.data(),function(e,t){("object"!=typeof t||t&&"object"==typeof t&&(t.constructor===Object||t.constructor===Array))&&(i[e]=t)}),i},objectKeys:function(e){if(Object.keys)return Object.keys(e);if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i},escape:function(t){return e("<div>").text(t).html()},itemsByValue:function(t,i,n){if(!i||null===t)return[];if("function"!=typeof n){var s=n||"value";n=function(e){return e[s]}}var o=e.isArray(t),r=[],a=this;return e.each(i,function(i,s){if(s.children)r=r.concat(a.itemsByValue(t,s.children,n));else if(o)e.grep(t,function(e){return e==(s&&"object"==typeof s?n(s):s)}).length&&r.push(s);else{var l=s&&"object"==typeof s?n(s):s;t==l&&r.push(s)}}),r},createInput:function(t){var i,n=t.type;return"date"===n&&("inline"===t.mode?e.fn.editable2types.datefield?n="datefield":e.fn.editable2types.dateuifield&&(n="dateuifield"):e.fn.editable2types.date?n="date":e.fn.editable2types.dateui&&(n="dateui"),"date"!==n||e.fn.editable2types.date||(n="combodate")),"datetime"===n&&"inline"===t.mode&&(n="datetimefield"),"wysihtml5"!==n||e.fn.editable2types[n]||(n="textarea"),"function"==typeof e.fn.editable2types[n]?new(i=e.fn.editable2types[n])(this.sliceObj(t,this.objectKeys(i.defaults))):(e.error("Unknown type: "+n),!1)},supportsTransitions:function(){var e=(document.body||document.documentElement).style,t="transition",i=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof e[t])return!0;t=t.charAt(0).toUpperCase()+t.substr(1);for(var n=0;n<i.length;n++)if("string"==typeof e[i[n]+t])return!0;return!1}}}(window.jQuery),function(e){"use strict";var t=function(e,t){this.init(e,t)},i=function(e,t){this.init(e,t)};t.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable2-container editable2-popup",defaults:{},init:function(i,n){this.$element=e(i),this.options=e.extend({},e.fn.editable2Container.defaults,n),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on("destroyed",e.proxy(function(){this.destroy()},this)),e(document).data("editable2-handlers-attached")||(e(document).on("keyup.editable2",function(t){27===t.which&&e(".editable2-open").editable2Container("hide")}),e(document).on("click.editable2",function(i){var n,s=e(i.target),o=[".editable2-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(e.contains(document.documentElement,i.target)&&!s.is(document)){for(n=0;n<o.length;n++)if(s.is(o[n])||s.parents(o[n]).length)return;t.prototype.closeOthers(i.target)}}),e(document).data("editable2-handlers-attached",!0))},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!e.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var t in this.options)t in this.defaults?this.containerOptions[t]=this.options[t]:this.formOptions[t]=this.options[t]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var e;return this.containerDataName&&(e=this.$element.data(this.containerDataName))?e:e=this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editable2form(this.formOptions).on({save:e.proxy(this.save,this),nochange:e.proxy(function(){this.hide("nochange")},this),cancel:e.proxy(function(){this.hide("cancel")},this),show:e.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:e.proxy(this.setPosition,this),resize:e.proxy(this.setPosition,this),rendered:e.proxy(function(){this.$element.triggerHandler("shown",e(this.options.scope).data("editable2"))},this)}).editable2form("render")},show:function(t){this.$element.addClass("editable2-open"),!1!==t&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=e("<div>"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(e){if(this.tip()&&this.tip().is(":visible")&&this.$element.hasClass("editable2-open")){if(this.$form.data("editable2form").isSaving)return void(this.delayedHide={reason:e});this.delayedHide=!1,this.$element.removeClass("editable2-open"),this.innerHide(),this.$element.triggerHandler("hidden",e||"manual")}},innerShow:function(){},innerHide:function(){},toggle:function(e){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(e)},setPosition:function(){},save:function(e,t){this.$element.triggerHandler("save",t),this.hide("save")},option:function(e,t){this.options[e]=t,e in this.containerOptions?(this.containerOptions[e]=t,this.setContainerOption(e,t)):(this.formOptions[e]=t,this.$form&&this.$form.editable2form("option",e,t))},setContainerOption:function(e,t){this.call("option",e,t)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off("destroyed"),this.$element.removeData("editable2Container")},innerDestroy:function(){},closeOthers:function(t){e(".editable2-open").each(function(i,n){if(n!==t&&!e(n).find(t).length){var s=e(n),o=s.data("editable2Container");o&&("cancel"===o.options.onblur?s.data("editable2Container").hide("onblur"):"submit"===o.options.onblur&&s.data("editable2Container").tip().find("form").submit())}})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editable2form").input.activate()}},e.fn.editable2Container=function(n){var s=arguments;return this.each(function(){var o=e(this),r="editable2Container",a=o.data(r),l="object"==typeof n&&n,c="inline"===l.mode?i:t;a||o.data(r,a=new c(this,l)),"string"==typeof n&&a[n].apply(a,Array.prototype.slice.call(s,1))})},e.fn.editable2Container.Popup=t,e.fn.editable2Container.Inline=i,e.fn.editable2Container.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"},jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}}}(window.jQuery),function(e){"use strict";e.extend(e.fn.editable2Container.Inline.prototype,e.fn.editable2Container.Popup.prototype,{containerName:"editable2form",innerCss:".editable2-inline",containerClass:"editable2-container editable2-inline",initContainer:function(){this.$tip=e("<span></span>"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,e.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(e){"use strict";var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.editable2.defaults,i,e.fn.editable2utils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!e.fn.editable2utils.supportsTransitions()&&(this.options.highlight=!1)};t.prototype={constructor:t,init:function(){var t,i=!1;if(this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=e.fn.editable2utils.createInput(this.options),this.input){switch(void 0===this.options.value||null===this.options.value?(this.value=this.input.html2value(e.trim(this.$element.html())),i=!0):(this.options.value=e.fn.editable2utils.tryParseJson(this.options.value,!0),this.value="string"==typeof this.options.value?this.input.str2value(this.options.value):this.options.value),this.$element.addClass("editable2"),"textarea"===this.input.type&&this.$element.addClass("editable2-pre-wrapped"),"manual"!==this.options.toggle?(this.$element.addClass("editable2-click"),this.$element.on(this.options.toggle+".editable2",e.proxy(function(e){if(this.options.disabled||e.preventDefault(),"mouseenter"===this.options.toggle)this.show();else{var t="click"!==this.options.toggle;this.toggle(t)}},this))):this.$element.attr("tabindex",-1),"function"==typeof this.options.display&&(this.options.autotext="always"),this.options.autotext){case"always":t=!0;break;case"auto":t=!e.trim(this.$element.text()).length&&null!==this.value&&void 0!==this.value&&!i;break;default:t=!1}e.when(!t||this.render()).then(e.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler("init",this)},this))}},initLive:function(){var t=this.options.selector;this.options.selector=!1,this.options.autotext="never",this.$element.on(this.options.toggle+".editable2",t,e.proxy(function(t){var i=e(t.target);i.data("editable2")||(i.hasClass(this.options.emptyclass)&&i.empty(),i.editable2(this.options).trigger(t))},this))},render:function(e){return!1!==this.options.display?this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,e):"function"==typeof this.options.display?this.options.display.call(this.$element[0],this.value,e):this.input.value2html(this.value,this.$element[0]):void 0},enable:function(){this.options.disabled=!1,this.$element.removeClass("editable2-disabled"),this.handleEmpty(this.isEmpty),"manual"!==this.options.toggle&&"-1"===this.$element.attr("tabindex")&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass("editable2-disabled"),this.handleEmpty(this.isEmpty),this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(t,i){return t&&"object"==typeof t?void e.each(t,e.proxy(function(t,i){this.option(e.trim(t),i)},this)):(this.options[t]=i,"disabled"===t?i?this.disable():this.enable():("value"===t&&this.setValue(i),this.container&&this.container.option(t,i),void(this.input.option&&this.input.option(t,i))))},handleEmpty:function(t){!1!==this.options.display&&(this.isEmpty=void 0!==t?t:"function"==typeof this.input.isEmpty?this.input.isEmpty(this.$element):""===e.trim(this.$element.html()),this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(t){if(!this.options.disabled){if(this.container){if(this.container.tip().is(":visible"))return}else{var i=e.extend({},this.options,{value:this.value,input:this.input});this.$element.editable2Container(i),this.$element.on("save.internal",e.proxy(this.save,this)),this.container=this.$element.data("editable2Container")}this.container.show(t)}},hide:function(){this.container&&this.container.hide()},toggle:function(e){this.container&&this.container.tip().is(":visible")?this.hide():this.show(e)},save:function(e,t){if(this.options.unsavedclass){var i=!1;(i=(i=(i=(i=i||"function"==typeof this.options.url)||!1===this.options.display)||void 0!==t.response)||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue))?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var n=this.$element,s=n.css("background-color");n.css("background-color",this.options.highlight),setTimeout(function(){"transparent"===s&&(s=""),n.css("background-color",s),n.addClass("editable2-bg-transition"),setTimeout(function(){n.removeClass("editable2-bg-transition")},1700)},10)}this.setValue(t.newValue,!1,t.response)},validate:function(){return"function"==typeof this.options.validate?this.options.validate.call(this,this.value):void 0},setValue:function(t,i,n){this.value=i?this.input.str2value(t):t,this.container&&this.container.option("value",this.value),e.when(this.render(n)).then(e.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),"manual"!==this.options.toggle&&(this.$element.removeClass("editable2-click"),this.$element.off(this.options.toggle+".editable2")),this.$element.off("save.internal"),this.$element.removeClass("editable2 editable2-open editable2-disabled"),this.$element.removeData("editable2")}},e.fn.editable2=function(i){var n={},s=arguments,o="editable2";switch(i){case"validate":return this.each(function(){var t,i=e(this).data(o);i&&(t=i.validate())&&(n[i.options.name]=t)}),n;case"getValue":return 2===arguments.length&&!0===arguments[1]?n=this.eq(0).data(o).value:this.each(function(){var t=e(this).data(o);t&&void 0!==t.value&&null!==t.value&&(n[t.options.name]=t.input.value2submit(t.value))}),n;case"submit":var r,a=arguments[1]||{},l=this,c=this.editable2("validate");return e.isEmptyObject(c)?(r=this.editable2("getValue"),a.data&&e.extend(r,a.data),e.ajax(e.extend({url:a.url,data:r,type:"POST"},a.ajaxOptions)).success(function(e){"function"==typeof a.success&&a.success.call(l,e,a)}).error(function(){"function"==typeof a.error&&a.error.apply(l,arguments)})):"function"==typeof a.error&&a.error.call(l,c),this}return this.each(function(){var n=e(this),r=n.data(o),a="object"==typeof i&&i;return a&&a.selector?void(r=new t(this,a)):(r||n.data(o,r=new t(this,a)),void("string"==typeof i&&r[i].apply(r,Array.prototype.slice.call(s,1))))})},e.fn.editable2.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable2-empty",unsavedclass:"editable2-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(e){"use strict";e.fn.editable2types={};var t=function(){};t.prototype={init:function(t,i,n){this.type=t,this.options=e.extend({},n,i)},prerender:function(){this.$tpl=e(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(t,i){e(i)[this.options.escape?"text":"html"](e.trim(t))},html2value:function(t){return e("<div>").html(t).text()},value2str:function(e){return e},str2value:function(e){return e},value2submit:function(e){return e},value2input:function(e){this.$input.val(e)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(t){return e("<div>").text(t).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(e){void 0!==this.options[e]&&null!==this.options[e]&&this.$input.attr(e,this.options[e])},option:function(e,t){this.options[e]=t}},t.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0},e.extend(e.fn.editable2types,{abstractinput:t})}(window.jQuery),function(e){"use strict";var t=function(){};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){var t=e.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),t.resolve()},function(){this.error=this.options.sourceError,t.resolve()}),t.promise()},html2value:function(){return null},value2html:function(t,i,n,s){var o=e.Deferred(),r=function(){"function"==typeof n?n.call(i,t,this.sourceData,s):this.value2htmlFinal(t,i),o.resolve()};return null===t?r.call(this):this.onSourceReady(r,function(){o.resolve()}),o.promise()},onSourceReady:function(t,i){var n;if(e.isFunction(this.options.source)?(n=this.options.source.call(this.options.scope),this.sourceData=null):n=this.options.source,this.options.sourceCache&&e.isArray(this.sourceData))t.call(this);else{try{n=e.fn.editable2utils.tryParseJson(n,!1)}catch(e){return void i.call(this)}if("string"==typeof n){if(this.options.sourceCache){var s,o=n;if(e(document).data(o)||e(document).data(o,{}),!1===(s=e(document).data(o)).loading&&s.sourceData)return this.sourceData=s.sourceData,this.doPrepend(),void t.call(this);if(!0===s.loading)return s.callbacks.push(e.proxy(function(){this.sourceData=s.sourceData,this.doPrepend(),t.call(this)},this)),void s.err_callbacks.push(e.proxy(i,this));s.loading=!0,s.callbacks=[],s.err_callbacks=[]}var r=e.extend({url:n,type:"get",cache:!1,dataType:"json",success:e.proxy(function(n){s&&(s.loading=!1),this.sourceData=this.makeArray(n),e.isArray(this.sourceData)?(s&&(s.sourceData=this.sourceData,e.each(s.callbacks,function(){this.call()})),this.doPrepend(),t.call(this)):(i.call(this),s&&e.each(s.err_callbacks,function(){this.call()}))},this),error:e.proxy(function(){i.call(this),s&&(s.loading=!1,e.each(s.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);e.ajax(r)}else this.sourceData=this.makeArray(n),e.isArray(this.sourceData)?(this.doPrepend(),t.call(this)):i.call(this)}},doPrepend:function(){null!==this.options.prepend&&void 0!==this.options.prepend&&(e.isArray(this.prependData)||(e.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=e.fn.editable2utils.tryParseJson(this.options.prepend,!0),"string"==typeof this.options.prepend&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),e.isArray(this.prependData)&&e.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(){},makeArray:function(t){var i,n,s,o,r=[];if(!t||"string"==typeof t)return null;if(e.isArray(t)){o=function(e,t){return n={value:e,text:t},!(i++>=2)&&void 0};for(var a=0;a<t.length;a++)"object"==typeof(s=t[a])?(i=0,e.each(s,o),1===i?r.push(n):i>1&&(s.children&&(s.children=this.makeArray(s.children)),r.push(s))):r.push({value:s,text:s})}else e.each(t,function(e,t){r.push({value:e,text:t})});return r},option:function(e,t){this.options[e]=t,"source"===e&&(this.sourceData=null),"prepend"===e&&(this.prependData=null)}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null}),e.fn.editable2types.list=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("text",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),e.fn.editable2utils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=e('<span class="editable2-clear-x"></span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(e.proxy(function(t){if(!~e.inArray(t.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var i=this;this.t=setTimeout(function(){i.toggleClear(t)},100)}},this)).parent().css("position","relative"),this.$clear.click(e.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(){if(this.$clear){var e=this.$input.val().length,t=this.$clear.is(":visible");e&&!t&&this.$clear.show(),!e&&t&&this.$clear.hide()}},clear:function(){this.$clear.hide(),this.$input.val("").focus()}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0}),e.fn.editable2types.text=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("textarea",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.setAttr("placeholder"),this.setAttr("rows"),this.$input.keydown(function(t){t.ctrlKey&&13===t.which&&e(this).closest("form").submit()})},activate:function(){e.fn.editable2types.text.prototype.activate.call(this)}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7}),e.fn.editable2types.textarea=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("select",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.list),e.extend(t.prototype,{renderList:function(){this.$input.empty();var t=function(i,n){var s;if(e.isArray(n))for(var o=0;o<n.length;o++)s={},n[o].children?(s.label=n[o].text,i.append(t(e("<optgroup>",s),n[o].children))):(s.value=n[o].value,n[o].disabled&&(s.disabled=!0),i.append(e("<option>",s).text(n[o].text)));return i};t(this.$input,this.sourceData),this.setClass(),this.$input.on("keydown.editable2",function(t){13===t.which&&e(this).closest("form").submit()})},value2htmlFinal:function(t,i){var n="",s=e.fn.editable2utils.itemsByValue(t,this.sourceData);s.length&&(n=s[0].text),e.fn.editable2types.abstractinput.prototype.value2html.call(this,n,i)},autosubmit:function(){this.$input.off("keydown.editable2").on("change.editable2",function(){e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editable2types.list.defaults,{tpl:"<select></select>"}),e.fn.editable2types.select=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("checklist",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.list),e.extend(t.prototype,{renderList:function(){var t;if(this.$tpl.empty(),e.isArray(this.sourceData)){for(var i=0;i<this.sourceData.length;i++)t=e("<label>").append(e("<input>",{type:"checkbox",value:this.sourceData[i].value})).append(e("<span>").text(" "+this.sourceData[i].text)),e("<div>").append(t).appendTo(this.$tpl);this.$input=this.$tpl.find('input[type="checkbox"]'),this.setClass()}},value2str:function(t){return e.isArray(t)?t.sort().join(e.trim(this.options.separator)):""},str2value:function(t){var i,n=null;return"string"==typeof t&&t.length?(i=new RegExp("\\s*"+e.trim(this.options.separator)+"\\s*"),n=t.split(i)):n=e.isArray(t)?t:[t],n},value2input:function(t){this.$input.prop("checked",!1),e.isArray(t)&&t.length&&this.$input.each(function(i,n){var s=e(n);e.each(t,function(e,t){s.val()==t&&s.prop("checked",!0)})})},input2value:function(){var t=[];return this.$input.filter(":checked").each(function(i,n){t.push(e(n).val())}),t},value2htmlFinal:function(t,i){var n=[],s=e.fn.editable2utils.itemsByValue(t,this.sourceData),o=this.options.escape;s.length?(e.each(s,function(t,i){var s=o?e.fn.editable2utils.escape(i.text):i.text;n.push(s)}),e(i).html(n.join("<br>"))):e(i).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(t){13===t.which&&e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editable2types.list.defaults,{tpl:'<div class="editable2-checklist"></div>',inputclass:null,separator:","}),e.fn.editable2types.checklist=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("password",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.text),e.extend(t.prototype,{value2html:function(t,i){t?e(i).text("[hidden]"):e(i).empty()},html2value:function(){return null}}),t.defaults=e.extend({},e.fn.editable2types.text.defaults,{tpl:'<input type="password">'}),e.fn.editable2types.password=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("email",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.text),t.defaults=e.extend({},e.fn.editable2types.text.defaults,{tpl:'<input type="email">'}),e.fn.editable2types.email=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("url",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.text),t.defaults=e.extend({},e.fn.editable2types.text.defaults,{tpl:'<input type="url">'}),e.fn.editable2types.url=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("tel",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.text),t.defaults=e.extend({},e.fn.editable2types.text.defaults,{tpl:'<input type="tel">'}),e.fn.editable2types.tel=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("number",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.text),e.extend(t.prototype,{render:function(){t.superclass.render.call(this),this.setAttr("min"),this.setAttr("max"),this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),t.defaults=e.extend({},e.fn.editable2types.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null}),e.fn.editable2types.number=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("range",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.number),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.setAttr("min"),this.setAttr("max"),this.setAttr("step"),this.$input.on("input",function(){e(this).siblings("output").text(e(this).val())})},activate:function(){this.$input.focus()}}),t.defaults=e.extend({},e.fn.editable2types.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"}),e.fn.editable2types.range=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("time",e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){this.setClass()}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<input type="time">'}),e.fn.editable2types.time=t}(window.jQuery),function(e){"use strict";var t=function(i){if(this.init("select2",i,t.defaults),i.select2=i.select2||{},this.sourceData=null,i.placeholder&&(i.select2.placeholder=i.placeholder),!i.select2.tags&&i.source){var n=i.source;e.isFunction(i.source)&&(n=i.source.call(i.scope)),"string"==typeof n?(i.select2.ajax=i.select2.ajax||{},i.select2.ajax.data||(i.select2.ajax.data=function(e){return{query:e}}),i.select2.ajax.results||(i.select2.ajax.results=function(e){return{results:e}}),i.select2.ajax.url=n):(this.sourceData=this.convertSource(n),i.select2.data=this.sourceData)}if(this.options.select2=e.extend({},t.defaults.select2,i.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote="ajax"in this.options.select2,this.idFunc=this.options.select2.id,"function"!=typeof this.idFunc){var s=this.idFunc||"id";this.idFunc=function(e){return e[s]}}this.formatSelection=this.options.select2.formatSelection,"function"!=typeof this.formatSelection&&(this.formatSelection=function(e){return e.text})};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on("select2-loaded",e.proxy(function(e){this.sourceData=e.items.results},this)),this.isMultiple&&this.$input.on("change",function(){e(this).closest("form").parent().triggerHandler("resize")})},value2html:function(i,n){var s,o="",r=this;this.options.select2.tags?s=i:this.sourceData&&(s=e.fn.editable2utils.itemsByValue(i,this.sourceData,this.idFunc)),e.isArray(s)?(o=[],e.each(s,function(e,t){o.push(t&&"object"==typeof t?r.formatSelection(t):t)})):s&&(o=r.formatSelection(s)),o=e.isArray(o)?o.join(this.options.viewseparator):o,t.superclass.value2html.call(this,o,n)},html2value:function(e){return this.options.select2.tags?this.str2value(e,this.options.viewseparator):null},value2input:function(t){if(this.$input.data("select2")?this.$input.val(t).trigger("change",!0):(this.$input.val(t),this.$input.select2(this.options.select2)),this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var i=this.options.select2.id,n=this.options.select2.formatSelection;if(!i&&!n){var s={id:t,text:e(this.options.scope).text()};this.$input.select2("data",s)}}},input2value:function(){return this.$input.select2("val")},str2value:function(t,i){if("string"!=typeof t||!this.isMultiple)return t;var n,s,o;if(i=i||this.options.select2.separator||e.fn.select2.defaults.separator,null===t||t.length<1)return null;for(s=0,o=(n=t.split(i)).length;o>s;s+=1)n[s]=e.trim(n[s]);return n},autosubmit:function(){this.$input.on("change",function(t,i){i||e(this).closest("form").submit()})},convertSource:function(t){if(e.isArray(t)&&t.length&&void 0!==t[0].value)for(var i=0;i<t.length;i++)void 0!==t[i].value&&(t[i].id=t[i].value,delete t[i].value);return t},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "}),e.fn.editable2types.select2=t}(window.jQuery),function(e){var t=function(t,i){return this.$element=e(t),this.$element.is("input")?(this.options=e.extend({},e.fn.combodate.defaults,i,this.$element.data()),void this.init()):void e.error("Combodate should be applied to INPUT element")};t.prototype={constructor:t,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]},this.$widget=e('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on("change","select",e.proxy(function(){this.$element.val(this.getValue())},this)),this.$widget.find("select").css("width","auto"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var t=this.options.template;return e.each(this.map,function(e,i){i=i[0];var n=new RegExp(i+"+"),s=i.length>1?i.substring(1,2):i;t=t.replace(n,"{"+s+"}")}),t=t.replace(/ /g,"&nbsp;"),e.each(this.map,function(e,i){var n=(i=i[0]).length>1?i.substring(1,2):i;t=t.replace("{"+n+"}",'<select class="'+e+'"></select>')}),t},initCombos:function(){var t=this;e.each(this.map,function(e){var i,n,s=t.$widget.find("."+e);s.length&&(t["$"+e]=s,i="fill"+e.charAt(0).toUpperCase()+e.slice(1),n=t[i](),t["$"+e].html(t.renderItems(n)))})},initItems:function(e){var t,i=[];if("name"===this.options.firstItem){var n="function"==typeof(t=moment.relativeTime||moment.langData()._relativeTime)[e]?t[e](1,!0,e,!1):t[e];n=n.split(" ").reverse()[0],i.push(["",n])}else"empty"===this.options.firstItem&&i.push(["",""]);return i},renderItems:function(e){for(var t=[],i=0;i<e.length;i++)t.push('<option value="'+e[i][0]+'">'+e[i][1]+"</option>");return t.join("\n")},fillDay:function(){var e,t,i=this.initItems("d"),n=-1!==this.options.template.indexOf("DD");for(t=1;31>=t;t++)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillMonth:function(){var e,t,i=this.initItems("M"),n=-1!==this.options.template.indexOf("MMMM"),s=-1!==this.options.template.indexOf("MMM"),o=-1!==this.options.template.indexOf("MM");for(t=0;11>=t;t++)e=n?moment().date(1).month(t).format("MMMM"):s?moment().date(1).month(t).format("MMM"):o?this.leadZero(t+1):t+1,i.push([t,e]);return i},fillYear:function(){var e,t,i=[],n=-1!==this.options.template.indexOf("YYYY");for(t=this.options.maxYear;t>=this.options.minYear;t--)e=n?t:(t+"").substring(2),i[this.options.yearDescending?"push":"unshift"]([t,e]);return this.initItems("y").concat(i)},fillHour:function(){var e,t,i=this.initItems("h"),n=-1!==this.options.template.indexOf("h"),s=(this.options.template.indexOf("H"),-1!==this.options.template.toLowerCase().indexOf("hh")),o=n?12:23;for(t=n?1:0;o>=t;t++)e=s?this.leadZero(t):t,i.push([t,e]);return i},fillMinute:function(){var e,t,i=this.initItems("m"),n=-1!==this.options.template.indexOf("mm");for(t=0;59>=t;t+=this.options.minuteStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillSecond:function(){var e,t,i=this.initItems("s"),n=-1!==this.options.template.indexOf("ss");for(t=0;59>=t;t+=this.options.secondStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillAmpm:function(){var e=-1!==this.options.template.indexOf("a");return this.options.template.indexOf("A"),[["am",e?"am":"AM"],["pm",e?"pm":"PM"]]},getValue:function(t){var i,n={},s=this,o=!1;return e.each(this.map,function(e){if("ampm"!==e){var t="day"===e?1:0;return n[e]=s["$"+e]?parseInt(s["$"+e].val(),10):t,isNaN(n[e])?(o=!0,!1):void 0}}),o?"":(this.$ampm&&(n.hour=12===n.hour?"am"===this.$ampm.val()?0:12:"am"===this.$ampm.val()?n.hour:n.hour+12),i=moment([n.year,n.month,n.day,n.hour,n.minute,n.second]),this.highlight(i),null===(t=void 0===t?this.options.format:t)?i.isValid()?i:null:i.isValid()?i.format(t):"")},setValue:function(t){function i(t,i){var n={};return t.children("option").each(function(t,s){var o,r=e(s).attr("value");""!==r&&(o=Math.abs(r-i),(void 0===n.distance||o<n.distance)&&(n={value:r,distance:o}))}),n.value}if(t){var n="string"==typeof t?moment(t,this.options.format):moment(t),s=this,o={};n.isValid()&&(e.each(this.map,function(e,t){"ampm"!==e&&(o[e]=n[t[1]]())}),this.$ampm&&(o.hour>=12?(o.ampm="pm",o.hour>12&&(o.hour-=12)):(o.ampm="am",0===o.hour&&(o.hour=12))),e.each(o,function(e,t){s["$"+e]&&("minute"===e&&s.options.minuteStep>1&&s.options.roundTime&&(t=i(s["$"+e],t)),"second"===e&&s.options.secondStep>1&&s.options.roundTime&&(t=i(s["$"+e],t)),s["$"+e].val(t))}),this.$element.val(n.format(this.options.format)))}},highlight:function(e){e.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(e){return 9>=e?"0"+e:e},destroy:function(){this.$widget.remove(),this.$element.removeData("combodate").show()}},e.fn.combodate=function(i){var n,s=Array.apply(null,arguments);return s.shift(),"getValue"===i&&this.length&&(n=this.eq(0).data("combodate"))?n.getValue.apply(n,s):this.each(function(){var n=e(this),o=n.data("combodate"),r="object"==typeof i&&i;o||n.data("combodate",o=new t(this,r)),"string"==typeof i&&"function"==typeof o[i]&&o[i].apply(o,s)})},e.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0}}(window.jQuery),function(e){"use strict";var t=function(i){this.init("combodate",i,t.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),i.combodate=e.fn.editable2utils.tryParseJson(i.combodate,!0),this.options.combodate=e.extend({},t.defaults.combodate,i.combodate,{format:this.options.format,template:this.options.template})};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{render:function(){this.$input.combodate(this.options.combodate),"bs3"===e.fn.editable2form.engine&&this.$input.siblings().find("select").addClass("form-control"),this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(e,i){var n=e?e.format(this.options.viewformat):"";t.superclass.value2html.call(this,n,i)},html2value:function(e){return e?moment(e,this.options.viewformat):null},value2str:function(e){return e?e.format(this.options.format):""},str2value:function(e){return e?moment(e,this.options.format):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.combodate("setValue",e)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null}),e.fn.editable2types.combodate=t}(window.jQuery),function(e){"use strict";var t=e.fn.editable2form.Constructor.prototype.initInput;e.extend(e.fn.editable2form.Constructor.prototype,{initTemplate:function(){this.$form=e(e.fn.editable2form.template),this.$form.find(".control-group").addClass("form-group"),this.$form.find(".editable2-error-block").addClass("help-block")},initInput:function(){t.apply(this);var i=null===this.input.options.inputclass||!1===this.input.options.inputclass,n="input-sm",s="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");~e.inArray(this.input.type,s)&&(this.input.$input.addClass("form-control"),i&&(this.input.options.inputclass=n,this.input.$input.addClass(n)));for(var o=this.$form.find(".editable2-buttons"),r=i?[n]:this.input.options.inputclass.split(" "),a=0;a<r.length;a++)"input-lg"===r[a].toLowerCase()&&o.find("button").removeClass("btn-sm").addClass("btn-lg")}}),e.fn.editable2form.buttons='<button type="submit" class="btn btn-primary btn-sm editable2-submit"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="btn btn-default btn-sm editable2-cancel"><i class="glyphicon glyphicon-remove"></i></button>',e.fn.editable2form.errorGroupClass="has-error",e.fn.editable2form.errorBlockClass=null,e.fn.editable2form.engine="bs3"}(window.jQuery),function(e){"use strict";e.extend(e.fn.editable2Container.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:e.fn.popover.Constructor.DEFAULTS,initContainer:function(){var t;e.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template}),this.$element.data("template")&&(t=this.$element.data("template"),this.$element.removeData("template")),this.call(this.containerOptions),t&&this.$element.data("template",t)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(e,t){this.container().options[e]=t},setPosition:function(){(function(){var e=this.tip(),t="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,i=this.getPosition(),n=e[0].offsetWidth,s=e[0].offsetHeight,o=this.getCalculatedOffset(t,i,n,s);this.applyPlacement(o,t)}).call(this.container())}})}(window.jQuery),function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}function i(t){var i={};if(c[t]||(t=t.split("-")[0],c[t])){var n=c[t];return e.each(l,function(e,t){t in n&&(i[t]=n[t])}),i}}var n=function(t,i){this._process_options(i),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(d.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};n.prototype={constructor:n,_process_options:function(t){this._o=e.extend({},this._o,t);var i=this.o=e.extend({},this._o),n=i.language;switch(c[n]||(n=n.split("-")[0],c[n]||(n=a.language)),i.language=n,i.startView){case 2:case"decade":i.startView=2;break;case 1:case"year":i.startView=1;break;default:i.startView=0}switch(i.minViewMode){case 1:case"months":i.minViewMode=1;break;case 2:case"years":i.minViewMode=2;break;default:i.minViewMode=0}i.startView=Math.max(i.startView,i.minViewMode),i.weekStart%=7,i.weekEnd=(i.weekStart+6)%7;var s=d.parseFormat(i.format);i.startDate!==-1/0&&(i.startDate=d.parseDate(i.startDate,s,i.language)),1/0!==i.endDate&&(i.endDate=d.parseDate(i.endDate,s,i.language)),i.daysOfWeekDisabled=i.daysOfWeekDisabled||[],e.isArray(i.daysOfWeekDisabled)||(i.daysOfWeekDisabled=i.daysOfWeekDisabled.split(/[,\s]*/)),i.daysOfWeekDisabled=e.map(i.daysOfWeekDisabled,function(e){return parseInt(e,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.on(i)},_unapplyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.off(i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).size()||this.picker.is(e.target)||this.picker.find(e.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,i){var n=i||this.date,s=new Date(n.getTime()+6e4*n.getTimezoneOffset());this.element.trigger({type:t,date:s,format:e.proxy(function(e){var t=e||this.o.format;return d.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),e&&e.preventDefault(),this._trigger("show")},hide:function(){this.isInline||this.picker.is(":visible")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){this.date=e,this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e):this.component&&this.element.find("input").val(e)},getFormattedDate:function(e){return void 0===e&&(e=this.o.format),d.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=parseInt(this.element.parents().filter(function(){return"auto"!=e(this).css("z-index")}).first().css("z-index"))+10,i=this.component?this.component.parent().offset():this.element.offset(),n=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:i.top+n,left:i.left,zIndex:t})}},_allow_update:!0,update:function(){if(this._allow_update){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=d.parseDate(e,this.o.format,this.o.language),t&&this.setValue(),this.viewDate=new Date(this.date<this.o.startDate?this.o.startDate:this.date>this.o.endDate?this.o.endDate:this.date),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var i='<th class="cw">&nbsp;</th>';t+=i,this.picker.find(".datepicker-days thead tr:first-child").prepend(i)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+c[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+c[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var i=[],n=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),o=this.date.valueOf(),r=new Date;return t.getUTCFullYear()<n||t.getUTCFullYear()==n&&t.getUTCMonth()<s?i.push("old"):(t.getUTCFullYear()>n||t.getUTCFullYear()==n&&t.getUTCMonth()>s)&&i.push("new"),this.o.todayHighlight&&t.getUTCFullYear()==r.getFullYear()&&t.getUTCMonth()==r.getMonth()&&t.getUTCDate()==r.getDate()&&i.push("today"),o&&t.valueOf()==o&&i.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&i.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&i.push("range"),-1!=e.inArray(t.valueOf(),this.range)&&i.push("selected")),i},fill:function(){var i,n=new Date(this.viewDate),s=n.getUTCFullYear(),o=n.getUTCMonth(),r=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,a=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,l=1/0!==this.o.endDate?this.o.endDate.getUTCFullYear():1/0,u=1/0!==this.o.endDate?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf(),this.picker.find(".datepicker-days thead th.datepicker-switch").text(c[this.o.language].months[o]+" "+s),this.picker.find("tfoot th.today").text(c[this.o.language].today).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot th.clear").text(c[this.o.language].clear).toggle(!1!==this.o.clearBtn),this.updateNavArrows(),this.fillMonths();var h=t(s,o-1,28,0,0,0,0),p=d.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(p),h.setUTCDate(p-(h.getUTCDay()-this.o.weekStart+7)%7);var f=new Date(h);f.setUTCDate(f.getUTCDate()+42),f=f.valueOf();for(var m,g=[];h.valueOf()<f;){if(h.getUTCDay()==this.o.weekStart&&(g.push("<tr>"),this.o.calendarWeeks)){var v=new Date(+h+(this.o.weekStart-h.getUTCDay()-7)%7*864e5),b=new Date(+v+(11-v.getUTCDay())%7*864e5),y=new Date(+(y=t(b.getUTCFullYear(),0,1))+(11-y.getUTCDay())%7*864e5),w=(b-y)/864e5/7+1;g.push('<td class="cw">'+w+"</td>")}(m=this.getClassNames(h)).push("day");var x=this.o.beforeShowDay(h);void 0===x?x={}:"boolean"==typeof x?x={enabled:x}:"string"==typeof x&&(x={classes:x}),!1===x.enabled&&m.push("disabled"),x.classes&&(m=m.concat(x.classes.split(/\s+/))),x.tooltip&&(i=x.tooltip),m=e.unique(m),g.push('<td class="'+m.join(" ")+'"'+(i?' title="'+i+'"':"")+">"+h.getUTCDate()+"</td>"),h.getUTCDay()==this.o.weekEnd&&g.push("</tr>"),h.setUTCDate(h.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(g.join(""));var C=this.date&&this.date.getUTCFullYear(),E=this.picker.find(".datepicker-months").find("th:eq(1)").text(s).end().find("span").removeClass("active");C&&C==s&&E.eq(this.date.getUTCMonth()).addClass("active"),(r>s||s>l)&&E.addClass("disabled"),s==r&&E.slice(0,a).addClass("disabled"),s==l&&E.slice(u+1).addClass("disabled"),g="",s=10*parseInt(s/10,10);var T=this.picker.find(".datepicker-years").find("th:eq(1)").text(s+"-"+(s+9)).end().find("td");s-=1;for(var k=-1;11>k;k++)g+='<span class="year'+(-1==k?" old":10==k?" new":"")+(C==s?" active":"")+(r>s||s>l?" disabled":"")+'">'+s+"</span>",s+=1;T.html(g)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth();switch(this.viewMode){case 0:this.picker.find(".prev").css(this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(1/0!==this.o.endDate&&t>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"});break;case 1:case 2:this.picker.find(".prev").css(this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(1/0!==this.o.endDate&&t>=this.o.endDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"})}}},click:function(i){i.preventDefault();var n=e(i.target).closest("span, td, th");if(1==n.length)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var s=d.modes[this.viewMode].navStep*("prev"==n[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s)}this.fill();break;case"today":var o=new Date;o=t(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0),this.showMode(-2);var r="linked"==this.o.todayBtn?null:"view";this._setDate(o,r);break;case"clear":var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!n.is(".disabled")){if(this.viewDate.setUTCDate(1),n.is(".month")){var l=1,c=n.parent().find("span").index(n),u=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(c),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(t(u,c,l,0,0,0,0))}else{u=parseInt(n.text(),10)||0,l=1,c=0;this.viewDate.setUTCFullYear(u),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(t(u,c,l,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(n.is(".day")&&!n.is(".disabled")){l=parseInt(n.text(),10)||1,u=this.viewDate.getUTCFullYear(),c=this.viewDate.getUTCMonth();n.is(".old")?0===c?(c=11,u-=1):c-=1:n.is(".new")&&(11==c?(c=0,u+=1):c+=1),this._setDate(t(u,c,l,0,0,0,0))}}},_setDate:function(e,t){var i;t&&"date"!=t||(this.date=new Date(e)),t&&"view"!=t||(this.viewDate=new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate"),this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),!this.o.autoclose||t&&"date"!=t||this.hide())},moveMonth:function(e,t){if(!t)return e;var i,n,s=new Date(e.valueOf()),o=s.getUTCDate(),r=s.getUTCMonth(),a=Math.abs(t);if(t=t>0?1:-1,1==a)n=-1==t?function(){return s.getUTCMonth()==r}:function(){return s.getUTCMonth()!=i},i=r+t,s.setUTCMonth(i),(0>i||i>11)&&(i=(i+12)%12);else{for(var l=0;a>l;l++)s=this.moveMonth(s,t);i=s.getUTCMonth(),s.setUTCDate(o),n=function(){return i!=s.getUTCMonth()}}for(;n();)s.setUTCDate(--o),s.setUTCMonth(i);return s},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))27==e.keyCode&&this.show();else{var t,i,n,s,o=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+7*t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+7*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(o)this._trigger("changeDate"),this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+d.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var s=function(t,i){this.element=e(t),this.inputs=e.map(i.inputs,function(e){return e.jquery?e[0]:e}),delete i.inputs,e(this.inputs).datepicker(i).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};s.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.date}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,i){i.setRange(t)})},dateUpdated:function(t){var i=e(t.target).data("datepicker").getUTCDate(),n=e.inArray(t.target,this.inputs),s=this.inputs.length;if(-1!=n){if(i<this.dates[n])for(;n>=0&&i<this.dates[n];)this.pickers[n--].setUTCDate(i);else if(i>this.dates[n])for(;s>n&&i>this.dates[n];)this.pickers[n++].setUTCDate(i);this.updateDates()}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var o=e.fn.datepicker,r=e.fn.datepicker=function(t){var o,r=Array.apply(null,arguments);return r.shift(),this.each(function(){var l=e(this),c=l.data("datepicker"),d="object"==typeof t&&t;if(!c){var u=function(t,i){var n=e(t).data(),s={},o=new RegExp("^"+i.toLowerCase()+"([A-Z])");for(var r in i=new RegExp("^"+i.toLowerCase()),n)i.test(r)&&(s[r.replace(o,function(e,t){return t.toLowerCase()})]=n[r]);return s}(this,"date"),h=i(e.extend({},a,u,d).language),p=e.extend({},a,h,u,d);if(l.is(".input-daterange")||p.inputs){var f={inputs:p.inputs||l.find("input").toArray()};l.data("datepicker",c=new s(this,e.extend(p,f)))}else l.data("datepicker",c=new n(this,p))}return("string"!=typeof t||"function"!=typeof c[t]||void 0===(o=c[t].apply(c,r)))&&void 0}),void 0!==o?o:this},a=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},l=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=n;var c=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},d={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,d.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),i=e.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(i,s,o){if(i instanceof Date)return i;if("string"==typeof s&&(s=d.parseFormat(s)),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(i)){var r,a=/([\-+]\d+)([dmwy])/,l=i.match(/([\-+]\d+)([dmwy])/g);i=new Date;for(var u=0;u<l.length;u++)switch(f=a.exec(l[u]),r=parseInt(f[1]),f[2]){case"d":i.setUTCDate(i.getUTCDate()+r);break;case"m":i=n.prototype.moveMonth.call(n.prototype,i,r);break;case"w":i.setUTCDate(i.getUTCDate()+7*r);break;case"y":i=n.prototype.moveYear.call(n.prototype,i,r)}return t(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0,0,0)}l=i&&i.match(this.nonpunctuation)||[],i=new Date;var h,p,f,m={},g=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};v.M=v.MM=v.mm=v.m,v.dd=v.d,i=t(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0);var b=s.parts.slice();if(l.length!=b.length&&(b=e(b).filter(function(t,i){return-1!==e.inArray(i,g)}).toArray()),l.length==b.length){u=0;for(var y=b.length;y>u;u++){if(h=parseInt(l[u],10),f=b[u],isNaN(h))switch(f){case"MM":p=e(c[o].months).filter(function(){var e=this.slice(0,l[u].length);return e==l[u].slice(0,e.length)}),h=e.inArray(p[0],c[o].months)+1;break;case"M":p=e(c[o].monthsShort).filter(function(){var e=this.slice(0,l[u].length);return e==l[u].slice(0,e.length)}),h=e.inArray(p[0],c[o].monthsShort)+1}m[f]=h}var w;for(u=0;u<g.length;u++)(w=g[u])in m&&!isNaN(m[w])&&v[w](i,m[w])}return i},formatDate:function(t,i,n){"string"==typeof i&&(i=d.parseFormat(i));var s={d:t.getUTCDate(),D:c[n].daysShort[t.getUTCDay()],DD:c[n].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:c[n].monthsShort[t.getUTCMonth()],MM:c[n].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m;t=[];for(var o=e.extend([],i.separators),r=0,a=i.parts.length;a>=r;r++)o.length&&t.push(o.shift()),t.push(s[i.parts[r]]);return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};d.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+d.headTemplate+"<tbody></tbody>"+d.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+d.headTemplate+d.contTemplate+d.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+d.headTemplate+d.contTemplate+d.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=d,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=o,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var i=e(this);i.data("datepicker")||(t.preventDefault(),r.call(i,"show"))}),e(function(){r.call(e('[data-provide="datepicker-inline"]'))})}(window.jQuery),function(e){"use strict";e.fn.bdatepicker=e.fn.datepicker.noConflict(),e.fn.datepicker||(e.fn.datepicker=e.fn.bdatepicker);var t=function(e){this.init("date",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{initPicker:function(t,i){this.options.viewformat||(this.options.viewformat=this.options.format),t.datepicker=e.fn.editable2utils.tryParseJson(t.datepicker,!0),this.options.datepicker=e.extend({},i.datepicker,t.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||"en",this.dpg=e.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable2-clear">').append(this.$clear)))},value2html:function(e,i){var n=e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"";t.superclass.value2html.call(this,n,i)},html2value:function(e){return this.parseDate(e,this.parsedViewFormat)},value2str:function(e){return e?this.dpg.formatDate(e,this.parsedFormat,this.options.datepicker.language):""},str2value:function(e){return this.parseDate(e,this.parsedFormat)},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.bdatepicker("update",e)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".day",function(t){if(!e(t.currentTarget).is(".old")&&!e(t.currentTarget).is(".new")){var i=e(this).closest("form");setTimeout(function(){i.submit()},200)}})},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datepicker.language),"string"==typeof e&&(e!==this.dpg.formatDate(i,t,this.options.datepicker.language)&&(i=null))),i}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<div class="editable2-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:"&times; clear"}),e.fn.editable2types.date=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.date),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.bdatepicker("update")},this))},value2input:function(e){this.$input.val(e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):""),this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editable2types.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editable2types.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),e.fn.editable2types.datefield=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetime",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.abstractinput),e.extend(t.prototype,{initPicker:function(t,i){this.options.viewformat||(this.options.viewformat=this.options.format),t.datetimepicker=e.fn.editable2utils.tryParseJson(t.datetimepicker,!0),this.options.datetimepicker=e.extend({},i.datetimepicker,t.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||"en",this.dpg=e.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on("changeMode",function(){var t=e(this).closest("form").parent();setTimeout(function(){t.triggerHandler("resize")},0)}),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable2-clear">').append(this.$clear)))},value2html:function(e,i){var n=e?this.dpg.formatDate(this.toUTC(e),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";return i?void t.superclass.value2html.call(this,n,i):n},html2value:function(e){var t=this.parseDate(e,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(e){return e?this.dpg.formatDate(this.toUTC(e),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(e){var t=this.parseDate(e,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){e&&this.$input.data("datetimepicker").setDate(e)},input2value:function(){var e=this.$input.data("datetimepicker");return e.date?e.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(){var t=e(this).closest("form");setTimeout(function(){t.submit()},200)})},toUTC:function(e){return e?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},fromUTC:function(e){return e?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datetimepicker.language,this.options.formatType),"string"==typeof e&&(e!==this.dpg.formatDate(i,t,this.options.datetimepicker.language,this.options.formatType)&&(i=null))),i}}),t.defaults=e.extend({},e.fn.editable2types.abstractinput.defaults,{tpl:'<div class="editable2-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"}),e.fn.editable2types.datetime=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetimefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editable2utils.inherit(t,e.fn.editable2types.datetime),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.datetimepicker("update")},this))},value2input:function(e){this.$input.val(this.value2html(e)),this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editable2types.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editable2types.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}}),e.fn.editable2types.datetimefield=t}(window.jQuery),jQuery(function(e){e.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Не",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ru)}),function(e){"function"==typeof define&&define.amd?define(["jquery","jquery.ui"],e):e(jQuery)}(function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.5.3"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,timeOnlyShowDate:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,maxTime:null,minTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,altRedirectFocus:!0,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",oneLine:!1,defaultValue:null,parse:"strict",afterInject:null},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,maxTime:null,minTime:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,opts){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(e){inlineSettings[attrName]=attrValue}}for(i in overrides={beforeShow:function(e,t){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst)},onChangeMonthYear:function(e,t,i){$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,i,tp_inst)},onClose:function(e,t){!0===tp_inst.timeDefined&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}},overrides)overrides.hasOwnProperty(i)&&(fns[i]=opts[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,opts,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:"")+(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:"")),"string"==typeof tp_inst._defaults.controlType?("slider"===tp_inst._defaults.controlType&&void 0===$.ui.slider&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;var timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];null!==tp_inst._defaults.timezoneList&&(timezoneList=tp_inst._defaults.timezoneList);var tzl=timezoneList.length,tzi=0,tzv=null;if(tzl>0&&"object"!=typeof timezoneList[0])for(;tzi<tzl;tzi++)tzv=timezoneList[tzi],timezoneList[tzi]={value:tzv,label:$.timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)};return tp_inst._defaults.timezoneList=timezoneList,tp_inst.timezone=null!==tp_inst._defaults.timezone?$.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):-1*(new Date).getTimezoneOffset(),tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec,tp_inst.ampm="",tp_inst.$input=$input,tp_inst._defaults.altField&&(tp_inst.$altInput=$(tp_inst._defaults.altField),!0===tp_inst._defaults.altRedirectFocus&&tp_inst.$altInput.css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),0!==tp_inst._defaults.minDate&&0!==tp_inst._defaults.minDateTime||(tp_inst._defaults.minDate=new Date),0!==tp_inst._defaults.maxDate&&0!==tp_inst._defaults.maxDateTime||(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=$.trim(this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val());this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker(),this._afterInject()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var i=$.datepicker._get(this.inst,"dateFormat");try{var n=parseDateTimeInternal(i,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!n.timeObj)return!1;$.extend(this,n.timeObj)}catch(t){return $.timepicker.log("Error parsing the date/time string: "+t+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+i),!1}return!0}var s=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return!!s&&($.extend(this,s),!0)},_afterInject:function(){var e=this.inst.settings;$.isFunction(e.afterInject)&&e.afterInject.call(this)},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,i=this,n="",s="",o=null,r={},a={},l=null,c=0,d=0;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){var u=" ui_tpicker_unit_hide",h='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+(t.oneLine&&"select"===t.controlType?" ui-timepicker-oneLine":"")+'"><dl><dt class="ui_tpicker_time_label"'+(t.showTime?"":u)+">"+t.timeText+'</dt><dd class="ui_tpicker_time '+(t.showTime?"":u)+'"></dd>';for(c=0,d=this.units.length;c<d;c++){if(o=null!==t["show"+(s=(n=this.units[c]).substr(0,1).toUpperCase()+n.substr(1))]?t["show"+s]:this.support[n],r[n]=parseInt(t[n+"Max"]-(t[n+"Max"]-t[n+"Min"])%t["step"+s],10),a[n]=0,h+='<dt class="ui_tpicker_'+n+"_label"+(o?"":u)+'">'+t[n+"Text"]+'</dt><dd class="ui_tpicker_'+n+(o?"":u)+'"><div class="ui_tpicker_'+n+"_slider"+(o?"":u)+'"></div>',o&&t[n+"Grid"]>0){if(h+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"===n)for(var p=t[n+"Min"];p<=r[n];p+=parseInt(t[n+"Grid"],10)){a[n]++;var f=$.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:p},t);h+='<td data-for="'+n+'">'+f+"</td>"}else for(var m=t[n+"Min"];m<=r[n];m+=parseInt(t[n+"Grid"],10))a[n]++,h+='<td data-for="'+n+'">'+(m<10?"0":"")+m+"</td>";h+="</tr></table></div>"}h+="</dd>"}var g=null!==t.showTimezone?t.showTimezone:this.support.timezone;h+='<dt class="ui_tpicker_timezone_label'+(g?"":u)+'">'+t.timezoneText+"</dt>",h+='<dd class="ui_tpicker_timezone'+(g?"":u)+'"></dd>';var v=$(h+="</dl></div>");for(!0===t.timeOnly&&(v.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),c=0,d=i.units.length;c<d;c++)o=null!==t["show"+(s=(n=i.units[c]).substr(0,1).toUpperCase()+n.substr(1))]?t["show"+s]:this.support[n],i[n+"_slider"]=i.control.create(i,v.find(".ui_tpicker_"+n+"_slider"),n,i[n],t[n+"Min"],r[n],t["step"+s]),o&&t[n+"Grid"]>0&&(l=100*a[n]*t[n+"Grid"]/(r[n]-t[n+"Min"]),v.find(".ui_tpicker_"+n+" table").css({width:l+"%",marginLeft:t.isRTL?"0":l/(-2*a[n])+"%",marginRight:t.isRTL?l/(-2*a[n])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(e){var t=$(this),s=t.html(),o=parseInt(s.replace(/[^0-9]/g),10),r=s.replace(/[^apm]/gi),a=t.data("for");"hour"===a&&(-1!==r.indexOf("p")&&o<12?o+=12:-1!==r.indexOf("a")&&12===o&&(o=0)),i.control.value(i,i[a+"_slider"],n,o),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/a[n]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=v.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val("object"==typeof e?e.value:e).text("object"==typeof e?e.label:e)})),void 0!==this.timezone&&null!==this.timezone&&""!==this.timezone)-1*new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()===this.timezone?selectLocalTimezone(i):this.timezone_select.val(this.timezone);else void 0!==this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.timezone):selectLocalTimezone(i);this.timezone_select.change(function(){i._onTimeChange(),i._onSelectHandler(),i._afterInject()});var b=e.find(".ui-datepicker-buttonpane");if(b.length?b.before(v):e.append(v),this.$timeObj=v.find(".ui_tpicker_time"),null!==this.inst){var y=this.timeDefined;this._onTimeChange(),this.timeDefined=y}if(this._defaults.addSliderAccess){var w=this._defaults.sliderAccessArgs,x=this._defaults.isRTL;w.isRTL=x,setTimeout(function(){if(0===v.find(".ui-slider-access").length){v.find(".ui-slider:visible").sliderAccess(w);var e=v.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&v.find("table:visible").each(function(){var t=$(this),i=t.outerWidth(),n=t.css(x?"marginRight":"marginLeft").toString().replace("%",""),s=i-e,o=n*s/i+"%",r={width:s,marginRight:0,marginLeft:0};r[x?"marginRight":"marginLeft"]=o,t.css(r)})}},10)}i._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(e,t){var i=this._defaults,n=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&n){var s=$.datepicker._get(e,"minDateTime"),o=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0);null!==this.hourMinOriginal&&null!==this.minuteMinOriginal&&null!==this.secondMinOriginal&&null!==this.millisecMinOriginal&&null!==this.microsecMinOriginal||(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin,this.microsecMinOriginal=i.microsecMin),e.settings.timeOnly||o.getTime()===n.getTime()?(this._defaults.hourMin=s.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=s.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=s.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=s.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=s.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&n){var r=$.datepicker._get(e,"maxDateTime"),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0);null!==this.hourMaxOriginal&&null!==this.minuteMaxOriginal&&null!==this.secondMaxOriginal&&null!==this.millisecMaxOriginal||(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax,this.microsecMaxOriginal=i.microsecMax),e.settings.timeOnly||a.getTime()===n.getTime()?(this._defaults.hourMax=r.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=r.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=r.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=r.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=r.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)}if(null!==e.settings.minTime){var l=new Date("01/01/1970 "+e.settings.minTime);this.hour<l.getHours()?(this.hour=this._defaults.hourMin=l.getHours(),this.minute=this._defaults.minuteMin=l.getMinutes()):this.hour===l.getHours()&&this.minute<l.getMinutes()?this.minute=this._defaults.minuteMin=l.getMinutes():this._defaults.hourMin<l.getHours()?(this._defaults.hourMin=l.getHours(),this._defaults.minuteMin=l.getMinutes()):this._defaults.hourMin===l.getHours()===this.hour&&this._defaults.minuteMin<l.getMinutes()?this._defaults.minuteMin=l.getMinutes():this._defaults.minuteMin=0}if(null!==e.settings.maxTime){var c=new Date("01/01/1970 "+e.settings.maxTime);this.hour>c.getHours()?(this.hour=this._defaults.hourMax=c.getHours(),this.minute=this._defaults.minuteMax=c.getMinutes()):this.hour===c.getHours()&&this.minute>c.getMinutes()?this.minute=this._defaults.minuteMax=c.getMinutes():this._defaults.hourMax>c.getHours()?(this._defaults.hourMax=c.getHours(),this._defaults.minuteMax=c.getMinutes()):this._defaults.hourMax===c.getHours()===this.hour&&this._defaults.minuteMax>c.getMinutes()?this._defaults.minuteMax=c.getMinutes():this._defaults.minuteMax=59}if(void 0!==t&&!0===t){var d=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),u=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),h=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),p=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),f=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:d,step:this._defaults.stepHour}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:u,step:this._defaults.stepMinute}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:h,step:this._defaults.stepSecond}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:p,step:this._defaults.stepMillisec}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec)),this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:f,step:this._defaults.stepMicrosec}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}}},_onTimeChange:function(){if(this._defaults.showTimepicker){var e=!!this.hour_slider&&this.control.value(this,this.hour_slider,"hour"),t=!!this.minute_slider&&this.control.value(this,this.minute_slider,"minute"),i=!!this.second_slider&&this.control.value(this,this.second_slider,"second"),n=!!this.millisec_slider&&this.control.value(this,this.millisec_slider,"millisec"),s=!!this.microsec_slider&&this.control.value(this,this.microsec_slider,"microsec"),o=!!this.timezone_select&&this.timezone_select.val(),r=this._defaults,a=r.pickerTimeFormat||r.timeFormat,l=r.pickerTimeSuffix||r.timeSuffix;"object"==typeof e&&(e=!1),"object"==typeof t&&(t=!1),"object"==typeof i&&(i=!1),"object"==typeof n&&(n=!1),"object"==typeof s&&(s=!1),"object"==typeof o&&(o=!1),!1!==e&&(e=parseInt(e,10)),!1!==t&&(t=parseInt(t,10)),!1!==i&&(i=parseInt(i,10)),!1!==n&&(n=parseInt(n,10)),!1!==s&&(s=parseInt(s,10)),!1!==o&&(o=o.toString());var c=r[e<12?"amNames":"pmNames"][0],d=e!==parseInt(this.hour,10)||t!==parseInt(this.minute,10)||i!==parseInt(this.second,10)||n!==parseInt(this.millisec,10)||s!==parseInt(this.microsec,10)||this.ampm.length>0&&e<12!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null!==this.timezone&&o!==this.timezone.toString();d&&(!1!==e&&(this.hour=e),!1!==t&&(this.minute=t),!1!==i&&(this.second=i),!1!==n&&(this.millisec=n),!1!==s&&(this.microsec=s),!1!==o&&(this.timezone=o),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),this.support.ampm&&(this.ampm=c),this.formattedTime=$.datepicker.formatTime(r.timeFormat,this,r),this.$timeObj&&(a===r.timeFormat?this.$timeObj.text(this.formattedTime+l):this.$timeObj.text($.datepicker.formatTime(a,this,r)+l)),this.timeDefined=!0,d&&this._updateDateTime()}},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){var t=(e=this.inst||e).currentYear>0?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(e.selectedYear,e.selectedMonth,e.selectedDay),i=$.datepicker._daylightSavingAdjust(t),n=$.datepicker._get(e,"dateFormat"),s=$.datepicker._getFormatConfig(e),o=null!==i&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(n,null===i?new Date:i,s);var r=this.formattedDate;if(""===e.lastVal&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),!0===this._defaults.timeOnly&&!1===this._defaults.timeOnlyShowDate?r=this.formattedTime:(!0!==this._defaults.timeOnly&&(this._defaults.alwaysSetTime||o)||!0===this._defaults.timeOnly&&!0===this._defaults.timeOnlyShowDate)&&(r+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=r,this._defaults.showTimepicker)if(this.$altInput&&!1===this._defaults.timeOnly&&!0===this._defaults.altFieldTimeOnly)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(r);var a="",l=null!==this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,c=null!==this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(a=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===i?new Date:i,s):this.formattedDate)&&(a+=l),null!==this._defaults.altTimeFormat?a+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+c:a+=this.formattedTime+c,this.$altInput.val(a)}else this.$input.val(r);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!==e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(e){$.timepicker.log(e)}}},_controls:{slider:{create:function(e,t,i,n,s,o,r){var a=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:a?-1*n:n,min:a?-1*o:s,max:a?-1*s:o,step:r,slide:function(t,n){e.control.value(e,$(this),i,a?-1*n.value:n.value),e._onTimeChange()},stop:function(t,i){e._onSelectHandler()}})},options:function(e,t,i,n,s){if(e._defaults.isRTL){if("string"==typeof n)return"min"===n||"max"===n?void 0!==s?t.slider(n,-1*s):Math.abs(t.slider(n)):t.slider(n);var o=n.min,r=n.max;return n.min=n.max=null,void 0!==o&&(n.max=-1*o),void 0!==r&&(n.min=-1*r),t.slider(n)}return"string"==typeof n&&void 0!==s?t.slider(n,s):t.slider(n)},value:function(e,t,i,n){return e._defaults.isRTL?void 0!==n?t.slider("value",-1*n):Math.abs(t.slider("value")):void 0!==n?t.slider("value",n):t.slider("value")}},select:{create:function(e,t,i,n,s,o,r){for(var a='<select class="ui-timepicker-select ui-state-default ui-corner-all" data-unit="'+i+'" data-min="'+s+'" data-max="'+o+'" data-step="'+r+'">',l=e._defaults.pickerTimeFormat||e._defaults.timeFormat,c=s;c<=o;c+=r)a+='<option value="'+c+'"'+(c===n?" selected":"")+">",a+="hour"===i?$.datepicker.formatTime($.trim(l.replace(/[^ht ]/gi,"")),{hour:c},e._defaults):"millisec"===i||"microsec"===i||c>=10?c:"0"+c.toString(),a+="</option>";return a+="</select>",t.children("select").remove(),$(a).appendTo(t).change(function(t){e._onTimeChange(),e._onSelectHandler(),e._afterInject()}),t},options:function(e,t,i,n,s){var o={},r=t.children("select");if("string"==typeof n){if(void 0===s)return r.data(n);o[n]=s}else o=n;return e.control.create(e,t,r.data("unit"),r.val(),o.min>=0?o.min:r.data("min"),o.max||r.data("max"),o.step||r.data("step"))},value:function(e,t,i,n){var s=t.children("select");return void 0!==n?s.val(n):s.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"==typeof e&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){var t=arguments;return"string"==typeof(e=e||{})?"getDate"===e||"option"===e&&2===t.length&&"string"==typeof t[1]?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,i,n,s){var o=parseDateTimeInternal(e,t,i,n,s);if(o.timeObj){var r=o.timeObj;o.date.setHours(r.hour,r.minute,r.second,r.millisec),o.date.setMicroseconds(r.microsec)}return o.date},$.datepicker.parseTime=function(e,t,i){var n=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),s=(e.replace(/\'.*?\'/g,"").indexOf("Z"),function(e,t,i){var n,s="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(e){var t,n,s,o=e.length;switch(e.charAt(0).toLowerCase()){case"h":case"m":case"s":return 1===o?"(\\d?\\d)":"(\\d{"+o+"})";case"l":case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return t=i.amNames,n=i.pmNames,s=[],t&&$.merge(s,t),n&&$.merge(s,n),"("+(s=$.map(s,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")})).join("|")+")?";default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}}).replace(/\s/g,"\\s?")+i.timeSuffix+"$",o=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),i={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(t)for(var n=0;n<t.length;n++)-1===i[t[n].toString().charAt(0)]&&(i[t[n].toString().charAt(0)]=n+1);return i}(e),r="",a={hour:0,minute:0,second:0,millisec:0,microsec:0};return!!(n=t.match(new RegExp(s,"i")))&&(-1!==o.t&&(void 0===n[o.t]||0===n[o.t].length?(r="",a.ampm=""):(r=-1!==$.inArray(n[o.t].toUpperCase(),$.map(i.amNames,function(e,t){return e.toUpperCase()}))?"AM":"PM",a.ampm=i["AM"===r?"amNames":"pmNames"][0])),-1!==o.h&&("AM"===r&&"12"===n[o.h]?a.hour=0:"PM"===r&&"12"!==n[o.h]?a.hour=parseInt(n[o.h],10)+12:a.hour=Number(n[o.h])),-1!==o.m&&(a.minute=Number(n[o.m])),-1!==o.s&&(a.second=Number(n[o.s])),-1!==o.l&&(a.millisec=Number(n[o.l])),-1!==o.c&&(a.microsec=Number(n[o.c])),-1!==o.z&&void 0!==n[o.z]&&(a.timezone=$.timepicker.timezoneOffsetNumber(n[o.z])),a)});return"function"==typeof n.parse?n.parse(e,t,n):"loose"===n.parse?function(e,t,i){try{var n=new Date("2012-01-01 "+t);if(isNaN(n.getTime())&&(n=new Date("2012-01-01T"+t),isNaN(n.getTime())&&(n=new Date("01/01/2012 "+t),isNaN(n.getTime()))))throw"Unable to parse time with native Date: "+t;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisec:n.getMilliseconds(),microsec:n.getMicroseconds(),timezone:-1*n.getTimezoneOffset()}}catch(n){try{return s(e,t,i)}catch(i){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1}(e,t,n):s(e,t,n)},$.datepicker.formatTime=function(e,t,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},t);var n=e,s=i.amNames[0],o=parseInt(t.hour,10);return o>11&&(s=i.pmNames[0]),n=n.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(e){switch(e){case"HH":return("0"+o).slice(-2);case"H":return o;case"hh":return("0"+convert24to12(o)).slice(-2);case"h":return convert24to12(o);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"c":return("00"+t.microsec).slice(-3);case"z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!1);case"Z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!0);case"T":return s.charAt(0).toUpperCase();case"TT":return s.toUpperCase();case"t":return s.charAt(0).toLowerCase();case"tt":return s.toLowerCase();default:return e.replace(/'/g,"")}})},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var i,n=this._getInst($(e)[0]),s=this._get(n,"timepicker");s&&n.settings.showTimepicker?(s._limitMinMaxDateTime(n,!0),i=n.inline,n.inline=n.stay_open=!0,this._base_selectDate(e,t),n.inline=i,n.stay_open=!1,this._notifyChange(n),this._updateDatepicker(n)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!==e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!==t||"boolean"==typeof e.stay_open&&!1!==e.stay_open)){this._base_updateDatepicker(e);var i=this._get(e,"timepicker");i&&i._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&$.datepicker._get(t,"constrainInput")){var n=i.support.ampm,s=null!==i._defaults.showTimezone?i._defaults.showTimezone:i.support.timezone,o=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,n?"APM":"").replace(/Tt/g,n?"AaPpMm":"").replace(/tT/g,n?"AaPpMm":"").replace(/T/g,n?"AP":"").replace(/tt/g,n?"apm":"").replace(/t/g,n?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(s?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+o,a=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||a<" "||!o||r.indexOf(a)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var i=t._defaults.altField;if(i){t._defaults.altFormat||t._defaults.dateFormat;var n=this._getDate(e),s=$.datepicker._getFormatConfig(e),o="",r=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,a=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,l=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;o+=$.datepicker.formatTime(l,t,t._defaults)+a,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||null===n||(o=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,n,s)+r+o:t.formattedDate+r+o),$(i).val(e.input.val()?o:"")}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!==t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(e){$.timepicker.log(e)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=(t.dpDiv,this._get(t,"timepicker"));selectLocalTimezone(i);var n=new Date;this._setTime(t,n),this._setDate(t,n),this._base_gotoToday(e)},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(t.settings.showTimepicker=!1,i._defaults.showTimepicker=!1,i._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(t.settings.showTimepicker=!0,i._defaults.showTimepicker=!0,i._addTimePicker(t),i._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var i=this._get(e,"timepicker");if(i){var n=i._defaults;i.hour=t?t.getHours():n.hour,i.minute=t?t.getMinutes():n.minute,i.second=t?t.getSeconds():n.second,i.millisec=t?t.getMilliseconds():n.millisec,i.microsec=t?t.getMicroseconds():n.microsec,i._limitMinMaxDateTime(e,!0),i._onTimeChange(),i._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,i){var n=this._getInst(e);if(n){var s,o=this._get(n,"timepicker");if(o)this._setDateFromField(n),t&&("string"==typeof t?(o._parseTime(t,i),(s=new Date).setHours(o.hour,o.minute,o.second,o.millisec),s.setMicroseconds(o.microsec)):(s=new Date(t.getTime())).setMicroseconds(t.getMicroseconds()),"Invalid Date"===s.toString()&&(s=void 0),this._setTime(n,s))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var i=this._getInst(e),n=t;if(i){"string"==typeof t&&((n=new Date(t)).getTime()||(this._base_setDateDatepicker.apply(this,arguments),n=$(e).datepicker("getDate")));var s,o=this._get(i,"timepicker");n instanceof Date?(s=new Date(n.getTime())).setMicroseconds(n.getMicroseconds()):s=n,o&&s&&(o.support.timezone||null!==o._defaults.timezone||(o.timezone=-1*s.getTimezoneOffset()),n=$.timepicker.timezoneAdjust(n,o.timezone),s=$.timepicker.timezoneAdjust(s,o.timezone)),this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,s,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var n=this._get(i,"timepicker");if(n){void 0===i.lastVal&&this._setDateFromField(i,t);var s=this._getDate(i),o=$.trim(n.$altInput&&n._defaults.altFieldTimeOnly?n.$input.val()+" "+n.$altInput.val():n.$input.val());return s&&n._parseTime(o,!i.settings.timeOnly)&&(s.setHours(n.hour,n.minute,n.second,n.millisec),s.setMicroseconds(n.microsec),null!=n.timezone&&(n.support.timezone||null!==n._defaults.timezone||(n.timezone=-1*s.getTimezoneOffset()),s=$.timepicker.timezoneAdjust(s,n.timezone))),s}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){var n;try{n=this._base_parseDate(e,t,i)}catch(s){if(!(s.indexOf(":")>=0))throw s;n=this._base_parseDate(e,t.substring(0,t.length-(s.length-s.indexOf(":")-2)),i),$.timepicker.log("Error parsing the date string: "+s+"\ndate string = "+t+"\ndate format = "+e)}return n},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,i,n){var s=this._get(e,"timepicker");return s?(s._updateDateTime(e),s.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,i){var n,s=this._getInst(e);if(!s)return null;var o=this._get(s,"timepicker");if(o){var r,a,l,c,d=null,u=null,h=null,p=o._defaults.evnts,f={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)d=i;else if("maxDate"===t||"maxDateTime"===t)u=i;else if("onSelect"===t)h=i;else if(p.hasOwnProperty(t)){if(void 0===i)return p[t];f[t]=i,n={}}}else if("object"==typeof t)for(r in t.minDate?d=t.minDate:t.minDateTime?d=t.minDateTime:t.maxDate?u=t.maxDate:t.maxDateTime&&(u=t.maxDateTime),p)p.hasOwnProperty(r)&&t[r]&&(f[r]=t[r]);for(r in f)f.hasOwnProperty(r)&&(p[r]=f[r],n||(n=$.extend({},t)),delete n[r]);if(n&&isEmptyObject(n))return;if(d?(d=0===d?new Date:new Date(d),o._defaults.minDate=d,o._defaults.minDateTime=d):u?(u=0===u?new Date:new Date(u),o._defaults.maxDate=u,o._defaults.maxDateTime=u):h&&(o._defaults.onSelect=h),d||u)return l=(c=$(e)).datetimepicker("getDate"),a=this._base_optionDatepicker.call($.datepicker,e,n||t,i),c.datetimepicker("setDate",l),a}return void 0===i?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,n||t,i)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},extendRemove=function(e,t){for(var i in $.extend(e,t),t)null!==t[i]&&void 0!==t[i]||(e[i]=t[i]);return e},detectSupport=function(e){var t=e.replace(/'.*?'/g,"").toLowerCase(),i=function(e,t){return-1!==e.indexOf(t)};return{hour:i(t,"h"),minute:i(t,"m"),second:i(t,"s"),millisec:i(t,"l"),microsec:i(t,"c"),timezone:i(t,"z"),ampm:i(t,"t")&&i(e,"h"),iso8601:i(e,"Z")}},convert24to12=function(e){return 0===(e%=12)&&(e=12),String(e)},computeEffectiveSetting=function(e,t){return e&&e[t]?e[t]:$.timepicker._defaults[t]},splitDateTime=function(e,t){var i=computeEffectiveSetting(t,"separator"),n=computeEffectiveSetting(t,"timeFormat").split(i).length,s=e.split(i),o=s.length;return o>1?{dateString:s.splice(0,o-n).join(i),timeString:s.splice(0,n).join(i)}:{dateString:e,timeString:""}},parseDateTimeInternal=function(e,t,i,n,s){var o,r,a;if(r=splitDateTime(i,s),o=$.datepicker._base_parseDate(e,r.dateString,n),""===r.timeString)return{date:o};if(!(a=$.datepicker.parseTime(t,r.timeString,s)))throw"Wrong time format";return{date:o,timeObj:a}},selectLocalTimezone=function(e,t){if(e&&e.timezone_select){var i=t||new Date;e.timezone_select.val(-i.getTimezoneOffset())}};$.timepicker=new Timepicker,$.timepicker.timezoneOffsetString=function(e,t){if(isNaN(e)||e>840||e<-720)return e;var i=e%60,n=(e-i)/60,s=t?":":"",o=(e>=0?"+":"-")+("0"+Math.abs(n)).slice(-2)+s+("0"+Math.abs(i)).slice(-2);return"+00:00"===o?"Z":o},$.timepicker.timezoneOffsetNumber=function(e){var t=e.toString().replace(":","");return"Z"===t.toUpperCase()?0:/^(\-|\+)\d{4}$/.test(t)?("-"===t.substr(0,1)?-1:1)*(60*parseInt(t.substr(1,2),10)+parseInt(t.substr(3,2),10)):e},$.timepicker.timezoneAdjust=function(e,t){var i=$.timepicker.timezoneOffsetNumber(t);return isNaN(i)||e.setMinutes(e.getMinutes()+-e.getTimezoneOffset()-i),e},$.timepicker.timeRange=function(e,t,i){return $.timepicker.handleRange("timepicker",e,t,i)},$.timepicker.datetimeRange=function(e,t,i){$.timepicker.handleRange("datetimepicker",e,t,i)},$.timepicker.dateRange=function(e,t,i){$.timepicker.handleRange("datepicker",e,t,i)},$.timepicker.handleRange=function(e,t,i,n){n=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},n);var s=!1;function o(s,o){var r=t[e]("getDate"),a=i[e]("getDate"),l=s[e]("getDate");if(null!==r){var c=new Date(r.getTime()),d=new Date(r.getTime());c.setMilliseconds(c.getMilliseconds()+n.minInterval),d.setMilliseconds(d.getMilliseconds()+n.maxInterval),n.minInterval>0&&c>a?i[e]("setDate",c):n.maxInterval>0&&d<a?i[e]("setDate",d):r>a&&o[e]("setDate",l)}}function r(t,i,s){if(t.val()){var o=t[e].call(t,"getDate");null!==o&&n.minInterval>0&&("minDate"===s&&o.setMilliseconds(o.getMilliseconds()+n.minInterval),"maxDate"===s&&o.setMilliseconds(o.getMilliseconds()-n.minInterval)),o.getTime&&i[e].call(i,"option",s,o)}}return"timepicker"===e&&(s=!0,e="datetimepicker"),$.fn[e].call(t,$.extend({timeOnly:s,onClose:function(e,t){o($(this),i)},onSelect:function(e){r($(this),i,"minDate")}},n,n.start)),$.fn[e].call(i,$.extend({timeOnly:s,onClose:function(e,i){o($(this),t)},onSelect:function(e){r($(this),t,"maxDate")}},n,n.end)),o(t,i),r(t,i,"minDate"),r(i,t,"maxDate"),$([t.get(0),i.get(0)])},$.timepicker.log=function(){window.console&&window.console.log.apply(window.console,Array.prototype.slice.call(arguments))},$.timepicker._util={_extendRemove:extendRemove,_isEmptyObject:isEmptyObject,_convert24to12:convert24to12,_detectSupport:detectSupport,_selectLocalTimezone:selectLocalTimezone,_computeEffectiveSetting:computeEffectiveSetting,_splitDateTime:splitDateTime,_parseDateTimeInternal:parseDateTimeInternal},Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+Math.floor(e/1e3)),this.microseconds=e%1e3,this}),$.timepicker.version="1.5.3"}}),function(e){e.timepicker.regional.af={timeOnlyTitle:"Kies Tyd",timeText:"Tyd ",hourText:"Ure ",minuteText:"Minute",secondText:"Sekondes",millisecText:"Millisekondes",microsecText:"Mikrosekondes",timezoneText:"Tydsone",currentText:"Huidige Tyd",closeText:"Klaar",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.am={timeOnlyTitle:"Ընտրեք ժամանակը",timeText:"Ժամանակը",hourText:"Ժամ",minuteText:"Րոպե",secondText:"Վարկյան",millisecText:"Միլիվարկյան",microsecText:"Միկրովարկյան",timezoneText:"Ժամային գոտին",currentText:"Այժմ",closeText:"Փակել",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.bg={timeOnlyTitle:"Изберете време",timeText:"Време",hourText:"Час",minuteText:"Минути",secondText:"Секунди",millisecText:"Милисекунди",microsecText:"Микросекунди",timezoneText:"Часови пояс",currentText:"Сега",closeText:"Затвори",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.ca={timeOnlyTitle:"Escollir una hora",timeText:"Hora",hourText:"Hores",minuteText:"Minuts",secondText:"Segons",millisecText:"Milisegons",microsecText:"Microsegons",timezoneText:"Fus horari",currentText:"Ara",closeText:"Tancar",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.cs={timeOnlyTitle:"Vyberte čas",timeText:"Čas",hourText:"Hodiny",minuteText:"Minuty",secondText:"Vteřiny",millisecText:"Milisekundy",microsecText:"Mikrosekundy",timezoneText:"Časové pásmo",currentText:"Nyní",closeText:"Zavřít",timeFormat:"HH:mm",timeSuffix:"",amNames:["dop.","AM","A"],pmNames:["odp.","PM","P"],isRTL:!1},e.timepicker.regional.da={timeOnlyTitle:"Vælg tid",timeText:"Tid",hourText:"Time",minuteText:"Minut",secondText:"Sekund",millisecText:"Millisekund",microsecText:"Mikrosekund",timezoneText:"Tidszone",currentText:"Nu",closeText:"Luk",timeFormat:"HH:mm",timeSuffix:"",amNames:["am","AM","A"],pmNames:["pm","PM","P"],isRTL:!1},e.timepicker.regional.de={timeOnlyTitle:"Zeit wählen",timeText:"Zeit",hourText:"Stunde",minuteText:"Minute",secondText:"Sekunde",millisecText:"Millisekunde",microsecText:"Mikrosekunde",timezoneText:"Zeitzone",currentText:"Jetzt",closeText:"Fertig",timeFormat:"HH:mm",timeSuffix:"",amNames:["vorm.","AM","A"],pmNames:["nachm.","PM","P"],isRTL:!1},e.timepicker.regional.el={timeOnlyTitle:"Επιλογή ώρας",timeText:"Ώρα",hourText:"Ώρες",minuteText:"Λεπτά",secondText:"Δευτερόλεπτα",millisecText:"μιλιδευτερόλεπτο",microsecText:"Microseconds",timezoneText:"Ζώνη ώρας",currentText:"Τώρα",closeText:"Κλείσιμο",timeFormat:"HH:mm",timeSuffix:"",amNames:["π.μ.","AM","A"],pmNames:["μ.μ.","PM","P"],isRTL:!1},e.timepicker.regional.es={timeOnlyTitle:"Elegir una hora",timeText:"Hora",hourText:"Horas",minuteText:"Minutos",secondText:"Segundos",millisecText:"Milisegundos",microsecText:"Microsegundos",timezoneText:"Uso horario",currentText:"Hoy",closeText:"Cerrar",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.et={timeOnlyTitle:"Vali aeg",timeText:"Aeg",hourText:"Tund",minuteText:"Minut",secondText:"Sekund",millisecText:"Millisekundis",microsecText:"Mikrosekundis",timezoneText:"Ajavöönd",currentText:"Praegu",closeText:"Valmis",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.eu={timeOnlyTitle:"Aukeratu ordua",timeText:"Ordua",hourText:"Orduak",minuteText:"Minutuak",secondText:"Segundoak",millisecText:"Milisegundoak",microsecText:"Mikrosegundoak",timezoneText:"Ordu-eremua",currentText:"Orain",closeText:"Itxi",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.fi={timeOnlyTitle:"Valitse aika",timeText:"Aika",hourText:"Tunti",minuteText:"Minuutti",secondText:"Sekunti",millisecText:"Millisekunnin",microsecText:"Mikrosekuntia",timezoneText:"Aikavyöhyke",currentText:"Nyt",closeText:"Sulje",timeFormat:"HH:mm",timeSuffix:"",amNames:["ap.","AM","A"],pmNames:["ip.","PM","P"],isRTL:!1},e.timepicker.regional.fr={timeOnlyTitle:"Choisir une heure",timeText:"Heure",hourText:"Heures",minuteText:"Minutes",secondText:"Secondes",millisecText:"Millisecondes",microsecText:"Microsecondes",timezoneText:"Fuseau horaire",currentText:"Maintenant",closeText:"Terminé",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.gl={timeOnlyTitle:"Elixir unha hora",timeText:"Hora",hourText:"Horas",minuteText:"Minutos",secondText:"Segundos",millisecText:"Milisegundos",microsecText:"Microssegundos",timezoneText:"Fuso horario",currentText:"Agora",closeText:"Pechar",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.he={timeOnlyTitle:"בחירת זמן",timeText:"שעה",hourText:"שעות",minuteText:"דקות",secondText:"שניות",millisecText:"אלפית השנייה",microsecText:"מיקרו",timezoneText:"אזור זמן",currentText:"עכשיו",closeText:"סגור",timeFormat:"HH:mm",timeSuffix:"",amNames:['לפנה"צ',"AM","A"],pmNames:['אחה"צ',"PM","P"],isRTL:!0},e.timepicker.regional.hr={timeOnlyTitle:"Odaberi vrijeme",timeText:"Vrijeme",hourText:"Sati",minuteText:"Minute",secondText:"Sekunde",millisecText:"Milisekunde",microsecText:"Mikrosekunde",timezoneText:"Vremenska zona",currentText:"Sada",closeText:"Gotovo",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.hu={timeOnlyTitle:"Válasszon időpontot",timeText:"Idő",hourText:"Óra",minuteText:"Perc",secondText:"Másodperc",millisecText:"Milliszekundumos",microsecText:"Ezredmásodperc",timezoneText:"Időzóna",currentText:"Most",closeText:"Kész",timeFormat:"HH:mm",timeSuffix:"",amNames:["de.","AM","A"],pmNames:["du.","PM","P"],isRTL:!1},e.timepicker.regional.id={timeOnlyTitle:"Pilih Waktu",timeText:"Waktu",hourText:"Pukul",minuteText:"Menit",secondText:"Detik",millisecText:"Milidetik",microsecText:"Mikrodetik",timezoneText:"Zona Waktu",currentText:"Sekarang",closeText:"OK",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.it={timeOnlyTitle:"Scegli orario",timeText:"Orario",hourText:"Ora",minuteText:"Minuti",secondText:"Secondi",millisecText:"Millisecondi",microsecText:"Microsecondi",timezoneText:"Fuso orario",currentText:"Adesso",closeText:"Chiudi",timeFormat:"HH:mm",timeSuffix:"",amNames:["m.","AM","A"],pmNames:["p.","PM","P"],isRTL:!1},e.timepicker.regional.ja={timeOnlyTitle:"時間を選択",timeText:"時間",hourText:"時",minuteText:"分",secondText:"秒",millisecText:"ミリ秒",microsecText:"マイクロ秒",timezoneText:"タイムゾーン",currentText:"現時刻",closeText:"閉じる",timeFormat:"HH:mm",timeSuffix:"",amNames:["午前","AM","A"],pmNames:["午後","PM","P"],isRTL:!1},e.timepicker.regional.ko={timeOnlyTitle:"시간 선택",timeText:"시간",hourText:"시",minuteText:"분",secondText:"초",millisecText:"밀리초",microsecText:"마이크로",timezoneText:"표준 시간대",currentText:"현재 시각",closeText:"닫기",timeFormat:"tt h:mm",timeSuffix:"",amNames:["오전","AM","A"],pmNames:["오후","PM","P"],isRTL:!1},e.timepicker.regional.lt={timeOnlyTitle:"Pasirinkite laiką",timeText:"Laikas",hourText:"Valandos",minuteText:"Minutės",secondText:"Sekundės",millisecText:"Milisekundės",microsecText:"Mikrosekundės",timezoneText:"Laiko zona",currentText:"Dabar",closeText:"Uždaryti",timeFormat:"HH:mm",timeSuffix:"",amNames:["priešpiet","AM","A"],pmNames:["popiet","PM","P"],isRTL:!1},e.timepicker.regional.lv={timeOnlyTitle:"Ievadiet laiku",timeText:"Laiks",hourText:"Stundas",minuteText:"Minūtes",secondText:"Sekundes",millisecText:"Milisekundes",microsecText:"Mikrosekundes",timezoneText:"Laika josla",currentText:"Tagad",closeText:"Aizvērt",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","AM","A"],pmNames:["PM","PM","P"],isRTL:!1},e.timepicker.regional.nl={timeOnlyTitle:"Tijdstip",timeText:"Tijd",hourText:"Uur",minuteText:"Minuut",secondText:"Seconde",millisecText:"Milliseconde",microsecText:"Microseconde",timezoneText:"Tijdzone",currentText:"Vandaag",closeText:"Sluiten",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.no={timeOnlyTitle:"Velg tid",timeText:"Tid",hourText:"Time",minuteText:"Minutt",secondText:"Sekund",millisecText:"Millisekund",microsecText:"mikrosekund",timezoneText:"Tidssone",currentText:"Nå",closeText:"Lukk",timeFormat:"HH:mm",timeSuffix:"",amNames:["am","AM","A"],pmNames:["pm","PM","P"],isRTL:!1},e.timepicker.regional.pl={timeOnlyTitle:"Wybierz godzinę",timeText:"Czas",hourText:"Godzina",minuteText:"Minuta",secondText:"Sekunda",millisecText:"Milisekunda",microsecText:"Mikrosekunda",timezoneText:"Strefa czasowa",currentText:"Teraz",closeText:"Gotowe",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional["pt-BR"]={timeOnlyTitle:"Escolha o horário",timeText:"Horário",hourText:"Hora",minuteText:"Minutos",secondText:"Segundos",millisecText:"Milissegundos",microsecText:"Microssegundos",timezoneText:"Fuso horário",currentText:"Agora",closeText:"Fechar",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.pt={timeOnlyTitle:"Escolha uma hora",timeText:"Hora",hourText:"Horas",minuteText:"Minutos",secondText:"Segundos",millisecText:"Milissegundos",microsecText:"Microssegundos",timezoneText:"Fuso horário",currentText:"Agora",closeText:"Fechar",timeFormat:"HH:mm",timeSuffix:"",amNames:["a.m.","AM","A"],pmNames:["p.m.","PM","P"],isRTL:!1},e.timepicker.regional.ro={timeOnlyTitle:"Alegeţi o oră",timeText:"Timp",hourText:"Ore",minuteText:"Minute",secondText:"Secunde",millisecText:"Milisecunde",microsecText:"Microsecunde",timezoneText:"Fus orar",currentText:"Acum",closeText:"Închide",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.ru={timeOnlyTitle:"Выберите время",timeText:"Время",hourText:"Часы",minuteText:"Минуты",secondText:"Секунды",millisecText:"Миллисекунды",microsecText:"Микросекунды",timezoneText:"Часовой пояс",currentText:"Сейчас",closeText:"Закрыть",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.sk={timeOnlyTitle:"Zvoľte čas",timeText:"Čas",hourText:"Hodiny",minuteText:"Minúty",secondText:"Sekundy",millisecText:"Milisekundy",microsecText:"Mikrosekundy",timezoneText:"Časové pásmo",currentText:"Teraz",closeText:"Zavrieť",timeFormat:"H:m",timeSuffix:"",amNames:["dop.","AM","A"],pmNames:["pop.","PM","P"],isRTL:!1},e.timepicker.regional.sl={timeOnlyTitle:"Izberite čas",timeText:"Čas",hourText:"Ura",minuteText:"Minute",secondText:"Sekunde",millisecText:"Milisekunde",microsecText:"Mikrosekunde",timezoneText:"Časovni pas",currentText:"Sedaj",closeText:"Zapri",timeFormat:"HH:mm",timeSuffix:"",amNames:["dop.","AM","A"],pmNames:["pop.","PM","P"],isRTL:!1},e.timepicker.regional["sr-RS"]={timeOnlyTitle:"Одаберите време",timeText:"Време",hourText:"Сати",minuteText:"Минути",secondText:"Секунде",millisecText:"Милисекунде",microsecText:"Микросекунде",timezoneText:"Временска зона",currentText:"Сада",closeText:"Затвори",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional["sr-YU"]={timeOnlyTitle:"Odaberite vreme",timeText:"Vreme",hourText:"Sati",minuteText:"Minuti",secondText:"Sekunde",millisecText:"Milisekunde",microsecText:"Mikrosekunde",timezoneText:"Vremenska zona",currentText:"Sada",closeText:"Zatvori",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.sv={timeOnlyTitle:"Välj en tid",timeText:"Tid",hourText:"Timme",minuteText:"Minut",secondText:"Sekund",millisecText:"Millisekund",microsecText:"Mikrosekund",timezoneText:"Tidszon",currentText:"Nu",closeText:"Stäng",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.th={timeOnlyTitle:"เลือกเวลา",timeText:"เวลา ",hourText:"ชั่วโมง ",minuteText:"นาที",secondText:"วินาที",millisecText:"มิลลิวินาที",microsecText:"ไมโคริวินาที",timezoneText:"เขตเวลา",currentText:"เวลาปัจจุบัน",closeText:"ปิด",timeFormat:"hh:mm tt",timeSuffix:""},e.timepicker.regional.tr={timeOnlyTitle:"Zaman Seçiniz",timeText:"Zaman",hourText:"Saat",minuteText:"Dakika",secondText:"Saniye",millisecText:"Milisaniye",microsecText:"Mikrosaniye",timezoneText:"Zaman Dilimi",currentText:"Şu an",closeText:"Tamam",timeFormat:"HH:mm",timeSuffix:"",amNames:["ÖÖ","Ö"],pmNames:["ÖS","S"],isRTL:!1},e.timepicker.regional.uk={timeOnlyTitle:"Виберіть час",timeText:"Час",hourText:"Години",minuteText:"Хвилини",secondText:"Секунди",millisecText:"Мілісекунди",microsecText:"Мікросекунди",timezoneText:"Часовий пояс",currentText:"Зараз",closeText:"Закрити",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional.vi={timeOnlyTitle:"Chọn giờ",timeText:"Thời gian",hourText:"Giờ",minuteText:"Phút",secondText:"Giây",millisecText:"Mili giây",microsecText:"Micrô giây",timezoneText:"Múi giờ",currentText:"Hiện thời",closeText:"Đóng",timeFormat:"HH:mm",timeSuffix:"",amNames:["SA","S"],pmNames:["CH","C"],isRTL:!1},e.timepicker.regional["zh-CN"]={timeOnlyTitle:"选择时间",timeText:"时间",hourText:"小时",minuteText:"分钟",secondText:"秒钟",millisecText:"毫秒",microsecText:"微秒",timezoneText:"时区",currentText:"现在时间",closeText:"关闭",timeFormat:"HH:mm",timeSuffix:"",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},e.timepicker.regional["zh-TW"]={timeOnlyTitle:"選擇時分秒",timeText:"時間",hourText:"時",minuteText:"分",secondText:"秒",millisecText:"毫秒",microsecText:"微秒",timezoneText:"時區",currentText:"現在時間",closeText:"確定",timeFormat:"HH:mm",timeSuffix:"",amNames:["上午","AM","A"],pmNames:["下午","PM","P"],isRTL:!1}}(jQuery),function(e){e.fn.extend({sliderAccess:function(t){return(t=t||{}).touchonly=void 0===t.touchonly||t.touchonly,!0!==t.touchonly||"ontouchend"in document?e(this).each(function(i,n){var s=e(this),o=e.extend({},{where:"after",step:s.slider("option","step"),upIcon:"ui-icon-plus",downIcon:"ui-icon-minus",text:!1,upText:"+",downText:"-",buttonset:!0,buttonsetTag:"span",isRTL:!1},t),r=e("<"+o.buttonsetTag+' class="ui-slider-access"><button data-icon="'+o.downIcon+'" data-step="'+(o.isRTL?o.step:-1*o.step)+'">'+o.downText+'</button><button data-icon="'+o.upIcon+'" data-step="'+(o.isRTL?-1*o.step:o.step)+'">'+o.upText+"</button></"+o.buttonsetTag+">");r.children("button").each(function(t,i){var n=e(this);n.button({text:o.text,icons:{primary:n.data("icon")}}).click(function(e){var t=n.data("step"),i=s.slider("value"),o=i+=1*t,r=s.slider("option","min"),a=s.slider("option","max"),l=s.slider("option","slide")||function(){},c=s.slider("option","stop")||function(){};e.preventDefault(),o<r||o>a||(s.slider("value",o),l.call(s,null,{value:o}),c.call(s,null,{value:o}))})}),s[o.where](r),o.buttonset&&(r.removeClass("ui-corner-right").removeClass("ui-corner-left").buttonset(),r.eq(0).addClass("ui-corner-left"),r.eq(1).addClass("ui-corner-right"));var a=r.css({marginLeft:"after"===o.where&&!o.isRTL||"before"===o.where&&o.isRTL?10:0,marginRight:"before"===o.where&&!o.isRTL||"after"===o.where&&o.isRTL?10:0}).outerWidth(!0)+5,l=s.outerWidth(!0);s.css("display","inline-block").width(l-a)}):e(this)}})}(jQuery),$("body").on({mouseenter:function(e){var t=e.screenX,i=e.screenY,n=$("#screenshot").width(),s=$("#screenshot").height();if(t<=600){var o=70,r=s/2;xOffset=r,yOffset=o}else{o=n+70,r=s/2;xOffset=r,yOffset=-o}if(i>=700){r=s+70;xOffset=r}else if(i<=250){r=s/4-50;xOffset=r}this.t=this.title,this.title="";""!=this.t&&this.t;$("body").append("<p id='screenshot'><img src='"+this.rel+"'  /></p>"),$("#screenshot").css("top",e.pageY-xOffset+"px").css("left",e.pageX+yOffset+"px").fadeIn("slow")},mouseleave:function(){this.title=this.t,$("#screenshot").remove()}},"a.screenshot"),function(e){var t=e.scrollTo=function(t,i,n){e(window).scrollTo(t,i,n)};function i(e){return"object"==typeof e?e:{top:e,left:e}}t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1},t.window=function(t){return e(window).scrollable()},e.fn.scrollable=function(){return this.map(function(){var t=this;if(!(!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])))return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return e.browser.safari||"BackCompat"==i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(n,s,o){return"object"==typeof s&&(o=s,s=0),"function"==typeof o&&(o={onAfter:o}),"max"==n&&(n=9e9),o=e.extend({},t.defaults,o),s=s||o.speed||o.duration,o.queue=o.queue&&o.axis.length>1,o.queue&&(s/=2),o.offset=i(o.offset),o.over=i(o.over),this.scrollable().each(function(){var t,r=this,a=e(r),l=n,c={},d=a.is("html,body");switch(typeof l){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px)?$/.test(l)){l=i(l);break}l=e(l,this);case"object":(l.is||l.style)&&(t=(l=e(l)).offset())}function u(e){a.animate(c,s,o.easing,e&&function(){e.call(this,n,o)})}e.each(o.axis.split(""),function(e,i){var n="x"==i?"Left":"Top",s=n.toLowerCase(),h="scroll"+n,p=r[h],f="x"==i?"Width":"Height";t?(c[h]=t[s]+(d?0:p-a.offset()[s]),o.margin&&(c[h]-=parseInt(l.css("margin"+n))||0,c[h]-=parseInt(l.css("border"+n+"Width"))||0),c[h]+=o.offset[s]||0,o.over[s]&&(c[h]+=l[f.toLowerCase()]()*o.over[s])):c[h]=l[s],/^\d+$/.test(c[h])&&(c[h]=c[h]<=0?0:Math.min(c[h],function(e){var t="scroll"+e;if(!d)return r[t];var i="client"+e,n=r.ownerDocument.documentElement,s=r.ownerDocument.body;return Math.max(n[t],s[t])-Math.min(n[i],s[i])}(f))),!e&&o.queue&&(p!=c[h]&&u(o.onAfterFirst),delete c[h])}),u(o.onAfter)}).end()}}(jQuery),function(e){e.widget("ui.multiselect",{options:{sortable:!0,searchable:!0,doubleClickable:!0,animated:"fast",show:"slideDown",hide:"slideUp",dividerLocation:.6,availableFirst:!1,nodeComparator:function(e,t){var i=e.text(),n=t.text();return i==n?0:i<n?-1:1}},_create:function(){this.element.hide(),this.id=this.element.attr("id"),this.container=e('<div class="ui-multiselect ui-helper-clearfix ui-widget"></div>').insertAfter(this.element),this.count=0,this.selectedContainer=e('<div class="selected"></div>').appendTo(this.container),this.availableContainer=e('<div class="available"></div>')[this.options.availableFirst?"prependTo":"appendTo"](this.container),this.selectedActions=e('<div class="actions ui-widget-header ui-helper-clearfix"><span class="count">0 выбрано</span><a href="#" class="remove-all">Удалить все</a></div>').appendTo(this.selectedContainer),this.availableActions=e('<div class="actions ui-widget-header ui-helper-clearfix"><input type="text" class="search empty ui-widget-content ui-corner-all"/><a href="#" class="add-all">'+e.ui.multiselect.locale.addAll+"</a></div>").appendTo(this.availableContainer),this.selectedList=e('<ul class="selected connected-list"><li class="ui-helper-hidden-accessible"></li></ul>').bind("selectstart",function(){return!1}).appendTo(this.selectedContainer),this.availableList=e('<ul class="available connected-list"><li class="ui-helper-hidden-accessible"></li></ul>').bind("selectstart",function(){return!1}).appendTo(this.availableContainer);var t=this;this.container.width(this.element.width()+1),this.selectedContainer.width(Math.floor(this.element.width()*this.options.dividerLocation)),this.availableContainer.width(Math.floor(this.element.width()*(1-this.options.dividerLocation))),this.selectedList.height(Math.max(this.element.height()-this.selectedActions.height(),1)),this.availableList.height(Math.max(this.element.height()-this.availableActions.height(),1)),this.options.animated||(this.options.show="show",this.options.hide="hide"),this._populateLists(this.element.find("option")),this.options.sortable&&this.selectedList.sortable({placeholder:"ui-state-highlight",axis:"y",update:function(i,n){t.selectedList.find("li").each(function(){e(this).data("optionLink")&&e(this).data("optionLink").remove().appendTo(t.element)})},receive:function(i,n){n.item.data("optionLink").attr("selected",!0),t.count+=1,t._updateCount(),t.selectedList.children(".ui-draggable").each(function(){e(this).removeClass("ui-draggable"),e(this).data("optionLink",n.item.data("optionLink")),e(this).data("idx",n.item.data("idx")),t._applyItemState(e(this),!0)}),setTimeout(function(){n.item.remove()},1)}}),this.options.searchable?this._registerSearchEvents(this.availableContainer.find("input.search")):e(".search").hide(),this.container.find(".remove-all").click(function(){return t._populateLists(t.element.find("option").removeAttr("selected")),!1}),this.container.find(".add-all").click(function(){var i=t.element.find("option").not(":selected");return t.availableList.children("li:hidden").length>1?t.availableList.children("li").each(function(t){e(this).is(":visible")&&e(i[t-1]).attr("selected","selected")}):i.attr("selected","selected"),t._populateLists(t.element.find("option")),!1})},destroy:function(){this.element.show(),this.container.remove(),e.Widget.prototype.destroy.apply(this,arguments)},_populateLists:function(t){this.selectedList.children(".ui-element").remove(),this.availableList.children(".ui-element").remove(),this.count=0;var i=this;e(t.map(function(e){var t=i._getOptionNode(this).appendTo(this.selected?i.selectedList:i.availableList).show();return this.selected&&(i.count+=1),i._applyItemState(t,this.selected),t.data("idx",e),t[0]}));this._updateCount(),i._filter.apply(this.availableContainer.find("input.search"),[i.availableList])},_updateCount:function(){this.element.trigger("change"),this.selectedContainer.find("span.count").text(this.count+" "+e.ui.multiselect.locale.itemsCount)},_getOptionNode:function(t){t=e(t);var i=e('<li class="ui-state-default ui-element" title="'+t.text()+'" data-selected-value="'+t.val()+'"><span class="ui-icon"/>'+t.text()+'<a href="#" class="action"><span class="ui-corner-all ui-icon"/></a></li>').hide();return i.data("optionLink",t),i},_cloneWithData:function(e){var t=e.clone(!1,!1);return t.data("optionLink",e.data("optionLink")),t.data("idx",e.data("idx")),t},_setSelected:function(t,i){if(t.data("optionLink").attr("selected",i),i){var n=this._cloneWithData(t);return t[this.options.hide](this.options.animated,function(){e(this).remove()}),n.appendTo(this.selectedList).hide()[this.options.show](this.options.animated),this._applyItemState(n,!0),n}var s=this.availableList.find("li"),o=this.options.nodeComparator,r=null,a=t.data("idx"),l=o(t,e(s[a]));if(l){for(;a>=0&&a<s.length;)if(l>0?a++:a--,l!=o(t,e(s[a]))){r=s[l>0?a:a+1];break}}else r=s[a];var c=this._cloneWithData(t);return r?c.insertBefore(e(r)):c.appendTo(this.availableList),t[this.options.hide](this.options.animated,function(){e(this).remove()}),c.hide()[this.options.show](this.options.animated),this._applyItemState(c,!1),c},_applyItemState:function(e,t){t?(this.options.sortable?e.children("span").addClass("ui-icon-arrowthick-2-n-s").removeClass("ui-helper-hidden").addClass("ui-icon"):e.children("span").removeClass("ui-icon-arrowthick-2-n-s").addClass("ui-helper-hidden").removeClass("ui-icon"),e.find("a.action span").addClass("ui-icon-minus").removeClass("ui-icon-plus"),this._registerRemoveEvents(e.find("a.action"))):(e.children("span").removeClass("ui-icon-arrowthick-2-n-s").addClass("ui-helper-hidden").removeClass("ui-icon"),e.find("a.action span").addClass("ui-icon-plus").removeClass("ui-icon-minus"),this._registerAddEvents(e.find("a.action"))),this._registerDoubleClickEvents(e),this._registerHoverEvents(e)},_filter:function(t){var i=e(this),n=t.children("li"),s=n.map(function(){return e(this).text().toLowerCase()}),o=e.trim(i.val().toLowerCase()),r=[];o?(n.hide(),s.each(function(e){this.indexOf(o)>-1&&r.push(e)}),e.each(r,function(){e(n[this]).show()})):n.show()},_registerDoubleClickEvents:function(t){this.options.doubleClickable&&t.dblclick(function(i){0===e(i.target).closest(".action").length&&t.find("a.action").click()})},_registerHoverEvents:function(t){t.removeClass("ui-state-hover"),t.mouseover(function(){e(this).addClass("ui-state-hover")}),t.mouseout(function(){e(this).removeClass("ui-state-hover")})},_registerAddEvents:function(t){var i=this;t.click(function(){i._setSelected(e(this).parent(),!0);return i.count+=1,i._updateCount(),!1}),this.options.sortable&&t.each(function(){e(this).parent().draggable({connectToSortable:i.selectedList,helper:function(){var t=i._cloneWithData(e(this)).width(e(this).width()-50);return t.width(e(this).width()),t},appendTo:i.container,containment:i.container,revert:"invalid"})})},_registerRemoveEvents:function(t){var i=this;t.click(function(){return i._setSelected(e(this).parent(),!1),i.count-=1,i._updateCount(),!1})},_registerSearchEvents:function(t){var i=this;t.focus(function(){e(this).addClass("ui-state-active")}).blur(function(){e(this).removeClass("ui-state-active")}).keypress(function(e){if(13==e.keyCode)return!1}).keyup(function(){i._filter.apply(this,[i.availableList])})}}),e.extend(e.ui.multiselect,{locale:{addAll:"Добавить все",removeAll:"Удалить все",itemsCount:"выбрано"}})}(jQuery),function(e){"use strict";var t=function(t,i){this.options=e.extend({},e.fn.editableform.defaults,i),this.$div=e(t),this.options.scope||(this.options.scope=this)};t.prototype={constructor:t,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=e(e.fn.editableform.template)},initButtons:function(){var t=this.$form.find(".editable-buttons");t.append(e.fn.editableform.buttons),"bottom"===this.options.showbuttons&&t.addClass("editable-buttons-bottom")},render:function(){this.$loading=e(e.fn.editableform.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(".editable-buttons").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler("rendering"),this.initInput(),this.$form.find("div.editable-input").append(this.input.$tpl),this.$div.append(this.$form),e.when(this.input.render()).then(e.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable-cancel").click(e.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(".editable-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(e){e.preventDefault()});else{this.error(!1),this.input.$input.removeAttr("disabled"),this.$form.find(".editable-submit").removeAttr("disabled");var t=null===this.value||void 0===this.value||""===this.value?this.options.defaultValue:this.value;this.input.value2input(t),this.$form.submit(e.proxy(this.submit,this))}this.$div.triggerHandler("rendered"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var e,t;this.$form?(e=this.$form.outerWidth(),t=this.$form.outerHeight(),e&&this.$loading.width(e),t&&this.$loading.height(t),this.$form.hide()):(e=this.$loading.parent().width())&&this.$loading.width(e),this.$loading.show()},showForm:function(e){this.$loading.hide(),this.$form.show(),!1!==e&&this.input.activate(),this.$div.triggerHandler("show")},error:function(t){var i,n=this.$form.find(".control-group"),s=this.$form.find(".editable-error-block");if(!1===t)n.removeClass(e.fn.editableform.errorGroupClass),s.removeClass(e.fn.editableform.errorBlockClass).empty().hide();else{if(t){i=t.split("\n");for(var o=0;o<i.length;o++)i[o]=e("<div>").text(i[o]).html();t=i.join("<br>")}n.addClass(e.fn.editableform.errorGroupClass),s.addClass(e.fn.editableform.errorBlockClass).html(t).show()}},submit:function(t){t.stopPropagation(),t.preventDefault();var i,n=this.input.input2value();if(i=this.validate(n))return this.error(i),void this.showForm();if(this.options.savenochange||this.input.value2str(n)!=this.input.value2str(this.value)){var s=this.input.value2submit(n);this.isSaving=!0,e.when(this.save(s)).done(e.proxy(function(e){this.isSaving=!1;var t="function"==typeof this.options.success?this.options.success.call(this.options.scope,e,n):null;return!1===t?(this.error(!1),void this.showForm(!1)):"string"==typeof t?(this.error(t),void this.showForm()):(t&&"object"==typeof t&&t.hasOwnProperty("newValue")&&(n=t.newValue),this.error(!1),this.value=n,void this.$div.triggerHandler("save",{newValue:n,submitValue:s,response:e}))},this)).fail(e.proxy(function(e){var t;this.isSaving=!1,t="function"==typeof this.options.error?this.options.error.call(this.options.scope,e,n):"string"==typeof e?e:e.responseText||e.statusText||"Unknown error!",this.error(t),this.showForm()},this))}else this.$div.triggerHandler("nochange")},save:function(t){this.options.pk=e.fn.editableutils.tryParseJson(this.options.pk,!0);var i,n="function"==typeof this.options.pk?this.options.pk.call(this.options.scope):this.options.pk;if(!!("function"==typeof this.options.url||this.options.url&&("always"===this.options.send||"auto"===this.options.send&&null!=n)))return this.showLoading(),i={name:this.options.name||"",value:t,pk:n},"function"==typeof this.options.params?i=this.options.params.call(this.options.scope,i):(this.options.params=e.fn.editableutils.tryParseJson(this.options.params,!0),e.extend(i,this.options.params)),"function"==typeof this.options.url?this.options.url.call(this.options.scope,i):e.ajax(e.extend({url:this.options.url,data:i,type:"POST"},this.options.ajaxOptions))},validate:function(e){if(void 0===e&&(e=this.value),"function"==typeof this.options.validate)return this.options.validate.call(this.options.scope,e)},option:function(e,t){e in this.options&&(this.options[e]=t),"value"===e&&this.setValue(t)},setValue:function(e,t){this.value=t?this.input.str2value(e):e,this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}},e.fn.editableform=function(i){var n=arguments;return this.each(function(){var s=e(this),o=s.data("editableform"),r="object"==typeof i&&i;o||s.data("editableform",o=new t(this,r)),"string"==typeof i&&o[i].apply(o,Array.prototype.slice.call(n,1))})},e.fn.editableform.Constructor=t,e.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},e.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>',e.fn.editableform.loading='<div class="editableform-loading"></div>',e.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>',e.fn.editableform.errorGroupClass=null,e.fn.editableform.errorBlockClass="editable-error",e.fn.editableform.engine="jquery"}(window.jQuery),function(e){"use strict";e.fn.editableutils={inherit:function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.superclass=t.prototype},setCursorPosition:function(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},tryParseJson:function(e,t){if("string"==typeof e&&e.length&&e.match(/^[\{\[].*[\}\]]$/))if(t)try{e=new Function("return "+e)()}catch(e){}finally{return e}else e=new Function("return "+e)();return e},sliceObj:function(t,i,n){var s,o,r={};if(!e.isArray(i)||!i.length)return r;for(var a=0;a<i.length;a++)s=i[a],t.hasOwnProperty(s)&&(r[s]=t[s]),!0!==n&&(o=s.toLowerCase(),t.hasOwnProperty(o)&&(r[s]=t[o]));return r},getConfigData:function(t){var i={};return e.each(t.data(),function(e,t){("object"!=typeof t||t&&"object"==typeof t&&(t.constructor===Object||t.constructor===Array))&&(i[e]=t)}),i},objectKeys:function(e){if(Object.keys)return Object.keys(e);if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i},escape:function(t){return e("<div>").text(t).html()},itemsByValue:function(t,i,n){if(!i||null===t)return[];if("function"!=typeof n){var s=n||"value";n=function(e){return e[s]}}var o=e.isArray(t),r=[],a=this;return e.each(i,function(i,s){if(s.children)r=r.concat(a.itemsByValue(t,s.children,n));else if(o)e.grep(t,function(e){return e==(s&&"object"==typeof s?n(s):s)}).length&&r.push(s);else{var l=s&&"object"==typeof s?n(s):s;t==l&&r.push(s)}}),r},createInput:function(t){var i,n=t.type;return"date"===n&&("inline"===t.mode?e.fn.editabletypes.datefield?n="datefield":e.fn.editabletypes.dateuifield&&(n="dateuifield"):e.fn.editabletypes.date?n="date":e.fn.editabletypes.dateui&&(n="dateui"),"date"!==n||e.fn.editabletypes.date||(n="combodate")),"datetime"===n&&"inline"===t.mode&&(n="datetimefield"),"wysihtml5"!==n||e.fn.editabletypes[n]||(n="textarea"),"function"==typeof e.fn.editabletypes[n]?new(i=e.fn.editabletypes[n])(this.sliceObj(t,this.objectKeys(i.defaults))):(e.error("Unknown type: "+n),!1)},supportsTransitions:function(){var e=(document.body||document.documentElement).style,t="transition",i=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof e[t])return!0;t=t.charAt(0).toUpperCase()+t.substr(1);for(var n=0;n<i.length;n++)if("string"==typeof e[i[n]+t])return!0;return!1}}}(window.jQuery),function(e){"use strict";var t=function(e,t){this.init(e,t)},i=function(e,t){this.init(e,t)};t.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(i,n){this.$element=e(i),this.options=e.extend({},e.fn.editableContainer.defaults,n),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on("destroyed",e.proxy(function(){this.destroy()},this)),e(document).data("editable-handlers-attached")||(e(document).on("keyup.editable",function(t){27===t.which&&e(".editable-open").editableContainer("hide")}),e(document).on("click.editable",function(i){var n,s=e(i.target),o=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(e.contains(document.documentElement,i.target)&&!s.is(document)){for(n=0;n<o.length;n++)if(s.is(o[n])||s.parents(o[n]).length)return;t.prototype.closeOthers(i.target)}}),e(document).data("editable-handlers-attached",!0))},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!e.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var t in this.options)t in this.defaults?this.containerOptions[t]=this.options[t]:this.formOptions[t]=this.options[t]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var e;return this.containerDataName&&(e=this.$element.data(this.containerDataName))?e:e=this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:e.proxy(this.save,this),nochange:e.proxy(function(){this.hide("nochange")},this),cancel:e.proxy(function(){this.hide("cancel")},this),show:e.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:e.proxy(this.setPosition,this),resize:e.proxy(this.setPosition,this),rendered:e.proxy(function(){this.$element.triggerHandler("shown",e(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(t){this.$element.addClass("editable-open"),!1!==t&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=e("<div>"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(e){this.tip()&&this.tip().is(":visible")&&this.$element.hasClass("editable-open")&&(this.$form.data("editableform").isSaving?this.delayedHide={reason:e}:(this.delayedHide=!1,this.$element.removeClass("editable-open"),this.innerHide(),this.$element.triggerHandler("hidden",e||"manual")))},innerShow:function(){},innerHide:function(){},toggle:function(e){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(e)},setPosition:function(){},save:function(e,t){this.$element.triggerHandler("save",t),this.hide("save")},option:function(e,t){this.options[e]=t,e in this.containerOptions?(this.containerOptions[e]=t,this.setContainerOption(e,t)):(this.formOptions[e]=t,this.$form&&this.$form.editableform("option",e,t))},setContainerOption:function(e,t){this.call("option",e,t)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off("destroyed"),this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(t){e(".editable-open").each(function(i,n){if(n!==t&&!e(n).find(t).length){var s=e(n),o=s.data("editableContainer");o&&("cancel"===o.options.onblur?s.data("editableContainer").hide("onblur"):"submit"===o.options.onblur&&s.data("editableContainer").tip().find("form").submit())}})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editableform").input.activate()}},e.fn.editableContainer=function(n){var s=arguments;return this.each(function(){var o=e(this),r=o.data("editableContainer"),a="object"==typeof n&&n,l="inline"===a.mode?i:t;r||o.data("editableContainer",r=new l(this,a)),"string"==typeof n&&r[n].apply(r,Array.prototype.slice.call(s,1))})},e.fn.editableContainer.Popup=t,e.fn.editableContainer.Inline=i,e.fn.editableContainer.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"},jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}}}(window.jQuery),function(e){"use strict";e.extend(e.fn.editableContainer.Inline.prototype,e.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=e("<span></span>"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,e.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(e){"use strict";var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.editable.defaults,i,e.fn.editableutils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!e.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};t.prototype={constructor:t,init:function(){var t,i=!1;if(this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=e.fn.editableutils.createInput(this.options),this.input){switch(void 0===this.options.value||null===this.options.value?(this.value=this.input.html2value(e.trim(this.$element.html())),i=!0):(this.options.value=e.fn.editableutils.tryParseJson(this.options.value,!0),"string"==typeof this.options.value?this.value=this.input.str2value(this.options.value):this.value=this.options.value),this.$element.addClass("editable"),"textarea"===this.input.type&&this.$element.addClass("editable-pre-wrapped"),"manual"!==this.options.toggle?(this.$element.addClass("editable-click"),this.$element.on(this.options.toggle+".editable",e.proxy(function(e){if(this.options.disabled||e.preventDefault(),"mouseenter"===this.options.toggle)this.show();else{var t="click"!==this.options.toggle;this.toggle(t)}},this))):this.$element.attr("tabindex",-1),"function"==typeof this.options.display&&(this.options.autotext="always"),this.options.autotext){case"always":t=!0;break;case"auto":t=!e.trim(this.$element.text()).length&&null!==this.value&&void 0!==this.value&&!i;break;default:t=!1}e.when(!t||this.render()).then(e.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler("init",this)},this))}},initLive:function(){var t=this.options.selector;this.options.selector=!1,this.options.autotext="never",this.$element.on(this.options.toggle+".editable",t,e.proxy(function(t){var i=e(t.target);i.data("editable")||(i.hasClass(this.options.emptyclass)&&i.empty(),i.editable(this.options).trigger(t))},this))},render:function(e){if(!1!==this.options.display)return this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,e):"function"==typeof this.options.display?this.options.display.call(this.$element[0],this.value,e):this.input.value2html(this.value,this.$element[0])},enable:function(){this.options.disabled=!1,this.$element.removeClass("editable-disabled"),this.handleEmpty(this.isEmpty),"manual"!==this.options.toggle&&"-1"===this.$element.attr("tabindex")&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass("editable-disabled"),this.handleEmpty(this.isEmpty),this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(t,i){if(t&&"object"==typeof t)e.each(t,e.proxy(function(t,i){this.option(e.trim(t),i)},this));else{if(this.options[t]=i,"disabled"===t)return i?this.disable():this.enable();"value"===t&&this.setValue(i),this.container&&this.container.option(t,i),this.input.option&&this.input.option(t,i)}},handleEmpty:function(t){!1!==this.options.display&&(void 0!==t?this.isEmpty=t:"function"==typeof this.input.isEmpty?this.isEmpty=this.input.isEmpty(this.$element):this.isEmpty=""===e.trim(this.$element.html()),this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(t){if(!this.options.disabled){if(this.container){if(this.container.tip().is(":visible"))return}else{var i=e.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(i),this.$element.on("save.internal",e.proxy(this.save,this)),this.container=this.$element.data("editableContainer")}this.container.show(t)}},hide:function(){this.container&&this.container.hide()},toggle:function(e){this.container&&this.container.tip().is(":visible")?this.hide():this.show(e)},save:function(e,t){if(this.options.unsavedclass){var i=!1;(i=(i=(i=(i=i||"function"==typeof this.options.url)||!1===this.options.display)||void 0!==t.response)||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue))?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var n=this.$element,s=n.css("background-color");n.css("background-color",this.options.highlight),setTimeout(function(){"transparent"===s&&(s=""),n.css("background-color",s),n.addClass("editable-bg-transition"),setTimeout(function(){n.removeClass("editable-bg-transition")},1700)},10)}this.setValue(t.newValue,!1,t.response)},validate:function(){if("function"==typeof this.options.validate)return this.options.validate.call(this,this.value)},setValue:function(t,i,n){this.value=i?this.input.str2value(t):t,this.container&&this.container.option("value",this.value),e.when(this.render(n)).then(e.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),"manual"!==this.options.toggle&&(this.$element.removeClass("editable-click"),this.$element.off(this.options.toggle+".editable")),this.$element.off("save.internal"),this.$element.removeClass("editable editable-open editable-disabled"),this.$element.removeData("editable")}},e.fn.editable=function(i){var n={},s=arguments;switch(i){case"validate":return this.each(function(){var t,i=e(this).data("editable");i&&(t=i.validate())&&(n[i.options.name]=t)}),n;case"getValue":return 2===arguments.length&&!0===arguments[1]?n=this.eq(0).data("editable").value:this.each(function(){var t=e(this).data("editable");t&&void 0!==t.value&&null!==t.value&&(n[t.options.name]=t.input.value2submit(t.value))}),n;case"submit":var o,r=arguments[1]||{},a=this,l=this.editable("validate");return e.isEmptyObject(l)?(o=this.editable("getValue"),r.data&&e.extend(o,r.data),e.ajax(e.extend({url:r.url,data:o,type:"POST"},r.ajaxOptions)).success(function(e){"function"==typeof r.success&&r.success.call(a,e,r)}).error(function(){"function"==typeof r.error&&r.error.apply(a,arguments)})):"function"==typeof r.error&&r.error.call(a,l),this}return this.each(function(){var n=e(this),o=n.data("editable"),r="object"==typeof i&&i;r&&r.selector?o=new t(this,r):(o||n.data("editable",o=new t(this,r)),"string"==typeof i&&o[i].apply(o,Array.prototype.slice.call(s,1)))})},e.fn.editable.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(e){"use strict";e.fn.editabletypes={};var t=function(){};t.prototype={init:function(t,i,n){this.type=t,this.options=e.extend({},n,i)},prerender:function(){this.$tpl=e(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(t,i){e(i)[this.options.escape?"text":"html"](e.trim(t))},html2value:function(t){return e("<div>").html(t).text()},value2str:function(e){return e},str2value:function(e){return e},value2submit:function(e){return e},value2input:function(e){this.$input.val(e)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(t){return e("<div>").text(t).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(e){void 0!==this.options[e]&&null!==this.options[e]&&this.$input.attr(e,this.options[e])},option:function(e,t){this.options[e]=t}},t.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0},e.extend(e.fn.editabletypes,{abstractinput:t})}(window.jQuery),function(e){"use strict";var t=function(e){};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){var t=e.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),t.resolve()},function(){this.error=this.options.sourceError,t.resolve()}),t.promise()},html2value:function(e){return null},value2html:function(t,i,n,s){var o=e.Deferred(),r=function(){"function"==typeof n?n.call(i,t,this.sourceData,s):this.value2htmlFinal(t,i),o.resolve()};return null===t?r.call(this):this.onSourceReady(r,function(){o.resolve()}),o.promise()},onSourceReady:function(t,i){var n;if(e.isFunction(this.options.source)?(n=this.options.source.call(this.options.scope),this.sourceData=null):n=this.options.source,this.options.sourceCache&&e.isArray(this.sourceData))t.call(this);else{try{n=e.fn.editableutils.tryParseJson(n,!1)}catch(e){return void i.call(this)}if("string"==typeof n){if(this.options.sourceCache){var s,o=n;if(e(document).data(o)||e(document).data(o,{}),!1===(s=e(document).data(o)).loading&&s.sourceData)return this.sourceData=s.sourceData,this.doPrepend(),void t.call(this);if(!0===s.loading)return s.callbacks.push(e.proxy(function(){this.sourceData=s.sourceData,this.doPrepend(),t.call(this)},this)),void s.err_callbacks.push(e.proxy(i,this));s.loading=!0,s.callbacks=[],s.err_callbacks=[]}var r=e.extend({url:n,type:"get",cache:!1,dataType:"json",success:e.proxy(function(n){s&&(s.loading=!1),this.sourceData=this.makeArray(n),e.isArray(this.sourceData)?(s&&(s.sourceData=this.sourceData,e.each(s.callbacks,function(){this.call()})),this.doPrepend(),t.call(this)):(i.call(this),s&&e.each(s.err_callbacks,function(){this.call()}))},this),error:e.proxy(function(){i.call(this),s&&(s.loading=!1,e.each(s.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);e.ajax(r)}else this.sourceData=this.makeArray(n),e.isArray(this.sourceData)?(this.doPrepend(),t.call(this)):i.call(this)}},doPrepend:function(){null!==this.options.prepend&&void 0!==this.options.prepend&&(e.isArray(this.prependData)||(e.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=e.fn.editableutils.tryParseJson(this.options.prepend,!0),"string"==typeof this.options.prepend&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),e.isArray(this.prependData)&&e.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(e,t){},makeArray:function(t){var i,n,s,o,r=[];if(!t||"string"==typeof t)return null;if(e.isArray(t)){o=function(e,t){if(n={value:e,text:t},i++>=2)return!1};for(var a=0;a<t.length;a++)"object"==typeof(s=t[a])?(i=0,e.each(s,o),1===i?r.push(n):i>1&&(s.children&&(s.children=this.makeArray(s.children)),r.push(s))):r.push({value:s,text:s})}else e.each(t,function(e,t){r.push({value:e,text:t})});return r},option:function(e,t){this.options[e]=t,"source"===e&&(this.sourceData=null),"prepend"===e&&(this.prependData=null)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null}),e.fn.editabletypes.list=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("text",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),e.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=e('<span class="editable-clear-x"></span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(e.proxy(function(t){if(!~e.inArray(t.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var i=this;this.t=setTimeout(function(){i.toggleClear(t)},100)}},this)).parent().css("position","relative"),this.$clear.click(e.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(e){if(this.$clear){var t=this.$input.val().length,i=this.$clear.is(":visible");t&&!i&&this.$clear.show(),!t&&i&&this.$clear.hide()}},clear:function(){this.$clear.hide(),this.$input.val("").focus()}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0}),e.fn.editabletypes.text=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("textarea",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.setAttr("placeholder"),this.setAttr("rows"),this.$input.keydown(function(t){t.ctrlKey&&13===t.which&&e(this).closest("form").submit()})},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7}),e.fn.editabletypes.textarea=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("select",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list),e.extend(t.prototype,{renderList:function(){this.$input.empty();var t=function(i,n){var s;if(e.isArray(n))for(var o=0;o<n.length;o++)s={},n[o].children?(s.label=n[o].text,i.append(t(e("<optgroup>",s),n[o].children))):(s.value=n[o].value,n[o].disabled&&(s.disabled=!0),i.append(e("<option>",s).text(n[o].text)));return i};t(this.$input,this.sourceData),this.setClass(),this.$input.on("keydown.editable",function(t){13===t.which&&e(this).closest("form").submit()})},value2htmlFinal:function(t,i){var n="",s=e.fn.editableutils.itemsByValue(t,this.sourceData);s.length&&(n=s[0].text),e.fn.editabletypes.abstractinput.prototype.value2html.call(this,n,i)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:"<select></select>"}),e.fn.editabletypes.select=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("checklist",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list),e.extend(t.prototype,{renderList:function(){var t;if(this.$tpl.empty(),e.isArray(this.sourceData)){for(var i=0;i<this.sourceData.length;i++)t=e("<label>").append(e("<input>",{type:"checkbox",value:this.sourceData[i].value})).append(e("<span>").text(" "+this.sourceData[i].text)),e("<div>").append(t).appendTo(this.$tpl);this.$input=this.$tpl.find('input[type="checkbox"]'),this.setClass()}},value2str:function(t){return e.isArray(t)?t.sort().join(e.trim(this.options.separator)):""},str2value:function(t){var i,n=null;return"string"==typeof t&&t.length?(i=new RegExp("\\s*"+e.trim(this.options.separator)+"\\s*"),n=t.split(i)):n=e.isArray(t)?t:[t],n},value2input:function(t){this.$input.prop("checked",!1),e.isArray(t)&&t.length&&this.$input.each(function(i,n){var s=e(n);e.each(t,function(e,t){s.val()==t&&s.prop("checked",!0)})})},input2value:function(){var t=[];return this.$input.filter(":checked").each(function(i,n){t.push(e(n).val())}),t},value2htmlFinal:function(t,i){var n=[],s=e.fn.editableutils.itemsByValue(t,this.sourceData),o=this.options.escape;s.length?(e.each(s,function(t,i){var s=o?e.fn.editableutils.escape(i.text):i.text;n.push(s)}),e(i).html(n.join("<br>"))):e(i).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(t){13===t.which&&e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","}),e.fn.editabletypes.checklist=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("password",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),e.extend(t.prototype,{value2html:function(t,i){t?e(i).text("[hidden]"):e(i).empty()},html2value:function(e){return null}}),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="password">'}),e.fn.editabletypes.password=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("email",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="email">'}),e.fn.editabletypes.email=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("url",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="url">'}),e.fn.editabletypes.url=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("tel",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'}),e.fn.editabletypes.tel=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("number",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),e.extend(t.prototype,{render:function(){t.superclass.render.call(this),this.setAttr("min"),this.setAttr("max"),this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null}),e.fn.editabletypes.number=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("range",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.number),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.setAttr("min"),this.setAttr("max"),this.setAttr("step"),this.$input.on("input",function(){e(this).siblings("output").text(e(this).val())})},activate:function(){this.$input.focus()}}),t.defaults=e.extend({},e.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"}),e.fn.editabletypes.range=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("time",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass()}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'}),e.fn.editabletypes.time=t}(window.jQuery),function(e){"use strict";var t=function(i){if(this.init("select2",i,t.defaults),i.select2=i.select2||{},this.sourceData=null,i.placeholder&&(i.select2.placeholder=i.placeholder),!i.select2.tags&&i.source){var n=i.source;e.isFunction(i.source)&&(n=i.source.call(i.scope)),"string"==typeof n?(i.select2.ajax=i.select2.ajax||{},i.select2.ajax.data||(i.select2.ajax.data=function(e){return{query:e}}),i.select2.ajax.results||(i.select2.ajax.results=function(e){return{results:e}}),i.select2.ajax.url=n):(this.sourceData=this.convertSource(n),i.select2.data=this.sourceData)}if(this.options.select2=e.extend({},t.defaults.select2,i.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote="ajax"in this.options.select2,this.idFunc=this.options.select2.id,"function"!=typeof this.idFunc){var s=this.idFunc||"id";this.idFunc=function(e){return e[s]}}this.formatSelection=this.options.select2.formatSelection,"function"!=typeof this.formatSelection&&(this.formatSelection=function(e){return e.text})};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on("select2-loaded",e.proxy(function(e){this.sourceData=e.items.results},this)),this.isMultiple&&this.$input.on("change",function(){e(this).closest("form").parent().triggerHandler("resize")})},value2html:function(i,n){var s,o="",r=this;this.options.select2.tags?s=i:this.sourceData&&(s=e.fn.editableutils.itemsByValue(i,this.sourceData,this.idFunc)),e.isArray(s)?(o=[],e.each(s,function(e,t){o.push(t&&"object"==typeof t?r.formatSelection(t):t)})):s&&(o=r.formatSelection(s)),o=e.isArray(o)?o.join(this.options.viewseparator):o,t.superclass.value2html.call(this,o,n)},html2value:function(e){return this.options.select2.tags?this.str2value(e,this.options.viewseparator):null},value2input:function(t){if(this.$input.data("select2")?this.$input.val(t).trigger("change",!0):(this.$input.val(t),this.$input.select2(this.options.select2)),this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var i=this.options.select2.id,n=this.options.select2.formatSelection;if(!i&&!n){var s={id:t,text:e(this.options.scope).text()};this.$input.select2("data",s)}}},input2value:function(){return this.$input.select2("val")},str2value:function(t,i){if("string"!=typeof t||!this.isMultiple)return t;var n,s,o;if(i=i||this.options.select2.separator||e.fn.select2.defaults.separator,null===t||t.length<1)return null;for(s=0,o=(n=t.split(i)).length;s<o;s+=1)n[s]=e.trim(n[s]);return n},autosubmit:function(){this.$input.on("change",function(t,i){i||e(this).closest("form").submit()})},convertSource:function(t){if(e.isArray(t)&&t.length&&void 0!==t[0].value)for(var i=0;i<t.length;i++)void 0!==t[i].value&&(t[i].id=t[i].value,delete t[i].value);return t},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "}),e.fn.editabletypes.select2=t}(window.jQuery),function(e){var t=function(t,i){this.$element=e(t),this.$element.is("input")?(this.options=e.extend({},e.fn.combodate.defaults,i,this.$element.data()),this.init()):e.error("Combodate should be applied to INPUT element")};t.prototype={constructor:t,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]},this.$widget=e('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on("change","select",e.proxy(function(){this.$element.val(this.getValue())},this)),this.$widget.find("select").css("width","auto"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var t=this.options.template;return e.each(this.map,function(e,i){i=i[0];var n=new RegExp(i+"+"),s=i.length>1?i.substring(1,2):i;t=t.replace(n,"{"+s+"}")}),t=t.replace(/ /g,"&nbsp;"),e.each(this.map,function(e,i){var n=(i=i[0]).length>1?i.substring(1,2):i;t=t.replace("{"+n+"}",'<select class="'+e+'"></select>')}),t},initCombos:function(){var t=this;e.each(this.map,function(e,i){var n,s,o=t.$widget.find("."+e);o.length&&(t["$"+e]=o,n="fill"+e.charAt(0).toUpperCase()+e.slice(1),s=t[n](),t["$"+e].html(t.renderItems(s)))})},initItems:function(e){var t,i=[];if("name"===this.options.firstItem){var n="function"==typeof(t=moment.relativeTime||moment.langData()._relativeTime)[e]?t[e](1,!0,e,!1):t[e];n=n.split(" ").reverse()[0],i.push(["",n])}else"empty"===this.options.firstItem&&i.push(["",""]);return i},renderItems:function(e){for(var t=[],i=0;i<e.length;i++)t.push('<option value="'+e[i][0]+'">'+e[i][1]+"</option>");return t.join("\n")},fillDay:function(){var e,t,i=this.initItems("d"),n=-1!==this.options.template.indexOf("DD");for(t=1;t<=31;t++)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillMonth:function(){var e,t,i=this.initItems("M"),n=-1!==this.options.template.indexOf("MMMM"),s=-1!==this.options.template.indexOf("MMM"),o=-1!==this.options.template.indexOf("MM");for(t=0;t<=11;t++)e=n?moment().date(1).month(t).format("MMMM"):s?moment().date(1).month(t).format("MMM"):o?this.leadZero(t+1):t+1,i.push([t,e]);return i},fillYear:function(){var e,t,i=[],n=-1!==this.options.template.indexOf("YYYY");for(t=this.options.maxYear;t>=this.options.minYear;t--)e=n?t:(t+"").substring(2),i[this.options.yearDescending?"push":"unshift"]([t,e]);return i=this.initItems("y").concat(i)},fillHour:function(){var e,t,i=this.initItems("h"),n=-1!==this.options.template.indexOf("h"),s=(this.options.template.indexOf("H"),-1!==this.options.template.toLowerCase().indexOf("hh")),o=n?12:23;for(t=n?1:0;t<=o;t++)e=s?this.leadZero(t):t,i.push([t,e]);return i},fillMinute:function(){var e,t,i=this.initItems("m"),n=-1!==this.options.template.indexOf("mm");for(t=0;t<=59;t+=this.options.minuteStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillSecond:function(){var e,t,i=this.initItems("s"),n=-1!==this.options.template.indexOf("ss");for(t=0;t<=59;t+=this.options.secondStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillAmpm:function(){var e=-1!==this.options.template.indexOf("a");this.options.template.indexOf("A");return[["am",e?"am":"AM"],["pm",e?"pm":"PM"]]},getValue:function(t){var i,n={},s=this,o=!1;return e.each(this.map,function(e,t){if("ampm"!==e){var i="day"===e?1:0;return n[e]=s["$"+e]?parseInt(s["$"+e].val(),10):i,isNaN(n[e])?(o=!0,!1):void 0}}),o?"":(this.$ampm&&(12===n.hour?n.hour="am"===this.$ampm.val()?0:12:n.hour="am"===this.$ampm.val()?n.hour:n.hour+12),i=moment([n.year,n.month,n.day,n.hour,n.minute,n.second]),this.highlight(i),null===(t=void 0===t?this.options.format:t)?i.isValid()?i:null:i.isValid()?i.format(t):"")},setValue:function(t){if(t){var i="string"==typeof t?moment(t,this.options.format):moment(t),n=this,s={};i.isValid()&&(e.each(this.map,function(e,t){"ampm"!==e&&(s[e]=i[t[1]]())}),this.$ampm&&(s.hour>=12?(s.ampm="pm",s.hour>12&&(s.hour-=12)):(s.ampm="am",0===s.hour&&(s.hour=12))),e.each(s,function(e,t){n["$"+e]&&("minute"===e&&n.options.minuteStep>1&&n.options.roundTime&&(t=o(n["$"+e],t)),"second"===e&&n.options.secondStep>1&&n.options.roundTime&&(t=o(n["$"+e],t)),n["$"+e].val(t))}),this.$element.val(i.format(this.options.format)))}function o(t,i){var n={};return t.children("option").each(function(t,s){var o,r=e(s).attr("value");""!==r&&(o=Math.abs(r-i),(void 0===n.distance||o<n.distance)&&(n={value:r,distance:o}))}),n.value}},highlight:function(e){e.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(e){return e<=9?"0"+e:e},destroy:function(){this.$widget.remove(),this.$element.removeData("combodate").show()}},e.fn.combodate=function(i){var n,s=Array.apply(null,arguments);return s.shift(),"getValue"===i&&this.length&&(n=this.eq(0).data("combodate"))?n.getValue.apply(n,s):this.each(function(){var n=e(this),o=n.data("combodate"),r="object"==typeof i&&i;o||n.data("combodate",o=new t(this,r)),"string"==typeof i&&"function"==typeof o[i]&&o[i].apply(o,s)})},e.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0}}(window.jQuery),function(e){"use strict";var t=function(i){this.init("combodate",i,t.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),i.combodate=e.fn.editableutils.tryParseJson(i.combodate,!0),this.options.combodate=e.extend({},t.defaults.combodate,i.combodate,{format:this.options.format,template:this.options.template})};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.$input.combodate(this.options.combodate),"bs3"===e.fn.editableform.engine&&this.$input.siblings().find("select").addClass("form-control"),this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(e,i){var n=e?e.format(this.options.viewformat):"";t.superclass.value2html.call(this,n,i)},html2value:function(e){return e?moment(e,this.options.viewformat):null},value2str:function(e){return e?e.format(this.options.format):""},str2value:function(e){return e?moment(e,this.options.format):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.combodate("setValue",e)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null}),e.fn.editabletypes.combodate=t}(window.jQuery),function(e){"use strict";var t=e.fn.editableform.Constructor.prototype.initInput;e.extend(e.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=e(e.fn.editableform.template),this.$form.find(".control-group").addClass("form-group"),this.$form.find(".editable-error-block").addClass("help-block")},initInput:function(){t.apply(this);var i=null===this.input.options.inputclass||!1===this.input.options.inputclass,n="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");~e.inArray(this.input.type,n)&&(this.input.$input.addClass("form-control"),i&&(this.input.options.inputclass="input-sm",this.input.$input.addClass("input-sm")));for(var s=this.$form.find(".editable-buttons"),o=i?["input-sm"]:this.input.options.inputclass.split(" "),r=0;r<o.length;r++)"input-lg"===o[r].toLowerCase()&&s.find("button").removeClass("btn-sm").addClass("btn-lg")}}),e.fn.editableform.buttons='<button type="submit" class="btn btn-primary btn-sm editable-submit"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="btn btn-default btn-sm editable-cancel"><i class="glyphicon glyphicon-remove"></i></button>',e.fn.editableform.errorGroupClass="has-error",e.fn.editableform.errorBlockClass=null,e.fn.editableform.engine="bs3"}(window.jQuery),function(e){"use strict";e.extend(e.fn.editableContainer.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:e.fn.popover.Constructor.DEFAULTS,initContainer:function(){var t;e.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template}),this.$element.data("template")&&(t=this.$element.data("template"),this.$element.removeData("template")),this.call(this.containerOptions),t&&this.$element.data("template",t)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(e,t){this.container().options[e]=t},setPosition:function(){(function(){var e=this.tip(),t="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,i=this.getPosition(),n=e[0].offsetWidth,s=e[0].offsetHeight,o=this.getCalculatedOffset(t,i,n,s);this.applyPlacement(o,t)}).call(this.container())}})}(window.jQuery),function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}var i=function(t,i){this._process_options(i),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(c.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};i.prototype={constructor:i,_process_options:function(t){this._o=e.extend({},this._o,t);var i=this.o=e.extend({},this._o),n=i.language;switch(l[n]||(n=n.split("-")[0],l[n]||(n=r.language)),i.language=n,i.startView){case 2:case"decade":i.startView=2;break;case 1:case"year":i.startView=1;break;default:i.startView=0}switch(i.minViewMode){case 1:case"months":i.minViewMode=1;break;case 2:case"years":i.minViewMode=2;break;default:i.minViewMode=0}i.startView=Math.max(i.startView,i.minViewMode),i.weekStart%=7,i.weekEnd=(i.weekStart+6)%7;var s=c.parseFormat(i.format);i.startDate!==-1/0&&(i.startDate=c.parseDate(i.startDate,s,i.language)),i.endDate!==1/0&&(i.endDate=c.parseDate(i.endDate,s,i.language)),i.daysOfWeekDisabled=i.daysOfWeekDisabled||[],e.isArray(i.daysOfWeekDisabled)||(i.daysOfWeekDisabled=i.daysOfWeekDisabled.split(/[,\s]*/)),i.daysOfWeekDisabled=e.map(i.daysOfWeekDisabled,function(e){return parseInt(e,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.on(i)},_unapplyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.off(i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).size()||this.picker.is(e.target)||this.picker.find(e.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,i){var n=i||this.date,s=new Date(n.getTime()+6e4*n.getTimezoneOffset());this.element.trigger({type:t,date:s,format:e.proxy(function(e){var t=e||this.o.format;return c.formatDate(n,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),e&&e.preventDefault(),this._trigger("show")},hide:function(e){this.isInline||this.picker.is(":visible")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){this.date=e,this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e):this.component&&this.element.find("input").val(e)},getFormattedDate:function(e){return void 0===e&&(e=this.o.format),c.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=parseInt(this.element.parents().filter(function(){return"auto"!=e(this).css("z-index")}).first().css("z-index"))+10,i=this.component?this.component.parent().offset():this.element.offset(),n=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:i.top+n,left:i.left,zIndex:t})}},_allow_update:!0,update:function(){if(this._allow_update){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=c.parseDate(e,this.o.format,this.o.language),t&&this.setValue(),this.date<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.date>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=new Date(this.date),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var i='<th class="cw">&nbsp;</th>';t+=i,this.picker.find(".datepicker-days thead tr:first-child").prepend(i)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+l[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+l[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var i=[],n=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),o=this.date.valueOf(),r=new Date;return t.getUTCFullYear()<n||t.getUTCFullYear()==n&&t.getUTCMonth()<s?i.push("old"):(t.getUTCFullYear()>n||t.getUTCFullYear()==n&&t.getUTCMonth()>s)&&i.push("new"),this.o.todayHighlight&&t.getUTCFullYear()==r.getFullYear()&&t.getUTCMonth()==r.getMonth()&&t.getUTCDate()==r.getDate()&&i.push("today"),o&&t.valueOf()==o&&i.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&i.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&i.push("range"),-1!=e.inArray(t.valueOf(),this.range)&&i.push("selected")),i},fill:function(){var i,n=new Date(this.viewDate),s=n.getUTCFullYear(),o=n.getUTCMonth(),r=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,a=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,d=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,u=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf();this.picker.find(".datepicker-days thead th.datepicker-switch").text(l[this.o.language].months[o]+" "+s),this.picker.find("tfoot th.today").text(l[this.o.language].today).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot th.clear").text(l[this.o.language].clear).toggle(!1!==this.o.clearBtn),this.updateNavArrows(),this.fillMonths();var h=t(s,o-1,28,0,0,0,0),p=c.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(p),h.setUTCDate(p-(h.getUTCDay()-this.o.weekStart+7)%7);var f=new Date(h);f.setUTCDate(f.getUTCDate()+42),f=f.valueOf();for(var m,g=[];h.valueOf()<f;){if(h.getUTCDay()==this.o.weekStart&&(g.push("<tr>"),this.o.calendarWeeks)){var v=new Date(+h+(this.o.weekStart-h.getUTCDay()-7)%7*864e5),b=new Date(+v+(11-v.getUTCDay())%7*864e5),y=new Date(+(y=t(b.getUTCFullYear(),0,1))+(11-y.getUTCDay())%7*864e5),w=(b-y)/864e5/7+1;g.push('<td class="cw">'+w+"</td>")}(m=this.getClassNames(h)).push("day");var x=this.o.beforeShowDay(h);void 0===x?x={}:"boolean"==typeof x?x={enabled:x}:"string"==typeof x&&(x={classes:x}),!1===x.enabled&&m.push("disabled"),x.classes&&(m=m.concat(x.classes.split(/\s+/))),x.tooltip&&(i=x.tooltip),m=e.unique(m),g.push('<td class="'+m.join(" ")+'"'+(i?' title="'+i+'"':"")+">"+h.getUTCDate()+"</td>"),h.getUTCDay()==this.o.weekEnd&&g.push("</tr>"),h.setUTCDate(h.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(g.join(""));var C=this.date&&this.date.getUTCFullYear(),E=this.picker.find(".datepicker-months").find("th:eq(1)").text(s).end().find("span").removeClass("active");C&&C==s&&E.eq(this.date.getUTCMonth()).addClass("active"),(s<r||s>d)&&E.addClass("disabled"),s==r&&E.slice(0,a).addClass("disabled"),s==d&&E.slice(u+1).addClass("disabled"),g="",s=10*parseInt(s/10,10);var T=this.picker.find(".datepicker-years").find("th:eq(1)").text(s+"-"+(s+9)).end().find("td");s-=1;for(var k=-1;k<11;k++)g+='<span class="year'+(-1==k?" old":10==k?" new":"")+(C==s?" active":"")+(s<r||s>d?" disabled":"")+'">'+s+"</span>",s+=1;T.html(g)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(i){i.preventDefault();var n=e(i.target).closest("span, td, th");if(1==n.length)switch(n[0].nodeName.toLowerCase()){case"th":switch(n[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var s=c.modes[this.viewMode].navStep*("prev"==n[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s)}this.fill();break;case"today":var o=new Date;o=t(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0),this.showMode(-2);var r="linked"==this.o.todayBtn?null:"view";this._setDate(o,r);break;case"clear":var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!n.is(".disabled")){if(this.viewDate.setUTCDate(1),n.is(".month")){var l=1,d=n.parent().find("span").index(n),u=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(d),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(t(u,d,l,0,0,0,0))}else{u=parseInt(n.text(),10)||0,l=1,d=0;this.viewDate.setUTCFullYear(u),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(t(u,d,l,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(n.is(".day")&&!n.is(".disabled")){l=parseInt(n.text(),10)||1,u=this.viewDate.getUTCFullYear(),d=this.viewDate.getUTCMonth();n.is(".old")?0===d?(d=11,u-=1):d-=1:n.is(".new")&&(11==d?(d=0,u+=1):d+=1),this._setDate(t(u,d,l,0,0,0,0))}}},_setDate:function(e,t){var i;t&&"date"!=t||(this.date=new Date(e)),t&&"view"!=t||(this.viewDate=new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate"),this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),!this.o.autoclose||t&&"date"!=t||this.hide())},moveMonth:function(e,t){if(!t)return e;var i,n,s=new Date(e.valueOf()),o=s.getUTCDate(),r=s.getUTCMonth(),a=Math.abs(t);if(t=t>0?1:-1,1==a)n=-1==t?function(){return s.getUTCMonth()==r}:function(){return s.getUTCMonth()!=i},i=r+t,s.setUTCMonth(i),(i<0||i>11)&&(i=(i+12)%12);else{for(var l=0;l<a;l++)s=this.moveMonth(s,t);i=s.getUTCMonth(),s.setUTCDate(o),n=function(){return i!=s.getUTCMonth()}}for(;n();)s.setUTCDate(--o),s.setUTCMonth(i);return s},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))27==e.keyCode&&this.show();else{var t,i,n,s,o=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+7*t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+7*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(o)this._trigger("changeDate"),this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+c.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var n=function(t,i){this.element=e(t),this.inputs=e.map(i.inputs,function(e){return e.jquery?e[0]:e}),delete i.inputs,e(this.inputs).datepicker(i).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};n.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.date}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,i){i.setRange(t)})},dateUpdated:function(t){var i=e(t.target).data("datepicker").getUTCDate(),n=e.inArray(t.target,this.inputs),s=this.inputs.length;if(-1!=n){if(i<this.dates[n])for(;n>=0&&i<this.dates[n];)this.pickers[n--].setUTCDate(i);else if(i>this.dates[n])for(;n<s&&i>this.dates[n];)this.pickers[n++].setUTCDate(i);this.updateDates()}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var s=e.fn.datepicker,o=e.fn.datepicker=function(t){var s,o=Array.apply(null,arguments);return o.shift(),this.each(function(){var c=e(this),d=c.data("datepicker"),u="object"==typeof t&&t;if(!d){var h=function(t,i){var n=e(t).data(),s={},o=new RegExp("^"+i.toLowerCase()+"([A-Z])");for(var r in i=new RegExp("^"+i.toLowerCase()),n)i.test(r)&&(s[r.replace(o,function(e,t){return t.toLowerCase()})]=n[r]);return s}(this,"date"),p=function(t){var i={};if(l[t]||(t=t.split("-")[0],l[t])){var n=l[t];return e.each(a,function(e,t){t in n&&(i[t]=n[t])}),i}}(e.extend({},r,h,u).language),f=e.extend({},r,p,h,u);if(c.is(".input-daterange")||f.inputs){var m={inputs:f.inputs||c.find("input").toArray()};c.data("datepicker",d=new n(this,e.extend(f,m)))}else c.data("datepicker",d=new i(this,f))}if("string"==typeof t&&"function"==typeof d[t]&&void 0!==(s=d[t].apply(d,o)))return!1}),void 0!==s?s:this},r=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},a=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=i;var l=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},c={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,c.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),i=e.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(n,s,o){if(n instanceof Date)return n;if("string"==typeof s&&(s=c.parseFormat(s)),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){var r,a=/([\-+]\d+)([dmwy])/,d=n.match(/([\-+]\d+)([dmwy])/g);n=new Date;for(var u=0;u<d.length;u++)switch(f=a.exec(d[u]),r=parseInt(f[1]),f[2]){case"d":n.setUTCDate(n.getUTCDate()+r);break;case"m":n=i.prototype.moveMonth.call(i.prototype,n,r);break;case"w":n.setUTCDate(n.getUTCDate()+7*r);break;case"y":n=i.prototype.moveYear.call(i.prototype,n,r)}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}d=n&&n.match(this.nonpunctuation)||[],n=new Date;var h,p,f,m={},g=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};v.M=v.MM=v.mm=v.m,v.dd=v.d,n=t(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var b=s.parts.slice();if(d.length!=b.length&&(b=e(b).filter(function(t,i){return-1!==e.inArray(i,g)}).toArray()),d.length==b.length){u=0;for(var y=b.length;u<y;u++){if(h=parseInt(d[u],10),f=b[u],isNaN(h))switch(f){case"MM":p=e(l[o].months).filter(function(){var e=this.slice(0,d[u].length);return e==d[u].slice(0,e.length)}),h=e.inArray(p[0],l[o].months)+1;break;case"M":p=e(l[o].monthsShort).filter(function(){var e=this.slice(0,d[u].length);return e==d[u].slice(0,e.length)}),h=e.inArray(p[0],l[o].monthsShort)+1}m[f]=h}var w;for(u=0;u<g.length;u++)(w=g[u])in m&&!isNaN(m[w])&&v[w](n,m[w])}return n},formatDate:function(t,i,n){"string"==typeof i&&(i=c.parseFormat(i));var s={d:t.getUTCDate(),D:l[n].daysShort[t.getUTCDay()],DD:l[n].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:l[n].monthsShort[t.getUTCMonth()],MM:l[n].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m;t=[];for(var o=e.extend([],i.separators),r=0,a=i.parts.length;r<=a;r++)o.length&&t.push(o.shift()),t.push(s[i.parts[r]]);return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};c.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+c.headTemplate+"<tbody></tbody>"+c.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+c.headTemplate+c.contTemplate+c.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+c.headTemplate+c.contTemplate+c.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=c,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=s,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var i=e(this);i.data("datepicker")||(t.preventDefault(),o.call(i,"show"))}),e(function(){o.call(e('[data-provide="datepicker-inline"]'))})}(window.jQuery),function(e){"use strict";e.fn.bdatepicker=e.fn.datepicker.noConflict(),e.fn.datepicker||(e.fn.datepicker=e.fn.bdatepicker);var t=function(e){this.init("date",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{initPicker:function(t,i){this.options.viewformat||(this.options.viewformat=this.options.format),t.datepicker=e.fn.editableutils.tryParseJson(t.datepicker,!0),this.options.datepicker=e.extend({},i.datepicker,t.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||"en",this.dpg=e.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,i){var n=e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"";t.superclass.value2html.call(this,n,i)},html2value:function(e){return this.parseDate(e,this.parsedViewFormat)},value2str:function(e){return e?this.dpg.formatDate(e,this.parsedFormat,this.options.datepicker.language):""},str2value:function(e){return this.parseDate(e,this.parsedFormat)},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.bdatepicker("update",e)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".day",function(t){if(!e(t.currentTarget).is(".old")&&!e(t.currentTarget).is(".new")){var i=e(this).closest("form");setTimeout(function(){i.submit()},200)}})},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datepicker.language),"string"==typeof e&&e!==this.dpg.formatDate(i,t,this.options.datepicker.language)&&(i=null)),i}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:"&times; clear"}),e.fn.editabletypes.date=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.date),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.bdatepicker("update")},this))},value2input:function(e){this.$input.val(e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):""),this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),e.fn.editabletypes.datefield=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetime",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{initPicker:function(t,i){this.options.viewformat||(this.options.viewformat=this.options.format),t.datetimepicker=e.fn.editableutils.tryParseJson(t.datetimepicker,!0),this.options.datetimepicker=e.extend({},i.datetimepicker,t.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||"en",this.dpg=e.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on("changeMode",function(t){var i=e(this).closest("form").parent();setTimeout(function(){i.triggerHandler("resize")},0)}),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,i){var n=e?this.dpg.formatDate(this.toUTC(e),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";if(!i)return n;t.superclass.value2html.call(this,n,i)},html2value:function(e){var t=this.parseDate(e,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(e){return e?this.dpg.formatDate(this.toUTC(e),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(e){var t=this.parseDate(e,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){e&&this.$input.data("datetimepicker").setDate(e)},input2value:function(){var e=this.$input.data("datetimepicker");return e.date?e.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(t){var i=e(this).closest("form");setTimeout(function(){i.submit()},200)})},toUTC:function(e){return e?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},fromUTC:function(e){return e?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datetimepicker.language,this.options.formatType),"string"==typeof e&&e!==this.dpg.formatDate(i,t,this.options.datetimepicker.language,this.options.formatType)&&(i=null)),i}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"}),e.fn.editabletypes.datetime=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetimefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.datetime),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.datetimepicker("update")},this))},value2input:function(e){this.$input.val(this.value2html(e)),this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}}),e.fn.editabletypes.datetimefield=t}(window.jQuery),function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";function e(i,n){if(!(this instanceof e))return new e(i,n);this.options=n=n?zn(n):{},zn(Xs,n,!1),h(n);var s=n.value;"string"==typeof s&&(s=new xo(s,n.mode)),this.doc=s;var o=new e.inputStyles[n.inputStyle](this),a=this.display=new t(i,s,o);a.wrapper.CodeMirror=this,l(this),r(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!_s&&a.input.focus(),g(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new Nn,keySeq:null,specialChars:null};var c=this;for(var d in gs&&11>vs&&setTimeout(function(){c.display.input.reset(!0)},20),function(e){function t(){n.activeTouch&&(s=setTimeout(function(){n.activeTouch=null},1e3),(o=n.activeTouch).end=+new Date)}function i(e,t){if(null==t.left)return!0;var i=t.left-e.left,n=t.top-e.top;return i*i+n*n>400}var n=e.display;So(n.scroller,"mousedown",pt(e,St)),So(n.scroller,"dblclick",gs&&11>vs?pt(e,function(t){if(!Mn(e,t)){var i=_t(e,t);if(i&&!$t(e,t)&&!kt(e.display,t)){To(t);var n=e.findWordAt(i);pe(e.doc,n.anchor,n.head)}}}):function(t){Mn(e,t)||To(t)}),As||So(n.scroller,"contextmenu",function(t){zt(e,t)});var s,o={end:0};So(n.scroller,"touchstart",function(e){if(!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(e)){clearTimeout(s);var t=+new Date;n.activeTouch={start:t,moved:!1,prev:t-o.end<=300?o:null},1==e.touches.length&&(n.activeTouch.left=e.touches[0].pageX,n.activeTouch.top=e.touches[0].pageY)}}),So(n.scroller,"touchmove",function(){n.activeTouch&&(n.activeTouch.moved=!0)}),So(n.scroller,"touchend",function(s){var o=n.activeTouch;if(o&&!kt(n,s)&&null!=o.left&&!o.moved&&new Date-o.start<300){var r,a=e.coordsChar(n.activeTouch,"page");r=!o.prev||i(o,o.prev)?new re(a,a):!o.prev.prev||i(o,o.prev.prev)?e.findWordAt(a):new re(Ns(a.line,0),de(e.doc,Ns(a.line+1,0))),e.setSelection(r.anchor,r.head),e.focus(),To(s)}t()}),So(n.scroller,"touchcancel",t),So(n.scroller,"scroll",function(){n.scroller.clientHeight&&(At(e,n.scroller.scrollTop),Ot(e,n.scroller.scrollLeft,!0),$o(e,"scroll",e))}),So(n.scroller,"mousewheel",function(t){Ft(e,t)}),So(n.scroller,"DOMMouseScroll",function(t){Ft(e,t)}),So(n.wrapper,"scroll",function(){n.wrapper.scrollTop=n.wrapper.scrollLeft=0}),n.dragFunctions={simple:function(t){Mn(e,t)||_o(t)},start:function(t){!function(e,t){if(gs&&(!e.state.draggingText||+new Date-js<100))return void _o(t);if(!Mn(e,t)&&!kt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!Cs)){var i=Yn("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",xs&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),xs&&i.parentNode.removeChild(i)}}(e,t)},drop:pt(e,Mt)};var r=n.input.getField();So(r,"keyup",function(t){Pt.call(e,t)}),So(r,"keydown",pt(e,It)),So(r,"keypress",pt(e,Bt)),So(r,"focus",jn(Ht,e)),So(r,"blur",jn(Ut,e))}(this),function(){qo||(So(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Jn(Tt)},100))}),So(window,"blur",function(){Jn(Ut)}),qo=!0);var e}(),ot(this),this.curOp.forceUpdate=!0,on(this,s),n.autofocus&&!_s||c.hasFocus()?setTimeout(jn(Ht,this),20):Ut(this),Qs)Qs.hasOwnProperty(d)&&Qs[d](this,n[d],Zs);x(this),n.finishInit&&n.finishInit(this);for(var u=0;u<io.length;++u)io[u](this);rt(this),bs&&n.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function t(e,t,i){var n=this;this.input=i,n.scrollbarFiller=Yn("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=Yn("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=Yn("div",null,"CodeMirror-code"),n.selectionDiv=Yn("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=Yn("div",null,"CodeMirror-cursors"),n.measure=Yn("div",null,"CodeMirror-measure"),n.lineMeasure=Yn("div",null,"CodeMirror-measure"),n.lineSpace=Yn("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=Yn("div",[Yn("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Yn("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=Yn("div",null,null,"position: absolute; height: "+Ao+"px; width: 1px;"),n.gutters=Yn("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=Yn("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Yn("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),gs&&8>vs&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),bs||ps&&_s||(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,i.init(n)}function i(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),n(t)}function n(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,$e(e,100),e.state.modeGen++,e.curOp&&bt(e)}function s(e){var t=nt(e.display),i=e.options.lineWrapping,n=i&&Math.max(5,e.display.scroller.clientWidth/st(e.display)-3);return function(s){if(Fi(e.doc,s))return 0;var o=0;if(s.widgets)for(var r=0;r<s.widgets.length;r++)s.widgets[r].height&&(o+=s.widgets[r].height);return i?o+(Math.ceil(s.text.length/n)||1)*t:o+t}}function o(e){var t=e.doc,i=s(e);t.iter(function(e){var t=i(e);t!=e.height&&cn(e,t)})}function r(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ve(e)}function a(e){l(e),bt(e),setTimeout(function(){w(e)},20)}function l(e){var t=e.display.gutters,i=e.options.gutters;qn(t);for(var n=0;n<i.length;++n){var s=i[n],o=t.appendChild(Yn("div",null,"CodeMirror-gutter "+s));"CodeMirror-linenumbers"==s&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",c(e)}function c(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function d(e){if(0==e.height)return 0;for(var t,i=e.text.length,n=e;t=Si(n);){n=(s=t.find(0,!0)).from.line,i+=s.from.ch-s.to.ch}for(n=e;t=Di(n);){var s=t.find(0,!0);i-=n.text.length-s.from.ch,i+=(n=s.to.line).text.length-s.to.ch}return i}function u(e){var t=e.display,i=e.doc;t.maxLine=rn(i,i.first),t.maxLineLength=d(t.maxLine),t.maxLineChanged=!0,i.iter(function(e){var i=d(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function h(e){var t=Pn(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function p(e){var t=e.display,i=t.gutters.offsetWidth,n=Math.round(e.doc.height+Fe(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:n,scrollHeight:n+Le(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function f(e,t,i){this.cm=i;var n=this.vert=Yn("div",[Yn("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),s=this.horiz=Yn("div",[Yn("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(n),e(s),So(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),So(s,"scroll",function(){s.clientWidth&&t(s.scrollLeft,"horizontal")}),this.checkedOverlay=!1,gs&&8>vs&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function m(){}function g(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Vo(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),So(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?Ot(t,e):At(t,e)},t),t.display.scrollbars.addClass&&Yo(t.display.wrapper,t.display.scrollbars.addClass)}function v(e,t){t||(t=p(e));var i=e.display.barWidth,n=e.display.barHeight;b(e,t);for(var s=0;4>s&&i!=e.display.barWidth||n!=e.display.barHeight;s++)i!=e.display.barWidth&&e.options.lineWrapping&&$(e),b(e,p(e)),i=e.display.barWidth,n=e.display.barHeight}function b(e,t){var i=e.display,n=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function y(e,t,i){var n=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop;n=Math.floor(n-Oe(e));var s=i&&null!=i.bottom?i.bottom:n+e.wrapper.clientHeight,o=un(t,n),r=un(t,s);if(i&&i.ensure){var a=i.ensure.from.line,l=i.ensure.to.line;o>a?(o=a,r=un(t,hn(rn(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=r&&(o=un(t,hn(rn(t,l))-e.wrapper.clientHeight),r=l)}return{from:o,to:Math.max(r,o+1)}}function w(e){var t=e.display,i=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=E(t)-t.scroller.scrollLeft+e.doc.scrollLeft,s=t.gutters.offsetWidth,o=n+"px",r=0;r<i.length;r++)if(!i[r].hidden){e.options.fixedGutter&&i[r].gutter&&(i[r].gutter.style.left=o);var a=i[r].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+s+"px")}}function x(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=C(e.options,t.first+t.size-1),n=e.display;if(i.length!=n.lineNumChars){var s=n.measure.appendChild(Yn("div",[Yn("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=s.firstChild.offsetWidth,r=s.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-r)+1,n.lineNumWidth=n.lineNumInnerWidth+r,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",c(e),!0}return!1}function C(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function E(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function T(e,t,i){var n=e.display;this.viewport=t,this.visible=y(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Re(e),this.force=i,this.dims=A(e),this.events=[]}function k(e,t){var i=e.display,n=e.doc;if(t.editorIsHidden)return wt(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==Et(e))return!1;x(e)&&(wt(e),t.dims=A(e));var s=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),r=Math.min(s,t.visible.to+e.options.viewportMargin);i.viewFrom<o&&o-i.viewFrom<20&&(o=Math.max(n.first,i.viewFrom)),i.viewTo>r&&i.viewTo-r<20&&(r=Math.min(s,i.viewTo)),Fs&&(o=Ai(e.doc,o),r=Oi(e.doc,r));var a=o!=i.viewFrom||r!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth;(function(e,t,i){var n=e.display;0==n.view.length||t>=n.viewTo||i<=n.viewFrom?(n.view=vt(e,t,i),n.viewFrom=t):(n.viewFrom>t?n.view=vt(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(xt(e,t))),n.viewFrom=t,n.viewTo<i?n.view=n.view.concat(vt(e,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,xt(e,i)))),n.viewTo=i})(e,o,r),i.viewOffset=hn(rn(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var l=Et(e);if(!a&&0==l&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var c=Xn();return l>4&&(i.lineDiv.style.display="none"),function(e,t,i){function n(t){var i=t.nextSibling;return bs&&Ss&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var s=e.display,o=e.options.lineNumbers,r=s.lineDiv,a=r.firstChild,l=s.view,c=s.viewFrom,d=0;d<l.length;d++){var u=l[d];if(u.hidden);else if(u.node&&u.node.parentNode==r){for(;a!=u.node;)a=n(a);var h=o&&null!=t&&c>=t&&u.lineNumber;u.changes&&(Pn(u.changes,"gutter")>-1&&(h=!1),O(e,u,c,i)),h&&(qn(u.lineNumber),u.lineNumber.appendChild(document.createTextNode(C(e.options,c)))),a=u.node.nextSibling}else{var p=B(e,u,c,i);r.insertBefore(p,a)}c+=u.size}for(;a;)a=n(a)}(e,i.updateLineNumbers,t.dims),l>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,c&&Xn()!=c&&c.offsetHeight&&c.focus(),qn(i.cursorDiv),qn(i.selectionDiv),i.gutters.style.height=0,a&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,$e(e,400)),i.updateLineNumbers=null,!0}function _(e,t){for(var i=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=Re(e)||(i&&null!=i.top&&(i={top:Math.min(e.doc.height+Fe(e.display)-Ie(e),i.top)}),t.visible=y(e.display,e.doc,i),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&k(e,t);n=!1){$(e);var s=p(e);Te(e),D(e,s),v(e,s)}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function S(e,t){var i=new T(e,t);if(k(e,i)){$(e),_(e,i);var n=p(e);Te(e),D(e,n),v(e,n),i.finish()}}function D(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var i=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=i+"px",e.display.gutters.style.height=Math.max(i+Le(e),t.clientHeight)+"px"}function $(e){for(var t=e.display,i=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var s,o=t.view[n];if(!o.hidden){if(gs&&8>vs){var r=o.node.offsetTop+o.node.offsetHeight;s=r-i,i=r}else{var a=o.node.getBoundingClientRect();s=a.bottom-a.top}var l=o.line.height-s;if(2>s&&(s=nt(t)),(l>.001||-.001>l)&&(cn(o.line,s),M(o.line),o.rest))for(var c=0;c<o.rest.length;c++)M(o.rest[c])}}}function M(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function A(e){for(var t=e.display,i={},n={},s=t.gutters.clientLeft,o=t.gutters.firstChild,r=0;o;o=o.nextSibling,++r)i[e.options.gutters[r]]=o.offsetLeft+o.clientLeft+s,n[e.options.gutters[r]]=o.clientWidth;return{fixedPos:E(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function O(e,t,i,n){for(var s=0;s<t.changes.length;s++){var o=t.changes[s];"text"==o?L(e,t):"gutter"==o?I(e,t,i,n):"class"==o?R(t):"widget"==o&&P(e,t,n)}t.changes=null}function F(e){return e.node==e.text&&(e.node=Yn("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),gs&&8>vs&&(e.node.style.zIndex=2)),e.node}function N(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):Yi(e,t)}function L(e,t){var i=t.text.className,n=N(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,R(t)):i&&(t.text.className=i)}function R(e){(function(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var i=F(e);e.background=i.insertBefore(Yn("div",null,t),i.firstChild)}})(e),e.line.wrapClass?F(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function I(e,t,i,n){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var s=t.line.gutterMarkers;if(e.options.lineNumbers||s){var o=F(t),r=t.gutter=Yn("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px");if(e.display.input.setUneditable(r),o.insertBefore(r,t.text),t.line.gutterClass&&(r.className+=" "+t.line.gutterClass),!e.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(t.lineNumber=r.appendChild(Yn("div",C(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),s)for(var a=0;a<e.options.gutters.length;++a){var l=e.options.gutters[a],c=s.hasOwnProperty(l)&&s[l];c&&r.appendChild(Yn("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function P(e,t,i){t.alignable&&(t.alignable=null);for(var n=t.node.firstChild;n;n=s){var s=n.nextSibling;"CodeMirror-linewidget"==n.className&&t.node.removeChild(n)}H(e,t,i)}function B(e,t,i,n){var s=N(e,t);return t.text=t.node=s.pre,s.bgClass&&(t.bgClass=s.bgClass),s.textClass&&(t.textClass=s.textClass),R(t),I(e,t,i,n),H(e,t,n),t.node}function H(e,t,i){if(U(e,t.line,t,i,!0),t.rest)for(var n=0;n<t.rest.length;n++)U(e,t.rest[n],t,i,!1)}function U(e,t,i,n,s){if(t.widgets)for(var o=F(i),r=0,a=t.widgets;r<a.length;++r){var l=a[r],c=Yn("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),z(l,c,i,n),e.display.input.setUneditable(c),s&&l.above?o.insertBefore(c,i.gutter||i.text):o.appendChild(c),Dn(l,"redraw")}}function z(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var s=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(s-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=s+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function j(e){return Ns(e.line,e.ch)}function K(e,t){return Ls(e,t)<0?t:e}function W(e,t){return Ls(e,t)<0?e:t}function V(e){e.state.focused||(e.display.input.focus(),Ht(e))}function Y(e){return e.options.readOnly||e.doc.cantEdit}function q(e,t,i,n,s){var o=e.doc;e.display.shift=!1,n||(n=o.sel);var r=Xo(t),a=null;e.state.pasteIncoming&&n.ranges.length>1&&(Rs&&Rs.join("\n")==t?a=n.ranges.length%Rs.length==0&&Bn(Rs,Xo):r.length==n.ranges.length&&(a=Bn(r,function(e){return[e]})));for(var l=n.ranges.length-1;l>=0;l--){var c=n.ranges[l],d=c.from(),u=c.to();c.empty()&&(i&&i>0?d=Ns(d.line,d.ch-i):e.state.overwrite&&!e.state.pasteIncoming&&(u=Ns(u.line,Math.min(rn(o,u.line).text.length,u.ch+In(r).length))));var h=e.curOp.updateInput,p={from:d,to:u,text:a?a[l%a.length]:r,origin:s||(e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input")};Yt(e.doc,p),Dn(e,"inputRead",e,p)}t&&!e.state.pasteIncoming&&G(e,t),ii(e),e.curOp.updateInput=h,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function G(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var i=e.doc.sel,n=i.ranges.length-1;n>=0;n--){var s=i.ranges[n];if(!(s.head.ch>100||n&&i.ranges[n-1].head.line==s.head.line)){var o=e.getModeAt(s.head),r=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){r=si(e,s.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(rn(e.doc,s.head.line).text.slice(0,s.head.ch))&&(r=si(e,s.head.line,"smart"));r&&Dn(e,"electricInput",e,s.head.line)}}}function X(e){for(var t=[],i=[],n=0;n<e.doc.sel.ranges.length;n++){var s=e.doc.sel.ranges[n].head.line,o={anchor:Ns(s,0),head:Ns(s+1,0)};i.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:i}}function Q(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function Z(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Nn,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function J(){var e=Yn("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=Yn("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return bs?e.style.width="1000px":e.setAttribute("wrap","off"),ks&&(e.style.border="1px solid black"),Q(e),t}function ee(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Nn,this.gracePeriod=!1}function te(e,t){var i=He(e,t.line);if(!i||i.hidden)return null;var n=rn(e.doc,t.line),s=Pe(i,n,t.line),o=pn(n),r="left";o&&(r=cs(o,t.ch)%2?"right":"left");var a=je(s.map,t.ch,r);return a.offset="right"==a.collapse?a.end:a.start,a}function ie(e,t){return t&&(e.bad=!0),e}function ne(e,t,i){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[i]))return ie(e.clipPos(Ns(e.display.viewTo-1)),!0);t=null,i=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var s=0;s<e.display.view.length;s++){var o=e.display.view[s];if(o.node==n)return se(o,t,i)}}function se(e,t,i){function n(t,i,n){for(var s=-1;s<(d?d.length:0);s++)for(var o=0>s?c.map:d[s],r=0;r<o.length;r+=3){var a=o[r+2];if(a==t||a==i){var l=dn(0>s?e.line:e.rest[s]),u=o[r]+n;return(0>n||a!=t)&&(u=o[r+(n?1:0)]),Ns(l,u)}}}var s=e.text.firstChild,o=!1;if(!t||!jo(s,t))return ie(Ns(dn(e.line),0),!0);if(t==s&&(o=!0,t=s.childNodes[i],i=0,!t)){var r=e.rest?In(e.rest):e.line;return ie(Ns(dn(r),r.text.length),o)}var a=3==t.nodeType?t:null,l=t;for(a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,i&&(i=a.nodeValue.length));l.parentNode!=s;)l=l.parentNode;var c=e.measure,d=c.maps,u=n(a,l,i);if(u)return ie(u,o);for(var h=l.nextSibling,p=a?a.nodeValue.length-i:0;h;h=h.nextSibling){if(u=n(h,h.firstChild,0))return ie(Ns(u.line,u.ch-p),o);p+=h.textContent.length}var f=l.previousSibling;for(p=i;f;f=f.previousSibling){if(u=n(f,f.firstChild,-1))return ie(Ns(u.line,u.ch+p),o);p+=h.textContent.length}}function oe(e,t){this.ranges=e,this.primIndex=t}function re(e,t){this.anchor=e,this.head=t}function ae(e,t){var i=e[t];e.sort(function(e,t){return Ls(e.from(),t.from())}),t=Pn(e,i);for(var n=1;n<e.length;n++){var s=e[n],o=e[n-1];if(Ls(o.to(),s.from())>=0){var r=W(o.from(),s.from()),a=K(o.to(),s.to()),l=o.empty()?s.from()==s.head:o.from()==o.head;t>=n&&--t,e.splice(--n,2,new re(l?a:r,l?r:a))}}return new oe(e,t)}function le(e,t){return new oe([new re(e,t||e)],0)}function ce(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function de(e,t){if(t.line<e.first)return Ns(e.first,0);var i=e.first+e.size-1;return t.line>i?Ns(i,rn(e,i).text.length):function(e,t){var i=e.ch;return null==i||i>t?Ns(e.line,t):0>i?Ns(e.line,0):e}(t,rn(e,t.line).text.length)}function ue(e,t){return t>=e.first&&t<e.first+e.size}function he(e,t,i,n){if(e.cm&&e.cm.display.shift||e.extend){var s=t.anchor;if(n){var o=Ls(i,s)<0;o!=Ls(n,s)<0?(s=i,i=n):o!=Ls(i,n)<0&&(i=n)}return new re(s,i)}return new re(n||i,i)}function pe(e,t,i,n){be(e,new oe([he(e,e.sel.primary(),t,i)],0),n)}function fe(e,t,i){for(var n=[],s=0;s<e.sel.ranges.length;s++)n[s]=he(e,e.sel.ranges[s],t[s],null);be(e,ae(n,e.sel.primIndex),i)}function me(e,t,i,n){var s=e.sel.ranges.slice(0);s[t]=i,be(e,ae(s,e.sel.primIndex),n)}function ge(e,t,i,n){be(e,le(t,i),n)}function ve(e,t,i){var n=e.history.done,s=In(n);s&&s.ranges?(n[n.length-1]=t,ye(e,t,i)):be(e,t,i)}function be(e,t,i){ye(e,t,i),function(e,t,i,n){var s=e.history,o=n&&n.origin;i==s.lastSelOp||o&&s.lastSelOrigin==o&&(s.lastModTime==s.lastSelTime&&s.lastOrigin==o||function(e,t,i,n){var s=t.charAt(0);return"*"==s||"+"==s&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,o,In(s.done),t))?s.done[s.done.length-1]=t:bn(t,s.done),s.lastSelTime=+new Date,s.lastSelOrigin=o,s.lastSelOp=i,n&&!1!==n.clearRedo&&gn(s.undone)}(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function ye(e,t,i){(On(e,"beforeSelectionChange")||e.cm&&On(e.cm,"beforeSelectionChange"))&&(t=function(e,t){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var i=0;i<t.length;i++)this.ranges[i]=new re(de(e,t[i].anchor),de(e,t[i].head))}};return $o(e,"beforeSelectionChange",e,i),e.cm&&$o(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?ae(i.ranges,i.ranges.length-1):t}(e,t));var n=i&&i.bias||(Ls(t.primary().head,e.sel.primary().head)<0?-1:1);we(e,Ce(e,t,n,!0)),i&&!1===i.scroll||!e.cm||ii(e.cm)}function we(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,An(e.cm)),Dn(e,"cursorActivity",e))}function xe(e){we(e,Ce(e,e.sel,null,!1))}function Ce(e,t,i,n){for(var s,o=0;o<t.ranges.length;o++){var r=t.ranges[o],a=Ee(e,r.anchor,i,n),l=Ee(e,r.head,i,n);(s||a!=r.anchor||l!=r.head)&&(s||(s=t.ranges.slice(0,o)),s[o]=new re(a,l))}return s?ae(s,t.primIndex):t}function Ee(e,t,i,n){var s=!1,o=t,r=i||1;e.cantEdit=!1;e:for(;;){var a=rn(e,o.line);if(a.markedSpans)for(var l=0;l<a.markedSpans.length;++l){var c=a.markedSpans[l],d=c.marker;if((null==c.from||(d.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(d.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(n&&($o(d,"beforeCursorEnter"),d.explicitlyCleared)){if(a.markedSpans){--l;continue}break}if(!d.atomic)continue;var u=d.find(0>r?-1:1);if(0==Ls(u,o)&&(u.ch+=r,u.ch<0?u=u.line>e.first?de(e,Ns(u.line-1)):null:u.ch>a.text.length&&(u=u.line<e.first+e.size-1?Ns(u.line+1,0):null),!u)){if(s)return n?(e.cantEdit=!0,Ns(e.first,0)):Ee(e,t,i,!0);s=!0,u=t,r=-r}o=u;continue e}}return o}}function Te(e){e.display.input.showSelection(e.display.input.prepareSelection())}function ke(e,t){for(var i=e.doc,n={},s=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),r=0;r<i.sel.ranges.length;r++)if(!1!==t||r!=i.sel.primIndex){var a=i.sel.ranges[r],l=a.empty();(l||e.options.showCursorWhenSelecting)&&_e(e,a,s),l||Se(e,a,o)}return n}function _e(e,t,i){var n=Ze(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),s=i.appendChild(Yn("div"," ","CodeMirror-cursor"));if(s.style.left=n.left+"px",s.style.top=n.top+"px",s.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var o=i.appendChild(Yn("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=n.other.left+"px",o.style.top=n.other.top+"px",o.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function Se(e,t,i){function n(e,t,i,n){0>t&&(t=0),t=Math.round(t),n=Math.round(n),a.appendChild(Yn("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==i?d-e:i)+"px; height: "+(n-t)+"px"))}function s(t,i,s){function o(i,n){return Qe(e,Ns(t,i),"div",u,n)}var a,l,u=rn(r,t),h=u.text.length;return function(e,t,i,n){if(!e)return n(t,i,"ltr");for(var s=!1,o=0;o<e.length;++o){var r=e[o];(r.from<i&&r.to>t||t==i&&r.to==t)&&(n(Math.max(r.from,t),Math.min(r.to,i),1==r.level?"rtl":"ltr"),s=!0)}s||n(t,i,"ltr")}(pn(u),i||0,null==s?h:s,function(e,t,r){var u,p,f,m=o(e,"left");if(e==t)u=m,p=f=m.left;else{if(u=o(t-1,"right"),"rtl"==r){var g=m;m=u,u=g}p=m.left,f=u.right}null==i&&0==e&&(p=c),u.top-m.top>3&&(n(p,m.top,null,m.bottom),p=c,m.bottom<u.top&&n(p,m.bottom,null,u.top)),null==s&&t==h&&(f=d),(!a||m.top<a.top||m.top==a.top&&m.left<a.left)&&(a=m),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),c+1>p&&(p=c),n(p,u.top,f-p,u.bottom)}),{start:a,end:l}}var o=e.display,r=e.doc,a=document.createDocumentFragment(),l=Ne(e.display),c=l.left,d=Math.max(o.sizerWidth,Re(e)-o.sizer.offsetLeft)-l.right,u=t.from(),h=t.to();if(u.line==h.line)s(u.line,u.ch,h.ch);else{var p=rn(r,u.line),f=rn(r,h.line),m=Mi(p)==Mi(f),g=s(u.line,u.ch,m?p.text.length+1:null).end,v=s(h.line,m?0:null,h.ch).start;m&&(g.top<v.top-2?(n(g.right,g.top,null,g.bottom),n(c,v.top,v.left,v.bottom)):n(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&n(c,g.bottom,null,v.top)}i.appendChild(a)}function De(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function $e(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,jn(Me,e))}function Me(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,n=so(t.mode,Ae(e,t.frontier)),s=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var r=o.styles,a=ji(e,o,n,!0);o.styles=a.styles;var l=o.styleClasses,c=a.classes;c?o.styleClasses=c:l&&(o.styleClasses=null);for(var d=!r||r.length!=o.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),u=0;!d&&u<r.length;++u)d=r[u]!=o.styles[u];d&&s.push(t.frontier),o.stateAfter=so(t.mode,n)}else Wi(e,o.text,n),o.stateAfter=t.frontier%5==0?so(t.mode,n):null;return++t.frontier,+new Date>i?($e(e,e.options.workDelay),!0):void 0}),s.length&&ht(e,function(){for(var t=0;t<s.length;t++)yt(e,s[t],"text")})}}function Ae(e,t,i){var n=e.doc,s=e.display;if(!n.mode.startState)return!0;var o=function(e,t,i){for(var n,s,o=e.doc,r=i?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>r;--a){if(a<=o.first)return o.first;var l=rn(o,a-1);if(l.stateAfter&&(!i||a<=o.frontier))return a;var c=Ro(l.text,null,e.options.tabSize);(null==s||n>c)&&(s=a-1,n=c)}return s}(e,t,i),r=o>n.first&&rn(n,o-1).stateAfter;return r=r?so(n.mode,r):oo(n.mode),n.iter(o,t,function(i){Wi(e,i.text,r);var a=o==t-1||o%5==0||o>=s.viewFrom&&o<s.viewTo;i.stateAfter=a?so(n.mode,r):null,++o}),i&&(n.frontier=o),r}function Oe(e){return e.lineSpace.offsetTop}function Fe(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ne(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Gn(e.measure,Yn("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function Le(e){return Ao-e.display.nativeBarWidth}function Re(e){return e.display.scroller.clientWidth-Le(e)-e.display.barWidth}function Ie(e){return e.display.scroller.clientHeight-Le(e)-e.display.barHeight}function Pe(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(n=0;n<e.rest.length;n++)if(dn(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function Be(e,t,i,n){return ze(e,Ue(e,t),i,n)}function He(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[xt(e,t)];var i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function Ue(e,t){var i=dn(t),n=He(e,i);n&&!n.text?n=null:n&&n.changes&&O(e,n,i,A(e)),n||(n=function(e,t){var i=dn(t=Mi(t)),n=e.display.externalMeasured=new gt(e.doc,t,i);n.lineN=i;var s=n.built=Yi(e,n);return n.text=s.pre,Gn(e.display.lineMeasure,s.pre),n}(e,t));var s=Pe(n,t,i);return{line:t,view:n,rect:null,map:s.map,cache:s.cache,before:s.before,hasHeights:!1}}function ze(e,t,i,n,s){t.before&&(i=-1);var o,r=i+(n||"");return t.cache.hasOwnProperty(r)?o=t.cache[r]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,i){var n=e.options.lineWrapping,s=n&&Re(e);if(!t.measure.heights||n&&t.measure.width!=s){var o=t.measure.heights=[];if(n){t.measure.width=s;for(var r=t.text.firstChild.getClientRects(),a=0;a<r.length-1;a++){var l=r[a],c=r[a+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-i.top)}}o.push(i.bottom-i.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,i,n){var s,o=je(t.map,i,n),r=o.node,a=o.start,l=o.end,c=o.collapse;if(3==r.nodeType){for(var d=0;4>d;d++){for(;a&&Vn(t.line.text.charAt(o.coverStart+a));)--a;for(;o.coverStart+l<o.coverEnd&&Vn(t.line.text.charAt(o.coverStart+l));)++l;if(gs&&9>vs&&0==a&&l==o.coverEnd-o.coverStart)s=r.parentNode.getBoundingClientRect();else if(gs&&e.options.lineWrapping){var u=Bo(r,a,l).getClientRects();s=u.length?u["right"==n?u.length-1:0]:Hs}else s=Bo(r,a,l).getBoundingClientRect()||Hs;if(s.left||s.right||0==a)break;l=a,a-=1,c="right"}gs&&11>vs&&(s=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=Jo)return Jo;var t=Gn(e,Yn("span","x")),i=t.getBoundingClientRect(),n=Bo(t,0,1).getBoundingClientRect();return Jo=Math.abs(i.left-n.left)>1}(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,s))}else{a>0&&(c=n="right"),s=e.options.lineWrapping&&(u=r.getClientRects()).length>1?u["right"==n?u.length-1:0]:r.getBoundingClientRect()}if(gs&&9>vs&&!a&&(!s||!s.left&&!s.right)){var h=r.parentNode.getClientRects()[0];s=h?{left:h.left,right:h.left+st(e.display),top:h.top,bottom:h.bottom}:Hs}for(var p=s.top-t.rect.top,f=s.bottom-t.rect.top,m=(p+f)/2,g=t.view.measure.heights,d=0;d<g.length-1&&!(m<g[d]);d++);var v=d?g[d-1]:0,b=g[d],y={left:("right"==c?s.right:s.left)-t.rect.left,right:("left"==c?s.left:s.right)-t.rect.left,top:v,bottom:b};return s.left||s.right||(y.bogus=!0),e.options.singleCursorHeightPerLine||(y.rtop=p,y.rbottom=f),y}(e,t,i,n)).bogus||(t.cache[r]=o)),{left:o.left,right:o.right,top:s?o.rtop:o.top,bottom:s?o.rbottom:o.bottom}}function je(e,t,i){for(var n,s,o,r,a=0;a<e.length;a+=3){var l=e[a],c=e[a+1];if(l>t?(s=0,o=1,r="left"):c>t?o=(s=t-l)+1:(a==e.length-3||t==c&&e[a+3]>t)&&(s=(o=c-l)-1,t>=c&&(r="right")),null!=s){if(n=e[a+2],l==c&&i==(n.insertLeft?"left":"right")&&(r=i),"left"==i&&0==s)for(;a&&e[a-2]==e[a-3]&&e[a-1].insertLeft;)n=e[2+(a-=3)],r="left";if("right"==i&&s==c-l)for(;a<e.length-3&&e[a+3]==e[a+4]&&!e[a+5].insertLeft;)n=e[(a+=3)+2],r="right";break}}return{node:n,start:s,end:o,collapse:r,coverStart:l,coverEnd:c}}function Ke(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function We(e){e.display.externalMeasure=null,qn(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Ke(e.display.view[t])}function Ve(e){We(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ye(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function qe(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Ge(e,t,i,n){if(t.widgets)for(var s=0;s<t.widgets.length;++s)if(t.widgets[s].above){var o=Ri(t.widgets[s]);i.top+=o,i.bottom+=o}if("line"==n)return i;n||(n="local");var r=hn(t);if("local"==n?r+=Oe(e.display):r-=e.display.viewOffset,"page"==n||"window"==n){var a=e.display.lineSpace.getBoundingClientRect();r+=a.top+("window"==n?0:qe());var l=a.left+("window"==n?0:Ye());i.left+=l,i.right+=l}return i.top+=r,i.bottom+=r,i}function Xe(e,t,i){if("div"==i)return t;var n=t.left,s=t.top;if("page"==i)n-=Ye(),s-=qe();else if("local"==i||!i){var o=e.display.sizer.getBoundingClientRect();n+=o.left,s+=o.top}var r=e.display.lineSpace.getBoundingClientRect();return{left:n-r.left,top:s-r.top}}function Qe(e,t,i,n,s){return n||(n=rn(e.doc,t.line)),Ge(e,n,Be(e,n,t.ch,s),i)}function Ze(e,t,i,n,s,o){function r(t,r){var a=ze(e,s,t,r?"right":"left",o);return r?a.left=a.right:a.right=a.left,Ge(e,n,a,i)}function a(e,t){var i=l[t],n=i.level%2;return e==is(i)&&t&&i.level<l[t-1].level?(e=ns(i=l[--t])-(i.level%2?0:1),n=!0):e==ns(i)&&t<l.length-1&&i.level<l[t+1].level&&(e=is(i=l[++t])-i.level%2,n=!1),n&&e==i.to&&e>i.from?r(e-1):r(e,n)}n=n||rn(e.doc,t.line),s||(s=Ue(e,n));var l=pn(n),c=t.ch;if(!l)return r(c);var d=a(c,cs(l,c));return null!=tr&&(d.other=a(c,tr)),d}function Je(e,t){var i=0;t=de(e.doc,t);e.options.lineWrapping||(i=st(e.display)*t.ch);var n=rn(e.doc,t.line),s=hn(n)+Oe(e.display);return{left:i,right:i,top:s,bottom:s+n.height}}function et(e,t,i,n){var s=Ns(e,t);return s.xRel=n,i&&(s.outside=!0),s}function tt(e,t,i){var n=e.doc;if(0>(i+=e.display.viewOffset))return et(n.first,0,!0,-1);var s=un(n,i),o=n.first+n.size-1;if(s>o)return et(n.first+n.size-1,rn(n,o).text.length,!0,1);0>t&&(t=0);for(var r=rn(n,s);;){var a=it(e,r,s,t,i),l=Di(r),c=l&&l.find(0,!0);if(!l||!(a.ch>c.from.ch||a.ch==c.from.ch&&a.xRel>0))return a;s=dn(r=c.to.line)}}function it(e,t,i,n,s){function o(n){var s=Ze(e,Ns(i,n),"line",t,c);return a=!0,r>s.bottom?s.left-l:r<s.top?s.left+l:(a=!1,s.left)}var r=s-hn(t),a=!1,l=2*e.display.wrapper.clientWidth,c=Ue(e,t),d=pn(t),u=t.text.length,h=ss(t),p=os(t),f=o(h),m=a,g=o(p),v=a;if(n>g)return et(i,p,v,1);for(;;){if(d?p==h||p==us(t,h,1):1>=p-h){for(var b=f>n||g-n>=n-f?h:p,y=n-(b==h?f:g);Vn(t.text.charAt(b));)++b;return et(i,b,b==h?m:v,-1>y?-1:y>1?1:0)}var w=Math.ceil(u/2),x=h+w;if(d){x=h;for(var C=0;w>C;++C)x=us(t,x,1)}var E=o(x);E>n?(p=x,g=E,(v=a)&&(g+=1e3),u=w):(h=x,f=E,m=a,u-=w)}}function nt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Is){Is=Yn("pre");for(var t=0;49>t;++t)Is.appendChild(document.createTextNode("x")),Is.appendChild(Yn("br"));Is.appendChild(document.createTextNode("x"))}Gn(e.measure,Is);var i=Is.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),qn(e.measure),i||1}function st(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Yn("span","xxxxxxxxxx"),i=Yn("pre",[t]);Gn(e.measure,i);var n=t.getBoundingClientRect(),s=(n.right-n.left)/10;return s>2&&(e.cachedCharWidth=s),s||10}function ot(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++zs},Us?Us.ops.push(e.curOp):e.curOp.ownsGroup=Us={ops:[e.curOp],delayedCallbacks:[]}}function rt(e){var t=e.curOp.ownsGroup;if(t)try{!function(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i]();for(var n=0;n<e.ops.length;n++){var s=e.ops[n];if(s.cursorActivityHandlers)for(;s.cursorActivityCalled<s.cursorActivityHandlers.length;)s.cursorActivityHandlers[s.cursorActivityCalled++](s.cm)}}while(i<t.length)}(t)}finally{Us=null;for(var i=0;i<t.ops.length;i++)t.ops[i].cm.curOp=null;!function(e){for(var t=e.ops,i=0;i<t.length;i++)at(t[i]);for(var i=0;i<t.length;i++)lt(t[i]);for(var i=0;i<t.length;i++)ct(t[i]);for(var i=0;i<t.length;i++)dt(t[i]);for(var i=0;i<t.length;i++)ut(t[i])}(t)}}function at(e){var t=e.cm,i=t.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Le(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Le(e)+"px",t.scrollbarsClipped=!0)})(t),e.updateMaxLine&&u(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new T(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function lt(e){e.updatedDisplay=e.mustUpdate&&k(e.cm,e.update)}function ct(e){var t=e.cm,i=t.display;e.updatedDisplay&&$(t),e.barMeasure=p(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Be(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+e.adjustWidthTo+Le(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo-Re(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=i.input.prepareSelection())}function dt(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Ot(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&D(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&v(t,e.barMeasure),e.selectionChanged&&De(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),e.focus&&e.focus==Xn()&&V(e.cm)}function ut(e){var t=e.cm,i=t.display,n=t.doc;if(e.updatedDisplay&&_(t,e.update),null==i.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null==e.scrollTop||i.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(n.scrollTop=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,e.scrollTop)),i.scrollbars.setScrollTop(n.scrollTop),i.scroller.scrollTop=n.scrollTop),null==e.scrollLeft||i.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(n.scrollLeft=Math.max(0,Math.min(i.scroller.scrollWidth-Re(t),e.scrollLeft)),i.scrollbars.setScrollLeft(n.scrollLeft),i.scroller.scrollLeft=n.scrollLeft,w(t)),e.scrollToPos){var s=function(e,t,i,n){null==n&&(n=0);for(var s=0;5>s;s++){var o=!1,r=Ze(e,t),a=i&&i!=t?Ze(e,i):r,l=ei(e,Math.min(r.left,a.left),Math.min(r.top,a.top)-n,Math.max(r.left,a.left),Math.max(r.bottom,a.bottom)+n),c=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=l.scrollTop&&(At(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(o=!0)),null!=l.scrollLeft&&(Ot(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(o=!0)),!o)break}return r}(t,de(n,e.scrollToPos.from),de(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&function(e,t){if(!Mn(e,"scrollCursorIntoView")){var i=e.display,n=i.sizer.getBoundingClientRect(),s=null;if(t.top+n.top<0?s=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(s=!1),null!=s&&!Ts){var o=Yn("div","​",null,"position: absolute; top: "+(t.top-i.viewOffset-Oe(e.display))+"px; height: "+(t.bottom-t.top+Le(e)+i.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(s),e.display.lineSpace.removeChild(o)}}}(t,s)}var o=e.maybeHiddenMarkers,r=e.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||$o(o[a],"hide");if(r)for(a=0;a<r.length;++a)r[a].lines.length&&$o(r[a],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&$o(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function ht(e,t){if(e.curOp)return t();ot(e);try{return t()}finally{rt(e)}}function pt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);ot(e);try{return t.apply(e,arguments)}finally{rt(e)}}}function ft(e){return function(){if(this.curOp)return e.apply(this,arguments);ot(this);try{return e.apply(this,arguments)}finally{rt(this)}}}function mt(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);ot(t);try{return e.apply(this,arguments)}finally{rt(t)}}}function gt(e,t,i){this.line=t,this.rest=function(e){for(var t,i;t=Di(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}(t),this.size=this.rest?dn(In(this.rest))-i+1:1,this.node=this.text=null,this.hidden=Fi(e,t)}function vt(e,t,i){for(var n,s=[],o=t;i>o;o=n){var r=new gt(e.doc,rn(e.doc,o),o);n=o+r.size,s.push(r)}return s}function bt(e,t,i,n){null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),n||(n=0);var s=e.display;if(n&&i<s.viewTo&&(null==s.updateLineNumbers||s.updateLineNumbers>t)&&(s.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=s.viewTo)Fs&&Ai(e.doc,t)<s.viewTo&&wt(e);else if(i<=s.viewFrom)Fs&&Oi(e.doc,i+n)>s.viewFrom?wt(e):(s.viewFrom+=n,s.viewTo+=n);else if(t<=s.viewFrom&&i>=s.viewTo)wt(e);else if(t<=s.viewFrom){(o=Ct(e,i,i+n,1))?(s.view=s.view.slice(o.index),s.viewFrom=o.lineN,s.viewTo+=n):wt(e)}else if(i>=s.viewTo){var o;(o=Ct(e,t,t,-1))?(s.view=s.view.slice(0,o.index),s.viewTo=o.lineN):wt(e)}else{var r=Ct(e,t,t,-1),a=Ct(e,i,i+n,1);r&&a?(s.view=s.view.slice(0,r.index).concat(vt(e,r.lineN,a.lineN)).concat(s.view.slice(a.index)),s.viewTo+=n):wt(e)}var l=s.externalMeasured;l&&(i<l.lineN?l.lineN+=n:t<l.lineN+l.size&&(s.externalMeasured=null))}function yt(e,t,i){e.curOp.viewChanged=!0;var n=e.display,s=e.display.externalMeasured;if(s&&t>=s.lineN&&t<s.lineN+s.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var o=n.view[xt(e,t)];if(null!=o.node){var r=o.changes||(o.changes=[]);-1==Pn(r,i)&&r.push(i)}}}function wt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function xt(e,t){if(t>=e.display.viewTo)return null;if(0>(t-=e.display.viewFrom))return null;for(var i=e.display.view,n=0;n<i.length;n++)if(0>(t-=i[n].size))return n}function Ct(e,t,i,n){var s,o=xt(e,t),r=e.display.view;if(!Fs||i==e.doc.first+e.doc.size)return{index:o,lineN:i};for(var a=0,l=e.display.viewFrom;o>a;a++)l+=r[a].size;if(l!=t){if(n>0){if(o==r.length-1)return null;s=l+r[o].size-t,o++}else s=l-t;t+=s,i+=s}for(;Ai(e.doc,i)!=i;){if(o==(0>n?0:r.length-1))return null;i+=n*r[o-(0>n?1:0)].size,o+=n}return{index:o,lineN:i}}function Et(e){for(var t=e.display.view,i=0,n=0;n<t.length;n++){var s=t[n];s.hidden||s.node&&!s.changes||++i}return i}function Tt(e){var t=e.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function kt(e,t){for(var i=_n(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return!0}function _t(e,t,i,n){var s=e.display;if(!i&&"true"==_n(t).getAttribute("cm-not-content"))return null;var o,r,a=s.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,r=t.clientY-a.top}catch(t){return null}var l,c=tt(e,o,r);if(n&&1==c.xRel&&(l=rn(e.doc,c.line).text).length==c.ch){var d=Ro(l,l.length,e.options.tabSize)-l.length;c=Ns(c.line,Math.max(0,Math.round((o-Ne(e.display).left)/st(e.display))-d))}return c}function St(e){var t=this,i=t.display;if(!(i.activeTouch&&i.input.supportsTouch()||Mn(t,e))){if(i.shift=e.shiftKey,kt(i,e))return void(bs||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)));if(!$t(t,e)){var n=_t(t,e);switch(window.focus(),Sn(e)){case 1:n?function(e,t,i){gs?setTimeout(jn(V,e),0):e.curOp.focus=Xn();var n,s=+new Date;Bs&&Bs.time>s-400&&0==Ls(Bs.pos,i)?n="triple":Ps&&Ps.time>s-400&&0==Ls(Ps.pos,i)?(n="double",Bs={time:s,pos:i}):(n="single",Ps={time:s,pos:i});var o,r=e.doc.sel,a=Ss?t.metaKey:t.ctrlKey;e.options.dragDrop&&Go&&!Y(e)&&"single"==n&&(o=r.contains(i))>-1&&!r.ranges[o].empty()?function(e,t,i,n){var s=e.display,o=+new Date,r=pt(e,function(a){bs&&(s.scroller.draggable=!1),e.state.draggingText=!1,Do(document,"mouseup",r),Do(s.scroller,"drop",r),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(To(a),!n&&+new Date-200<o&&pe(e.doc,i),bs||gs&&9==vs?setTimeout(function(){document.body.focus(),s.input.focus()},20):s.input.focus())});bs&&(s.scroller.draggable=!0),e.state.draggingText=r,s.scroller.dragDrop&&s.scroller.dragDrop(),So(document,"mouseup",r),So(s.scroller,"drop",r)}(e,t,i,a):function(e,t,i,n,s){function o(t){if(0!=Ls(g,t))if(g=t,"rect"==n){for(var s=[],o=e.options.tabSize,r=Ro(rn(c,i.line).text,i.ch,o),a=Ro(rn(c,t.line).text,t.ch,o),l=Math.min(r,a),p=Math.max(r,a),f=Math.min(i.line,t.line),m=Math.min(e.lastLine(),Math.max(i.line,t.line));m>=f;f++){var v=rn(c,f).text,b=Ln(v,l,o);l==p?s.push(new re(Ns(f,b),Ns(f,b))):v.length>b&&s.push(new re(Ns(f,b),Ns(f,Ln(v,p,o))))}s.length||s.push(new re(i,i)),be(c,ae(h.ranges.slice(0,u).concat(s),u),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y=d,w=y.anchor,x=t;if("single"!=n){if("double"==n)var C=e.findWordAt(t);else var C=new re(Ns(t.line,0),de(c,Ns(t.line+1,0)));Ls(C.anchor,w)>0?(x=C.head,w=W(y.from(),C.anchor)):(x=C.anchor,w=K(y.to(),C.head))}var s=h.ranges.slice(0);s[u]=new re(de(c,w),x),be(c,ae(s,u),No)}}function r(t){var i=++b,s=_t(e,t,!0,"rect"==n);if(s)if(0!=Ls(s,g)){e.curOp.focus=Xn(),o(s);var a=y(l,c);(s.line>=a.to||s.line<a.from)&&setTimeout(pt(e,function(){b==i&&r(t)}),150)}else{var d=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;d&&setTimeout(pt(e,function(){b==i&&(l.scroller.scrollTop+=d,r(t))}),50)}}function a(e){b=1/0,To(e),l.input.focus(),Do(document,"mousemove",w),Do(document,"mouseup",x),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;To(t);var d,u,h=c.sel,p=h.ranges;if(s&&!t.shiftKey?(u=c.sel.contains(i),d=u>-1?p[u]:new re(i,i)):(d=c.sel.primary(),u=c.sel.primIndex),t.altKey)n="rect",s||(d=new re(i,i)),i=_t(e,t,!0,!0),u=-1;else if("double"==n){var f=e.findWordAt(i);d=e.display.shift||c.extend?he(c,d,f.anchor,f.head):f}else if("triple"==n){var m=new re(Ns(i.line,0),de(c,Ns(i.line+1,0)));d=e.display.shift||c.extend?he(c,d,m.anchor,m.head):m}else d=he(c,d,i);s?-1==u?(u=p.length,be(c,ae(p.concat([d]),u),{scroll:!1,origin:"*mouse"})):p.length>1&&p[u].empty()&&"single"==n&&!t.shiftKey?(be(c,ae(p.slice(0,u).concat(p.slice(u+1)),0)),h=c.sel):me(c,u,d,No):(u=0,be(c,new oe([d],0),No),h=c.sel);var g=i,v=l.wrapper.getBoundingClientRect(),b=0,w=pt(e,function(e){Sn(e)?r(e):a(e)}),x=pt(e,a);So(document,"mousemove",w),So(document,"mouseup",x)}(e,t,i,n,a)}(t,e,n):_n(e)==i.scroller&&To(e);break;case 2:bs&&(t.state.lastMiddleDown=+new Date),n&&pe(t.doc,n),setTimeout(function(){i.input.focus()},20),To(e);break;case 3:As?zt(t,e):function(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Ut(e))},100)}(t)}}}}function Dt(e,t,i,n,s){try{var o=t.clientX,r=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&To(t);var a=e.display,l=a.lineDiv.getBoundingClientRect();if(r>l.bottom||!On(e,i))return kn(t);r-=l.top-a.viewOffset;for(var c=0;c<e.options.gutters.length;++c){var d=a.gutters.childNodes[c];if(d&&d.getBoundingClientRect().right>=o)return s(e,i,e,un(e.doc,r),e.options.gutters[c],t),kn(t)}}function $t(e,t){return Dt(e,t,"gutterClick",!0,Dn)}function Mt(e){var t=this;if(!Mn(t,e)&&!kt(t.display,e)){To(e),gs&&(js=+new Date);var i=_t(t,e,!0),n=e.dataTransfer.files;if(i&&!Y(t))if(n&&n.length&&window.FileReader&&window.File)for(var s=n.length,o=Array(s),r=0,a=function(e,n){var a=new FileReader;a.onload=pt(t,function(){if(o[n]=a.result,++r==s){var e={from:i=de(t.doc,i),to:i,text:Xo(o.join("\n")),origin:"paste"};Yt(t.doc,e),ve(t.doc,le(i,Gs(e)))}}),a.readAsText(e)},l=0;s>l;++l)a(n[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{if(o=e.dataTransfer.getData("Text")){if(t.state.draggingText&&!(Ss?e.altKey:e.ctrlKey))var c=t.listSelections();if(ye(t.doc,le(i,i)),c)for(l=0;l<c.length;++l)Jt(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(o,"around","paste"),t.display.input.focus()}}catch(e){}}}}function At(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,ps||S(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),ps&&S(e),$e(e,100))}function Ot(e,t,i){(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,w(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Ft(e,t){var i=Vs(t),n=i.x,s=i.y,o=e.display,r=o.scroller;if(n&&r.scrollWidth>r.clientWidth||s&&r.scrollHeight>r.clientHeight){if(s&&Ss&&bs)e:for(var a=t.target,l=o.view;a!=r;a=a.parentNode)for(var c=0;c<l.length;c++)if(l[c].node==a){e.display.currentWheelTarget=a;break e}if(n&&!ps&&!xs&&null!=Ws)return s&&At(e,Math.max(0,Math.min(r.scrollTop+s*Ws,r.scrollHeight-r.clientHeight))),Ot(e,Math.max(0,Math.min(r.scrollLeft+n*Ws,r.scrollWidth-r.clientWidth))),To(t),void(o.wheelStartX=null);if(s&&null!=Ws){var d=s*Ws,u=e.doc.scrollTop,h=u+o.wrapper.clientHeight;0>d?u=Math.max(0,u+d-50):h=Math.min(e.doc.height,h+d+50),S(e,{top:u,bottom:h})}20>Ks&&(null==o.wheelStartX?(o.wheelStartX=r.scrollLeft,o.wheelStartY=r.scrollTop,o.wheelDX=n,o.wheelDY=s,setTimeout(function(){if(null!=o.wheelStartX){var e=r.scrollLeft-o.wheelStartX,t=r.scrollTop-o.wheelStartY,i=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,i&&(Ws=(Ws*Ks+i)/(Ks+1),++Ks)}},200)):(o.wheelDX+=n,o.wheelDY+=s))}}function Nt(e,t,i){if("string"==typeof t&&!(t=ro[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,s=!1;try{Y(e)&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),s=t(e)!=Oo}finally{e.display.shift=n,e.state.suppressEdits=!1}return s}function Lt(e,t,i,n){var s=e.state.keySeq;if(s){if(co(t))return"handled";Ys.set(50,function(){e.state.keySeq==s&&(e.state.keySeq=null,e.display.input.reset())}),t=s+" "+t}var o=function(e,t,i){for(var n=0;n<e.state.keyMaps.length;n++){var s=lo(t,e.state.keyMaps[n],i,e);if(s)return s}return e.options.extraKeys&&lo(t,e.options.extraKeys,i,e)||lo(t,e.options.keyMap,i,e)}(e,t,n);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&Dn(e,"keyHandled",e,t,i),("handled"==o||"multi"==o)&&(To(i),De(e)),s&&!o&&/\'$/.test(t)?(To(i),!0):!!o}function Rt(e,t){var i=uo(t,!0);return!!i&&(t.shiftKey&&!e.state.keySeq?Lt(e,"Shift-"+i,t,function(t){return Nt(e,t,!0)})||Lt(e,i,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?Nt(e,t):void 0}):Lt(e,i,t,function(t){return Nt(e,t)}))}function It(e){var t=this;if(t.curOp.focus=Xn(),!Mn(t,e)){gs&&11>vs&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var n=Rt(t,e);xs&&(qs=n?i:null,!n&&88==i&&!Zo&&(Ss?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){function t(e){18!=e.keyCode&&e.altKey||(Vo(i,"CodeMirror-crosshair"),Do(document,"keyup",t),Do(document,"mouseover",t))}var i=e.display.lineDiv;Yo(i,"CodeMirror-crosshair"),So(document,"keyup",t),So(document,"mouseover",t)}(t)}}function Pt(e){16==e.keyCode&&(this.doc.sel.shift=!1),Mn(this,e)}function Bt(e){var t=this;if(!(kt(t.display,e)||Mn(t,e)||e.ctrlKey&&!e.altKey||Ss&&e.metaKey)){var i=e.keyCode,n=e.charCode;if(xs&&i==qs)return qs=null,void To(e);if(!xs||e.which&&!(e.which<10)||!Rt(t,e))(function(e,t,i){return Lt(e,"'"+i+"'",t,function(t){return Nt(e,t,!0)})})(t,e,String.fromCharCode(null==n?i:n))||t.display.input.onKeyPress(e)}}function Ht(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||($o(e,"focus",e),e.state.focused=!0,Yo(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),bs&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),De(e))}function Ut(e){e.state.delayingBlurEvent||(e.state.focused&&($o(e,"blur",e),e.state.focused=!1,Vo(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function zt(e,t){kt(e.display,t)||function(e,t){return!!On(e,"gutterContextMenu")&&Dt(e,t,"gutterContextMenu",!1,$o)}(e,t)||e.display.input.onContextMenu(t)}function jt(e,t){if(Ls(e,t.from)<0)return e;if(Ls(e,t.to)<=0)return Gs(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=Gs(t).ch-t.to.ch),Ns(i,n)}function Kt(e,t){for(var i=[],n=0;n<e.sel.ranges.length;n++){var s=e.sel.ranges[n];i.push(new re(jt(s.anchor,t),jt(s.head,t)))}return ae(i,e.sel.primIndex)}function Wt(e,t,i){return e.line==t.line?Ns(i.line,e.ch-t.ch+i.ch):Ns(i.line+(e.line-t.line),e.ch)}function Vt(e,t,i){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(t,i,n,s){t&&(this.from=de(e,t)),i&&(this.to=de(e,i)),n&&(this.text=n),void 0!==s&&(this.origin=s)}),$o(e,"beforeChange",e,n),e.cm&&$o(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Yt(e,t,i){if(e.cm){if(!e.cm.curOp)return pt(e.cm,Yt)(e,t,i);if(e.cm.state.suppressEdits)return}if(!(On(e,"beforeChange")||e.cm&&On(e.cm,"beforeChange"))||(t=Vt(e,t,!0))){var n=Os&&!i&&function(e,t,i){var n=null;if(e.iter(t.line,i.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var i=e.markedSpans[t].marker;!i.readOnly||n&&-1!=Pn(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var s=[{from:t,to:i}],o=0;o<n.length;++o)for(var r=n[o],a=r.find(0),l=0;l<s.length;++l){var c=s[l];if(!(Ls(c.to,a.from)<0||Ls(c.from,a.to)>0)){var d=[l,1],u=Ls(c.from,a.from),h=Ls(c.to,a.to);(0>u||!r.inclusiveLeft&&!u)&&d.push({from:c.from,to:a.from}),(h>0||!r.inclusiveRight&&!h)&&d.push({from:a.to,to:c.to}),s.splice.apply(s,d),l+=d.length-1}}return s}(e,t.from,t.to);if(n)for(var s=n.length-1;s>=0;--s)qt(e,{from:n[s].from,to:n[s].to,text:s?[""]:t.text});else qt(e,t)}}function qt(e,t){if(1!=t.text.length||""!=t.text[0]||0!=Ls(t.from,t.to)){var i=Kt(e,t);vn(e,t,i,e.cm?e.cm.curOp.id:NaN),Qt(e,t,i,bi(e,t));var n=[];sn(e,function(e,i){i||-1!=Pn(n,e.history)||(Tn(e.history,t),n.push(e.history)),Qt(e,t,null,bi(e,t))})}}function Gt(e,t,i){if(!e.cm||!e.cm.state.suppressEdits){for(var n,s=e.history,o=e.sel,r="undo"==t?s.done:s.undone,a="undo"==t?s.undone:s.done,l=0;l<r.length&&(n=r[l],i?!n.ranges||n.equals(e.sel):n.ranges);l++);if(l!=r.length){for(s.lastOrigin=s.lastSelOrigin=null;(n=r.pop()).ranges;){if(bn(n,a),i&&!n.equals(e.sel))return void be(e,n,{clearRedo:!1});o=n}var c=[];bn(o,a),a.push({changes:c,generation:s.generation}),s.generation=n.generation||++s.maxGeneration;var d=On(e,"beforeChange")||e.cm&&On(e.cm,"beforeChange");for(l=n.changes.length-1;l>=0;--l){var u=n.changes[l];if(u.origin=t,d&&!Vt(e,u,!1))return void(r.length=0);c.push(mn(e,u));var h=l?Kt(e,u):In(r);Qt(e,u,h,wi(e,u)),!l&&e.cm&&e.cm.scrollIntoView({from:u.from,to:Gs(u)});var p=[];sn(e,function(e,t){t||-1!=Pn(p,e.history)||(Tn(e.history,u),p.push(e.history)),Qt(e,u,null,wi(e,u))})}}}}function Xt(e,t){if(0!=t&&(e.first+=t,e.sel=new oe(Bn(e.sel.ranges,function(e){return new re(Ns(e.anchor.line+t,e.anchor.ch),Ns(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){bt(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,n=i.viewFrom;n<i.viewTo;n++)yt(e.cm,n,"gutter")}}function Qt(e,t,i,n){if(e.cm&&!e.cm.curOp)return pt(e.cm,Qt)(e,t,i,n);if(t.to.line<e.first)Xt(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var s=t.text.length-1-(e.first-t.from.line);Xt(e,s),t={from:Ns(e.first,0),to:Ns(t.to.line+s,t.to.ch),text:[In(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Ns(o,rn(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=an(e,t.from,t.to),i||(i=Kt(e,t)),e.cm?Zt(e.cm,t,n):en(e,t,n),ye(e,i,Fo)}}function Zt(e,t,i){var n=e.doc,o=e.display,r=t.from,a=t.to,l=!1,c=r.line;e.options.lineWrapping||(c=dn(Mi(rn(n,r.line))),n.iter(c,a.line+1,function(e){return e==o.maxLine?(l=!0,!0):void 0})),n.sel.contains(t.from,t.to)>-1&&An(e),en(n,t,i,s(e)),e.options.lineWrapping||(n.iter(c,r.line+t.text.length,function(e){var t=d(e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,r.line),$e(e,400);var u=t.text.length-(a.line-r.line)-1;t.full?bt(e):r.line!=a.line||1!=t.text.length||Ji(e.doc,t)?bt(e,r.line,a.line+1,u):yt(e,r.line,"text");var h=On(e,"changes"),p=On(e,"change");if(p||h){var f={from:r,to:a,text:t.text,removed:t.removed,origin:t.origin};p&&Dn(e,"change",e,f),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function Jt(e,t,i,n,s){if(n||(n=i),Ls(n,i)<0){var o=n;n=i,i=o}"string"==typeof t&&(t=Xo(t)),Yt(e,{from:i,to:n,text:t,origin:s})}function ei(e,t,i,n,s){var o=e.display,r=nt(e.display);0>i&&(i=0);var a=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=Ie(e),c={};s-i>l&&(s=i+l);var d=e.doc.height+Fe(o),u=r>i,h=s>d-r;if(a>i)c.scrollTop=u?0:i;else if(s>a+l){var p=Math.min(i,(h?d:s)-l);p!=a&&(c.scrollTop=p)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,m=Re(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),g=n-t>m;return g&&(n=t+m),10>t?c.scrollLeft=0:f>t?c.scrollLeft=Math.max(0,t-(g?0:10)):n>m+f-3&&(c.scrollLeft=n+(g?0:10)-m),c}function ti(e,t,i){(null!=t||null!=i)&&ni(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=i&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+i)}function ii(e){ni(e);var t=e.getCursor(),i=t,n=t;e.options.lineWrapping||(i=t.ch?Ns(t.line,t.ch-1):t,n=Ns(t.line,t.ch+1)),e.curOp.scrollToPos={from:i,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function ni(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=Je(e,t.from),n=Je(e,t.to),s=ei(e,Math.min(i.left,n.left),Math.min(i.top,n.top)-t.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+t.margin);e.scrollTo(s.scrollLeft,s.scrollTop)}}function si(e,t,i,n){var s,o=e.doc;null==i&&(i="add"),"smart"==i&&(o.mode.indent?s=Ae(e,t):i="prev");var r=e.options.tabSize,a=rn(o,t),l=Ro(a.text,null,r);a.stateAfter&&(a.stateAfter=null);var c,d=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==i&&((c=o.mode.indent(s,a.text.slice(d.length),a.text))==Oo||c>150)){if(!n)return;i="prev"}}else c=0,i="not";"prev"==i?c=t>o.first?Ro(rn(o,t-1).text,null,r):0:"add"==i?c=l+e.options.indentUnit:"subtract"==i?c=l-e.options.indentUnit:"number"==typeof i&&(c=l+i),c=Math.max(0,c);var u="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(c/r);p;--p)h+=r,u+="\t";if(c>h&&(u+=Rn(c-h)),u!=d)return Jt(o,u,Ns(t,0),Ns(t,d.length),"+input"),a.stateAfter=null,!0;for(p=0;p<o.sel.ranges.length;p++){var f=o.sel.ranges[p];if(f.head.line==t&&f.head.ch<d.length){me(o,p,new re(h=Ns(t,d.length),h));break}}}function oi(e,t,i,n){var s=t,o=t;return"number"==typeof t?o=rn(e,ce(e,t)):s=dn(t),null==s?null:(n(o,s)&&e.cm&&yt(e.cm,s,i),o)}function ri(e,t){for(var i=e.doc.sel.ranges,n=[],s=0;s<i.length;s++){for(var o=t(i[s]);n.length&&Ls(o.from,In(n).to)<=0;){var r=n.pop();if(Ls(r.from,o.from)<0){o.from=r.from;break}}n.push(o)}ht(e,function(){for(var t=n.length-1;t>=0;t--)Jt(e.doc,"",n[t].from,n[t].to,"+delete");ii(e)})}function ai(e,t,i,n,s){function o(){var t=a+i;return t<e.first||t>=e.first+e.size?u=!1:(a=t,d=rn(e,t))}function r(e){var t=(s?us:hs)(d,l,i,!0);if(null==t){if(e||!o())return u=!1;l=s?(0>i?os:ss)(d):0>i?d.text.length:0}else l=t;return!0}var a=t.line,l=t.ch,c=i,d=rn(e,a),u=!0;if("char"==n)r();else if("column"==n)r(!0);else if("word"==n||"group"==n)for(var h=null,p="group"==n,f=e.cm&&e.cm.getHelper(t,"wordChars"),m=!0;!(0>i)||r(!m);m=!1){var g=d.text.charAt(l)||"\n",v=Kn(g,f)?"w":p&&"\n"==g?"n":!p||/\s/.test(g)?null:"p";if(!p||m||v||(v="s"),h&&h!=v){0>i&&(i=1,r());break}if(v&&(h=v),i>0&&!r(!m))break}var b=Ee(e,Ns(a,l),c,!0);return u||(b.hitSide=!0),b}function li(e,t,i,n){var s,o=e.doc,r=t.left;if("page"==n){var a=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);s=t.top+i*(a-(0>i?1.5:.5)*nt(e.display))}else"line"==n&&(s=i>0?t.bottom+3:t.top-3);for(;;){var l=tt(e,r,s);if(!l.outside)break;if(0>i?0>=s:s>=o.height){l.hitSide=!0;break}s+=5*i}return l}function ci(t,i,n,s){e.defaults[t]=i,n&&(Qs[t]=s?function(e,t,i){i!=Zs&&n(e,t,i)}:n)}function di(e){for(var t,i,n,s,o=e.split(/-(?!$)/),r=(e=o[o.length-1],0);r<o.length-1;r++){var a=o[r];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else{if(!/^s(hift)$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),s&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function ui(e){return"string"==typeof e?ao[e]:e}function hi(e,t,i,n,s){if(n&&n.shared)return function(e,t,i,n,s){(n=zn(n)).shared=!1;var o=[hi(e,t,i,n,s)],r=o[0],a=n.widgetNode;return sn(e,function(e){a&&(n.widgetNode=a.cloneNode(!0)),o.push(hi(e,de(e,t),de(e,i),n,s));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;r=In(o)}),new mo(o,r)}(e,t,i,n,s);if(e.cm&&!e.cm.curOp)return pt(e.cm,hi)(e,t,i,n,s);var o=new fo(e,s),r=Ls(t,i);if(n&&zn(n,o,!1),r>0||0==r&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=Yn("span",[o.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if($i(e,t.line,t,i,o)||t.line!=i.line&&$i(e,i.line,t,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Fs=!0}o.addToHistory&&vn(e,{from:t,to:i,origin:"markText"},e.sel,NaN);var a,l=t.line,c=e.cm;if(e.iter(l,i.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&Mi(e)==c.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&cn(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new mi(o,l==t.line?t.ch:null,l==i.line?i.ch:null)),++l}),o.collapsed&&e.iter(t.line,i.line+1,function(t){Fi(e,t)&&cn(t,0)}),o.clearOnEnter&&So(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(Os=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++po,o.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),o.collapsed)bt(c,t.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var d=t.line;d<=i.line;d++)yt(c,d,"text");o.atomic&&xe(c.doc),Dn(c,"markerAdded",c,o)}return o}function pi(e){return e.findMarks(Ns(e.first,0),e.clipPos(Ns(e.lastLine())),function(e){return e.parent})}function fi(e){for(var t=0;t<e.length;t++){var i=e[t],n=[i.primary.doc];sn(i.primary.doc,function(e){n.push(e)});for(var s=0;s<i.markers.length;s++){var o=i.markers[s];-1==Pn(n,o.doc)&&(o.parent=null,i.markers.splice(s--,1))}}}function mi(e,t,i){this.marker=e,this.from=t,this.to=i}function gi(e,t){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(n.marker==t)return n}}function vi(e,t){for(var i,n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i}function bi(e,t){if(t.full)return null;var i=ue(e,t.from.line)&&rn(e,t.from.line).markedSpans,n=ue(e,t.to.line)&&rn(e,t.to.line).markedSpans;if(!i&&!n)return null;var s=t.from.ch,o=t.to.ch,r=0==Ls(t.from,t.to),a=function(e,t,i){if(e)for(var n,s=0;s<e.length;++s){var o=e[s],r=o.marker;if(null==o.from||(r.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==r.type&&(!i||!o.marker.insertLeft)){var a=null==o.to||(r.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new mi(r,o.from,a?null:o.to))}}return n}(i,s,r),l=function(e,t,i){if(e)for(var n,s=0;s<e.length;++s){var o=e[s],r=o.marker;if(null==o.to||(r.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==r.type&&(!i||o.marker.insertLeft)){var a=null==o.from||(r.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new mi(r,a?null:o.from-t,null==o.to?null:o.to-t))}}return n}(n,o,r),c=1==t.text.length,d=In(t.text).length+(c?s:0);if(a)for(var u=0;u<a.length;++u){if(null==(h=a[u]).to)(p=gi(l,h.marker))?c&&(h.to=null==p.to?null:p.to+d):h.to=s}if(l)for(u=0;u<l.length;++u){var h,p;if(null!=(h=l[u]).to&&(h.to+=d),null==h.from)(p=gi(a,h.marker))||(h.from=d,c&&(a||(a=[])).push(h));else h.from+=d,c&&(a||(a=[])).push(h)}a&&(a=yi(a)),l&&l!=a&&(l=yi(l));var f=[a];if(!c){var m,g=t.text.length-2;if(g>0&&a)for(u=0;u<a.length;++u)null==a[u].to&&(m||(m=[])).push(new mi(a[u].marker,null,null));for(u=0;g>u;++u)f.push(m);f.push(l)}return f}function yi(e){for(var t=0;t<e.length;++t){var i=e[t];null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function wi(e,t){var i=function(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var n=0,s=[];n<t.text.length;++n)s.push(wn(i[n]));return s}(e,t),n=bi(e,t);if(!i)return n;if(!n)return i;for(var s=0;s<i.length;++s){var o=i[s],r=n[s];if(o&&r)e:for(var a=0;a<r.length;++a){for(var l=r[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else r&&(i[s]=r)}return i}function xi(e){var t=e.markedSpans;if(t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function Ci(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Ei(e){return e.inclusiveLeft?-1:0}function Ti(e){return e.inclusiveRight?1:0}function ki(e,t){var i=e.lines.length-t.lines.length;if(0!=i)return i;var n=e.find(),s=t.find(),o=Ls(n.from,s.from)||Ei(e)-Ei(t);if(o)return-o;var r=Ls(n.to,s.to)||Ti(e)-Ti(t);return r||t.id-e.id}function _i(e,t){var i,n=Fs&&e.markedSpans;if(n)for(var s,o=0;o<n.length;++o)(s=n[o]).marker.collapsed&&null==(t?s.from:s.to)&&(!i||ki(i,s.marker)<0)&&(i=s.marker);return i}function Si(e){return _i(e,!0)}function Di(e){return _i(e,!1)}function $i(e,t,i,n,s){var o=rn(e,t),r=Fs&&o.markedSpans;if(r)for(var a=0;a<r.length;++a){var l=r[a];if(l.marker.collapsed){var c=l.marker.find(0),d=Ls(c.from,i)||Ei(l.marker)-Ei(s),u=Ls(c.to,n)||Ti(l.marker)-Ti(s);if(!(d>=0&&0>=u||0>=d&&u>=0)&&(0>=d&&(Ls(c.to,i)>0||l.marker.inclusiveRight&&s.inclusiveLeft)||d>=0&&(Ls(c.from,n)<0||l.marker.inclusiveLeft&&s.inclusiveRight)))return!0}}}function Mi(e){for(var t;t=Si(e);)e=t.find(-1,!0).line;return e}function Ai(e,t){var i=rn(e,t),n=Mi(i);return i==n?t:dn(n)}function Oi(e,t){if(t>e.lastLine())return t;var i,n=rn(e,t);if(!Fi(e,n))return t;for(;i=Di(n);)n=i.find(1,!0).line;return dn(n)+1}function Fi(e,t){var i=Fs&&t.markedSpans;if(i)for(var n,s=0;s<i.length;++s)if((n=i[s]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Ni(e,t,n))return!0}}function Ni(e,t,i){if(null==i.to){var n=i.marker.find(1,!0);return Ni(e,n.line,gi(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var s,o=0;o<t.markedSpans.length;++o)if((s=t.markedSpans[o]).marker.collapsed&&!s.marker.widgetNode&&s.from==i.to&&(null==s.to||s.to!=i.from)&&(s.marker.inclusiveLeft||i.marker.inclusiveRight)&&Ni(e,t,s))return!0}function Li(e,t,i){hn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ti(e,null,i)}function Ri(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!jo(document.body,e.node)){var i="position: relative;";e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),Gn(t.display.measure,Yn("div",[e.node],null,i))}return e.height=e.node.offsetHeight}function Ii(e){e.parent=null,xi(e)}function Pi(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function Bi(t,i){if(t.blankLine)return t.blankLine(i);if(t.innerMode){var n=e.innerMode(t,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function Hi(t,i,n,s){for(var o=0;10>o;o++){s&&(s[0]=e.innerMode(t,n).mode);var r=t.token(i,n);if(i.pos>i.start)return r}throw new Error("Mode "+t.name+" failed to advance stream.")}function Ui(e,t,i,n){function s(e){return{start:u.start,end:u.pos,string:u.current(),type:o||null,state:e?so(r.mode,d):d}}var o,r=e.doc,a=r.mode;t=de(r,t);var l,c=rn(r,t.line),d=Ae(e,t.line,i),u=new ho(c.text,e.options.tabSize);for(n&&(l=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,o=Hi(a,u,d),n&&l.push(s(!0));return n?l:s()}function zi(e,t,i,n,s,o,r){var a=i.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,c=0,d=null,u=new ho(t,e.options.tabSize),h=e.options.addModeClass&&[null];for(""==t&&Pi(Bi(i,n),o);!u.eol();){if(u.pos>e.options.maxHighlightLength?(a=!1,r&&Wi(e,t,n,u.pos),u.pos=t.length,l=null):l=Pi(Hi(i,u,n,h),o),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||d!=l){for(;c<u.start;)s(c=Math.min(u.start,c+5e4),d);d=l}u.start=u.pos}for(;c<u.pos;){var f=Math.min(u.pos,c+5e4);s(f,d),c=f}}function ji(e,t,i,n){var s=[e.state.modeGen],o={};zi(e,t.text,e.doc.mode,i,function(e,t){s.push(e,t)},o,n);for(var r=0;r<e.state.overlays.length;++r){var a=e.state.overlays[r],l=1,c=0;zi(e,t.text,a.mode,!0,function(e,t){for(var i=l;e>c;){var n=s[l];n>e&&s.splice(l,1,e,s[l+1],n),l+=2,c=Math.min(e,n)}if(t)if(a.opaque)s.splice(i,l-i,e,"cm-overlay "+t),l=i+2;else for(;l>i;i+=2){var o=s[i+1];s[i+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:s,classes:o.bgClass||o.textClass?o:null}}function Ki(e,t,i){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=ji(e,t,t.stateAfter=Ae(e,dn(t)));t.styles=n.styles,n.classes?t.styleClasses=n.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.frontier&&e.doc.frontier++}return t.styles}function Wi(e,t,i,n){var s=e.doc.mode,o=new ho(t,e.options.tabSize);for(o.start=o.pos=n||0,""==t&&Bi(s,i);!o.eol()&&o.pos<=e.options.maxHighlightLength;)Hi(s,o,i),o.start=o.pos}function Vi(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?yo:bo;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function Yi(e,t){var i=Yn("span",null,null,bs?"padding-right: .1px":null),n={pre:Yn("pre",[i]),content:i,col:0,pos:0,cm:e,splitSpaces:(gs||bs)&&e.getOption("lineWrapping")};t.measure={};for(var s=0;s<=(t.rest?t.rest.length:0);s++){var o,r=s?t.rest[s-1]:t.line;n.pos=0,n.addToken=qi,ts(e.display.measure)&&(o=pn(r))&&(n.addToken=Xi(n.addToken,o)),n.map=[],Zi(r,n,Ki(e,r,t!=e.display.externalMeasured&&dn(r))),r.styleClasses&&(r.styleClasses.bgClass&&(n.bgClass=Zn(r.styleClasses.bgClass,n.bgClass||"")),r.styleClasses.textClass&&(n.textClass=Zn(r.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(es(e.display.measure))),0==s?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return bs&&/\bcm-tab\b/.test(n.content.lastChild.className)&&(n.content.className="cm-tab-wrap-hack"),$o(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Zn(n.pre.className,n.textClass||"")),n}function qi(e,t,i,n,s,o,r){if(t){var a=e.splitSpaces?t.replace(/ {3,}/g,Gi):t,l=e.cm.state.specialChars,c=!1;if(l.test(t))for(var d=document.createDocumentFragment(),u=0;;){l.lastIndex=u;var h=l.exec(t),p=h?h.index-u:t.length-u;if(p){var f=document.createTextNode(a.slice(u,u+p));d.appendChild(gs&&9>vs?Yn("span",[f]):f),e.map.push(e.pos,e.pos+p,f),e.col+=p,e.pos+=p}if(!h)break;if(u+=p+1,"\t"==h[0]){var m=e.cm.options.tabSize,g=m-e.col%m;(f=d.appendChild(Yn("span",Rn(g),"cm-tab"))).setAttribute("role","presentation"),f.setAttribute("cm-text","\t"),e.col+=g}else{(f=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),d.appendChild(gs&&9>vs?Yn("span",[f]):f),e.col+=1}e.map.push(e.pos,e.pos+1,f),e.pos++}else{e.col+=t.length;d=document.createTextNode(a);e.map.push(e.pos,e.pos+t.length,d),gs&&9>vs&&(c=!0),e.pos+=t.length}if(i||n||s||c||r){var v=i||"";n&&(v+=n),s&&(v+=s);var b=Yn("span",[d],v,r);return o&&(b.title=o),e.content.appendChild(b)}e.content.appendChild(d)}}function Gi(e){for(var t=" ",i=0;i<e.length-2;++i)t+=i%2?" ":" ";return t+" "}function Xi(e,t){return function(i,n,s,o,r,a,l){s=s?s+" cm-force-border":"cm-force-border";for(var c=i.pos,d=c+n.length;;){for(var u=0;u<t.length;u++){var h=t[u];if(h.to>c&&h.from<=c)break}if(h.to>=d)return e(i,n,s,o,r,a,l);e(i,n.slice(0,h.to-c),s,o,null,a,l),o=null,n=n.slice(h.to-c),c=h.to}}}function Qi(e,t,i,n){var s=!n&&i.widgetNode;s&&e.map.push(e.pos,e.pos+t,s),!n&&e.cm.display.input.needsContentAttribute&&(s||(s=e.content.appendChild(document.createElement("span"))),s.setAttribute("cm-marker",i.id)),s&&(e.cm.display.input.setUneditable(s),e.content.appendChild(s)),e.pos+=t}function Zi(e,t,i){var n=e.markedSpans,s=e.text,o=0;if(n)for(var r,a,l,c,d,u,h,p=s.length,f=0,m=1,g="",v=0;;){if(v==f){l=c=d=u=a="",h=null,v=1/0;for(var b=[],y=0;y<n.length;++y){var w=n[y],x=w.marker;"bookmark"==x.type&&w.from==f&&x.widgetNode?b.push(x):w.from<=f&&(null==w.to||w.to>f||x.collapsed&&w.to==f&&w.from==f)?(null!=w.to&&w.to!=f&&v>w.to&&(v=w.to,c=""),x.className&&(l+=" "+x.className),x.css&&(a=x.css),x.startStyle&&w.from==f&&(d+=" "+x.startStyle),x.endStyle&&w.to==v&&(c+=" "+x.endStyle),x.title&&!u&&(u=x.title),x.collapsed&&(!h||ki(h.marker,x)<0)&&(h=w)):w.from>f&&v>w.from&&(v=w.from)}if(h&&(h.from||0)==f){if(Qi(t,(null==h.to?p+1:h.to)-f,h.marker,null==h.from),null==h.to)return;h.to==f&&(h=!1)}if(!h&&b.length)for(y=0;y<b.length;++y)Qi(t,0,b[y])}if(f>=p)break;for(var C=Math.min(p,v);;){if(g){var E=f+g.length;if(!h){var T=E>C?g.slice(0,C-f):g;t.addToken(t,T,r?r+l:l,d,f+T.length==v?c:"",u,a)}if(E>=C){g=g.slice(C-f),f=C;break}f=E,d=""}g=s.slice(o,o=i[m++]),r=Vi(i[m++],t.cm.options)}}else for(m=1;m<i.length;m+=2)t.addToken(t,s.slice(o,o=i[m]),Vi(i[m+1],t.cm.options))}function Ji(e,t){return 0==t.from.ch&&0==t.to.ch&&""==In(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function en(e,t,i,n){function s(e){return i?i[e]:null}function o(e,i,s){(function(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),xi(e),Ci(e,i);var s=n?n(e):1;s!=e.height&&cn(e,s)})(e,i,s,n),Dn(e,"change",e,t)}function r(e,t){for(var i=e,o=[];t>i;++i)o.push(new vo(c[i],s(i),n));return o}var a=t.from,l=t.to,c=t.text,d=rn(e,a.line),u=rn(e,l.line),h=In(c),p=s(c.length-1),f=l.line-a.line;if(t.full)e.insert(0,r(0,c.length)),e.remove(c.length,e.size-c.length);else if(Ji(e,t)){var m=r(0,c.length-1);o(u,u.text,p),f&&e.remove(a.line,f),m.length&&e.insert(a.line,m)}else if(d==u)if(1==c.length)o(d,d.text.slice(0,a.ch)+h+d.text.slice(l.ch),p);else{(m=r(1,c.length-1)).push(new vo(h+d.text.slice(l.ch),p,n)),o(d,d.text.slice(0,a.ch)+c[0],s(0)),e.insert(a.line+1,m)}else if(1==c.length)o(d,d.text.slice(0,a.ch)+c[0]+u.text.slice(l.ch),s(0)),e.remove(a.line+1,f);else{o(d,d.text.slice(0,a.ch)+c[0],s(0)),o(u,h+u.text.slice(l.ch),p);m=r(1,c.length-1);f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,m)}Dn(e,"change",e,t)}function tn(e){this.lines=e,this.parent=null;for(var t=0,i=0;t<e.length;++t)e[t].parent=this,i+=e[t].height;this.height=i}function nn(e){this.children=e;for(var t=0,i=0,n=0;n<e.length;++n){var s=e[n];t+=s.chunkSize(),i+=s.height,s.parent=this}this.size=t,this.height=i,this.parent=null}function sn(e,t,i){!function e(n,s,o){if(n.linked)for(var r=0;r<n.linked.length;++r){var a=n.linked[r];if(a.doc!=s){var l=o&&a.sharedHist;(!i||l)&&(t(a.doc,l),e(a.doc,n,l))}}}(e,null,!0)}function on(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,o(e),i(e),e.options.lineWrapping||u(e),e.options.mode=t.modeOption,bt(e)}function rn(e,t){if(0>(t-=e.first)||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var n=0;;++n){var s=i.children[n],o=s.chunkSize();if(o>t){i=s;break}t-=o}return i.lines[t]}function an(e,t,i){var n=[],s=t.line;return e.iter(t.line,i.line+1,function(e){var o=e.text;s==i.line&&(o=o.slice(0,i.ch)),s==t.line&&(o=o.slice(t.ch)),n.push(o),++s}),n}function ln(e,t,i){var n=[];return e.iter(t,i,function(e){n.push(e.text)}),n}function cn(e,t){var i=t-e.height;if(i)for(var n=e;n;n=n.parent)n.height+=i}function dn(e){if(null==e.parent)return null;for(var t=e.parent,i=Pn(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var s=0;n.children[s]!=t;++s)i+=n.children[s].chunkSize();return i+t.first}function un(e,t){var i=e.first;e:do{for(var n=0;n<e.children.length;++n){var s=e.children[n],o=s.height;if(o>t){e=s;continue e}t-=o,i+=s.chunkSize()}return i}while(!e.lines);for(n=0;n<e.lines.length;++n){var r=e.lines[n].height;if(r>t)break;t-=r}return i+n}function hn(e){for(var t=0,i=(e=Mi(e)).parent,n=0;n<i.lines.length;++n){var s=i.lines[n];if(s==e)break;t+=s.height}for(var o=i.parent;o;o=(i=o).parent)for(n=0;n<o.children.length;++n){var r=o.children[n];if(r==i)break;t+=r.height}return t}function pn(e){var t=e.order;return null==t&&(t=e.order=ir(e.text)),t}function fn(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function mn(e,t){var i={from:j(t.from),to:Gs(t),text:an(e,t.from,t.to)};return yn(e,i,t.from.line,t.to.line+1),sn(e,function(e){yn(e,i,t.from.line,t.to.line+1)},!0),i}function gn(e){for(;e.length;){if(!In(e).ranges)break;e.pop()}}function vn(e,t,i,n){var s=e.history;s.undone.length=0;var o,r=+new Date;if((s.lastOp==n||s.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&s.lastModTime>r-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=function(e,t){return t?(gn(e.done),In(e.done)):e.done.length&&!In(e.done).ranges?In(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),In(e.done)):void 0}(s,s.lastOp==n))){var a=In(o.changes);0==Ls(t.from,t.to)&&0==Ls(t.from,a.to)?a.to=Gs(t):o.changes.push(mn(e,t))}else{var l=In(s.done);for(l&&l.ranges||bn(e.sel,s.done),o={changes:[mn(e,t)],generation:s.generation},s.done.push(o);s.done.length>s.undoDepth;)s.done.shift(),s.done[0].ranges||s.done.shift()}s.done.push(i),s.generation=++s.maxGeneration,s.lastModTime=s.lastSelTime=r,s.lastOp=s.lastSelOp=n,s.lastOrigin=s.lastSelOrigin=t.origin,a||$o(e,"historyAdded")}function bn(e,t){var i=In(t);i&&i.ranges&&i.equals(e)||t.push(e)}function yn(e,t,i,n){var s=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),function(i){i.markedSpans&&((s||(s=t["spans_"+e.id]={}))[o]=i.markedSpans),++o})}function wn(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function xn(e,t,i){for(var n=0,s=[];n<e.length;++n){var o=e[n];if(o.ranges)s.push(i?oe.prototype.deepCopy.call(o):o);else{var r=o.changes,a=[];s.push({changes:a});for(var l=0;l<r.length;++l){var c,d=r[l];if(a.push({from:d.from,to:d.to,text:d.text}),t)for(var u in d)(c=u.match(/^spans_(\d+)$/))&&Pn(t,Number(c[1]))>-1&&(In(a)[u]=d[u],delete d[u])}}}return s}function Cn(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function En(e,t,i,n){for(var s=0;s<e.length;++s){var o=e[s],r=!0;if(o.ranges){o.copied||((o=e[s]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)Cn(o.ranges[a].anchor,t,i,n),Cn(o.ranges[a].head,t,i,n)}else{for(a=0;a<o.changes.length;++a){var l=o.changes[a];if(i<l.from.line)l.from=Ns(l.from.line+n,l.from.ch),l.to=Ns(l.to.line+n,l.to.ch);else if(t<=l.to.line){r=!1;break}}r||(e.splice(0,s+1),s=0)}}}function Tn(e,t){var i=t.from.line,n=t.to.line,s=t.text.length-(n-i)-1;En(e.done,i,n,s),En(e.undone,i,n,s)}function kn(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function _n(e){return e.target||e.srcElement}function Sn(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Ss&&e.ctrlKey&&1==t&&(t=3),t}function Dn(e,t){function i(e){return function(){e.apply(null,o)}}var n=e._handlers&&e._handlers[t];if(n){var s,o=Array.prototype.slice.call(arguments,2);Us?s=Us.delayedCallbacks:Mo?s=Mo:(s=Mo=[],setTimeout($n,0));for(var r=0;r<n.length;++r)s.push(i(n[r]))}}function $n(){var e=Mo;Mo=null;for(var t=0;t<e.length;++t)e[t]()}function Mn(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),$o(e,i||t.type,e,t),kn(t)||t.codemirrorIgnore}function An(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==Pn(i,t[n])&&i.push(t[n])}function On(e,t){var i=e._handlers&&e._handlers[t];return i&&i.length>0}function Fn(e){e.prototype.on=function(e,t){So(this,e,t)},e.prototype.off=function(e,t){Do(this,e,t)}}function Nn(){this.id=null}function Ln(e,t,i){for(var n=0,s=0;;){var o=e.indexOf("\t",n);-1==o&&(o=e.length);var r=o-n;if(o==e.length||s+r>=t)return n+Math.min(r,t-s);if(s+=o-n,n=o+1,(s+=i-s%i)>=t)return n}}function Rn(e){for(;Io.length<=e;)Io.push(In(Io)+" ");return Io[e]}function In(e){return e[e.length-1]}function Pn(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function Bn(e,t){for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n],n);return i}function Hn(){}function Un(e,t){var i;return Object.create?i=Object.create(e):(Hn.prototype=e,i=new Hn),t&&zn(t,i),i}function zn(e,t,i){for(var n in t||(t={}),e)!e.hasOwnProperty(n)||!1===i&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function jn(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Kn(e,t){return t?!!(t.source.indexOf("\\w")>-1&&Uo(e))||t.test(e):Uo(e)}function Wn(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Vn(e){return e.charCodeAt(0)>=768&&zo.test(e)}function Yn(e,t,i,n){var s=document.createElement(e);if(i&&(s.className=i),n&&(s.style.cssText=n),"string"==typeof t)s.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)s.appendChild(t[o]);return s}function qn(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Gn(e,t){return qn(e).appendChild(t)}function Xn(){return document.activeElement}function Qn(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Zn(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]&&!Qn(i[n]).test(t)&&(t+=" "+i[n]);return t}function Jn(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&e(n)}}function es(e){if(null==Ko){var t=Yn("span","​");Gn(e,Yn("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ko=t.offsetWidth<=1&&t.offsetHeight>2&&!(gs&&8>vs))}var i=Ko?Yn("span","​"):Yn("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function ts(e){if(null!=Wo)return Wo;var t=Gn(e,document.createTextNode("AخA")),i=Bo(t,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=Bo(t,1,2).getBoundingClientRect();return Wo=n.right-i.right<3}function is(e){return e.level%2?e.to:e.from}function ns(e){return e.level%2?e.from:e.to}function ss(e){var t=pn(e);return t?is(t[0]):0}function os(e){var t=pn(e);return t?ns(In(t)):e.text.length}function rs(e,t){var i=rn(e.doc,t),n=Mi(i);n!=i&&(t=dn(n));var s=pn(n),o=s?s[0].level%2?os(n):ss(n):0;return Ns(t,o)}function as(e,t){var i=rs(e,t.line),n=rn(e.doc,i.line),s=pn(n);if(!s||0==s[0].level){var o=Math.max(0,n.text.search(/\S/)),r=t.line==i.line&&t.ch<=o&&t.ch;return Ns(i.line,r?0:o)}return i}function ls(e,t,i){var n=e[0].level;return t==n||i!=n&&i>t}function cs(e,t){tr=null;for(var i,n=0;n<e.length;++n){var s=e[n];if(s.from<t&&s.to>t)return n;if(s.from==t||s.to==t){if(null!=i)return ls(e,s.level,e[i].level)?(s.from!=s.to&&(tr=i),n):(s.from!=s.to&&(tr=n),i);i=n}}return i}function ds(e,t,i,n){if(!n)return t+i;do{t+=i}while(t>0&&Vn(e.text.charAt(t)));return t}function us(e,t,i,n){var s=pn(e);if(!s)return hs(e,t,i,n);for(var o=cs(s,t),r=s[o],a=ds(e,t,r.level%2?-i:i,n);;){if(a>r.from&&a<r.to)return a;if(a==r.from||a==r.to)return cs(s,a)==o?a:i>0==(r=s[o+=i]).level%2?r.to:r.from;if(!(r=s[o+=i]))return null;a=i>0==r.level%2?ds(e,r.to,-1,n):ds(e,r.from,1,n)}}function hs(e,t,i,n){var s=t+i;if(n)for(;s>0&&Vn(e.text.charAt(s));)s+=i;return 0>s||s>e.text.length?null:s}var ps=/gecko\/\d/i.test(navigator.userAgent),fs=/MSIE \d/.test(navigator.userAgent),ms=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),gs=fs||ms,vs=gs&&(fs?document.documentMode||6:ms[1]),bs=/WebKit\//.test(navigator.userAgent),ys=bs&&/Qt\/\d+\.\d+/.test(navigator.userAgent),ws=/Chrome\//.test(navigator.userAgent),xs=/Opera\//.test(navigator.userAgent),Cs=/Apple Computer/.test(navigator.vendor),Es=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Ts=/PhantomJS/.test(navigator.userAgent),ks=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),_s=ks||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Ss=ks||/Mac/.test(navigator.platform),Ds=/win/i.test(navigator.platform),$s=xs&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);$s&&($s=Number($s[1])),$s&&$s>=15&&(xs=!1,bs=!0);var Ms=Ss&&(ys||xs&&(null==$s||12.11>$s)),As=ps||gs&&vs>=9,Os=!1,Fs=!1;f.prototype=zn({update:function(e){var t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var s=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+s)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(i?n:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedOverlay&&e.clientHeight>0&&(0==n&&this.overlayHack(),this.checkedOverlay=!0),{right:i?n:0,bottom:t?n:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e)},overlayHack:function(){var e=Ss&&!Es?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=e;var t=this,i=function(e){_n(e)!=t.vert&&_n(e)!=t.horiz&&pt(t.cm,St)(e)};So(this.vert,"mousedown",i),So(this.horiz,"mousedown",i)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},f.prototype),m.prototype=zn({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},m.prototype),e.scrollbarModel={native:f,null:m},T.prototype.signal=function(e,t){On(e,t)&&this.events.push(arguments)},T.prototype.finish=function(){for(var e=0;e<this.events.length;e++)$o.apply(null,this.events[e])};var Ns=e.Pos=function(e,t){return this instanceof Ns?(this.line=e,void(this.ch=t)):new Ns(e,t)},Ls=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Rs=null;Z.prototype=zn({init:function(e){function t(e){if(n.somethingSelected())Rs=n.getSelections(),i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,o.value=Rs.join("\n"),Po(o));else{if(!n.options.lineWiseCopyCut)return;var t=X(n);Rs=t.text,"cut"==e.type?n.setSelections(t.ranges,null,Fo):(i.prevInput="",o.value=t.text.join("\n"),Po(o))}"cut"==e.type&&(n.state.cutIncoming=!0)}var i=this,n=this.cm,s=this.wrapper=J(),o=this.textarea=s.firstChild;e.wrapper.insertBefore(s,e.wrapper.firstChild),ks&&(o.style.width="0px"),So(o,"input",function(){gs&&vs>=9&&i.hasSelection&&(i.hasSelection=null),i.poll()}),So(o,"paste",function(){if(bs&&!n.state.fakedLastChar&&!(new Date-n.state.lastMiddleDown<200)){var e=o.selectionStart,t=o.selectionEnd;o.value+="$",o.selectionEnd=t,o.selectionStart=e,n.state.fakedLastChar=!0}n.state.pasteIncoming=!0,i.fastPoll()}),So(o,"cut",t),So(o,"copy",t),So(e.scroller,"paste",function(t){kt(e,t)||(n.state.pasteIncoming=!0,i.focus())}),So(e.lineSpace,"selectstart",function(t){kt(e,t)||To(t)}),So(o,"compositionstart",function(){var e=n.getCursor("from");i.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),So(o,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,i=e.doc,n=ke(e);if(e.options.moveInputWithCursor){var s=Ze(e,i.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),r=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,s.top+r.top-o.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,s.left+r.left-o.left))}return n},showSelection:function(e){var t=this.cm.display;Gn(t.cursorDiv,e.cursors),Gn(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,i,n=this.cm,s=n.doc;if(n.somethingSelected()){this.prevInput="";var o=s.sel.primary(),r=(t=Zo&&(o.to().line-o.from().line>100||(i=n.getSelection()).length>1e3))?"-":i||n.getSelection();this.textarea.value=r,n.state.focused&&Po(this.textarea),gs&&vs>=9&&(this.hasSelection=r)}else e||(this.prevInput=this.textarea.value="",gs&&vs>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!_s||Xn()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,function i(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,i))})},poll:function(){var e=this.cm,t=this.textarea,i=this.prevInput;if(!e.state.focused||Qo(t)&&!i||Y(e)||e.options.disableInput||e.state.keySeq)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var n=t.value;if(n==i&&!e.somethingSelected())return!1;if(gs&&vs>=9&&this.hasSelection===n||Ss&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var s=n.charCodeAt(0);if(8203!=s||i||(i="​"),8666==s)return this.reset(),this.cm.execCommand("undo")}for(var o=0,r=Math.min(i.length,n.length);r>o&&i.charCodeAt(o)==n.charCodeAt(o);)++o;var a=this;return ht(e,function(){q(e,n.slice(o),i.length-o,null,a.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?t.value=a.prevInput="":a.prevInput=n,a.composing&&(a.composing.range.clear(),a.composing.range=e.markText(a.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){gs&&vs>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=r.selectionStart){var e=s.somethingSelected(),t="​"+(e?r.value:"");r.value="⇚",r.value=t,n.prevInput=e?"":"​",r.selectionStart=1,r.selectionEnd=t.length,o.selForContextMenu=s.doc.sel}}function i(){if(n.contextMenuPending=!1,n.wrapper.style.position="relative",r.style.cssText=c,gs&&9>vs&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l),null!=r.selectionStart){(!gs||gs&&9>vs)&&t();var e=0,i=function(){o.selForContextMenu==s.doc.sel&&0==r.selectionStart&&r.selectionEnd>0&&"​"==n.prevInput?pt(s,ro.selectAll)(s):e++<10?o.detectingSelectAll=setTimeout(i,500):o.input.reset()};o.detectingSelectAll=setTimeout(i,200)}}var n=this,s=n.cm,o=s.display,r=n.textarea,a=_t(s,e),l=o.scroller.scrollTop;if(a&&!xs){s.options.resetSelectionOnContextMenu&&-1==s.doc.sel.contains(a)&&pt(s,be)(s.doc,le(a),Fo);var c=r.style.cssText;if(n.wrapper.style.position="absolute",r.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(gs?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",bs)var d=window.scrollY;if(o.input.focus(),bs&&window.scrollTo(null,d),o.input.reset(),s.somethingSelected()||(r.value=n.prevInput=" "),n.contextMenuPending=!0,o.selForContextMenu=s.doc.sel,clearTimeout(o.detectingSelectAll),gs&&vs>=9&&t(),As){_o(e);var u=function(){Do(window,"mouseup",u),setTimeout(i,20)};So(window,"mouseup",u)}else setTimeout(i,50)}},setUneditable:Hn,needsContentAttribute:!1},Z.prototype),ee.prototype=zn({init:function(e){function t(e){if(n.somethingSelected())Rs=n.getSelections(),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=X(n);Rs=t.text,"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,Fo),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!ks)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Rs.join("\n"));else{var i=J(),s=i.firstChild;n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),s.value=Rs.join("\n");var o=document.activeElement;Po(s),setTimeout(function(){n.display.lineSpace.removeChild(i),o.focus()},50)}}var i=this,n=i.cm,s=i.div=e.lineDiv;s.contentEditable="true",Q(s),So(s,"paste",function(e){var t=e.clipboardData&&e.clipboardData.getData("text/plain");t&&(e.preventDefault(),n.replaceSelection(t,null,"paste"))}),So(s,"compositionstart",function(e){var t=e.data;if(i.composing={sel:n.doc.sel,data:t,startData:t},t){var s=n.doc.sel.primary(),o=n.getLine(s.head.line).indexOf(t,Math.max(0,s.head.ch-t.length));o>-1&&o<=s.head.ch&&(i.composing.sel=le(Ns(s.head.line,o),Ns(s.head.line,o+t.length)))}}),So(s,"compositionupdate",function(e){i.composing.data=e.data}),So(s,"compositionend",function(e){var t=i.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||i.applyComposition(t),i.composing==t&&(i.composing=null)},50))}),So(s,"touchstart",function(){i.forceCompositionEnd()}),So(s,"input",function(){i.composing||i.pollContent()||ht(i.cm,function(){bt(n)})}),So(s,"copy",t),So(s,"cut",t)},prepareSelection:function(){var e=ke(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),i=ne(this.cm,e.anchorNode,e.anchorOffset),n=ne(this.cm,e.focusNode,e.focusOffset);if(!i||i.bad||!n||n.bad||0!=Ls(W(i,n),t.from())||0!=Ls(K(i,n),t.to())){var s=te(this.cm,t.from()),o=te(this.cm,t.to());if(s||o){var r=this.cm.display.view,a=e.rangeCount&&e.getRangeAt(0);if(s){if(!o){var l=r[r.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;o={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else s={node:r[0].measure.map[2],offset:0};try{var d=Bo(s.node,s.offset,o.offset,o.node)}catch(e){}d&&(e.removeAllRanges(),e.addRange(d),a&&null==e.anchorNode?e.addRange(a):ps&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){Gn(this.cm.display.cursorDiv,e.cursors),Gn(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return jo(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){var e=this;this.selectionInEditor()?this.pollSelection():ht(this.cm,function(){e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))})},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var i=ne(t,e.anchorNode,e.anchorOffset),n=ne(t,e.focusNode,e.focusOffset);i&&n&&ht(t,function(){be(t.doc,le(i,n),Fo),(i.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e,t=this.cm,i=t.display,n=t.doc.sel.primary(),s=n.from(),o=n.to();if(s.line<i.viewFrom||o.line>i.viewTo-1)return!1;if(s.line==i.viewFrom||0==(e=xt(t,s.line)))var r=dn(i.view[0].line),a=i.view[0].node;else r=dn(i.view[e].line),a=i.view[e-1].node.nextSibling;var l=xt(t,o.line);if(l==i.view.length-1)var c=i.viewTo-1,d=i.view[l].node;else c=dn(i.view[l+1].line)-1,d=i.view[l+1].node.previousSibling;for(var u=Xo(function(e,t,i,n,s){function o(t){if(1==t.nodeType){var i=t.getAttribute("cm-text");if(null!=i)return""==i&&(i=t.textContent.replace(/\u200b/g,"")),void(r+=i);var l,c=t.getAttribute("cm-marker");if(c){var d=e.findMarks(Ns(n,0),Ns(s+1,0),function(e){return function(t){return t.id==e}}(+c));return void(d.length&&(l=d[0].find())&&(r+=an(e.doc,l.from,l.to).join("\n")))}if("false"==t.getAttribute("contenteditable"))return;for(var u=0;u<t.childNodes.length;u++)o(t.childNodes[u]);/^(pre|div|p)$/i.test(t.nodeName)&&(a=!0)}else if(3==t.nodeType){var h=t.nodeValue;if(!h)return;a&&(r+="\n",a=!1),r+=h}}for(var r="",a=!1;o(t),t!=i;)t=t.nextSibling;return r}(t,a,d,r,c)),h=an(t.doc,Ns(r,0),Ns(c,rn(t.doc,c).text.length));u.length>1&&h.length>1;)if(In(u)==In(h))u.pop(),h.pop(),c--;else{if(u[0]!=h[0])break;u.shift(),h.shift(),r++}for(var p=0,f=0,m=u[0],g=h[0],v=Math.min(m.length,g.length);v>p&&m.charCodeAt(p)==g.charCodeAt(p);)++p;for(var b=In(u),y=In(h),w=Math.min(b.length-(1==u.length?p:0),y.length-(1==h.length?p:0));w>f&&b.charCodeAt(b.length-f-1)==y.charCodeAt(y.length-f-1);)++f;u[u.length-1]=b.slice(0,b.length-f),u[0]=u[0].slice(p);var x=Ns(r,p),C=Ns(c,h.length?In(h).length-f:0);return u.length>1||u[0]||Ls(x,C)?(Jt(t.doc,u,x,C,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){e.data&&e.data!=e.startData&&pt(this.cm,q)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.setAttribute("contenteditable","false")},onKeyPress:function(e){e.preventDefault(),pt(this.cm,q)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},onContextMenu:Hn,resetPosition:Hn,needsContentAttribute:!0},ee.prototype),e.inputStyles={textarea:Z,contenteditable:ee},oe.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],n=e.ranges[t];if(0!=Ls(i.anchor,n.anchor)||0!=Ls(i.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new re(j(this.ranges[t].anchor),j(this.ranges[t].head));return new oe(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(Ls(t,n.from())>=0&&Ls(e,n.to())<=0)return i}return-1}},re.prototype={from:function(){return W(this.anchor,this.head)},to:function(){return K(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Is,Ps,Bs,Hs={left:0,right:0,top:0,bottom:0},Us=null,zs=0,js=0,Ks=0,Ws=null;gs?Ws=-.53:ps?Ws=15:ws?Ws=-.7:Cs&&(Ws=-1/3);var Vs=function(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}};e.wheelEventPixels=function(e){var t=Vs(e);return t.x*=Ws,t.y*=Ws,t};var Ys=new Nn,qs=null,Gs=e.changeEnd=function(e){return e.text?Ns(e.from.line+e.text.length-1,In(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,n=i[e];(i[e]!=t||"mode"==e)&&(i[e]=t,Qs.hasOwnProperty(e)&&pt(this,Qs[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](ui(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:ft(function(t,i){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:t,opaque:i&&i.opaque}),this.state.modeGen++,bt(this)}),removeOverlay:ft(function(e){for(var t=this.state.overlays,i=0;i<t.length;++i){var n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,void bt(this)}}),indentLine:ft(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),ue(this.doc,e)&&si(this,e,t,i)}),indentSelection:ft(function(e){for(var t=this.doc.sel.ranges,i=-1,n=0;n<t.length;n++){var s=t[n];if(s.empty())s.head.line>i&&(si(this,s.head.line,e,!0),i=s.head.line,n==this.doc.sel.primIndex&&ii(this));else{var o=s.from(),r=s.to(),a=Math.max(i,o.line);i=Math.min(this.lastLine(),r.line-(r.ch?0:1))+1;for(var l=a;i>l;++l)si(this,l,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[n].from().ch>0&&me(this.doc,n,new re(o,c[n].to()),Fo)}}}),getTokenAt:function(e,t){return Ui(this,e,t)},getLineTokens:function(e,t){return Ui(this,Ns(e),t,!0)},getTokenTypeAt:function(e){e=de(this.doc,e);var t,i=Ki(this,rn(this.doc,e.line)),n=0,s=(i.length-1)/2,o=e.ch;if(0==o)t=i[2];else for(;;){var r=n+s>>1;if((r?i[2*r-1]:0)>=o)s=r;else{if(!(i[2*r+1]<o)){t=i[2*r+2];break}n=r+1}}var a=t?t.indexOf("cm-overlay "):-1;return 0>a?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(t).state).mode:i},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!no.hasOwnProperty(t))return i;var n=no[t],s=this.getModeAt(e);if("string"==typeof s[t])n[s[t]]&&i.push(n[s[t]]);else if(s[t])for(var o=0;o<s[t].length;o++){var r=n[s[t][o]];r&&i.push(r)}else s.helperType&&n[s.helperType]?i.push(n[s.helperType]):n[s.name]&&i.push(n[s.name]);for(o=0;o<n._global.length;o++){var a=n._global[o];a.pred(s,this)&&-1==Pn(i,a.val)&&i.push(a.val)}return i},getStateAfter:function(e,t){var i=this.doc;return Ae(this,(e=ce(i,null==e?i.first+i.size-1:e))+1,t)},cursorCoords:function(e,t){var i=this.doc.sel.primary();return Ze(this,null==e?i.head:"object"==typeof e?de(this.doc,e):e?i.from():i.to(),t||"page")},charCoords:function(e,t){return Qe(this,de(this.doc,e),t||"page")},coordsChar:function(e,t){return tt(this,(e=Xe(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Xe(this,{top:e,left:0},t||"page").top,un(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var i,n=!1;if("number"==typeof e){var s=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>s&&(e=s,n=!0),i=rn(this.doc,e)}else i=e;return Ge(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-hn(i):0)},defaultTextHeight:function(){return nt(this.display)},defaultCharWidth:function(){return st(this.display)},setGutterMarker:ft(function(e,t,i){return oi(this.doc,e,"gutter",function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&Wn(n)&&(e.gutterMarkers=null),!0})}),clearGutter:ft(function(e){var t=this,i=t.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&(i.gutterMarkers[e]=null,yt(t,n,"gutter"),Wn(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),lineInfo:function(e){if("number"==typeof e){if(!ue(this.doc,e))return null;var t=e;if(!(e=rn(this.doc,e)))return null}else{if(null==(t=dn(e)))return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,s){var o=this.display,r=(e=Ze(this,de(this.doc,e))).bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==n)r=e.top;else if("above"==n||"near"==n){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?r=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(r=e.bottom),a+t.offsetWidth>c&&(a=c-t.offsetWidth)}t.style.top=r+"px",t.style.left=t.style.right="","right"==s?(a=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==s?a=0:"middle"==s&&(a=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),i&&function(e,t,i,n,s){var o=ei(e,t,i,n,s);null!=o.scrollTop&&At(e,o.scrollTop),null!=o.scrollLeft&&Ot(e,o.scrollLeft)}(this,a,r,a+t.offsetWidth,r+t.offsetHeight)},triggerOnKeyDown:ft(It),triggerOnKeyPress:ft(Bt),triggerOnKeyUp:Pt,execCommand:function(e){return ro.hasOwnProperty(e)?ro[e](this):void 0},triggerElectric:ft(function(e){G(this,e)}),findPosH:function(e,t,i,n){var s=1;0>t&&(s=-1,t=-t);for(var o=0,r=de(this.doc,e);t>o&&!(r=ai(this.doc,r,s,i,n)).hitSide;++o);return r},moveH:ft(function(e,t){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?ai(i.doc,n.head,e,t,i.options.rtlMoveVisually):0>e?n.from():n.to()},Lo)}),deleteH:ft(function(e,t){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):ri(this,function(i){var s=ai(n,i.head,e,t,!1);return 0>e?{from:s,to:i.head}:{from:i.head,to:s}})}),findPosV:function(e,t,i,n){var s=1,o=n;0>t&&(s=-1,t=-t);for(var r=0,a=de(this.doc,e);t>r;++r){var l=Ze(this,a,"div");if(null==o?o=l.left:l.left=o,(a=li(this,l,s,i)).hitSide)break}return a},moveV:ft(function(e,t){var i=this,n=this.doc,s=[],o=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(r){if(o)return 0>e?r.from():r.to();var a=Ze(i,r.head,"div");null!=r.goalColumn&&(a.left=r.goalColumn),s.push(a.left);var l=li(i,a,e,t);return"page"==t&&r==n.sel.primary()&&ti(i,null,Qe(i,l,"div").top-a.top),l},Lo),s.length)for(var r=0;r<n.sel.ranges.length;r++)n.sel.ranges[r].goalColumn=s[r]}),findWordAt:function(e){var t=rn(this.doc,e.line).text,i=e.ch,n=e.ch;if(t){var s=this.getHelper(e,"wordChars");(e.xRel<0||n==t.length)&&i?--i:++n;for(var o=t.charAt(i),r=Kn(o,s)?function(e){return Kn(e,s)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Kn(e)};i>0&&r(t.charAt(i-1));)--i;for(;n<t.length&&r(t.charAt(n));)++n}return new re(Ns(e.line,i),Ns(e.line,n))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Yo(this.display.cursorDiv,"CodeMirror-overwrite"):Vo(this.display.cursorDiv,"CodeMirror-overwrite"),$o(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Xn()},scrollTo:ft(function(e,t){(null!=e||null!=t)&&ni(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Le(this)-this.display.barHeight,width:e.scrollWidth-Le(this)-this.display.barWidth,clientHeight:Ie(this),clientWidth:Re(this)}},scrollIntoView:ft(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Ns(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)ni(this),this.curOp.scrollToPos=e;else{var i=ei(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:ft(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this;null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&We(this);var s=n.display.viewFrom;n.doc.iter(s,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){yt(n,s,"widget");break}++s}),n.curOp.forceUpdate=!0,$o(n,"refresh",this)}),operation:function(e){return ht(this,e)},refresh:ft(function(){var e=this.display.cachedTextHeight;bt(this),this.curOp.forceUpdate=!0,Ve(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),c(this),(null==e||Math.abs(e-nt(this.display))>.5)&&o(this),$o(this,"refresh",this)}),swapDoc:ft(function(e){var t=this.doc;return t.cm=null,on(this,e),Ve(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Dn(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Fn(e);var Xs=e.defaults={},Qs=e.optionHandlers={},Zs=e.Init={toString:function(){return"CodeMirror.Init"}};ci("value","",function(e,t){e.setValue(t)},!0),ci("mode",null,function(e,t){e.doc.modeOption=t,i(e)},!0),ci("indentUnit",2,i,!0),ci("indentWithTabs",!1),ci("smartIndent",!0),ci("tabSize",4,function(e){n(e),Ve(e),bt(e)},!0),ci("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,i,n){t.state.specialChars=new RegExp(i.source+(i.test("\t")?"":"|\t"),"g"),n!=e.Init&&t.refresh()}),ci("specialCharPlaceholder",function(e){var t=Yn("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t},function(e){e.refresh()},!0),ci("electricChars",!0),ci("inputStyle",_s?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),ci("rtlMoveVisually",!Ds),ci("wholeLineUpdateBefore",!0),ci("theme","default",function(e){r(e),a(e)},!0),ci("keyMap","default",function(t,i,n){var s=ui(i),o=n!=e.Init&&ui(n);o&&o.detach&&o.detach(t,s),s.attach&&s.attach(t,o||null)}),ci("extraKeys",null),ci("lineWrapping",!1,function(e){e.options.lineWrapping?(Yo(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Vo(e.display.wrapper,"CodeMirror-wrap"),u(e)),o(e),bt(e),Ve(e),setTimeout(function(){v(e)},100)},!0),ci("gutters",[],function(e){h(e.options),a(e)},!0),ci("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?E(e.display)+"px":"0",e.refresh()},!0),ci("coverGutterNextToScrollbar",!1,function(e){v(e)},!0),ci("scrollbarStyle","native",function(e){g(e),v(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),ci("lineNumbers",!1,function(e){h(e.options),a(e)},!0),ci("firstLineNumber",1,a,!0),ci("lineNumberFormatter",function(e){return e},a,!0),ci("showCursorWhenSelecting",!1,Te,!0),ci("resetSelectionOnContextMenu",!0),ci("lineWiseCopyCut",!0),ci("readOnly",!1,function(e,t){"nocursor"==t?(Ut(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||e.display.input.reset())}),ci("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),ci("dragDrop",!0,function(t,i,n){if(!i!=!(n&&n!=e.Init)){var s=t.display.dragFunctions,o=i?So:Do;o(t.display.scroller,"dragstart",s.start),o(t.display.scroller,"dragenter",s.simple),o(t.display.scroller,"dragover",s.simple),o(t.display.scroller,"drop",s.drop)}}),ci("cursorBlinkRate",530),ci("cursorScrollMargin",0),ci("cursorHeight",1,Te,!0),ci("singleCursorHeightPerLine",!0,Te,!0),ci("workTime",100),ci("workDelay",100),ci("flattenSpans",!0,n,!0),ci("addModeClass",!1,n,!0),ci("pollInterval",100),ci("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),ci("historyEventDelay",1250),ci("viewportMargin",10,function(e){e.refresh()},!0),ci("maxHighlightLength",1e4,n,!0),ci("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),ci("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),ci("autofocus",null);var Js=e.modes={},eo=e.mimeModes={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),Js[t]=i},e.defineMIME=function(e,t){eo[e]=t},e.resolveMode=function(t){if("string"==typeof t&&eo.hasOwnProperty(t))t=eo[t];else if(t&&"string"==typeof t.name&&eo.hasOwnProperty(t.name)){var i=eo[t.name];"string"==typeof i&&(i={name:i}),(t=Un(i,t)).name=i.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,i){i=e.resolveMode(i);var n=Js[i.name];if(!n)return e.getMode(t,"text/plain");var s=n(t,i);if(to.hasOwnProperty(i.name)){var o=to[i.name];for(var r in o)o.hasOwnProperty(r)&&(s.hasOwnProperty(r)&&(s["_"+r]=s[r]),s[r]=o[r])}if(s.name=i.name,i.helperType&&(s.helperType=i.helperType),i.modeProps)for(var r in i.modeProps)s[r]=i.modeProps[r];return s},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var to=e.modeExtensions={};e.extendMode=function(e,t){zn(t,to.hasOwnProperty(e)?to[e]:to[e]={})},e.defineExtension=function(t,i){e.prototype[t]=i},e.defineDocExtension=function(e,t){xo.prototype[e]=t},e.defineOption=ci;var io=[];e.defineInitHook=function(e){io.push(e)};var no=e.helpers={};e.registerHelper=function(t,i,n){no.hasOwnProperty(t)||(no[t]=e[t]={_global:[]}),no[t][i]=n},e.registerGlobalHelper=function(t,i,n,s){e.registerHelper(t,i,s),no[t]._global.push({pred:n,val:s})};var so=e.copyState=function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var s=t[n];s instanceof Array&&(s=s.concat([])),i[n]=s}return i},oo=e.startState=function(e,t,i){return!e.startState||e.startState(t,i)};e.innerMode=function(e,t){for(;e.innerMode;){var i=e.innerMode(t);if(!i||i.mode==e)break;t=i.state,e=i.mode}return i||{mode:e,state:t}};var ro=e.commands={selectAll:function(e){e.setSelection(Ns(e.firstLine(),0),Ns(e.lastLine()),Fo)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Fo)},killLine:function(e){ri(e,function(t){if(t.empty()){var i=rn(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:Ns(t.head.line+1,0)}:{from:t.head,to:Ns(t.head.line,i)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){ri(e,function(t){return{from:Ns(t.from().line,0),to:de(e.doc,Ns(t.to().line+1,0))}})},delLineLeft:function(e){ri(e,function(e){return{from:Ns(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){ri(e,function(t){var i=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:i},"div"),to:t.from()}})},delWrappedLineRight:function(e){ri(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:n}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Ns(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Ns(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return rs(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return as(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return function(e,t){for(var i,n=rn(e.doc,t);i=Di(n);)n=i.find(1,!0).line,t=null;var s=pn(n),o=s?s[0].level%2?ss(n):os(n):n.text.length;return Ns(null==t?dn(n):t,o)}(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},Lo)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},Lo)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?as(e,t.head):n},Lo)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),n=e.options.tabSize,s=0;s<i.length;s++){var o=i[s].from(),r=Ro(e.getLine(o.line),o.ch,n);t.push(new Array(n-r%n+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){ht(e,function(){for(var t=e.listSelections(),i=[],n=0;n<t.length;n++){var s=t[n].head,o=rn(e.doc,s.line).text;if(o)if(s.ch==o.length&&(s=new Ns(s.line,s.ch-1)),s.ch>0)s=new Ns(s.line,s.ch+1),e.replaceRange(o.charAt(s.ch-1)+o.charAt(s.ch-2),Ns(s.line,s.ch-2),s,"+transpose");else if(s.line>e.doc.first){var r=rn(e.doc,s.line-1).text;r&&e.replaceRange(o.charAt(0)+"\n"+r.charAt(r.length-1),Ns(s.line-1,r.length-1),Ns(s.line,1),"+transpose")}i.push(new re(s,s))}e.setSelections(i)})},newlineAndIndent:function(e){ht(e,function(){for(var t=e.listSelections().length,i=0;t>i;i++){var n=e.listSelections()[i];e.replaceRange("\n",n.anchor,n.head,"+input"),e.indentLine(n.from().line+1,null,!0),ii(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},ao=e.keyMap={};ao.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ao.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ao.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},ao.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ao.default=Ss?ao.macDefault:ao.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete e[i];continue}for(var s=Bn(i.split(" "),di),o=0;o<s.length;o++){var r,a;o==s.length-1?(a=s.join(" "),r=n):(a=s.slice(0,o+1).join(" "),r="...");var l=t[a];if(l){if(l!=r)throw new Error("Inconsistent bindings for "+a)}else t[a]=r}delete e[i]}for(var c in t)e[c]=t[c];return e};var lo=e.lookupKey=function(e,t,i,n){var s=(t=ui(t)).call?t.call(e,n):t[e];if(!1===s)return"nothing";if("..."===s)return"multi";if(null!=s&&i(s))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return lo(e,t.fallthrough,i,n);for(var o=0;o<t.fallthrough.length;o++){var r=lo(e,t.fallthrough[o],i,n);if(r)return r}}},co=e.isModifierKey=function(e){var t="string"==typeof e?e:er[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},uo=e.keyName=function(e,t){if(xs&&34==e.keyCode&&e.char)return!1;var i=er[e.keyCode],n=i;return null!=n&&!e.altGraphKey&&(e.altKey&&"Alt"!=i&&(n="Alt-"+n),(Ms?e.metaKey:e.ctrlKey)&&"Ctrl"!=i&&(n="Ctrl-"+n),(Ms?e.ctrlKey:e.metaKey)&&"Cmd"!=i&&(n="Cmd-"+n),!t&&e.shiftKey&&"Shift"!=i&&(n="Shift-"+n),n)};e.fromTextArea=function(t,i){function n(){t.value=l.getValue()}if((i=i?zn(i):{}).value=t.value,!i.tabindex&&t.tabIndex&&(i.tabindex=t.tabIndex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),null==i.autofocus){var s=Xn();i.autofocus=s==t||null!=t.getAttribute("autofocus")&&s==document.body}if(t.form&&(So(t.form,"submit",n),!i.leaveSubmitMethodAlone)){var o=t.form,r=o.submit;try{var a=o.submit=function(){n(),o.submit=r,o.submit(),o.submit=a}}catch(e){}}i.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Do(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=r))}},t.style.display="none";var l=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return l};var ho=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ho.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else i=t&&(e.test?e.test(t):e(t));return i?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ro(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ro(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Ro(this.string,null,this.tabSize)-(this.lineStart?Ro(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,i){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}var s=function(e){return i?e.toLowerCase():e};return s(this.string.substr(this.pos,e.length))==s(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var po=0,fo=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++po};Fn(fo),fo.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&ot(e),On(this,"clear")){var i=this.find();i&&Dn(this,"clear",i.from,i.to)}for(var n=null,s=null,o=0;o<this.lines.length;++o){var r=this.lines[o],a=gi(r.markedSpans,this);e&&!this.collapsed?yt(e,dn(r),"text"):e&&(null!=a.to&&(s=dn(r)),null!=a.from&&(n=dn(r))),r.markedSpans=vi(r.markedSpans,a),null==a.from&&this.collapsed&&!Fi(this.doc,r)&&e&&cn(r,nt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(o=0;o<this.lines.length;++o){var l=Mi(this.lines[o]),c=d(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&bt(e,n,s+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&xe(e.doc)),e&&Dn(e,"markerCleared",e,this),t&&rt(e),this.parent&&this.parent.clear()}},fo.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var i,n,s=0;s<this.lines.length;++s){var o=this.lines[s],r=gi(o.markedSpans,this);if(null!=r.from&&(i=Ns(t?o:dn(o),r.from),-1==e))return i;if(null!=r.to&&(n=Ns(t?o:dn(o),r.to),1==e))return n}return i&&{from:i,to:n}},fo.prototype.changed=function(){var e=this.find(-1,!0),t=this,i=this.doc.cm;e&&i&&ht(i,function(){var n=e.line,s=dn(e.line),o=He(i,s);if(o&&(Ke(o),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!Fi(t.doc,n)&&null!=t.height){var r=t.height;t.height=null;var a=Ri(t)-r;a&&cn(n,n.height+a)}})},fo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Pn(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},fo.prototype.detachLine=function(e){if(this.lines.splice(Pn(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};po=0;var mo=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};Fn(mo),mo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Dn(this,"clear")}},mo.prototype.find=function(e,t){return this.primary.find(e,t)};var go=e.LineWidget=function(e,t,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.doc=e,this.node=t};Fn(go),go.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,i=this.line,n=dn(i);if(null!=n&&t){for(var s=0;s<t.length;++s)t[s]==this&&t.splice(s--,1);t.length||(i.widgets=null);var o=Ri(this);cn(i,Math.max(0,i.height-o)),e&&ht(e,function(){Li(e,i,-o),yt(e,n,"widget")})}},go.prototype.changed=function(){var e=this.height,t=this.doc.cm,i=this.line;this.height=null;var n=Ri(this)-e;n&&(cn(i,i.height+n),t&&ht(t,function(){t.curOp.forceUpdate=!0,Li(t,i,n)}))};var vo=e.Line=function(e,t,i){this.text=e,Ci(this,t),this.height=i?i(this):1};Fn(vo),vo.prototype.lineNo=function(){return dn(this)};var bo={},yo={};tn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,n=e+t;n>i;++i){var s=this.lines[i];this.height-=s.height,Ii(s),Dn(s,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;n>e;++e)if(i(this.lines[e]))return!0}},nn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],s=n.chunkSize();if(s>e){var o=Math.min(t,s-e),r=n.height;if(n.removeInner(e,o),this.height-=r-n.height,s==o&&(this.children.splice(i--,1),n.parent=null),0==(t-=o))break;e=0}else e-=s}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof tn))){var a=[];this.collapse(a),this.children=[new tn(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0;n<this.children.length;++n){var s=this.children[n],o=s.chunkSize();if(o>=e){if(s.insertInner(e,t,i),s.lines&&s.lines.length>50){for(;s.lines.length>50;){var r=new tn(s.lines.splice(s.lines.length-25,25));s.height-=r.height,this.children.splice(n+1,0,r),r.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new nn(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var i=Pn(e.parent.children,e);e.parent.children.splice(i+1,0,t)}else{var n=new nn(e.children);n.parent=e,e.children=[n,t],e=n}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var n=0;n<this.children.length;++n){var s=this.children[n],o=s.chunkSize();if(o>e){var r=Math.min(t,o-e);if(s.iterN(e,r,i))return!0;if(0==(t-=r))break;e=0}else e-=o}}};var wo=0,xo=e.Doc=function(e,t,i){if(!(this instanceof xo))return new xo(e,t,i);null==i&&(i=0),nn.call(this,[new tn([new vo("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var n=Ns(i,0);this.sel=le(n),this.history=new fn(null),this.id=++wo,this.modeOption=t,"string"==typeof e&&(e=Xo(e)),en(this,{from:n,to:n,text:e}),be(this,le(n),Fo)};xo.prototype=Un(nn.prototype,{constructor:xo,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,n=0;n<t.length;++n)i+=t[n].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=ln(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:mt(function(e){var t=Ns(this.first,0),i=this.first+this.size-1;Yt(this,{from:t,to:Ns(i,rn(this,i).text.length),text:Xo(e),origin:"setValue",full:!0},!0),be(this,le(t))}),replaceRange:function(e,t,i,n){Jt(this,e,t=de(this,t),i=i?de(this,i):t,n)},getRange:function(e,t,i){var n=an(this,de(this,e),de(this,t));return!1===i?n:n.join(i||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return ue(this,e)?rn(this,e):void 0},getLineNumber:function(e){return dn(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=rn(this,e)),Mi(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return de(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:mt(function(e,t,i){ge(this,de(this,"number"==typeof e?Ns(e,t||0):e),null,i)}),setSelection:mt(function(e,t,i){ge(this,de(this,e),de(this,t||e),i)}),extendSelection:mt(function(e,t,i){pe(this,de(this,e),t&&de(this,t),i)}),extendSelections:mt(function(e,t){fe(this,function(e,t){for(var i=[],n=0;n<t.length;n++)i[n]=de(e,t[n]);return i}(this,e))}),extendSelectionsBy:mt(function(e,t){fe(this,Bn(this.sel.ranges,e),t)}),setSelections:mt(function(e,t,i){if(e.length){for(var n=0,s=[];n<e.length;n++)s[n]=new re(de(this,e[n].anchor),de(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),be(this,ae(s,t),i)}}),addSelection:mt(function(e,t,i){var n=this.sel.ranges.slice(0);n.push(new re(de(this,e),de(this,t||e))),be(this,ae(n,n.length-1),i)}),getSelection:function(e){for(var t,i=this.sel.ranges,n=0;n<i.length;n++){var s=an(this,i[n].from(),i[n].to());t=t?t.concat(s):s}return!1===e?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],i=this.sel.ranges,n=0;n<i.length;n++){var s=an(this,i[n].from(),i[n].to());!1!==e&&(s=s.join(e||"\n")),t[n]=s}return t},replaceSelection:function(e,t,i){for(var n=[],s=0;s<this.sel.ranges.length;s++)n[s]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:mt(function(e,t,i){for(var n=[],s=this.sel,o=0;o<s.ranges.length;o++){var r=s.ranges[o];n[o]={from:r.from(),to:r.to(),text:Xo(e[o]),origin:i}}var a=t&&"end"!=t&&function(e,t,i){for(var n=[],s=Ns(e.first,0),o=s,r=0;r<t.length;r++){var a=t[r],l=Wt(a.from,s,o),c=Wt(Gs(a),s,o);if(s=a.to,o=c,"around"==i){var d=e.sel.ranges[r],u=Ls(d.head,d.anchor)<0;n[r]=new re(u?c:l,u?l:c)}else n[r]=new re(l,l)}return new oe(n,e.sel.primIndex)}(this,n,t);for(o=n.length-1;o>=0;o--)Yt(this,n[o]);a?ve(this,a):this.cm&&ii(this.cm)}),undo:mt(function(){Gt(this,"undo")}),redo:mt(function(){Gt(this,"redo")}),undoSelection:mt(function(){Gt(this,"undo",!0)}),redoSelection:mt(function(){Gt(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new fn(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:xn(this.history.done),undone:xn(this.history.undone)}},setHistory:function(e){var t=this.history=new fn(this.history.maxGeneration);t.done=xn(e.done.slice(0),null,!0),t.undone=xn(e.undone.slice(0),null,!0)},addLineClass:mt(function(e,t,i){return oi(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(Qn(i).test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:mt(function(e,t,i){return oi(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",s=e[n];if(!s)return!1;if(null==i)e[n]=null;else{var o=s.match(Qn(i));if(!o)return!1;var r=o.index+o[0].length;e[n]=s.slice(0,o.index)+(o.index&&r!=s.length?" ":"")+s.slice(r)||null}return!0})}),addLineWidget:mt(function(e,t,i){return function(e,t,i,n){var s=new go(e,i,n),o=e.cm;return o&&s.noHScroll&&(o.display.alignWidgets=!0),oi(e,t,"widget",function(t){var i=t.widgets||(t.widgets=[]);if(null==s.insertAt?i.push(s):i.splice(Math.min(i.length-1,Math.max(0,s.insertAt)),0,s),s.line=t,o&&!Fi(e,t)){var n=hn(t)<e.scrollTop;cn(t,t.height+Ri(s)),n&&ti(o,null,s.height),o.curOp.forceUpdate=!0}return!0}),s}(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return hi(this,de(this,e),de(this,t),i,"range")},setBookmark:function(e,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return hi(this,e=de(this,e),e,i,"bookmark")},findMarksAt:function(e){var t=[],i=rn(this,(e=de(this,e)).line).markedSpans;if(i)for(var n=0;n<i.length;++n){var s=i[n];(null==s.from||s.from<=e.ch)&&(null==s.to||s.to>=e.ch)&&t.push(s.marker.parent||s.marker)}return t},findMarks:function(e,t,i){e=de(this,e),t=de(this,t);var n=[],s=e.line;return this.iter(e.line,t.line+1,function(o){var r=o.markedSpans;if(r)for(var a=0;a<r.length;a++){var l=r[a];s==e.line&&e.ch>l.to||null==l.from&&s!=e.line||s==t.line&&l.from>t.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++s}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&e.push(i[n].marker)}),e},posFromIndex:function(e){var t,i=this.first;return this.iter(function(n){var s=n.text.length+1;return s>e?(t=e,!0):(e-=s,void++i)}),de(this,Ns(i,t))},indexFromPos:function(e){var t=(e=de(this,e)).ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new xo(ln(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);var n=new xo(ln(this,t,i),e.mode||this.modeOption,t);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var i=0;i<t.length;i++){var n=t[i],s=n.find(),o=e.clipPos(s.from),r=e.clipPos(s.to);if(Ls(o,r)){var a=hi(e,o,r,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}(n,pi(this)),n},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i){if(this.linked[i].doc==t){this.linked.splice(i,1),t.unlinkDoc(this),fi(pi(this));break}}if(t.history==this.history){var n=[t.id];sn(t,function(e){n.push(e.id)},!0),t.history=new fn(null),t.history.done=xn(this.history.done,n),t.history.undone=xn(this.history.undone,n)}},iterLinkedDocs:function(e){sn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),xo.prototype.eachLine=xo.prototype.iter;var Co="iter insert remove copy getEditor".split(" ");for(var Eo in xo.prototype)xo.prototype.hasOwnProperty(Eo)&&Pn(Co,Eo)<0&&(e.prototype[Eo]=function(e){return function(){return e.apply(this.doc,arguments)}}(xo.prototype[Eo]));Fn(xo);var To=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},ko=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},_o=e.e_stop=function(e){To(e),ko(e)},So=e.on=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var n=e._handlers||(e._handlers={});(n[t]||(n[t]=[])).push(i)}},Do=e.off=function(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else{var n=e._handlers&&e._handlers[t];if(!n)return;for(var s=0;s<n.length;++s)if(n[s]==i){n.splice(s,1);break}}},$o=e.signal=function(e,t){var i=e._handlers&&e._handlers[t];if(i)for(var n=Array.prototype.slice.call(arguments,2),s=0;s<i.length;++s)i[s].apply(null,n)},Mo=null,Ao=30,Oo=e.Pass={toString:function(){return"CodeMirror.Pass"}},Fo={scroll:!1},No={origin:"*mouse"},Lo={origin:"+move"};Nn.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Ro=e.countColumn=function(e,t,i,n,s){null==t&&(-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length));for(var o=n||0,r=s||0;;){var a=e.indexOf("\t",o);if(0>a||a>=t)return r+(t-o);r+=a-o,r+=i-r%i,o=a+1}},Io=[""],Po=function(e){e.select()};ks?Po=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:gs&&(Po=function(e){try{e.select()}catch(e){}});var Bo,Ho=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Uo=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Ho.test(e))},zo=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Bo=document.createRange?function(e,t,i,n){var s=document.createRange();return s.setEnd(n||e,i),s.setStart(e,t),s}:function(e,t,i){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n};var jo=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)};gs&&11>vs&&(Xn=function(){try{return document.activeElement}catch(e){return document.body}});var Ko,Wo,Vo=e.rmClass=function(e,t){var i=e.className,n=Qn(t).exec(i);if(n){var s=i.slice(n.index+n[0].length);e.className=i.slice(0,n.index)+(s?n[1]+s:"")}},Yo=e.addClass=function(e,t){var i=e.className;Qn(t).test(i)||(e.className+=(i?" ":"")+t)},qo=!1,Go=function(){if(gs&&9>vs)return!1;var e=Yn("div");return"draggable"in e||"dragDrop"in e}(),Xo=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,i=[],n=e.length;n>=t;){var s=e.indexOf("\n",t);-1==s&&(s=e.length);var o=e.slice(t,"\r"==e.charAt(s-1)?s-1:s),r=o.indexOf("\r");-1!=r?(i.push(o.slice(0,r)),t+=r+1):(i.push(o),t=s+1)}return i}:function(e){return e.split(/\r\n?|\n/)},Qo=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Zo=function(){var e=Yn("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Jo=null,er={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=er,function(){for(var e=0;10>e;e++)er[e+48]=er[e+96]=String(e);for(e=65;90>=e;e++)er[e]=String.fromCharCode(e);for(e=1;12>=e;e++)er[e+111]=er[e+63235]="F"+e}();var tr,ir=function(){function e(e){return 247>=e?i.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?n.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,i){this.level=e,this.from=t,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",s=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,r=/[LRr]/,a=/[Lb1n]/,l=/[1n]/,c="L";return function(i){if(!s.test(i))return!1;for(var n=i.length,d=[],u=0;n>u;++u)d.push(v=e(i.charCodeAt(u)));u=0;for(var h=c;n>u;++u){"m"==(v=d[u])?d[u]=h:h=v}u=0;for(var p=c;n>u;++u){"1"==(v=d[u])&&"r"==p?d[u]="n":r.test(v)&&(p=v,"r"==v&&(d[u]="R"))}for(u=1,h=d[0];n-1>u;++u){"+"==(v=d[u])&&"1"==h&&"1"==d[u+1]?d[u]="1":","!=v||h!=d[u+1]||"1"!=h&&"n"!=h||(d[u]=h),h=v}for(u=0;n>u;++u){if(","==(v=d[u]))d[u]="N";else if("%"==v){for(var f=u+1;n>f&&"%"==d[f];++f);for(var m=u&&"!"==d[u-1]||n>f&&"1"==d[f]?"1":"N",g=u;f>g;++g)d[g]=m;u=f-1}}for(u=0,p=c;n>u;++u){var v=d[u];"L"==p&&"1"==v?d[u]="L":r.test(v)&&(p=v)}for(u=0;n>u;++u)if(o.test(d[u])){for(f=u+1;n>f&&o.test(d[f]);++f);var b="L"==(u?d[u-1]:c),y="L"==(n>f?d[f]:c);for(m=b||y?"L":"R",g=u;f>g;++g)d[g]=m;u=f-1}var w,x=[];for(u=0;n>u;)if(a.test(d[u])){var C=u;for(++u;n>u&&a.test(d[u]);++u);x.push(new t(0,C,u))}else{var E=u,T=x.length;for(++u;n>u&&"L"!=d[u];++u);for(g=E;u>g;)if(l.test(d[g])){g>E&&x.splice(T,0,new t(1,E,g));var k=g;for(++g;u>g&&l.test(d[g]);++g);x.splice(T,0,new t(2,k,g)),E=g}else++g;u>E&&x.splice(T,0,new t(1,E,u))}return 1==x[0].level&&(w=i.match(/^\s+/))&&(x[0].from=w[0].length,x.unshift(new t(0,0,w[0].length))),1==In(x).level&&(w=i.match(/\s+$/))&&(In(x).to-=w[0].length,x.push(new t(0,n-w[0].length,n))),2==x[0].level&&x.unshift(new t(1,x[0].to,x[0].to)),x[0].level!=In(x).level&&x.push(new t(x[0].level,n,n)),x}}();return e.version="5.3.0",e}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("xml",function(t,i){function n(e,t){function i(i){return t.tokenize=i,i(e,t)}var n=e.next();return"<"==n?e.eat("!")?e.eat("[")?e.match("CDATA[")?i(r("atom","]]>")):null:e.match("--")?i(r("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),i(a(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=r("meta","?>"),"meta"):(E=e.eat("/")?"closeTag":"openTag",t.tokenize=s,"tag bracket"):"&"==n?(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error":(e.eatWhile(/[^&<]/),null)}function s(e,t){var i=e.next();if(">"==i||"/"==i&&e.eat(">"))return t.tokenize=n,E=">"==i?"endTag":"selfcloseTag","tag bracket";if("="==i)return E="equals",null;if("<"==i){t.tokenize=n,t.state=u,t.tagName=t.tagStart=null;var s=t.tokenize(e,t);return s?s+" tag error":"tag error"}return/[\'\"]/.test(i)?(t.tokenize=o(i),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function o(e){var t=function(t,i){for(;!t.eol();)if(t.next()==e){i.tokenize=s;break}return"string"};return t.isInAttribute=!0,t}function r(e,t){return function(i,s){for(;!i.eol();){if(i.match(t)){s.tokenize=n;break}i.next()}return e}}function a(e){return function(t,i){for(var s;null!=(s=t.next());){if("<"==s)return i.tokenize=a(e+1),i.tokenize(t,i);if(">"==s){if(1==e){i.tokenize=n;break}return i.tokenize=a(e-1),i.tokenize(t,i)}}return"meta"}}function l(e,t,i){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=i,(k.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function c(e){e.context&&(e.context=e.context.prev)}function d(e,t){for(var i;;){if(!e.context)return;if(i=e.context.tagName,!k.contextGrabbers.hasOwnProperty(i)||!k.contextGrabbers[i].hasOwnProperty(t))return;c(e)}}function u(e,t,i){return"openTag"==e?(i.tagStart=t.column(),h):"closeTag"==e?p:u}function h(e,t,i){return"word"==e?(i.tagName=t.current(),T="tag",g):(T="error",h)}function p(e,t,i){if("word"==e){var n=t.current();return i.context&&i.context.tagName!=n&&k.implicitlyClosed.hasOwnProperty(i.context.tagName)&&c(i),i.context&&i.context.tagName==n?(T="tag",f):(T="tag error",m)}return T="error",m}function f(e,t,i){return"endTag"!=e?(T="error",f):(c(i),u)}function m(e,t,i){return T="error",f(e,0,i)}function g(e,t,i){if("word"==e)return T="attribute",v;if("endTag"==e||"selfcloseTag"==e){var n=i.tagName,s=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==e||k.autoSelfClosers.hasOwnProperty(n)?d(i,n):(d(i,n),i.context=new l(i,n,s==i.indented)),u}return T="error",g}function v(e,t,i){return"equals"==e?b:(k.allowMissing||(T="error"),g(e,0,i))}function b(e,t,i){return"string"==e?y:"word"==e&&k.allowUnquoted?(T="string",g):(T="error",g(e,0,i))}function y(e,t,i){return"string"==e?y:g(e,0,i)}var w=t.indentUnit,x=i.multilineTagIndentFactor||1,C=i.multilineTagIndentPastTag;null==C&&(C=!0);var E,T,k=i.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},_=i.alignCDATA;return{startState:function(){return{tokenize:n,state:u,indented:0,tagName:null,tagStart:null,context:null}},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;E=null;var i=t.tokenize(e,t);return(i||E)&&"comment"!=i&&(T=null,t.state=t.state(E||i,e,t),T&&(i="error"==T?i+" error":T)),i},indent:function(t,i,o){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+w;if(r&&r.noIndent)return e.Pass;if(t.tokenize!=s&&t.tokenize!=n)return o?o.match(/^(\s*)/)[0].length:0;if(t.tagName)return C?t.tagStart+t.tagName.length+2:t.tagStart+w*x;if(_&&/<!\[CDATA\[/.test(i))return 0;var a=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(a&&a[1])for(;r;){if(r.tagName==a[2]){r=r.prev;break}if(!k.implicitlyClosed.hasOwnProperty(r.tagName))break;r=r.prev}else if(a)for(;r;){var l=k.contextGrabbers[r.tagName];if(!l||!l.hasOwnProperty(a[2]))break;r=r.prev}for(;r&&!r.startOfLine;)r=r.prev;return r?r.indent+w:0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:i.htmlMode?"html":"xml",helperType:i.htmlMode?"html":"xml"}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){var t=function(i,n){this.id=++e.FE.ID,this.opts=e.extend(!0,{},e.extend({},t.DEFAULTS,"object"==typeof n&&n));var s=JSON.stringify(this.opts);e.FE.OPTS_MAPPING[s]=e.FE.OPTS_MAPPING[s]||this.id,this.sid=e.FE.OPTS_MAPPING[s],e.FE.SHARED[this.sid]=e.FE.SHARED[this.sid]||{},this.shared=e.FE.SHARED[this.sid],this.shared.count=(this.shared.count||0)+1,this.$oel=e(i),this.$oel.data("froala.editor",this),this.o_doc=i.ownerDocument,this.o_win="defaultView"in this.o_doc?this.o_doc.defaultView:this.o_doc.parentWindow;var o=e(this.o_win).scrollTop();this.$oel.on("froala.doInit",e.proxy(function(){this.$oel.off("froala.doInit"),this.doc=this.$el.get(0).ownerDocument,this.win="defaultView"in this.doc?this.doc.defaultView:this.doc.parentWindow,this.$doc=e(this.doc),this.$win=e(this.win),this.opts.pluginsEnabled||(this.opts.pluginsEnabled=Object.keys(e.FE.PLUGINS)),this.opts.initOnClick?(this.load(e.FE.MODULES),this.$el.on("touchstart.init",function(){e(this).data("touched",!0)}),this.$el.on("touchmove.init",function(){e(this).removeData("touched")}),this.$el.on("mousedown.init touchend.init dragenter.init focus.init",e.proxy(function(t){if("touchend"==t.type&&!this.$el.data("touched"))return!0;if(1===t.which||!t.which){this.$el.off("mousedown.init touchstart.init touchmove.init touchend.init dragenter.init focus.init"),this.load(e.FE.MODULES),this.load(e.FE.PLUGINS);var i=t.originalEvent&&t.originalEvent.originalTarget;i&&"IMG"==i.tagName&&e(i).trigger("mousedown"),void 0===this.ul&&this.destroy(),"touchend"==t.type&&this.image&&t.originalEvent&&t.originalEvent.target&&e(t.originalEvent.target).is("img")&&setTimeout(e.proxy(function(){this.image.edit(e(t.originalEvent.target))},this),100),this.ready=!0,this.events.trigger("initialized")}},this))):(this.load(e.FE.MODULES),this.load(e.FE.PLUGINS),e(this.o_win).scrollTop(o),void 0===this.ul&&this.destroy(),this.ready=!0,this.events.trigger("initialized"))},this)),this._init()};t.DEFAULTS={initOnClick:!1,pluginsEnabled:null},t.MODULES={},t.PLUGINS={},t.VERSION="2.4.0",t.INSTANCES=[],t.OPTS_MAPPING={},t.SHARED={},t.ID=0,t.prototype._init=function(){var t=this.$oel.prop("tagName"),i=e.proxy(function(){"TEXTAREA"!=t&&(this._original_html=this._original_html||this.$oel.html()),this.$box=this.$box||this.$oel,this.opts.fullPage&&(this.opts.iframe=!0),this.opts.iframe?(this.$iframe=e('<iframe src="about:blank" frameBorder="0">'),this.$wp=e("<div></div>"),this.$box.html(this.$wp),this.$wp.append(this.$iframe),this.$iframe.get(0).contentWindow.document.open(),this.$iframe.get(0).contentWindow.document.write("<!DOCTYPE html>"),this.$iframe.get(0).contentWindow.document.write("<html><head></head><body></body></html>"),this.$iframe.get(0).contentWindow.document.close(),this.$el=this.$iframe.contents().find("body"),this.el=this.$el.get(0),this.$head=this.$iframe.contents().find("head"),this.$html=this.$iframe.contents().find("html"),this.iframe_document=this.$iframe.get(0).contentWindow.document,this.$oel.trigger("froala.doInit")):(this.$el=e("<div></div>"),this.el=this.$el.get(0),this.$wp=e("<div></div>").append(this.$el),this.$box.html(this.$wp),this.$oel.trigger("froala.doInit"))},this),n=e.proxy(function(){this.$box=e("<div>"),this.$oel.before(this.$box).hide(),this._original_html=this.$oel.val(),this.$oel.parents("form").on("submit."+this.id,e.proxy(function(){this.events.trigger("form.submit")},this)),this.$oel.parents("form").on("reset."+this.id,e.proxy(function(){this.events.trigger("form.reset")},this)),i()},this),s=e.proxy(function(){this.$el=this.$oel,this.el=this.$el.get(0),this.$el.attr("contenteditable",!0).css("outline","none").css("display","inline-block"),this.opts.multiLine=!1,this.opts.toolbarInline=!1,this.$oel.trigger("froala.doInit")},this),o=e.proxy(function(){this.$el=this.$oel,this.el=this.$el.get(0),this.opts.toolbarInline=!1,this.$oel.trigger("froala.doInit")},this),r=e.proxy(function(){this.$el=this.$oel,this.el=this.$el.get(0),this.opts.toolbarInline=!1,this.$oel.on("click.popup",function(e){e.preventDefault()}),this.$oel.trigger("froala.doInit")},this);this.opts.editInPopup?r():"TEXTAREA"==t?n():"A"==t?s():"IMG"==t?o():"BUTTON"==t||"INPUT"==t?(this.opts.editInPopup=!0,this.opts.toolbarInline=!1,r()):i()},t.prototype.load=function(t){for(var i in t)if(t.hasOwnProperty(i)){if(this[i])continue;if(e.FE.PLUGINS[i]&&this.opts.pluginsEnabled.indexOf(i)<0)continue;if(this[i]=new t[i](this),this[i]._init&&(this[i]._init(),this.opts.initOnClick&&"core"==i))return!1}},t.prototype.destroy=function(){this.shared.count--,this.events.$off();var t=this.html.get();if(this.events.trigger("destroy",[],!0),this.events.trigger("shared.destroy",void 0,!0),0===this.shared.count){for(var i in this.shared)this.shared.hasOwnProperty(i)&&(this.shared[i],e.FE.SHARED[this.sid][i]=null);e.FE.SHARED[this.sid]={}}this.$oel.parents("form").off("."+this.id),this.$oel.off("click.popup"),this.$oel.removeData("froala.editor"),this.$oel.off("froalaEditor"),this.core.destroy(t),e.FE.INSTANCES.splice(e.FE.INSTANCES.indexOf(this),1)},e.fn.froalaEditor=function(i){for(var n=[],s=0;s<arguments.length;s++)n.push(arguments[s]);if("string"==typeof i){var o=[];return this.each(function(){var t=e(this).data("froala.editor");if(t){var s,r;if(i.indexOf(".")>0&&t[i.split(".")[0]]?(t[i.split(".")[0]]&&(s=t[i.split(".")[0]]),r=i.split(".")[1]):(s=t,r=i.split(".")[0]),!s[r])return e.error("Method "+i+" does not exist in Froala Editor.");var a=s[r].apply(t,n.slice(1));void 0===a?o.push(this):0===o.length&&o.push(a)}}),1==o.length?o[0]:o}if("object"==typeof i||!i)return this.each(function(){if(!e(this).data("froala.editor")){new t(this,i)}})},e.fn.froalaEditor.Constructor=t,e.FroalaEditor=t,e.FE=t,e.FE.XS=0,e.FE.SM=1,e.FE.MD=2,e.FE.LG=3,e.FE.MODULES.helpers=function(t){function i(){var e={},t=function(){var e,t=-1;return"Microsoft Internet Explorer"==navigator.appName?(e=navigator.userAgent,null!==new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=navigator.userAgent,null!==new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))),t}();if(t>0)e.msie=!0;else{var i=navigator.userAgent.toLowerCase(),n=/(edge)[ \/]([\w.]+)/.exec(i)||/(chrome)[ \/]([\w.]+)/.exec(i)||/(webkit)[ \/]([\w.]+)/.exec(i)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(i)||/(msie) ([\w.]+)/.exec(i)||i.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(i)||[],s={browser:n[1]||"",version:n[2]||"0"};n[1]&&(e[s.browser]=!0),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0)}return e.msie&&(e.version=t),e}function n(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&!r()}function s(){return/(Android)/g.test(navigator.userAgent)&&!r()}function o(){return/(Blackberry)/g.test(navigator.userAgent)}function r(){return/(Windows Phone)/gi.test(navigator.userAgent)}function a(e){return parseInt(e,10)||0}function l(e){if(!/^(https?:|ftps?:|)\/\//i.test(e))return!1;e=String(e).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");return/(http|ftp|https):\/\/[a-z\u00a1-\uffff0-9{}]+(\.[a-z\u00a1-\uffff0-9{}]*)*([a-z\u00a1-\uffff0-9.,@?^=%&amp;:\/~+#-_{}]*[a-z\u00a1-\uffff0-9@?^=%&amp;\/~+#-_{}])?/gi.test(e)}var c,d=null;return{_init:function(){t.browser=i(),function(){function e(e,t){var s=e[t];e[t]=function(e){var t,o=!1,r=!1;if(e.match(n)){e=e.replace(n,""),this.parentNode||(i.appendChild(this),r=!0);var a=this.parentNode;return this.id||(this.id="rootedQuerySelector_id_"+(new Date).getTime(),o=!0),t=s.call(a,"#"+this.id+" "+e),o&&(this.id=""),r&&i.removeChild(this),t}return s.call(this,e)}}var i=t.o_doc.createElement("div");try{i.querySelectorAll(":scope *")}catch(t){var n=/^\s*:scope/gi;e(HTMLElement.prototype,"querySelector"),e(HTMLElement.prototype,"querySelectorAll")}}()},isIOS:n,isMac:function(){return null==d&&(d=navigator.platform.toUpperCase().indexOf("MAC")>=0),d},isAndroid:s,isBlackberry:o,isWindowsPhone:r,isMobile:function(){return s()||n()||o()},requestAnimationFrame:function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}},getPX:a,screenSize:function(){var t=e('<div class="fr-visibility-helper"></div>').appendTo("body"),i=a(t.css("margin-left"));return t.remove(),i},isTouch:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch},sanitizeURL:function(e){if(/^(https?:|ftps?:|)\/\//i.test(e)){if(!l(e)&&!l("http:"+e))return""}else e=encodeURIComponent(e).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/gi,"mailto:").replace(/file%3A/gi,"file:").replace(/sms%3A/gi,"sms:").replace(/tel%3A/gi,"tel:").replace(/notes%3A/gi,"notes:").replace(/data%3Aimage/gi,"data:image").replace(/blob%3A/gi,"blob:").replace(/webkit-fake-url%3A/gi,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@").replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%7B/g,"{").replace(/%7D/g,"}");return e},isArray:function(e){return e&&!e.propertyIsEnumerable("length")&&"object"==typeof e&&"number"==typeof e.length},RGBToHex:function(e){function t(e){return("0"+parseInt(e,10).toString(16)).slice(-2)}try{return e&&"transparent"!==e?/^#[0-9A-F]{6}$/i.test(e)?e:("#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])).toUpperCase():""}catch(e){return null}},HEXtoRGB:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,n){return t+t+i+i+n+n});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgb("+parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16)+")":""},isURL:l,getAlignment:function(t){var i=(t.css("text-align")||"").replace(/-(.*)-/g,"");if(["left","right","justify","center"].indexOf(i)<0){if(!c){var n=e('<div dir="auto" style="text-align: initial; position: fixed; left: -3000px;"><span id="s1">.</span><span id="s2">.</span></div>');e("body").append(n);var s=n.find("#s1").get(0).getBoundingClientRect().left,o=n.find("#s2").get(0).getBoundingClientRect().left;n.remove(),c=s<o?"left":"right"}i=c}return i}}},e.FE.MODULES.events=function(t){function i(e,t,i){c(e,t,i)}function n(i){if(void 0===i&&(i=!0),!t.$wp)return!1;if(t.helpers.isIOS()&&t.$win.get(0).focus(),!t.core.hasFocus()&&i){var n=t.$win.scrollTop();return t.$el.focus(),n!=t.$win.scrollTop()&&t.$win.scrollTop(n),!1}if(!t.core.hasFocus()||t.$el.find(".fr-marker").length>0)return!1;if(t.selection.info(t.el).atStart&&t.selection.isCollapsed()&&null!=t.html.defaultTag()){var s=t.markers.insert();if(s&&!t.node.blockParent(s)){e(s).remove();var o=t.$el.find(t.html.blockTagsQuery()).get(0);o&&(e(o).prepend(e.FE.MARKERS),t.selection.restore())}else s&&e(s).remove()}}function s(i){var n=e(i.currentTarget);return t.edit.isDisabled()||t.node.hasClass(n.get(0),"fr-disabled")?(i.preventDefault(),!1):"mousedown"===i.type&&1!==i.which||(t.helpers.isMobile()||i.preventDefault(),(t.helpers.isAndroid()||t.helpers.isWindowsPhone())&&0===n.parents(".fr-dropdown-menu").length&&(i.preventDefault(),i.stopPropagation()),n.addClass("fr-selected"),void t.events.trigger("commands.mousedown",[n]))}function o(i,n){var s=e(i.currentTarget);if(t.edit.isDisabled()||t.node.hasClass(s.get(0),"fr-disabled"))return i.preventDefault(),!1;if("mouseup"===i.type&&1!==i.which)return!0;if(!t.node.hasClass(s.get(0),"fr-selected"))return!0;if("touchmove"!=i.type){if(i.stopPropagation(),i.stopImmediatePropagation(),i.preventDefault(),!t.node.hasClass(s.get(0),"fr-selected"))return e(".fr-selected").removeClass("fr-selected"),!1;if(e(".fr-selected").removeClass("fr-selected"),s.data("dragging")||s.attr("disabled"))return s.removeData("dragging"),!1;var o=s.data("timeout");o&&(clearTimeout(o),s.removeData("timeout")),n.apply(t,[i])}else s.data("timeout")||s.data("timeout",setTimeout(function(){s.data("dragging",!0)},100))}function r(){f=!0}function a(){return f}function l(e,i,n){var s,o=e.split(" ");if(o.length>1){for(var r=0;r<o.length;r++)l(o[r],i,n);return!0}void 0===n&&(n=!1),s=0!=e.indexOf("shared.")?m[e]=m[e]||[]:t.shared._events[e]=t.shared._events[e]||[],n?s.unshift(i):s.push(i)}function c(e,i,n,s,o){"function"==typeof n&&(o=s,s=n,n=!1);var r=o?t.shared.$_events:v,a=o?t.sid:t.id;n?e.on(i.split(" ").join(".ed"+a+" ")+".ed"+a,n,s):e.on(i.split(" ").join(".ed"+a+" ")+".ed"+a,s),r.indexOf(e.get(0))<0&&r.push(e.get(0))}function d(t,i){for(var n=0;n<t.length;n++)e(t[n]).off(".ed"+i)}function u(i,n,s){if(!t.edit.isDisabled()||s){var o,r;if(0!=i.indexOf("shared."))o=m[i];else{if(t.shared.count>0)return!1;o=t.shared._events[i]}if(o)for(var a=0;a<o.length;a++)if(!1===(r=o[a].apply(t,n)))return!1;return!1!==(r=t.$oel.triggerHandler("froalaEditor."+i,e.merge([t],n||[])))&&r}}function h(){for(var e in m)m.hasOwnProperty(e)&&delete m[e]}function p(){for(var e in t.shared._events)t.shared._events.hasOwnProperty(e)&&delete t.shared._events[e]}var f,m={},g=!1,v=[];return{_init:function(){t.shared.$_events=t.shared.$_events||[],t.shared._events={},t.helpers.isMobile()?(t._mousedown="touchstart",t._mouseup="touchend",t._move="touchmove",t._mousemove="touchmove"):(t._mousedown="mousedown",t._mouseup="mouseup",t._move="",t._mousemove="mousemove"),i(t.$el,"click mouseup mousedown touchstart touchend dragenter dragover dragleave dragend drop dragstart",function(e){u(e.type,[e])}),l("mousedown",function(){for(var i=0;i<e.FE.INSTANCES.length;i++)e.FE.INSTANCES[i]!=t&&e.FE.INSTANCES[i].popups&&e.FE.INSTANCES[i].popups.areVisible()&&e.FE.INSTANCES[i].$el.find(".fr-marker").remove()}),i(t.$win,t._mousedown,function(e){u("window.mousedown",[e]),r()}),i(t.$win,t._mouseup,function(e){u("window.mouseup",[e])}),i(t.$win,"cut copy keydown keyup touchmove touchend",function(e){u("window."+e.type,[e])}),i(t.$doc,"dragend drop",function(e){u("document."+e.type,[e])}),i(t.$el,"keydown keypress keyup input",function(e){u(e.type,[e])}),i(t.$el,"focus",function(e){a()&&(n(!1),!1===g&&u(e.type,[e]))}),i(t.$el,"blur",function(e){a()&&!0===g&&(u(e.type,[e]),r())}),l("focus",function(){g=!0}),l("blur",function(){g=!1}),r(),i(t.$el,"cut copy paste beforepaste",function(e){u(e.type,[e])}),l("destroy",h),l("shared.destroy",p)},on:l,trigger:u,bindClick:function(e,i,n){c(e,t._mousedown,i,function(e){t.edit.isDisabled()||s(e)},!0),c(e,t._mouseup+" "+t._move,i,function(e){t.edit.isDisabled()||o(e,n)},!0),c(e,"mousedown click mouseup",i,function(e){t.edit.isDisabled()||e.stopPropagation()},!0),l("window.mouseup",function(){t.edit.isDisabled()||(e.find(i).removeClass("fr-selected"),r())})},disableBlur:function(){f=!1},enableBlur:r,blurActive:a,focus:n,chainTrigger:function(i,n,s){if(!t.edit.isDisabled()||s){var o,r;if(0!=i.indexOf("shared."))o=m[i];else{if(t.shared.count>0)return!1;o=t.shared._events[i]}if(o)for(var a=0;a<o.length;a++)void 0!==(r=o[a].apply(t,[n]))&&(n=r);return void 0!==(r=t.$oel.triggerHandler("froalaEditor."+i,e.merge([t],[n])))&&(n=r),n}},$on:c,$off:function(){d(v,t.id),v=[],0==t.shared.count&&(d(t.shared.$_events,t.sid),t.shared.$_events=null)}}},e.FE.MODULES.node=function(t){function i(e){return e&&"IFRAME"!=e.tagName?Array.prototype.slice.call(e.childNodes||[]):[]}function n(t){return!!t&&t.nodeType==Node.ELEMENT_NODE&&e.FE.BLOCK_TAGS.indexOf(t.tagName.toLowerCase())>=0}function s(e){var t={},i=e.attributes;if(i)for(var n=0;n<i.length;n++){var s=i[n];t[s.nodeName]=s.value}return t}function o(e){for(var t="",i=s(e),n=Object.keys(i).sort(),o=0;o<n.length;o++){var r=n[o],a=i[r];t+=a.indexOf('"')<0?" "+r+'="'+a+'"':" "+r+"='"+a+"'"}return t}function r(e){return e===t.el}return{isBlock:n,isEmpty:function(s,o){if(!s)return!0;if(s.querySelector("table"))return!1;var r=i(s);1==r.length&&n(r[0])&&(r=i(r[0]));for(var a=!1,l=0;l<r.length;l++){var c=r[l];if(!(o&&t.node.hasClass(c,"fr-marker")||c.nodeType==Node.TEXT_NODE&&0==c.textContent.length)){if("BR"!=c.tagName&&(c.textContent||"").replace(/\u200B/gi,"").replace(/\n/g,"").length>0)return!1;if(a)return!1;"BR"==c.tagName&&(a=!0)}}return!(s.querySelectorAll(e.FE.VOID_ELEMENTS.join(",")).length-s.querySelectorAll("br").length||s.querySelector(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)")||s.querySelectorAll(e.FE.BLOCK_TAGS.join(",")).length>1||s.querySelector(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)"))},blockParent:function(e){for(;e&&e.parentNode!==t.el&&(!e.parentNode||!t.node.hasClass(e.parentNode,"fr-inner"));)if(n(e=e.parentNode))return e;return null},deepestParent:function(i,s,o){if(void 0===s&&(s=[]),void 0===o&&(o=!0),s.push(t.el),s.indexOf(i.parentNode)>=0||i.parentNode&&t.node.hasClass(i.parentNode,"fr-inner")||i.parentNode&&e.FE.SIMPLE_ENTER_TAGS.indexOf(i.parentNode.tagName)>=0&&o)return null;for(;s.indexOf(i.parentNode)<0&&i.parentNode&&!t.node.hasClass(i.parentNode,"fr-inner")&&(e.FE.SIMPLE_ENTER_TAGS.indexOf(i.parentNode.tagName)<0||!o)&&(!n(i)||!n(i.parentNode)||!o);)i=i.parentNode;return i},rawAttributes:s,attributes:o,clearAttributes:function(e){for(var t=e.attributes,i=0;i<t.length;i++){var n=t[i];e.removeAttribute(n.nodeName)}},openTagString:function(e){return"<"+e.tagName.toLowerCase()+o(e)+">"},closeTagString:function(e){return"</"+e.tagName.toLowerCase()+">"},isFirstSibling:function e(i,n){void 0===n&&(n=!0);for(var s=i.previousSibling;s&&n&&t.node.hasClass(s,"fr-marker");)s=s.previousSibling;return!s||s.nodeType==Node.TEXT_NODE&&""===s.textContent&&e(s)},isLastSibling:function e(i,n){void 0===n&&(n=!0);for(var s=i.nextSibling;s&&n&&t.node.hasClass(s,"fr-marker");)s=s.nextSibling;return!s||s.nodeType==Node.TEXT_NODE&&""===s.textContent&&e(s)},isList:function(e){return!!e&&["UL","OL"].indexOf(e.tagName)>=0},isElement:r,contents:i,isVoid:function(t){return t&&t.nodeType==Node.ELEMENT_NODE&&e.FE.VOID_ELEMENTS.indexOf((t.tagName||"").toLowerCase())>=0},hasFocus:function(e){return e===t.doc.activeElement&&(!t.doc.hasFocus||t.doc.hasFocus())&&!!(r(e)||e.type||e.href||~e.tabIndex)},isEditable:function(e){return(!e.getAttribute||"false"!=e.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(e.tagName)<0},isDeletable:function(e){return e&&e.nodeType==Node.ELEMENT_NODE&&e.getAttribute("class")&&(e.getAttribute("class")||"").indexOf("fr-deletable")>=0},hasClass:function(e,t){return e instanceof jQuery&&(e=e.get(0)),e&&e.classList&&e.classList.contains(t)},filter:function(e){return t.browser.msie?e:{acceptNode:e}}}},e.FE.INVISIBLE_SPACE="&#8203;",e.FE.START_MARKER='<span class="fr-marker" data-id="0" data-type="true" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",e.FE.END_MARKER='<span class="fr-marker" data-id="0" data-type="false" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",e.FE.MARKERS=e.FE.START_MARKER+e.FE.END_MARKER,e.FE.MODULES.markers=function(t){function i(){if(!t.$wp)return null;try{var i=t.selection.ranges(0),n=i.commonAncestorContainer;if(n!=t.el&&0==t.$el.find(n).length)return null;var s=i.cloneRange(),o=i.cloneRange();s.collapse(!0);var r=e('<span class="fr-marker" style="display: none; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",t.doc)[0];if(s.insertNode(r),r=t.$el.find("span.fr-marker").get(0)){for(var a=r.nextSibling;a&&a.nodeType===Node.TEXT_NODE&&0===a.textContent.length;)e(a).remove(),a=t.$el.find("span.fr-marker").get(0).nextSibling;return t.selection.clear(),t.selection.get().addRange(o),r}return null}catch(e){}}function n(){t.$el.find(".fr-marker").remove()}return{place:function(i,n,s){try{var o=i.cloneRange();if(o.collapse(n),o.insertNode(function(i,n){return e('<span class="fr-marker" data-id="'+n+'" data-type="'+i+'" style="display: '+(t.browser.safari?"none":"inline-block")+'; line-height: 0;">'+e.FE.INVISIBLE_SPACE+"</span>",t.doc)[0]}(n,s)),!0===n&&i.collapsed)for(var r=(l=t.$el.find('span.fr-marker[data-type="true"][data-id="'+s+'"]')).get(0).nextSibling;r&&r.nodeType===Node.TEXT_NODE&&0===r.textContent.length;)e(r).remove(),r=l.nextSibling;if(!0===n&&!i.collapsed&&(r=(l=t.$el.find('span.fr-marker[data-type="true"][data-id="'+s+'"]').get(0)).nextSibling)&&r.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(r)){var a=[r];do{r=a[0],a=t.node.contents(r)}while(a[0]&&t.node.isBlock(a[0]));e(r).prepend(e(l))}if(!1===n&&!i.collapsed){var l;if((r=(l=t.$el.find('span.fr-marker[data-type="false"][data-id="'+s+'"]').get(0)).previousSibling)&&r.nodeType===Node.ELEMENT_NODE&&t.node.isBlock(r)){a=[r];do{r=a[a.length-1],a=t.node.contents(r)}while(a[a.length-1]&&t.node.isBlock(a[a.length-1]));e(r).append(e(l))}l.parentNode&&["TD","TH"].indexOf(l.parentNode.tagName)>=0&&l.parentNode.previousSibling&&!l.previousSibling&&e(l.parentNode.previousSibling).append(l)}var c=t.$el.find('span.fr-marker[data-type="'+n+'"][data-id="'+s+'"]').get(0);return c&&(c.style.display="none"),c}catch(e){return null}},insert:i,split:function(){t.selection.isCollapsed()||t.selection.remove();var n=t.$el.find(".fr-marker").get(0);if(null==n&&(n=i()),null==n)return null;var s=t.node.deepestParent(n);if(s||(s=t.node.blockParent(n))&&"LI"!=s.tagName&&(s=null),s)if(t.node.isBlock(s)&&t.node.isEmpty(s))e(s).replaceWith('<span class="fr-marker"></span>');else if(t.cursor.isAtStart(n,s))e(s).before('<span class="fr-marker"></span>'),e(n).remove();else if(t.cursor.isAtEnd(n,s))e(s).after('<span class="fr-marker"></span>'),e(n).remove();else{var o=n,r="",a="";do{o=o.parentNode,r+=t.node.closeTagString(o),a=t.node.openTagString(o)+a}while(o!=s);e(n).replaceWith('<span id="fr-break"></span>');var l=t.node.openTagString(s)+e(s).html()+t.node.closeTagString(s);l=l.replace(/<span id="fr-break"><\/span>/g,r+'<span class="fr-marker"></span>'+a),e(s).replaceWith(l)}return t.$el.find(".fr-marker").get(0)},insertAtPoint:function(e){var s=e.clientX,o=e.clientY;n();var r,a=null;if(void 0!==t.doc.caretPositionFromPoint?(r=t.doc.caretPositionFromPoint(s,o),(a=t.doc.createRange()).setStart(r.offsetNode,r.offset),a.setEnd(r.offsetNode,r.offset)):void 0!==t.doc.caretRangeFromPoint&&(r=t.doc.caretRangeFromPoint(s,o),(a=t.doc.createRange()).setStart(r.startContainer,r.startOffset),a.setEnd(r.startContainer,r.startOffset)),null!==a&&void 0!==t.win.getSelection){var l=t.win.getSelection();l.removeAllRanges(),l.addRange(a)}else if(void 0!==t.doc.body.createTextRange)try{(a=t.doc.body.createTextRange()).moveToPoint(s,o);var c=a.duplicate();c.moveToPoint(s,o),a.setEndPoint("EndToEnd",c),a.select()}catch(e){return!1}i()},remove:n}},e.FE.MODULES.selection=function(t){function i(){var e="";return t.win.getSelection?e=t.win.getSelection():t.doc.getSelection?e=t.doc.getSelection():t.doc.selection&&(e=t.doc.selection.createRange().text),e.toString()}function n(){return t.win.getSelection?t.win.getSelection():t.doc.getSelection?t.doc.getSelection():t.doc.selection.createRange()}function s(e){var i=n(),s=[];if(i&&i.getRangeAt&&i.rangeCount){s=[];for(var o=0;o<i.rangeCount;o++)s.push(i.getRangeAt(o))}else s=t.doc.createRange?[t.doc.createRange()]:[];return void 0!==e?s[e]:s}function o(){var e=n();try{e.removeAllRanges?e.removeAllRanges():e.empty?e.empty():e.clear&&e.clear()}catch(e){}}function r(e,t){var i=e;return i.nodeType==Node.ELEMENT_NODE&&i.childNodes.length>0&&i.childNodes[t]&&(i=i.childNodes[t]),i.nodeType==Node.TEXT_NODE&&(i=i.parentNode),i}function a(){if(t.$wp){t.markers.remove();for(var e=s(),i=[],n=0;n<e.length;n++)if(e[n].startContainer!==t.doc){var o,r=(o=e[n]).collapsed,a=t.markers.place(o,!0,n),l=t.markers.place(o,!1,n);if(t.el.normalize(),t.browser.safari&&!r)(o=t.doc.createRange()).setStartAfter(a),o.setEndBefore(l),i.push(o)}if(t.browser.safari&&i.length){t.selection.clear();for(n=0;n<i.length;n++)t.selection.get().addRange(i[n])}}}function l(){var i=t.el.querySelectorAll('.fr-marker[data-type="true"]');if(!t.$wp)return t.markers.remove(),!1;if(0===i.length)return!1;if(t.browser.msie||t.browser.edge)for(var s=0;s<i.length;s++)i[s].style.display="inline-block";t.core.hasFocus()||t.browser.msie||t.browser.webkit||t.$el.focus(),o();var r=n();for(s=0;s<i.length;s++){var a=e(i[s]).data("id"),l=i[s],d=t.doc.createRange(),u=t.$el.find('.fr-marker[data-type="false"][data-id="'+a+'"]');(t.browser.msie||t.browser.edge)&&u.css("display","inline-block");var h=null;if(u.length>0){u=u[0];try{for(var p=!1,f=l.nextSibling;f&&f.nodeType==Node.TEXT_NODE&&0==f.textContent.length;){var m=f;f=f.nextSibling,e(m).remove()}for(var g=u.nextSibling;g&&g.nodeType==Node.TEXT_NODE&&0==g.textContent.length;){m=g;g=g.nextSibling,e(m).remove()}if(l.nextSibling==u||u.nextSibling==l){for(var v=l.nextSibling==u?l:u,b=v==l?u:l,y=v.previousSibling;y&&y.nodeType==Node.TEXT_NODE&&0==y.length;){m=y;y=y.previousSibling,e(m).remove()}if(y&&y.nodeType==Node.TEXT_NODE)for(;y&&y.previousSibling&&y.previousSibling.nodeType==Node.TEXT_NODE;)y.previousSibling.textContent=y.previousSibling.textContent+y.textContent,y=y.previousSibling,e(y.nextSibling).remove();for(var w=b.nextSibling;w&&w.nodeType==Node.TEXT_NODE&&0==w.length;){m=w;w=w.nextSibling,e(m).remove()}if(w&&w.nodeType==Node.TEXT_NODE)for(;w&&w.nextSibling&&w.nextSibling.nodeType==Node.TEXT_NODE;)w.nextSibling.textContent=w.textContent+w.nextSibling.textContent,w=w.nextSibling,e(w.previousSibling).remove();if(y&&(t.node.isVoid(y)||t.node.isBlock(y))&&(y=null),w&&(t.node.isVoid(w)||t.node.isBlock(w))&&(w=null),y&&w&&y.nodeType==Node.TEXT_NODE&&w.nodeType==Node.TEXT_NODE){e(l).remove(),e(u).remove();var x=y.textContent.length;y.textContent=y.textContent+w.textContent,e(w).remove(),t.spaces.normalize(y),d.setStart(y,x),d.setEnd(y,x),p=!0}else!y&&w&&w.nodeType==Node.TEXT_NODE?(e(l).remove(),e(u).remove(),t.spaces.normalize(w),h=e(t.doc.createTextNode("​")),e(w).before(h),d.setStart(w,0),d.setEnd(w,0),p=!0):!w&&y&&y.nodeType==Node.TEXT_NODE&&(e(l).remove(),e(u).remove(),t.spaces.normalize(y),h=e(t.doc.createTextNode("​")),e(y).after(h),d.setStart(y,y.textContent.length),d.setEnd(y,y.textContent.length),p=!0)}if(!p){var C,E;if(t.browser.chrome&&l.nextSibling==u)C=c(u,d,!0)||d.setStartAfter(u),E=c(l,d,!1)||d.setEndBefore(l);else{l.previousSibling==u&&(u=(l=u).nextSibling),u.nextSibling&&"BR"===u.nextSibling.tagName||!u.nextSibling&&t.node.isBlock(l.previousSibling)||l.previousSibling&&"BR"==l.previousSibling.tagName||(l.style.display="inline",u.style.display="inline",h=e(t.doc.createTextNode("​")));var T=l.previousSibling;T&&T.style&&"block"==t.win.getComputedStyle(T).display&&!t.opts.enter==e.FE.ENTER_BR?(d.setEndAfter(T),d.setStartAfter(T)):(C=c(l,d,!0)||e(l).before(h)&&d.setStartBefore(l),E=c(u,d,!1)||e(u).after(h)&&d.setEndAfter(u))}"function"==typeof C&&C(),"function"==typeof E&&E()}}catch(e){}}h&&h.remove();try{r.addRange(d)}catch(e){}}t.markers.remove()}function c(i,n,s){var o=i.previousSibling,r=i.nextSibling;if(o&&r&&o.nodeType==Node.TEXT_NODE&&r.nodeType==Node.TEXT_NODE){var a=o.textContent.length;return s?(r.textContent=o.textContent+r.textContent,e(o).remove(),e(i).remove(),t.spaces.normalize(r),function(){n.setStart(r,a)}):(o.textContent=o.textContent+r.textContent,e(r).remove(),e(i).remove(),t.spaces.normalize(o),function(){n.setEnd(o,a)})}if(o&&!r&&o.nodeType==Node.TEXT_NODE){a=o.textContent.length;return s?(t.spaces.normalize(o),function(){n.setStart(o,a)}):(t.spaces.normalize(o),function(){n.setEnd(o,a)})}return!(!r||o||r.nodeType!=Node.TEXT_NODE)&&(s?(t.spaces.normalize(r),function(){n.setStart(r,0)}):(t.spaces.normalize(r),function(){n.setEnd(r,0)}))}function d(){for(var e=s(),t=0;t<e.length;t++)if(!e[t].collapsed)return!1;return!0}function u(e){var i,n,s=!1,o=!1;if(t.win.getSelection){var r=t.win.getSelection();r.rangeCount&&((n=(i=r.getRangeAt(0)).cloneRange()).selectNodeContents(e),n.setEnd(i.startContainer,i.startOffset),s=""===n.toString(),n.selectNodeContents(e),n.setStart(i.endContainer,i.endOffset),o=""===n.toString())}else t.doc.selection&&"Control"!=t.doc.selection.type&&((n=(i=t.doc.selection.createRange()).duplicate()).moveToElementText(e),n.setEndPoint("EndToStart",i),s=""===n.text,n.moveToElementText(e),n.setEndPoint("StartToEnd",i),o=""===n.text);return{atStart:s,atEnd:o}}function h(i,n){void 0===n&&(n=!0);var s=e(i).html();s&&s.replace(/\u200b/g,"").length!=s.length&&e(i).html(s.replace(/\u200b/g,""));for(var o=t.node.contents(i),r=0;r<o.length;r++)o[r].nodeType!=Node.ELEMENT_NODE?e(o[r]).remove():(h(o[r],0==r),0==r&&(n=!1));i.nodeType==Node.TEXT_NODE?e(i).replaceWith('<span data-first="true" data-text="true"></span>'):n&&e(i).attr("data-first",!0)}function p(i,n){var s=t.node.contents(i.get(0));["TD","TH"].indexOf(i.get(0).tagName)>=0&&1==i.find(".fr-marker").length&&t.node.hasClass(s[0],"fr-marker")&&i.attr("data-del-cell",!0);for(var o=0;o<s.length;o++){var r=s[o];t.node.hasClass(r,"fr-marker")?n=(n+1)%2:n?e(r).find(".fr-marker").length>0?n=p(e(r),n):["TD","TH"].indexOf(r.tagName)<0&&!t.node.hasClass(r,"fr-inner")?!t.opts.keepFormatOnDelete||t.$el.find("[data-first]").length>0?e(r).remove():h(r):t.node.hasClass(r,"fr-inner")?0==e(r).find(".fr-inner").length?e(r).html("<br>"):e(r).find(".fr-inner").filter(function(){return 0==e(this).find("fr-inner").length}).html("<br>"):(e(r).empty(),e(r).attr("data-del-cell",!0)):e(r).find(".fr-marker").length>0&&(n=p(e(r),n))}return n}function f(){try{if(!t.$wp)return!1;for(var e=s(0).commonAncestorContainer;e&&!t.node.isElement(e);)e=e.parentNode;return!!t.node.isElement(e)}catch(e){return!1}}function m(i){if(!i||i.getElementsByClassName("fr-marker").length>0)return!1;for(var n=i.firstChild;n&&t.node.isBlock(n);)i=n,n=n.firstChild;i.innerHTML=e.FE.MARKERS+i.innerHTML}function g(i){if(!i||i.getElementsByClassName("fr-marker").length>0)return!1;for(var n=i.lastChild;n&&t.node.isBlock(n);)i=n,n=n.lastChild;i.innerHTML=i.innerHTML+e.FE.MARKERS}return{text:i,get:n,ranges:s,clear:o,element:function(){var o=n();try{if(o.rangeCount){var r=s(0),a=r.startContainer;if(a.nodeType==Node.TEXT_NODE&&r.startOffset==(a.textContent||"").length&&a.nextSibling&&(a=a.nextSibling),a.nodeType==Node.ELEMENT_NODE){var l=!1;if(a.childNodes.length>0&&a.childNodes[r.startOffset]){for(var c=a.childNodes[r.startOffset];c&&c.nodeType==Node.TEXT_NODE&&0==c.textContent.length;)c=c.nextSibling;if(c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0),!l&&a.childNodes.length>1&&r.startOffset>0&&a.childNodes[r.startOffset-1]){for(c=a.childNodes[r.startOffset-1];c&&c.nodeType==Node.TEXT_NODE&&0==c.textContent.length;)c=c.nextSibling;c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}}else!r.collapsed&&a.nextSibling&&a.nextSibling.nodeType==Node.ELEMENT_NODE&&(c=a.nextSibling)&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0);!l&&a.childNodes.length>0&&e(a.childNodes[0]).text().replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&["BR","IMG","HR"].indexOf(a.childNodes[0].tagName)<0&&(a=a.childNodes[0])}for(;a.nodeType!=Node.ELEMENT_NODE&&a.parentNode;)a=a.parentNode;for(var d=a;d&&"HTML"!=d.tagName;){if(d==t.el)return a;d=e(d).parent()[0]}}}catch(e){}return t.el},endElement:function(){var o=n();try{if(o.rangeCount){var r=s(0),a=r.endContainer;if(a.nodeType==Node.ELEMENT_NODE){var l=!1;if(a.childNodes.length>0&&a.childNodes[r.endOffset]&&e(a.childNodes[r.endOffset]).text()===i())a=a.childNodes[r.endOffset],l=!0;else if(!r.collapsed&&a.previousSibling&&a.previousSibling.nodeType==Node.ELEMENT_NODE)(c=a.previousSibling)&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0);else if(!r.collapsed&&a.childNodes.length>0&&a.childNodes[r.endOffset]){var c;(c=a.childNodes[r.endOffset].previousSibling).nodeType==Node.ELEMENT_NODE&&c&&c.textContent.replace(/\u200B/g,"")===i().replace(/\u200B/g,"")&&(a=c,l=!0)}!l&&a.childNodes.length>0&&e(a.childNodes[a.childNodes.length-1]).text()===i()&&["BR","IMG","HR"].indexOf(a.childNodes[a.childNodes.length-1].tagName)<0&&(a=a.childNodes[a.childNodes.length-1])}for(a.nodeType==Node.TEXT_NODE&&0==r.endOffset&&a.previousSibling&&a.previousSibling.nodeType==Node.ELEMENT_NODE&&(a=a.previousSibling);a.nodeType!=Node.ELEMENT_NODE&&a.parentNode;)a=a.parentNode;for(var d=a;d&&"HTML"!=d.tagName;){if(d==t.el)return a;d=e(d).parent()[0]}}}catch(e){}return t.el},save:a,restore:l,isCollapsed:d,isFull:function(){if(d())return!1;t.$el.find("td, th, img").prepend('<span class="fr-mk">'+e.FE.INVISIBLE_SPACE+"</span>");var i=!1,n=u(t.el);return n.atStart&&n.atEnd&&(i=!0),t.$el.find(".fr-mk").remove(),i},inEditor:f,remove:function(){if(d())return!0;a();for(var i=function(t){for(var i=t.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&0==i.textContent.length;){var n=i;i=i.previousSibling,e(n).remove()}return i},n=function(t){for(var i=t.nextSibling;i&&i.nodeType==Node.TEXT_NODE&&0==i.textContent.length;){var n=i;i=i.nextSibling,e(n).remove()}return i},s=t.$el.find('.fr-marker[data-type="true"]'),o=0;o<s.length;o++)for(var r=s[o];!i(r)&&!t.node.isBlock(r.parentNode)&&!t.$el.is(r.parentNode);)e(r.parentNode).before(r);var c=t.$el.find('.fr-marker[data-type="false"]');for(o=0;o<c.length;o++){for(var u=c[o];!n(u)&&!t.node.isBlock(u.parentNode)&&!t.$el.is(u.parentNode);)e(u.parentNode).after(u);u.parentNode&&t.node.isBlock(u.parentNode)&&t.node.isEmpty(u.parentNode)&&!t.$el.is(u.parentNode)&&t.opts.keepFormatOnDelete&&e(u.parentNode).after(u)}p(t.$el,0);var h=t.$el.find('[data-first="true"]');if(h.length)t.$el.find(".fr-marker").remove(),h.append(e.FE.INVISIBLE_SPACE+e.FE.MARKERS).removeAttr("data-first"),h.attr("data-text")&&h.replaceWith(h.html());else for(t.$el.find("table").filter(function(){return e(this).find("[data-del-cell]").length>0&&e(this).find("[data-del-cell]").length==e(this).find("td, th").length}).remove(),t.$el.find("[data-del-cell]").removeAttr("data-del-cell"),s=t.$el.find('.fr-marker[data-type="true"]'),o=0;o<s.length;o++){var f=s[o],m=f.nextSibling,g=t.$el.find('.fr-marker[data-type="false"][data-id="'+e(f).data("id")+'"]').get(0);if(g){if(m&&m==g);else if(f){var v=t.node.blockParent(f),b=t.node.blockParent(g),y=!1,w=!1;if(v&&["UL","OL"].indexOf(v.tagName)>=0&&(v=null,y=!0),b&&["UL","OL"].indexOf(b.tagName)>=0&&(b=null,w=!0),e(f).after(g),v==b);else if(null!=v||y)if(null!=b||w||0!=e(v).parentsUntil(t.$el,"table").length)v&&b&&0==e(v).parentsUntil(t.$el,"table").length&&0==e(b).parentsUntil(t.$el,"table").length&&(e(v).append(e(b).html()),e(b).remove());else{for(m=v;!m.nextSibling&&m.parentNode!=t.el;)m=m.parentNode;for(m=m.nextSibling;m&&"BR"!=m.tagName;){var x=m.nextSibling;e(v).append(m),m=x}m&&"BR"==m.tagName&&e(m).remove()}else{var C=t.node.deepestParent(f);C?(e(C).after(e(b).html()),e(b).remove()):0==e(b).parentsUntil(t.$el,"table").length&&(e(f).next().after(e(b).html()),e(b).remove())}}}else g=e(f).clone().attr("data-type",!1),e(f).after(g)}t.opts.keepFormatOnDelete||t.html.fillEmptyBlocks(),t.html.cleanEmptyTags(!0),t.clean.lists(),t.spaces.normalize();var E=t.$el.find(".fr-marker:last").get(0),T=t.$el.find(".fr-marker:first").get(0);!E.nextSibling&&T.previousSibling&&"BR"==T.previousSibling.tagName&&t.node.isElement(E.parentNode)&&t.node.isElement(T.parentNode)&&t.$el.append("<br>"),l()},blocks:function(){var i=[],o=n();if(f()&&o.rangeCount)for(var a=s(),l=0;l<a.length;l++){var c,d=a[l],u=r(d.startContainer,d.startOffset),h=r(d.endContainer,d.endOffset);t.node.isBlock(u)&&i.indexOf(u)<0&&i.push(u),(c=t.node.blockParent(u))&&i.indexOf(c)<0&&i.push(c);for(var p=[],m=u;m!==h&&m!==t.el;)p.indexOf(m)<0&&m.children&&m.children.length?(p.push(m),m=m.children[0]):m.nextSibling?m=m.nextSibling:m.parentNode&&(m=m.parentNode,p.push(m)),t.node.isBlock(m)&&p.indexOf(m)<0&&i.indexOf(m)<0&&(m!==h||d.endOffset>0)&&i.push(m);t.node.isBlock(h)&&i.indexOf(h)<0&&d.endOffset>0&&i.push(h),(c=t.node.blockParent(h))&&i.indexOf(c)<0&&i.push(c)}for(l=i.length-1;l>0;l--)e(i[l]).find(i).length&&("LI"!=i[l].tagName||1==i[l].children.length&&i.indexOf(i[l].children[0])>=0)&&i.splice(l,1);return i},info:u,setAtEnd:g,setAtStart:m,setBefore:function(i,n){void 0===n&&(n=!0);for(var s=i.previousSibling;s&&s.nodeType==Node.TEXT_NODE&&0==s.textContent.length;)s=s.previousSibling;return s?(t.node.isBlock(s)?g(s):"BR"==s.tagName?e(s).before(e.FE.MARKERS):e(s).after(e.FE.MARKERS),!0):!!n&&(t.node.isBlock(i)?m(i):e(i).before(e.FE.MARKERS),!0)},setAfter:function(i,n){void 0===n&&(n=!0);for(var s=i.nextSibling;s&&s.nodeType==Node.TEXT_NODE&&0==s.textContent.length;)s=s.nextSibling;return s?(t.node.isBlock(s)?m(s):e(s).before(e.FE.MARKERS),!0):!!n&&(t.node.isBlock(i)?g(i):e(i).after(e.FE.MARKERS),!0)},rangeElement:r}},e.extend(e.FE.DEFAULTS,{htmlAllowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","style","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],htmlRemoveTags:["script","style"],htmlAllowedAttrs:["accept","accept-charset","accesskey","action","align","allowfullscreen","allowtransparency","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","frameborder","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","mozallowfullscreen","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","webkitallowfullscreen","width","wrap"],htmlAllowComments:!0,fullPage:!1}),e.FE.HTML5Map={B:"STRONG",I:"EM",STRIKE:"S"},e.FE.MODULES.clean=function(t){function i(e){if(e.nodeType==Node.ELEMENT_NODE&&e.getAttribute("class")&&e.getAttribute("class").indexOf("fr-marker")>=0)return!1;var n,s=t.node.contents(e),o=[];for(n=0;n<s.length;n++)s[n].nodeType!=Node.ELEMENT_NODE||t.node.isVoid(s[n])?s[n].nodeType==Node.TEXT_NODE&&(s[n].textContent=s[n].textContent.replace(/\u200b/g,"").replace(/&/g,"&amp;")):s[n].textContent.replace(/\u200b/g,"").length!=s[n].textContent.length&&i(s[n]);if(e.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(e)&&(e.normalize(),s=t.node.contents(e),o=e.querySelectorAll(".fr-marker"),s.length-o.length==0)){for(n=0;n<s.length;n++)if((s[n].getAttribute("class")||"").indexOf("fr-marker")<0)return!1;for(n=0;n<o.length;n++)e.parentNode.insertBefore(o[n].cloneNode(!0),e);return e.parentNode.removeChild(e),!1}}function n(e){if(e.nodeType==Node.COMMENT_NODE)return"\x3c!--"+e.nodeValue+"--\x3e";if(e.nodeType==Node.TEXT_NODE)return e.textContent.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\u00A0/g,"&nbsp;");if(e.nodeType!=Node.ELEMENT_NODE)return e.outerHTML;if(e.nodeType==Node.ELEMENT_NODE&&["STYLE","SCRIPT"].indexOf(e.tagName)>=0)return e.outerHTML;if(e.nodeType==Node.ELEMENT_NODE&&"svg"==e.tagName){var i=document.createElement("div"),s=e.cloneNode(!0);return i.appendChild(s),i.innerHTML}if("IFRAME"==e.tagName)return e.outerHTML;var o=e.childNodes;if(0===o.length)return e.outerHTML;for(var r="",a=0;a<o.length;a++)r+=n(o[a]);return t.node.openTagString(e)+r+t.node.closeTagString(e)}function s(e){var t;for(t in e)e.hasOwnProperty(t)&&(t.match(h)||delete e[t]);for(var i="",n=Object.keys(e).sort(),s=0;s<n.length;s++)i+=e[t=n[s]].indexOf('"')<0?" "+t+'="'+e[t]+'"':" "+t+"='"+e[t]+"'";return i}function o(e,i,n){if(t.opts.fullPage){var o=t.html.extractDoctype(n),r=s(t.html.extractNodeAttrs(n,"html"));return i=null==i?t.html.extractNode(n,"head")||"<title></title>":i,o+"<html"+r+"><head"+s(t.html.extractNodeAttrs(n,"head"))+">"+i+"</head><body"+s(t.html.extractNodeAttrs(n,"body"))+">"+e+"</body></html>"}return e}function r(i,s){var o=e("<div>"+i+"</div>"),r="";if(o){for(var a=t.node.contents(o.get(0)),l=0;l<a.length;l++)s(a[l]);a=t.node.contents(o.get(0));for(l=0;l<a.length;l++)r+=n(a[l])}return r}function a(e,i,n){var s=e=function(e){return p=[],(e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,function(e){return p.push(e),"[FROALA.EDITOR.SCRIPT "+(p.length-1)+"]"})).replace(/<img((?:[\w\W]*?)) src="/g,'<img$1 data-fr-src="')}(e),a=null;if(t.opts.fullPage){s=t.html.extractNode(e,"body")||(e.indexOf("<body")>=0?"":e);n&&(a=t.html.extractNode(e,"head")||"")}return s=r(s,i),a&&(a=r(a,i)),function(e){return(e=e.replace(/\[FROALA\.EDITOR\.SCRIPT ([\d]*)\]/gi,function(e,i){return t.opts.htmlRemoveTags.indexOf("script")>=0?"":p[parseInt(i,10)]})).replace(/<img((?:[\w\W]*?)) data-fr-src="/g,'<img$1 src="')}(o(s,a,e))}function l(i){if("SPAN"==i.tagName&&(i.getAttribute("class")||"").indexOf("fr-marker")>=0)return!1;if("PRE"==i.tagName&&function(e){var t=e.innerHTML;t.indexOf("\n")>=0&&(e.innerHTML=t.replace(/\n/g,"<br>"))}(i),i.nodeType==Node.ELEMENT_NODE&&(i.getAttribute("data-fr-src")&&i.setAttribute("data-fr-src",t.helpers.sanitizeURL(i.getAttribute("data-fr-src"))),i.getAttribute("href")&&i.setAttribute("href",t.helpers.sanitizeURL(i.getAttribute("href"))),["TABLE","TBODY","TFOOT","TR"].indexOf(i.tagName)>=0&&(i.innerHTML=i.innerHTML.trim())),!t.opts.pasteAllowLocalImages&&i.nodeType==Node.ELEMENT_NODE&&"IMG"==i.tagName&&i.getAttribute("data-fr-src")&&0==i.getAttribute("data-fr-src").indexOf("file://"))return i.parentNode.removeChild(i),!1;if(i.nodeType==Node.ELEMENT_NODE&&e.FE.HTML5Map[i.tagName]&&""===t.node.attributes(i)){var n=e.FE.HTML5Map[i.tagName],s="<"+n+">"+i.innerHTML+"</"+n+">";i.insertAdjacentHTML("beforebegin",s),(i=i.previousSibling).parentNode.removeChild(i.nextSibling)}if(t.opts.htmlAllowComments||i.nodeType!=Node.COMMENT_NODE)if(i.tagName&&i.tagName.match(u))i.parentNode.removeChild(i);else if(i.tagName&&!i.tagName.match(d))i.outerHTML=i.innerHTML;else{var o=i.attributes;if(o)for(var r=o.length-1;r>=0;r--){var a=o[r];a.nodeName.match(h)||i.removeAttribute(a.nodeName)}}else 0!==i.data.indexOf("[FROALA.EDITOR")&&i.parentNode.removeChild(i)}function c(e){for(var i=t.node.contents(e),n=0;n<i.length;n++)i[n].nodeType!=Node.TEXT_NODE&&c(i[n]);l(e)}var d,u,h,p=[];p=[];return{_init:function(){t.opts.fullPage&&e.merge(t.opts.htmlAllowedTags,["head","title","style","link","base","body","html","meta"])},html:function(i,n,s,o){void 0===n&&(n=[]),void 0===s&&(s=[]),void 0===o&&(o=!1),i=i.replace(/\u0009/g,"");var r,l=e.merge([],t.opts.htmlAllowedTags);for(r=0;r<n.length;r++)l.indexOf(n[r])>=0&&l.splice(l.indexOf(n[r]),1);var p=e.merge([],t.opts.htmlAllowedAttrs);for(r=0;r<s.length;r++)p.indexOf(s[r])>=0&&p.splice(p.indexOf(s[r]),1);return p.push("data-fr-.*"),p.push("fr-.*"),d=new RegExp("^"+l.join("$|^")+"$","gi"),h=new RegExp("^"+p.join("$|^")+"$","gi"),u=new RegExp("^"+t.opts.htmlRemoveTags.join("$|^")+"$","gi"),a(i,c,!0)},toHTML5:function(){var i=t.el.querySelectorAll(Object.keys(e.FE.HTML5Map).join(","));if(i.length){var n=!1;t.el.querySelector(".fr-marker")||(t.selection.save(),n=!0);for(var s=0;s<i.length;s++)""===t.node.attributes(i[s])&&e(i[s]).replaceWith("<"+e.FE.HTML5Map[i[s].tagName]+">"+i[s].innerHTML+"</"+e.FE.HTML5Map[i[s].tagName]+">");n&&t.selection.restore()}},tables:function(){(function(){for(var e=t.el.querySelectorAll("tr"),i=0;i<e.length;i++){for(var n=e[i].children,s=!0,o=0;o<n.length;o++)if("TH"!=n[o].tagName){s=!1;break}if(0!=s&&0!=n.length){for(var r=e[i];r&&"TABLE"!=r.tagName&&"THEAD"!=r.tagName;)r=r.parentNode;var a=r;"THEAD"!=a.tagName&&(a=t.doc.createElement("THEAD"),r.insertBefore(a,r.firstChild)),a.appendChild(e[i])}}})(),function(){var i=t.html.defaultTag();if(i)for(var n=t.el.querySelectorAll("td > "+i+", th > "+i),s=0;s<n.length;s++)""===t.node.attributes(n[s])&&e(n[s]).replaceWith(n[s].innerHTML+"<br>")}()},lists:function(){(function(){var e=[],i=function(e){return!t.node.isList(e.parentNode)};do{if(e.length){var n=e[0],s=t.doc.createElement("ul");n.parentNode.insertBefore(s,n);do{var o=n;n=n.nextSibling,s.appendChild(o)}while(n&&"LI"==n.tagName)}e=[];for(var r=t.el.querySelectorAll("li"),a=0;a<r.length;a++)i(r[a])&&e.push(r[a])}while(e.length>0)})(),function(){for(var e=t.el.querySelectorAll("ol + ol, ul + ul"),i=0;i<e.length;i++){var n=e[i];if(t.node.isList(n.previousSibling)&&t.node.openTagString(n)==t.node.openTagString(n.previousSibling)){for(var s=t.node.contents(n),o=0;o<s.length;o++)n.previousSibling.appendChild(s[o]);n.parentNode.removeChild(n)}}}(),function(){var e,i=function(t){t.querySelector("LI")||(e=!0,t.parentNode.removeChild(t))};do{e=!1;for(var n=t.el.querySelectorAll("li:empty"),s=0;s<n.length;s++)n[s].parentNode.removeChild(n[s]);var o=t.el.querySelectorAll("ul, ol");for(s=0;s<o.length;s++)i(o[s])}while(!0===e)}(),function(){for(var i=t.el.querySelectorAll("ul > ul, ol > ol, ul > ol, ol > ul"),n=0;n<i.length;n++){var s=i[n],o=s.previousSibling;o&&("LI"==o.tagName?o.appendChild(s):e(s).wrap("<li></li>"))}}(),function(){for(var i=t.el.querySelectorAll("li > ul, li > ol"),n=0;n<i.length;n++){var s=i[n];if(s.nextSibling){var o=s.nextSibling,r=e("<li>");e(s.parentNode).after(r);do{var a=o;o=o.nextSibling,r.append(a)}while(o)}}}(),function(){for(var i=t.el.querySelectorAll("li > ul, li > ol"),n=0;n<i.length;n++){var s=i[n];if(t.node.isFirstSibling(s))e(s).before("<br/>");else if(s.previousSibling&&"BR"==s.previousSibling.tagName){for(var o=s.previousSibling.previousSibling;o&&t.node.hasClass(o,"fr-marker");)o=o.previousSibling;o&&"BR"!=o.tagName&&e(s.previousSibling).remove()}}}(),function(){for(var i=t.el.querySelectorAll("ul, ol"),n=0;n<i.length;n++)for(var s=t.node.contents(i[n]),o=null,r=s.length-1;r>=0;r--)"LI"!=s[r].tagName?(o||(o=e("<li>")).insertBefore(s[r]),o.prepend(s[r])):o=null}(),function(){for(var i=t.el.querySelectorAll("li:empty"),n=0;n<i.length;n++)e(i[n]).remove()}()},quotes:function(){for(var i=t.el.querySelectorAll("blockquote + blockquote"),n=0;n<i.length;n++){var s=i[n];t.node.attributes(s)==t.node.attributes(s.previousSibling)&&(e(s).prev().append(e(s).html()),e(s).remove())}},invisibleSpaces:function(e){return e.replace(/\u200b/g,"").length==e.length?e:t.clean.exec(e,i)},exec:a}},e.FE.MODULES.spaces=function(t){function i(i,n){var s=i.previousSibling,o=i.nextSibling,r=i.textContent,a=i.parentNode;n&&(r=r.replace(/[\f\n\r\t\v ]{2,}/g," "),(!o||t.node.isVoid(o)||t.node.isBlock(o))&&t.node.isBlock(a)&&(r=r.replace(/[\f\n\r\t\v ]{1,}$/g,"")),(!s||t.node.isVoid(s)||t.node.isBlock(s))&&t.node.isBlock(a)&&(r=r.replace(/^[\f\n\r\t\v ]{1,}/g,""))),r=r.replace(new RegExp(e.FE.UNICODE_NBSP,"g")," ");for(var l="",c=0;c<r.length;c++)l+=32!=r.charCodeAt(c)||0!==c&&32!=l.charCodeAt(c-1)?r[c]:e.FE.UNICODE_NBSP;(!o||t.node.isBlock(o)||o.nodeType==Node.ELEMENT_NODE&&t.win.getComputedStyle(o)&&"block"==t.win.getComputedStyle(o).display)&&(l=l.replace(/ $/,e.FE.UNICODE_NBSP)),!s||t.node.isVoid(s)||t.node.isBlock(s)||(1!==(l=l.replace(/^\u00A0([^ $])/," $1")).length||160!==l.charCodeAt(0)||!o||t.node.isVoid(o)||t.node.isBlock(o)||(l=" ")),l=l.replace(/([^ \u00A0])\u00A0([^ \u00A0])/g,"$1 $2"),i.textContent!=l&&(i.textContent=l)}function n(e,n){if(void 0!==e&&e||(e=t.el),void 0===n&&(n=!1),!e.getAttribute||"false"!=e.getAttribute("contenteditable"))if(e.nodeType==Node.TEXT_NODE)i(e,n);else if(e.nodeType==Node.ELEMENT_NODE)for(var s=t.doc.createTreeWalker(e,NodeFilter.SHOW_TEXT,t.node.filter(function(e){return null!=e.textContent.match(/([ \u00A0\f\n\r\t\v]{2,})|(^[ \u00A0\f\n\r\t\v]{1,})|([ \u00A0\f\n\r\t\v]{1,}$)/g)&&!t.node.hasClass(e.parentNode,"fr-marker")}),!1);s.nextNode();)i(s.currentNode,n)}return{normalize:n,normalizeAroundCursor:function(){for(var e=[],i=t.el.querySelectorAll(".fr-marker"),s=0;s<i.length;s++){for(var o,r=t.node.blockParent(i[s]),a=(o=r||i[s]).nextSibling,l=o.previousSibling;a&&"BR"==a.tagName;)a=a.nextSibling;for(;l&&"BR"==l.tagName;)l=l.previousSibling;o&&e.indexOf(o)<0&&e.push(o),l&&e.indexOf(l)<0&&e.push(l),a&&e.indexOf(a)<0&&e.push(a)}for(var c=0;c<e.length;c++)n(e[c])}}},e.FE.UNICODE_NBSP=String.fromCharCode(160),e.FE.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],e.FE.BLOCK_TAGS=["address","article","aside","audio","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video"],e.extend(e.FE.DEFAULTS,{htmlAllowedEmptyTags:["textarea","a","iframe","object","video","style","script",".fa",".fr-emoticon"],htmlDoNotWrapTags:["script","style"],htmlSimpleAmpersand:!1,htmlIgnoreCSSProperties:[]}),e.FE.MODULES.html=function(t){function i(){return t.opts.enter==e.FE.ENTER_P?"p":t.opts.enter==e.FE.ENTER_DIV?"div":t.opts.enter==e.FE.ENTER_BR?null:void 0}function n(i){var n=[],o=[];if(i)for(var r=t.el.querySelectorAll(".fr-marker"),a=0;a<r.length;a++){var l=t.node.blockParent(r[a])||r[a];if(l){var c=l.nextSibling,d=l.previousSibling;l&&o.indexOf(l)<0&&t.node.isBlock(l)&&o.push(l),d&&t.node.isBlock(d)&&o.indexOf(d)<0&&o.push(d),c&&t.node.isBlock(c)&&o.indexOf(c)<0&&o.push(c)}}else o=t.el.querySelectorAll(s());var u=s();u+=","+e.FE.VOID_ELEMENTS.join(","),u+=","+t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)";for(a=o.length-1;a>=0;a--)if(!(o[a].textContent&&o[a].textContent.replace(/\u200B|\n/g,"").length>0||o[a].querySelectorAll(u).length>0)){for(var h=t.node.contents(o[a]),p=!1,f=0;f<h.length;f++)if(h[f].nodeType!=Node.COMMENT_NODE&&h[f].textContent&&h[f].textContent.replace(/\u200B|\n/g,"").length>0){p=!0;break}p||n.push(o[a])}return n}function s(){return e.FE.BLOCK_TAGS.join(", ")}function o(i){var n,s,o=e.merge([],e.FE.VOID_ELEMENTS);o=e.merge(o,t.opts.htmlAllowedEmptyTags),void 0===i&&(o=e.merge(o,e.FE.BLOCK_TAGS)),n=t.el.querySelectorAll("*:empty:not("+o.join("):not(")+"):not(.fr-marker)");do{s=!1;for(var r=0;r<n.length;r++)0!==n[r].attributes.length&&void 0===n[r].getAttribute("href")||(n[r].parentNode.removeChild(n[r]),s=!0);n=t.el.querySelectorAll("*:empty:not("+o.join("):not(")+"):not(.fr-marker)")}while(n.length&&s)}function r(e,n){var s=i();if(n&&(s="div"),s){for(var o=t.doc.createDocumentFragment(),r=null,a=!1,l=e.firstChild;l;){var c=l.nextSibling;if(l.nodeType==Node.ELEMENT_NODE&&(t.node.isBlock(l)||t.opts.htmlDoNotWrapTags.indexOf(l.tagName.toLowerCase())>=0&&!t.node.hasClass(l,"fr-marker")))r=null,o.appendChild(l);else if(l.nodeType!=Node.ELEMENT_NODE&&l.nodeType!=Node.TEXT_NODE)r=null,o.appendChild(l);else if("BR"==l.tagName)c&&"BR"==c.tagName&&(c=c.nextSibling),null==r?(r=t.doc.createElement(s),n&&r.setAttribute("data-empty",!0),r.appendChild(l),o.appendChild(r)):!1===a&&(r.appendChild(t.doc.createElement("br")),r.setAttribute("data-empty",!0)),r=null;else{var d=l.textContent;l.nodeType==Node.TEXT_NODE&&0==d.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length||(null==r&&(r=t.doc.createElement(s),n&&r.setAttribute("class","fr-temp-div"),o.appendChild(r),a=!1),r.appendChild(l),a||t.node.hasClass(l,"fr-marker")||l.nodeType==Node.TEXT_NODE&&0===d.replace(/ /g,"").length||(a=!0))}l=c}e.innerHTML="",e.appendChild(o)}}function a(e,t){for(var i=0;i<e.length;i++)r(e[i],t)}function l(e,i,n,s){return!!t.$wp&&(void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===s&&(s=!1),r(t.el,e),s&&a(t.el.querySelectorAll(".fr-inner"),e),i&&a(t.el.querySelectorAll("td, th"),e),void(n&&a(t.el.querySelectorAll("blockquote"),e)))}function c(e){if(void 0===e&&(e=t.el),e&&["SCRIPT","STYLE","PRE"].indexOf(e.tagName)>=0)return!1;for(var i=t.doc.createTreeWalker(e,NodeFilter.SHOW_TEXT,t.node.filter(function(e){return null!=e.textContent.match(/([ \n]{2,})|(^[ \n]{1,})|([ \n]{1,}$)/g)}),!1);i.nextNode();){var n=i.currentNode,s=t.node.isBlock(n.parentNode)||t.node.isElement(n.parentNode),o=n.textContent.replace(/(?!^)( ){2,}(?!$)/g," ").replace(/\n/g," ").replace(/^[ ]{2,}/g," ").replace(/[ ]{2,}$/g," ");if(s){var r=n.previousSibling,a=n.nextSibling;r&&a&&" "==o?o=t.node.isBlock(r)&&t.node.isBlock(a)?"":"\n":(r||(o=o.replace(/^ */,"")),a||(o=o.replace(/ *$/,"")))}n.textContent=o}}function d(e,t,i){var n=new RegExp(t,"gi").exec(e);return n?n[i]:null}function u(e){var t=e.doctype,i="<!DOCTYPE html>";return t&&(i="<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"),i}function h(i,n){var s=i.parentNode;if(s&&(t.node.isBlock(s)||t.node.isElement(s))&&["TD","TH"].indexOf(s.tagName)<0){var o=i.previousSibling,r=i.nextSibling;o&&s&&"BR"!=o.tagName&&!t.node.isBlock(o)&&!r&&s.textContent.replace(/\u200B/g,"").length>0&&o.textContent.length>0&&!t.node.hasClass(o,"fr-marker")&&(t.el==s&&!r&&t.opts.enter==e.FE.ENTER_BR&&t.browser.msie||(n&&t.selection.save(),i.parentNode.removeChild(i),n&&t.selection.restore()))}}function p(){o(),l(),c(),t.spaces.normalize(null,!0),t.html.fillEmptyBlocks(),t.clean.quotes(),t.clean.lists(),t.clean.tables(),t.clean.toHTML5(),t.html.cleanBRs(),t.selection.restore(),f(),t.placeholder.refresh()}function f(){t.core.isEmpty()&&(null!=i()?t.el.querySelector(s())||t.el.querySelector(t.opts.htmlDoNotWrapTags.join(":not(.fr-marker),")+":not(.fr-marker)")||(t.core.hasFocus()?(t.$el.html("<"+i()+">"+e.FE.MARKERS+"<br/></"+i()+">"),t.selection.restore()):t.$el.html("<"+i()+"><br/></"+i()+">")):t.el.querySelector("*:not(.fr-marker):not(br)")||(t.core.hasFocus()?(t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore()):t.$el.html("<br/>")))}function m(e,t){return d(e,"<"+t+"[^>]*?>([\\w\\W]*)</"+t+">",1)}function g(i,n){var s=e("<div "+(d(i,"<"+n+"([^>]*?)>",1)||"")+">");return t.node.rawAttributes(s.get(0))}function v(e){return d(e,"<!DOCTYPE([^>]*?)>",0)||"<!DOCTYPE html>"}function b(e){var i=t.doc.createElement("div");return i.innerHTML=e,null!==i.querySelector(s())}function y(i){var n=null;if(void 0===i&&(n=t.selection.element()),t.opts.keepFormatOnDelete)return!1;var s,o,r=n?(n.textContent.match(/\u200B/g)||[]).length-n.querySelectorAll(".fr-marker").length:0;if((t.el.textContent.match(/\u200B/g)||[]).length-t.el.querySelectorAll(".fr-marker").length==r)return!1;do{o=!1,s=t.el.querySelectorAll("*:not(.fr-marker)");for(var a=0;a<s.length;a++){var l=s[a];if(n!=l){var c=l.textContent;0===l.children.length&&1===c.length&&8203==c.charCodeAt(0)&&(e(l).remove(),o=!0)}}}while(o)}return{defaultTag:i,emptyBlocks:n,emptyBlockTagsQuery:function(){return e.FE.BLOCK_TAGS.join(":empty, ")+":empty"},blockTagsQuery:s,fillEmptyBlocks:function(i){for(var s=n(i),o=0;o<s.length;o++){var r=s[o];"false"==r.getAttribute("contenteditable")||r.querySelector(t.opts.htmlAllowedEmptyTags.join(":not(.fr-marker),")+":not(.fr-marker)")||t.node.isVoid(r)||"TABLE"!=r.tagName&&"TBODY"!=r.tagName&&"TR"!=r.tagName&&r.appendChild(t.doc.createElement("br"))}if(t.browser.msie&&t.opts.enter==e.FE.ENTER_BR){var a=t.node.contents(t.el);a.length&&a[a.length-1].nodeType==Node.TEXT_NODE&&t.$el.append("<br>")}},cleanEmptyTags:o,cleanWhiteTags:y,cleanBlankSpaces:c,blocks:function(){return t.$el.get(0).querySelectorAll(s())},getDoctype:u,set:function(i){var n=t.clean.html(i||"",[],[],t.opts.fullPage);if(t.opts.fullPage){var s=m(n,"body")||(n.indexOf("<body")>=0?"":n),o=g(n,"body"),r=m(n,"head")||"<title></title>",a=g(n,"head"),l=e("<div>").append(r).contents().each(function(){(this.nodeType==Node.COMMENT_NODE||["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0)&&this.parentNode.removeChild(this)}).end().html().trim();r=e("<div>").append(r).contents().map(function(){return this.nodeType==Node.COMMENT_NODE?"\x3c!--"+this.nodeValue+"--\x3e":["BASE","LINK","META","NOSCRIPT","SCRIPT","STYLE","TEMPLATE","TITLE"].indexOf(this.tagName)>=0?this.outerHTML:""}).toArray().join("");var c=v(n),d=g(n,"html");t.$el.html(l+"\n"+s),t.node.clearAttributes(t.el),t.$el.attr(o),t.$el.addClass("fr-view"),t.$el.attr("spellcheck",t.opts.spellcheck),t.$el.attr("dir",t.opts.direction),t.$head.html(r),t.node.clearAttributes(t.$head.get(0)),t.$head.attr(a),t.node.clearAttributes(t.$html.get(0)),t.$html.attr(d),t.iframe_document.doctype.parentNode.replaceChild(function(e,t){var i=e.match(/<!DOCTYPE ?([^ ]*) ?([^ ]*) ?"?([^"]*)"? ?"?([^"]*)"?>/i);return i?t.implementation.createDocumentType(i[1],i[3],i[4]):t.implementation.createDocumentType("html")}(c,t.iframe_document),t.iframe_document.doctype)}else t.$el.html(n);var u=t.edit.isDisabled();t.edit.on(),t.core.injectStyle(t.opts.iframeStyle),p(),t.opts.useClasses||(t.$el.find("[fr-original-class]").each(function(){this.setAttribute("class",this.getAttribute("fr-original-class")),this.removeAttribute("fr-original-class")}),t.$el.find("[fr-original-style]").each(function(){this.setAttribute("style",this.getAttribute("fr-original-style")),this.removeAttribute("fr-original-style")})),u&&t.edit.off(),t.events.trigger("html.set")},get:function(e,i){if(!t.$wp)return t.$oel.clone().removeClass("fr-view").removeAttr("contenteditable").get(0).outerHTML;var n="";t.events.trigger("html.beforeGet");var s,o=function(e){return function(){var t=/:not\(([^\)]*)\)/g;t.test(e)&&(e=e.replace(t,"     $1 "))}(),100*(e.match(/(#[^\s\+>~\.\[:]+)/g)||[]).length+10*(e.match(/(\[[^\]]+\])/g)||[]).length+10*(e.match(/(\.[^\s\+>~\.\[:]+)/g)||[]).length+10*(e.match(/(:[\w-]+\([^\)]*\))/gi)||[]).length+10*(e.match(/(:[^\s\+>~\.\[:]+)/g)||[]).length+(e.match(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi)||[]).length+((e=(e=e.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," ")).match(/([^\s\+>~\.\[:]+)/g)||[]).length},r=[],a={};if(!t.opts.useClasses&&!i){var l=new RegExp("^"+t.opts.htmlIgnoreCSSProperties.join("$|^")+"$","gi");for(s=0;s<t.doc.styleSheets.length;s++){var c,d=0;try{c=t.doc.styleSheets[s].cssRules,t.doc.styleSheets[s].ownerNode&&"STYLE"==t.doc.styleSheets[s].ownerNode.nodeType&&(d=1)}catch(e){}if(c)for(var h=0,p=c.length;h<p;h++)if(c[h].selectorText&&c[h].style.cssText.length>0){var f,m=c[h].selectorText.replace(/body |\.fr-view /g,"").replace(/::/g,":");try{f=t.el.querySelectorAll(m)}catch(e){f=[]}for(var g=0;g<f.length;g++){!f[g].getAttribute("fr-original-style")&&f[g].getAttribute("style")?(f[g].setAttribute("fr-original-style",f[g].getAttribute("style")),r.push(f[g])):f[g].getAttribute("fr-original-style")||r.push(f[g]),a[f[g]]||(a[f[g]]={});for(var v=1e3*d+o(c[h].selectorText),b=c[h].style.cssText.split(";"),y=0;y<b.length;y++){var w=b[y].trim().split(":")[0];w.match(l)||(a[f[g]][w]||(a[f[g]][w]=0,(f[g].getAttribute("fr-original-style")||"").indexOf(w+":")>=0&&(a[f[g]][w]=1e4)),v>=a[f[g]][w]&&(a[f[g]][w]=v,b[y].trim().length&&(f[g].style[w.trim()]=b[y].trim().split(":")[1].trim())))}}}}for(s=0;s<r.length;s++)if(r[s].getAttribute("class")&&(r[s].setAttribute("fr-original-class",r[s].getAttribute("class")),r[s].removeAttribute("class")),(r[s].getAttribute("fr-original-style")||"").trim().length>0){var x=r[s].getAttribute("fr-original-style").split(";");for(g=0;g<x.length;g++)x[g].indexOf(":")>0&&(r[s].style[x[g].split(":")[0].trim()]=x[g].split(":")[1].trim())}}if(t.core.isEmpty()?t.opts.fullPage&&(n=u(t.iframe_document),n+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.find("head").get(0).outerHTML+"<body></body></html>"):(void 0===e&&(e=!1),t.opts.fullPage?(n=u(t.iframe_document),t.$el.removeClass("fr-view"),n+="<html"+t.node.attributes(t.$html.get(0))+">"+t.$html.html()+"</html>",t.$el.addClass("fr-view")):n=t.$el.html()),!t.opts.useClasses&&!i)for(s=0;s<r.length;s++)r[s].getAttribute("fr-original-class")&&(r[s].setAttribute("class",r[s].getAttribute("fr-original-class")),r[s].removeAttribute("fr-original-class")),r[s].getAttribute("fr-original-style")?(r[s].setAttribute("style",r[s].getAttribute("fr-original-style")),r[s].removeAttribute("fr-original-style")):r[s].removeAttribute("style");t.opts.fullPage&&(n=(n=(n=(n=(n=(n=(n=(n=n.replace(/<style data-fr-style="true">(?:[\w\W]*?)<\/style>/g,"")).replace(/<link([^>]*)data-fr-style="true"([^>]*)>/g,"")).replace(/<style(?:[\w\W]*?)class="firebugResetStyles"(?:[\w\W]*?)>(?:[\w\W]*?)<\/style>/g,"")).replace(/<body((?:[\w\W]*?)) spellcheck="true"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3</body>")).replace(/<body((?:[\w\W]*?)) contenteditable="(true|false)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4</body>")).replace(/<body((?:[\w\W]*?)) dir="([\w]*)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$3>$4</body>")).replace(/<body((?:[\w\W]*?))class="([\w\W]*?)(fr-rtl|fr-ltr)([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,'<body$1class="$2$4"$5>$6</body>')).replace(/<body((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/body>/g,"<body$1$2>$3</body>")),t.opts.htmlSimpleAmpersand&&(n=n.replace(/\&amp;/gi,"&")),t.events.trigger("html.afterGet"),e||(n=n.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,"")),n=t.clean.invisibleSpaces(n);var C=t.events.chainTrigger("html.get",n);return"string"==typeof C&&(n=C),n.replace(/<pre(?:[\w\W]*?)>(?:[\w\W]*?)<\/pre>/g,function(e){return e.replace(/<br>/g,"\n")})},getSelected:function(){var i=function(i,n){for(;n&&(n.nodeType==Node.TEXT_NODE||!t.node.isBlock(n))&&!t.node.isElement(n);)n&&n.nodeType!=Node.TEXT_NODE&&e(i).wrapInner(t.node.openTagString(n)+t.node.closeTagString(n)),n=n.parentNode;n&&i.innerHTML==n.innerHTML&&(i.innerHTML=n.outerHTML)},n=function(){var i,n=null;return t.win.getSelection?(i=t.win.getSelection())&&i.rangeCount&&(n=i.getRangeAt(0).commonAncestorContainer).nodeType!=Node.ELEMENT_NODE&&(n=n.parentNode):(i=t.doc.selection)&&"Control"!=i.type&&(n=i.createRange().parentElement()),null!=n&&(e.inArray(t.el,e(n).parents())>=0||n==t.el)?n:null},s="";if(void 0!==t.win.getSelection){t.browser.mozilla&&(t.selection.save(),t.$el.find('.fr-marker[data-type="false"]').length>1&&(t.$el.find('.fr-marker[data-type="false"][data-id="0"]').remove(),t.$el.find('.fr-marker[data-type="false"]:last').attr("data-id","0"),t.$el.find(".fr-marker").not('[data-id="0"]').remove()),t.selection.restore());for(var o=t.selection.ranges(),r=0;r<o.length;r++){var a=document.createElement("div");a.appendChild(o[r].cloneContents()),i(a,n()),e(a).find(".fr-element").length>0&&(a=t.el),s+=a.innerHTML}}else void 0!==t.doc.selection&&"Text"==t.doc.selection.type&&(s=t.doc.selection.createRange().htmlText);return s},insert:function(e,i,n){var s;if(t.selection.isCollapsed()||t.selection.remove(),s=(s=i?e:t.clean.html(e)).replace(/\r|\n/g," "),e.indexOf('class="fr-marker"')<0&&(s=function(e){var i=t.doc.createElement("div");return i.innerHTML=e,t.selection.setAtEnd(i),i.innerHTML}(s)),t.core.isEmpty()&&!t.opts.keepFormatOnDelete)t.el.innerHTML=s;else if(r=t.markers.insert()){var o=t.node.blockParent(r);if((b(s)||n)&&(t.node.deepestParent(r)||o&&"LI"==o.tagName)){var r;if(!(r=t.markers.split()))return!1;r.outerHTML=s}else r.outerHTML=s}else t.el.innerHTML=t.el.innerHTML+s;p(),t.events.trigger("html.inserted")},wrap:l,unwrap:function(){t.$el.find("div.fr-temp-div").each(function(){e(this).data("empty")||"LI"==this.parentNode.tagName||t.node.isBlock(this.previousSibling)?e(this).replaceWith(e(this).html()):e(this).replaceWith(e(this).html()+"<br>")}),t.$el.find(".fr-temp-div").removeClass("fr-temp-div").filter(function(){return""==e(this).attr("class")}).removeAttr("class")},escapeEntities:function(e){return e.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&#39;")},checkIfEmpty:f,extractNode:m,extractNodeAttrs:g,extractDoctype:v,cleanBRs:function(e,i){var n;if(e){n=function(){var e,i=t.selection.element(),n=[];if(e=t.node.isBlock(i)?i:t.node.blockParent(i)){var s=e.nextSibling,o=e.previousSibling;e&&n.indexOf(e)<0&&n.push(e),o&&t.node.isBlock(o)&&n.indexOf(o)<0&&n.push(o),s&&t.node.isBlock(s)&&n.indexOf(s)<0&&n.push(s)}for(var r=[],a=0;a<n.length;a++)for(var l=n[a].querySelectorAll("br"),c=0;c<l.length;c++)r.indexOf(l[c])<0&&r.push(l[c]);if(i.parentNode==t.el){var d=t.el.children;for(a=0;a<d.length;a++)"BR"==d[a].tagName&&r.indexOf(d[a])<0&&r.push(d[a])}return r}();for(var s=0;s<n.length;s++)h(n[s],i)}else for(n=t.el.getElementsByTagName("br"),s=0;s<n.length;s++)h(n[s],i)},_init:function(){var e=function(){y(),t.placeholder&&t.placeholder.refresh()};t.events.on("mouseup",e),t.events.on("keydown",e),t.events.on("contentChanged",f)}}},e.extend(e.FE.DEFAULTS,{height:null,heightMax:null,heightMin:null,width:null}),e.FE.MODULES.size=function(e){function t(){i(),e.opts.height&&e.$el.css("minHeight",e.opts.height-e.helpers.getPX(e.$el.css("padding-top"))-e.helpers.getPX(e.$el.css("padding-bottom"))),e.$iframe.height(e.$el.outerHeight(!0))}function i(){e.opts.heightMin?e.$el.css("minHeight",e.opts.heightMin):e.$el.css("minHeight",""),e.opts.heightMax?(e.$wp.css("maxHeight",e.opts.heightMax),e.$wp.css("overflow","auto")):(e.$wp.css("maxHeight",""),e.$wp.css("overflow","")),e.opts.height?(e.$wp.height(e.opts.height),e.$el.css("minHeight",e.opts.height-e.helpers.getPX(e.$el.css("padding-top"))-e.helpers.getPX(e.$el.css("padding-bottom"))),e.$wp.css("overflow","auto")):(e.$wp.css("height",""),e.opts.heightMin||e.$el.css("minHeight",""),e.opts.heightMax||e.$wp.css("overflow","")),e.opts.width&&e.$box.width(e.opts.width)}return{_init:function(){return!!e.$wp&&(i(),void(e.$iframe&&(e.events.on("keyup",t),e.events.on("commands.after",t),e.events.on("html.set",t),e.events.on("init",t),e.events.on("initialized",t))))},syncIframe:t,refresh:i}},e.extend(e.FE.DEFAULTS,{language:null}),e.FE.LANGUAGE={},e.FE.MODULES.language=function(t){var i;return{_init:function(){e.FE.LANGUAGE&&(i=e.FE.LANGUAGE[t.opts.language]),i&&i.direction&&(t.opts.direction=i.direction)},translate:function(e){return i&&i.translation[e]?i.translation[e]:e}}},e.extend(e.FE.DEFAULTS,{placeholderText:"Type something"}),e.FE.MODULES.placeholder=function(t){function i(){t.$placeholder||(t.$placeholder=e('<span class="fr-placeholder"></span>'),t.$wp.append(t.$placeholder));var i=0,n=0,s=0,o=0,r=0,a=0,l=t.node.contents(t.el),c=e(t.selection.element()).css("text-align");if(l.length&&l[0].nodeType==Node.ELEMENT_NODE){var d=e(l[0]);!t.opts.toolbarInline&&t.ready&&(i=t.helpers.getPX(d.css("margin-top")),o=t.helpers.getPX(d.css("padding-top")),n=t.helpers.getPX(d.css("margin-left")),s=t.helpers.getPX(d.css("margin-right")),r=t.helpers.getPX(d.css("padding-left")),a=t.helpers.getPX(d.css("padding-right"))),t.$placeholder.css("font-size",d.css("font-size")),t.$placeholder.css("line-height",d.css("line-height"))}else t.$placeholder.css("font-size",t.$el.css("font-size")),t.$placeholder.css("line-height",t.$el.css("line-height"));t.$wp.addClass("show-placeholder"),t.$placeholder.css({marginTop:Math.max(t.helpers.getPX(t.$el.css("margin-top")),i),paddingTop:Math.max(t.helpers.getPX(t.$el.css("padding-top")),o),paddingLeft:Math.max(t.helpers.getPX(t.$el.css("padding-left")),r),marginLeft:Math.max(t.helpers.getPX(t.$el.css("margin-left")),n),paddingRight:Math.max(t.helpers.getPX(t.$el.css("padding-right")),a),marginRight:Math.max(t.helpers.getPX(t.$el.css("margin-right")),s),textAlign:c}).text(t.language.translate(t.opts.placeholderText||t.$oel.attr("placeholder")||"")),t.$placeholder.html(t.$placeholder.text().replace(/\n/g,"<br>"))}function n(){t.$wp.removeClass("show-placeholder")}function s(){return!!t.$wp&&void(t.core.isEmpty()?i():n())}return{_init:function(){return!!t.$wp&&void t.events.on("init input keydown keyup contentChanged initialized",s)},show:i,hide:n,refresh:s,isVisible:function(){return!t.$wp||t.node.hasClass(t.$wp.get(0),"show-placeholder")}}},e.FE.MODULES.edit=function(e){function t(){if(e.browser.mozilla)try{e.doc.execCommand("enableObjectResizing",!1,"false"),e.doc.execCommand("enableInlineTableEditing",!1,"false")}catch(e){}if(e.browser.msie)try{e.doc.body.addEventListener("mscontrolselect",function(e){return e.preventDefault(),!1})}catch(e){}}var i=!1;return{on:function(){e.$wp?(e.$el.attr("contenteditable",!0),e.$el.removeClass("fr-disabled").attr("aria-disabled",!1),e.$tb&&e.$tb.removeClass("fr-disabled").attr("aria-disabled",!1),t()):e.$el.is("a")&&e.$el.attr("contenteditable",!0),i=!1},off:function(){e.$wp?(e.$el.attr("contenteditable",!1),e.$el.addClass("fr-disabled").attr("aria-disabled",!0),e.$tb&&e.$tb.addClass("fr-disabled").attr("aria-disabled",!0)):e.$el.is("a")&&e.$el.attr("contenteditable",!1),i=!0},disableDesign:t,isDisabled:function(){return i}}},e.extend(e.FE.DEFAULTS,{editorClass:null,typingTimer:500,iframe:!1,requestWithCORS:!0,requestWithCredentials:!1,requestHeaders:{},useClasses:!0,spellcheck:!0,iframeStyle:'html{margin:0px;height:auto;}body{height:auto;padding:10px;background:transparent;color:#000000;position:relative;z-index: 2;-webkit-user-select:auto;margin:0px;overflow:hidden;min-height:20px;}body:after{content:"";display:block;clear:both;}',iframeStyleFiles:[],direction:"auto",zIndex:1,disableRightClick:!1,scrollableContainer:"body",keepFormatOnDelete:!1,theme:null}),e.FE.MODULES.core=function(t){function i(){if(t.$box.addClass("fr-box"+(t.opts.editorClass?" "+t.opts.editorClass:"")),t.$wp.addClass("fr-wrapper"),t.opts.iframe||t.$el.addClass("fr-element fr-view"),t.opts.iframe){t.$iframe.addClass("fr-iframe"),t.$el.addClass("fr-view");for(var e=0;e<t.o_doc.styleSheets.length;e++){var i;try{i=t.o_doc.styleSheets[e].cssRules}catch(e){}if(i)for(var n=0,s=i.length;n<s;n++)!i[n].selectorText||0!==i[n].selectorText.indexOf(".fr-view")&&0!==i[n].selectorText.indexOf(".fr-element")||i[n].style.cssText.length>0&&(0===i[n].selectorText.indexOf(".fr-view")?t.opts.iframeStyle+=i[n].selectorText.replace(/\.fr-view/g,"body")+"{"+i[n].style.cssText+"}":t.opts.iframeStyle+=i[n].selectorText.replace(/\.fr-element/g,"body")+"{"+i[n].style.cssText+"}")}}"auto"!=t.opts.direction&&t.$box.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),t.$el.attr("dir",t.opts.direction),t.$wp.attr("dir",t.opts.direction),t.opts.zIndex>1&&t.$box.css("z-index",t.opts.zIndex),t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme")}return{_init:function(){if(e.FE.INSTANCES.push(t),t.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!t.win.FormData,progress:"upload"in new XMLHttpRequest},t.$wp){i(),t.html.set(t._original_html),t.$el.attr("spellcheck",t.opts.spellcheck),t.helpers.isMobile()&&(t.$el.attr("autocomplete",t.opts.spellcheck?"on":"off"),t.$el.attr("autocorrect",t.opts.spellcheck?"on":"off"),t.$el.attr("autocapitalize",t.opts.spellcheck?"on":"off")),t.opts.disableRightClick&&t.events.$on(t.$el,"contextmenu",function(e){if(2==e.button)return!1});try{t.doc.execCommand("styleWithCSS",!1,!1)}catch(e){}}t.events.on("drop",function(e){e.preventDefault(),e.stopPropagation()}),"TEXTAREA"==t.$oel.get(0).tagName&&(t.events.on("contentChanged",function(){t.$oel.val(t.html.get())}),t.events.on("form.submit",function(){t.$oel.val(t.html.get())}),t.events.on("form.reset",function(){t.html.set(t._original_html)}),t.$oel.val(t.html.get())),t.helpers.isIOS()&&t.events.$on(t.$doc,"selectionchange",function(){t.$doc.get(0).hasFocus()||t.$win.get(0).focus()}),t.events.trigger("init")},destroy:function(e){"TEXTAREA"==t.$oel.get(0).tagName&&t.$oel.val(e),t.$wp&&("TEXTAREA"==t.$oel.get(0).tagName?(t.$el.html(""),t.$wp.html(""),t.$box.replaceWith(t.$oel),t.$oel.show()):(t.$wp.replaceWith(e),t.$el.html(""),t.$box.removeClass("fr-view fr-ltr fr-box "+(t.opts.editorClass||"")),t.opts.theme&&t.$box.addClass(t.opts.theme+"-theme"))),this.$wp=null,this.$el=null,this.el=null,this.$box=null},isEmpty:function(){return t.node.isEmpty(t.el)},getXHR:function(e,i){var n=new XMLHttpRequest;for(var s in n.open(i,e,!0),t.opts.requestWithCredentials&&(n.withCredentials=!0),t.opts.requestHeaders)t.opts.requestHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,t.opts.requestHeaders[s]);return n},injectStyle:function(i){if(t.opts.iframe){t.$head.find("style[data-fr-style], link[data-fr-style]").remove(),t.$head.append('<style data-fr-style="true">'+i+"</style>");for(var n=0;n<t.opts.iframeStyleFiles.length;n++){var s=e('<link data-fr-style="true" rel="stylesheet" href="'+t.opts.iframeStyleFiles[n]+'">');s.get(0).addEventListener("load",t.size.syncIframe),t.$head.append(s)}}},hasFocus:function(){return t.browser.mozilla&&t.helpers.isMobile()?t.selection.inEditor():t.node.hasFocus(t.el)||t.$el.find("*:focus").length>0},sameInstance:function(e){if(!e)return!1;var i=e.data("instance");return!!i&&i.id==t.id}}},e.FE.MODULES.cursorLists=function(t){function i(e){for(var t=e;"LI"!=t.tagName;)t=t.parentNode;return t}function n(e){for(var i=e;!t.node.isList(i);)i=i.parentNode;return i}return{_startEnter:function(s){var o,r=i(s),a=r.nextSibling,l=r.previousSibling,c=t.html.defaultTag();if(t.node.isEmpty(r,!0)&&a){for(var d="",u="",h=s.parentNode;!t.node.isList(h)&&h.parentNode&&"LI"!==h.parentNode.tagName;)d=t.node.openTagString(h)+d,u+=t.node.closeTagString(h),h=h.parentNode;var p;for(d=t.node.openTagString(h)+d,u+=t.node.closeTagString(h),p=h.parentNode&&"LI"==h.parentNode.tagName?u+"<li>"+e.FE.MARKERS+"<br>"+d:c?u+"<"+c+">"+e.FE.MARKERS+"<br></"+c+">"+d:u+e.FE.MARKERS+"<br>"+d,e(r).html('<span id="fr-break"></span>');["UL","OL"].indexOf(h.tagName)<0||h.parentNode&&"LI"===h.parentNode.tagName;)h=h.parentNode;var f=t.node.openTagString(h)+e(h).html()+t.node.closeTagString(h);f=f.replace(/<span id="fr-break"><\/span>/g,p),e(h).replaceWith(f),t.$el.find("li:empty").remove()}else l&&a||!t.node.isEmpty(r,!0)?(e(r).before("<li><br></li>"),e(s).remove()):l?((o=n(r)).parentNode&&"LI"==o.parentNode.tagName?e(o.parentNode).after("<li>"+e.FE.MARKERS+"<br></li>"):c?e(o).after("<"+c+">"+e.FE.MARKERS+"<br></"+c+">"):e(o).after(e.FE.MARKERS+"<br>"),e(r).remove()):((o=n(r)).parentNode&&"LI"==o.parentNode.tagName?a?e(o.parentNode).before("<li>"+e.FE.MARKERS+"<br></li>"):e(o.parentNode).after("<li>"+e.FE.MARKERS+"<br></li>"):c?e(o).before("<"+c+">"+e.FE.MARKERS+"<br></"+c+">"):e(o).before(e.FE.MARKERS+"<br>"),e(r).remove())},_middleEnter:function(n){for(var s=i(n),o="",r=n,a="",l="";r!=s;){var c="A"==(r=r.parentNode).tagName&&t.cursor.isAtEnd(n,r)?"fr-to-remove":"";a=t.node.openTagString(e(r).clone().addClass(c).get(0))+a,l=t.node.closeTagString(r)+l}o=l+o+a+e.FE.MARKERS,e(n).replaceWith('<span id="fr-break"></span>');var d=t.node.openTagString(s)+e(s).html()+t.node.closeTagString(s);d=d.replace(/<span id="fr-break"><\/span>/g,o),e(s).replaceWith(d)},_endEnter:function(n){for(var s=i(n),o=e.FE.MARKERS,r="",a=n,l=!1;a!=s;){var c="A"==(a=a.parentNode).tagName&&t.cursor.isAtEnd(n,a)?"fr-to-remove":"";l||a==s||t.node.isBlock(a)||(l=!0,r+=e.FE.INVISIBLE_SPACE),r=t.node.openTagString(e(a).clone().addClass(c).get(0))+r,o+=t.node.closeTagString(a)}var d=r+o;e(n).remove(),e(s).after(d)},_backspace:function(s){var o=i(s),r=o.previousSibling;if(r){r=e(r).find(t.html.blockTagsQuery()).get(-1)||r,e(s).replaceWith(e.FE.MARKERS);var a=t.node.contents(r);a.length&&"BR"==a[a.length-1].tagName&&e(a[a.length-1]).remove(),e(o).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==o&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))});for(var l,c=t.node.contents(o)[0];c&&!t.node.isList(c);)l=c.nextSibling,e(r).append(c),c=l;for(r=o.previousSibling;c;)l=c.nextSibling,e(r).append(c),c=l;e(o).remove()}else{var d=n(o);if(e(s).replaceWith(e.FE.MARKERS),d.parentNode&&"LI"==d.parentNode.tagName){var u=d.previousSibling;t.node.isBlock(u)?(e(o).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==o&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),e(u).append(e(o).html())):e(d).before(e(o).html())}else{var h=t.html.defaultTag();h&&0===e(o).find(t.html.blockTagsQuery()).length?e(d).before("<"+h+">"+e(o).html()+"</"+h+">"):e(d).before(e(o).html())}e(o).remove(),0===e(d).find("li").length&&e(d).remove()}},_del:function(n){var s,o=i(n),r=o.nextSibling;if(r){(s=t.node.contents(r)).length&&"BR"==s[0].tagName&&e(s[0]).remove(),e(r).find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==r&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))});for(var a,l=n,c=t.node.contents(r)[0];c&&!t.node.isList(c);)a=c.nextSibling,e(l).after(c),l=c,c=a;for(;c;)a=c.nextSibling,e(o).append(c),c=a;e(n).replaceWith(e.FE.MARKERS),e(r).remove()}else{for(var d=o;!d.nextSibling&&d!=t.el;)d=d.parentNode;if(d==t.el)return!1;if(d=d.nextSibling,t.node.isBlock(d))e.FE.NO_DELETE_TAGS.indexOf(d.tagName)<0&&(e(n).replaceWith(e.FE.MARKERS),(s=t.node.contents(o)).length&&"BR"==s[s.length-1].tagName&&e(s[s.length-1]).remove(),e(o).append(e(d).html()),e(d).remove());else for((s=t.node.contents(o)).length&&"BR"==s[s.length-1].tagName&&e(s[s.length-1]).remove(),e(n).replaceWith(e.FE.MARKERS);d&&!t.node.isBlock(d)&&"BR"!=d.tagName;)e(o).append(e(d)),d=d.nextSibling}}}},e.FE.NO_DELETE_TAGS=["TH","TD","TR","TABLE","FORM"],e.FE.SIMPLE_ENTER_TAGS=["TH","TD","LI","DL","DT","FORM"],e.FE.MODULES.cursor=function(t){function i(e){return!!e&&(!!t.node.isBlock(e)||(e.nextSibling&&e.nextSibling.nodeType==Node.TEXT_NODE&&0==e.nextSibling.textContent.replace(/\u200b/g,"").length?i(e.nextSibling):!e.nextSibling&&i(e.parentNode)))}function n(e){return!!e&&(!!t.node.isBlock(e)||(e.previousSibling&&e.previousSibling.nodeType==Node.TEXT_NODE&&0==e.previousSibling.textContent.replace(/\u200b/g,"").length?n(e.previousSibling):!e.previousSibling&&n(e.parentNode)))}function s(e,i){return!!e&&e!=t.$wp.get(0)&&(e.previousSibling&&e.previousSibling.nodeType==Node.TEXT_NODE&&0==e.previousSibling.textContent.replace(/\u200b/g,"").length?s(e.previousSibling,i):!e.previousSibling&&(e.parentNode==i||s(e.parentNode,i)))}function o(e,i){return!!e&&e!=t.$wp.get(0)&&(e.nextSibling&&e.nextSibling.nodeType==Node.TEXT_NODE&&0==e.nextSibling.textContent.replace(/\u200b/g,"").length?o(e.nextSibling,i):!e.nextSibling&&(e.parentNode==i||o(e.parentNode,i)))}function r(i){return e(i).parentsUntil(t.$el,"LI").length>0&&0===e(i).parentsUntil("LI","TABLE").length}function a(i){for(var n=i;!n.previousSibling;)if(n=n.parentNode,t.node.isElement(n))return!1;var s;if(n=n.previousSibling,!t.node.isBlock(n)&&t.node.isEditable(n)){for(s=t.node.contents(n);n.nodeType!=Node.TEXT_NODE&&!t.node.isDeletable(n)&&s.length&&t.node.isEditable(n);)n=s[s.length-1],s=t.node.contents(n);if(n.nodeType==Node.TEXT_NODE){if(t.helpers.isIOS())return!0;var o=n.textContent,r=o.length-1;if(t.opts.tabSpaces&&o.length>=t.opts.tabSpaces)0==o.substr(o.length-t.opts.tabSpaces,o.length-1).replace(/ /g,"").replace(new RegExp(e.FE.UNICODE_NBSP,"g"),"").length&&(r=o.length-t.opts.tabSpaces);n.textContent=o.substring(0,r),n.textContent.length&&55357==n.textContent.charCodeAt(n.textContent.length-1)&&(n.textContent=n.textContent.substr(0,n.textContent.length-1));var a=o.length!=n.textContent.length;0==n.textContent.length?a&&t.opts.keepFormatOnDelete?e(n).after(e.FE.INVISIBLE_SPACE+e.FE.MARKERS):2!=n.parentNode.childNodes.length||n.parentNode!=i.parentNode||t.node.isBlock(n.parentNode)||t.node.isElement(n.parentNode)?(e(n).after(e.FE.MARKERS),t.node.isElement(n.parentNode)&&!i.nextSibling&&n.previousSibling&&"BR"==n.previousSibling.tagName&&e(i).after("<br>"),n.parentNode.removeChild(n)):(e(n.parentNode).after(e.FE.MARKERS),e(n.parentNode).remove()):e(n).after(e.FE.MARKERS)}else t.node.isDeletable(n)?(e(n).after(e.FE.MARKERS),e(n).remove()):!1!==t.events.trigger("node.remove",[e(n)])&&(e(n).after(e.FE.MARKERS),e(n).remove())}else if(e.FE.NO_DELETE_TAGS.indexOf(n.tagName)<0&&(t.node.isEditable(n)||t.node.isDeletable(n)))if(t.node.isDeletable(n))e(i).replaceWith(e.FE.MARKERS),e(n).remove();else if(t.node.isEmpty(n)&&!t.node.isList(n))e(n).remove(),e(i).replaceWith(e.FE.MARKERS);else{for(t.node.isList(n)&&(n=e(n).find("li:last").get(0)),(s=t.node.contents(n))&&"BR"==s[s.length-1].tagName&&e(s[s.length-1]).remove(),s=t.node.contents(n);s&&t.node.isBlock(s[s.length-1]);)n=s[s.length-1],s=t.node.contents(n);e(n).append(e.FE.MARKERS);for(var l=i;!l.previousSibling;)l=l.parentNode;for(;l&&"BR"!==l.tagName&&!t.node.isBlock(l);){var c=l;l=l.nextSibling,e(n).append(c)}l&&"BR"==l.tagName&&e(l).remove(),e(i).remove()}else i.nextSibling&&"BR"==i.nextSibling.tagName&&e(i.nextSibling).remove()}function l(i){var n=e(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,s=t.node.deepestParent(i,[],!n);if(s&&"BLOCKQUOTE"==s.tagName){var o=t.node.deepestParent(i,[e(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]);o&&o.nextSibling&&(s=o)}if(null!==s){var r,a=s.nextSibling;if(t.node.isBlock(s)&&(t.node.isEditable(s)||t.node.isDeletable(s))&&a&&e.FE.NO_DELETE_TAGS.indexOf(a.tagName)<0)if(t.node.isDeletable(a))e(a).remove(),e(i).replaceWith(e.FE.MARKERS);else if(t.node.isBlock(a)&&t.node.isEditable(a))if(t.node.isList(a))if(t.node.isEmpty(s,!0))e(s).remove(),e(a).find("li:first").prepend(e.FE.MARKERS);else{var l=e(a).find("li:first");"BLOCKQUOTE"==s.tagName&&((r=t.node.contents(s)).length&&t.node.isBlock(r[r.length-1])&&(s=r[r.length-1])),0===l.find("ul, ol").length&&(e(i).replaceWith(e.FE.MARKERS),l.find(t.html.blockTagsQuery()).not("ol, ul, table").each(function(){this.parentNode==l.get(0)&&e(this).replaceWith(e(this).html()+(t.node.isEmpty(this)?"":"<br>"))}),e(s).append(t.node.contents(l.get(0))),l.remove(),0===e(a).find("li").length&&e(a).remove())}else{if((r=t.node.contents(a)).length&&"BR"==r[0].tagName&&e(r[0]).remove(),"BLOCKQUOTE"!=a.tagName&&"BLOCKQUOTE"==s.tagName)for(r=t.node.contents(s);r.length&&t.node.isBlock(r[r.length-1]);)s=r[r.length-1],r=t.node.contents(s);else if("BLOCKQUOTE"==a.tagName&&"BLOCKQUOTE"!=s.tagName)for(r=t.node.contents(a);r.length&&t.node.isBlock(r[0]);)a=r[0],r=t.node.contents(a);e(i).replaceWith(e.FE.MARKERS),e(s).append(a.innerHTML),e(a).remove()}else{for(e(i).replaceWith(e.FE.MARKERS);a&&"BR"!==a.tagName&&!t.node.isBlock(a)&&t.node.isEditable(a);){var c=a;a=a.nextSibling,e(s).append(c)}a&&"BR"==a.tagName&&t.node.isEditable(a)&&e(a).remove()}}}function c(){for(var e=t.el.querySelectorAll("blockquote:empty"),i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i])}function d(i,n,s){var r,a=t.node.deepestParent(i,[],!s);if(a&&"BLOCKQUOTE"==a.tagName)return o(i,a)?((r=t.html.defaultTag())?e(a).after("<"+r+">"+e.FE.MARKERS+"<br></"+r+">"):e(a).after(e.FE.MARKERS+"<br>"),e(i).remove(),!1):(h(i,n,s),!1);if(null==a)(r=t.html.defaultTag())&&t.node.isElement(i.parentNode)?e(i).replaceWith("<"+r+">"+e.FE.MARKERS+"<br></"+r+">"):e(i).replaceWith((t.node.isEmpty(i.parentNode,!0)?"":"<br/>")+e.FE.MARKERS+"<br/>");else{var l=i,c="";t.node.isBlock(a)&&!n||(c="<br/>");var d,u="",p="",f="",m="";(r=t.html.defaultTag())&&t.node.isBlock(a)&&(f="<"+r+">",m="</"+r+">",a.tagName==r.toUpperCase()&&(f=t.node.openTagString(e(a).clone().removeAttr("id").get(0))));do{if(l=l.parentNode,!n||l!=a||n&&!t.node.isBlock(a))if(u+=t.node.closeTagString(l),l==a&&t.node.isBlock(a))p=f+p;else{var g="A"==l.tagName&&o(i,l)?"fr-to-remove":"";p=t.node.openTagString(e(l).clone().addClass(g).get(0))+p}}while(l!=a);c=u+c+p+(i.parentNode==a&&t.node.isBlock(a)?"":e.FE.INVISIBLE_SPACE)+e.FE.MARKERS,t.node.isBlock(a)&&!e(a).find("*:last").is("br")&&e(a).append("<br/>"),e(i).after('<span id="fr-break"></span>'),e(i).remove(),a.nextSibling&&!t.node.isBlock(a.nextSibling)||t.node.isBlock(a)||e(a).after("<br>"),d=(d=!n&&t.node.isBlock(a)?t.node.openTagString(a)+e(a).html()+m:t.node.openTagString(a)+e(a).html()+t.node.closeTagString(a)).replace(/<span id="fr-break"><\/span>/g,c),e(a).replaceWith(d)}}function u(i,n,r){var a,l=t.node.deepestParent(i,[],!r);if(l&&"TABLE"==l.tagName)return e(l).find("td:first, th:first").prepend(i),u(i,n,r);if(l&&"BLOCKQUOTE"==l.tagName){if(s(i,l))return(a=t.html.defaultTag())?e(l).before("<"+a+">"+e.FE.MARKERS+"<br></"+a+">"):e(l).before(e.FE.MARKERS+"<br>"),e(i).remove(),!1;o(i,l)?d(i,n,!0):h(i,n,!0)}if(null==l)(a=t.html.defaultTag())&&t.node.isElement(i.parentNode)?e(i).replaceWith("<"+a+">"+e.FE.MARKERS+"<br></"+a+">"):e(i).replaceWith("<br>"+e.FE.MARKERS);else{if(t.node.isBlock(l))if(n)e(i).remove(),e(l).prepend("<br>"+e.FE.MARKERS);else{if(t.node.isEmpty(l,!0))return d(i,n,r);e(l).before(t.node.openTagString(e(l).clone().removeAttr("id").get(0))+"<br>"+t.node.closeTagString(l))}else e(l).before("<br>");e(i).remove()}}function h(i,n,r){var a=t.node.deepestParent(i,[],!r);if(null==a)t.html.defaultTag()&&i.parentNode===t.el?e(i).replaceWith("<"+t.html.defaultTag()+">"+e.FE.MARKERS+"<br></"+t.html.defaultTag()+">"):(i.nextSibling&&!t.node.isBlock(i.nextSibling)||e(i).after("<br>"),e(i).replaceWith("<br>"+e.FE.MARKERS));else{var l=i,c="";"PRE"==a.tagName&&(n=!0),t.node.isBlock(a)&&!n||(c="<br>");var d="",u="";do{var h=l;if(l=l.parentNode,"BLOCKQUOTE"==a.tagName&&t.node.isEmpty(h)&&!t.node.hasClass(h,"fr-marker")&&e(h).find(i).length>0&&e(h).after(i),("BLOCKQUOTE"!=a.tagName||!o(i,l)&&!s(i,l))&&(!n||l!=a||n&&!t.node.isBlock(a))){d+=t.node.closeTagString(l);var p="A"==l.tagName&&o(i,l)?"fr-to-remove":"";u=t.node.openTagString(e(l).clone().addClass(p).removeAttr("id").get(0))+u}}while(l!=a);var f=a==i.parentNode&&t.node.isBlock(a)||i.nextSibling;if("BLOCKQUOTE"==a.tagName){i.previousSibling&&t.node.isBlock(i.previousSibling)&&i.nextSibling&&"BR"==i.nextSibling.tagName&&(e(i.nextSibling).after(i),i.nextSibling&&"BR"==i.nextSibling.tagName&&e(i.nextSibling).remove());var m=t.html.defaultTag();c=d+c+(m?"<"+m+">":"")+e.FE.MARKERS+"<br>"+(m?"</"+m+">":"")+u}else c=d+c+u+(f?"":e.FE.INVISIBLE_SPACE)+e.FE.MARKERS;e(i).replaceWith('<span id="fr-break"></span>');var g=t.node.openTagString(a)+e(a).html()+t.node.closeTagString(a);g=g.replace(/<span id="fr-break"><\/span>/g,c),e(a).replaceWith(g)}}return{enter:function(s){var o=t.markers.insert();if(!o)return!0;t.el.normalize();var a=!1;e(o).parentsUntil(t.$el,"BLOCKQUOTE").length>0&&(s=!1,a=!0),e(o).parentsUntil(t.$el,"TD, TH").length&&(a=!1),i(o)?!r(o)||s||a?d(o,s,a):t.cursorLists._endEnter(o):n(o)?!r(o)||s||a?u(o,s,a):t.cursorLists._startEnter(o):!r(o)||s||a?h(o,s,a):t.cursorLists._middleEnter(o),t.$el.find(".fr-to-remove").each(function(){for(var i=t.node.contents(this),n=0;n<i.length;n++)i[n].nodeType==Node.TEXT_NODE&&(i[n].textContent=i[n].textContent.replace(/\u200B/g,""));e(this).replaceWith(this.innerHTML)}),t.html.fillEmptyBlocks(!0),t.html.cleanEmptyTags(),t.clean.lists(),t.spaces.normalizeAroundCursor(),t.selection.restore()},backspace:function(){var o=!1,l=t.markers.insert();if(!l)return!0;t.el.normalize();var d=l.previousSibling;if(d){var u=d.textContent;u&&u.length&&8203==u.charCodeAt(u.length-1)&&(1==u.length?e(d).remove():(d.textContent=d.textContent.substr(0,u.length-1),d.textContent.length&&55357==d.textContent.charCodeAt(d.textContent.length-1)&&(d.textContent=d.textContent.substr(0,d.textContent.length-1))))}return i(l)?o=a(l):n(l)?r(l)&&s(l,e(l).parents("li:first").get(0))?t.cursorLists._backspace(l):function(i){var n=e(i).parentsUntil(t.$el,"BLOCKQUOTE").length>0,s=t.node.deepestParent(i,[],!n);if(s&&"BLOCKQUOTE"==s.tagName){var o=t.node.deepestParent(i,[e(i).parentsUntil(t.$el,"BLOCKQUOTE").get(0)]);o&&o.previousSibling&&(s=o)}if(null!==s){var r,a=s.previousSibling;if(t.node.isBlock(s)&&t.node.isEditable(s)&&a&&e.FE.NO_DELETE_TAGS.indexOf(a.tagName)<0)if(t.node.isDeletable(a))e(a).remove(),e(i).replaceWith(e.FE.MARKERS);else if(t.node.isEditable(a))if(t.node.isBlock(a))if(t.node.isEmpty(a)&&!t.node.isList(a))e(a).remove();else{if(t.node.isList(a)&&(a=e(a).find("li:last").get(0)),(r=t.node.contents(a)).length&&"BR"==r[r.length-1].tagName&&e(r[r.length-1]).remove(),"BLOCKQUOTE"==a.tagName&&"BLOCKQUOTE"!=s.tagName)for(r=t.node.contents(a);r.length&&t.node.isBlock(r[r.length-1]);)a=r[r.length-1],r=t.node.contents(a);else if("BLOCKQUOTE"!=a.tagName&&"BLOCKQUOTE"==s.tagName)for(r=t.node.contents(s);r.length&&t.node.isBlock(r[0]);)s=r[0],r=t.node.contents(s);e(i).replaceWith(e.FE.MARKERS),e(a).append(t.node.isEmpty(s)?e.FE.MARKERS:s.innerHTML),e(s).remove()}else e(i).replaceWith(e.FE.MARKERS),"BLOCKQUOTE"==s.tagName&&a.nodeType==Node.ELEMENT_NODE?e(a).remove():(e(a).after(t.node.isEmpty(s)?"":e(s).html()),e(s).remove(),"BR"==a.tagName&&e(a).remove())}}(l):o=a(l),e(l).remove(),c(),t.html.fillEmptyBlocks(!0),t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists(),t.spaces.normalizeAroundCursor(),t.selection.restore(),o},del:function(){var s=t.markers.insert();if(!s)return!1;if(t.el.normalize(),i(s))if(r(s))if(0===e(s).parents("li:first").find("ul, ol").length)t.cursorLists._del(s);else{var o=e(s).parents("li:first").find("ul:first, ol:first").find("li:first");(o=o.find(t.html.blockTagsQuery()).get(-1)||o).prepend(s),t.cursorLists._backspace(s)}else l(s);else!function(n){for(var s=n;!s.nextSibling;)if(s=s.parentNode,t.node.isElement(s))return!1;if("BR"==(s=s.nextSibling).tagName&&t.node.isEditable(s))if(s.nextSibling){if(t.node.isBlock(s.nextSibling)&&t.node.isEditable(s.nextSibling)){if(!(e.FE.NO_DELETE_TAGS.indexOf(s.nextSibling.tagName)<0))return void e(s).remove();s=s.nextSibling,e(s.previousSibling).remove()}}else if(i(s))return void(r(n)?t.cursorLists._del(n):t.node.deepestParent(s)&&(e(s).remove(),l(n)));var o;if(!t.node.isBlock(s)&&t.node.isEditable(s)){for(o=t.node.contents(s);s.nodeType!=Node.TEXT_NODE&&o.length&&!t.node.isDeletable(s)&&t.node.isEditable(s);)s=o[0],o=t.node.contents(s);s.nodeType==Node.TEXT_NODE?(e(s).before(e.FE.MARKERS),s.textContent.length&&55357==s.textContent.charCodeAt(0)?s.textContent=s.textContent.substring(2,s.textContent.length):s.textContent=s.textContent.substring(1,s.textContent.length)):t.node.isDeletable(s)?(e(s).before(e.FE.MARKERS),e(s).remove()):!1!==t.events.trigger("node.remove",[e(s)])&&(e(s).before(e.FE.MARKERS),e(s).remove()),e(n).remove()}else if(e.FE.NO_DELETE_TAGS.indexOf(s.tagName)<0&&(t.node.isEditable(s)||t.node.isDeletable(s)))if(t.node.isDeletable(s))e(n).replaceWith(e.FE.MARKERS),e(s).remove();else if(t.node.isList(s))n.previousSibling?(e(s).find("li:first").prepend(n),t.cursorLists._backspace(n)):(e(s).find("li:first").prepend(e.FE.MARKERS),e(n).remove());else if((o=t.node.contents(s))&&"BR"==o[0].tagName&&e(o[0]).remove(),o&&"BLOCKQUOTE"==s.tagName){var a=o[0];for(e(n).before(e.FE.MARKERS);a&&"BR"!=a.tagName;){var c=a;a=a.nextSibling,e(n).before(c)}a&&"BR"==a.tagName&&e(a).remove()}else e(n).after(e(s).html()).after(e.FE.MARKERS),e(s).remove()}((n(s),s));e(s).remove(),c(),t.html.fillEmptyBlocks(!0),t.html.cleanEmptyTags(),t.clean.quotes(),t.clean.lists(),t.spaces.normalizeAroundCursor(),t.selection.restore()},isAtEnd:o,isAtStart:s}},e.FE.ENTER_P=0,e.FE.ENTER_DIV=1,e.FE.ENTER_BR=2,e.FE.KEYCODE={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,FF_HYPHEN:173,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,HYPHEN:189,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221},e.extend(e.FE.DEFAULTS,{enter:e.FE.ENTER_P,multiLine:!0,tabSpaces:0}),e.FE.MODULES.keys=function(t){function i(){if(t.browser.mozilla&&t.selection.isCollapsed()&&!m){var e=t.selection.ranges(0),i=e.startContainer,n=e.startOffset;i&&i.nodeType==Node.TEXT_NODE&&n<=i.textContent.length&&n>0&&32==i.textContent.charCodeAt(n-1)&&(t.selection.save(),t.spaces.normalize(),t.selection.restore())}}function n(){t.selection.isFull()&&setTimeout(function(){var i=t.html.defaultTag();i?t.$el.html("<"+i+">"+e.FE.MARKERS+"<br/></"+i+">"):t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore(),t.placeholder.refresh(),t.button.bulkRefresh(),t.undo.saveStep()},0)}function s(e){m=!1}function o(i){t.events.disableBlur(),h=!0;var n=i.which;if(16===n)return!0;if(229===n)return m=!0,!0;m=!1;var s=c(n)&&!a(i),o=n==e.FE.KEYCODE.BACKSPACE||n==e.FE.KEYCODE.DELETE;if((t.selection.isFull()&&!t.opts.keepFormatOnDelete&&!t.placeholder.isVisible()||o&&t.placeholder.isVisible()&&t.opts.keepFormatOnDelete)&&(s||o)){var r=t.html.defaultTag();if(r?t.$el.html("<"+r+">"+e.FE.MARKERS+"<br/></"+r+">"):t.$el.html(e.FE.MARKERS+"<br/>"),t.selection.restore(),!c(n))return i.preventDefault(),!0}n==e.FE.KEYCODE.ENTER?i.shiftKey?function(e){e.preventDefault(),e.stopPropagation(),t.opts.multiLine&&(t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter(!0))}(i):function(e){t.opts.multiLine?t.helpers.isIOS()||(e.preventDefault(),e.stopPropagation(),t.selection.isCollapsed()||t.selection.remove(),t.cursor.enter()):(e.preventDefault(),e.stopPropagation())}(i):n!=e.FE.KEYCODE.BACKSPACE||a(i)||i.altKey?n!=e.FE.KEYCODE.DELETE||a(i)||i.altKey?n==e.FE.KEYCODE.SPACE?function(i){var n=t.selection.element();if(!t.helpers.isMobile()&&(t.browser.mozilla||n&&"A"==n.tagName)){i.preventDefault(),i.stopPropagation(),t.selection.isCollapsed()||t.selection.remove();var s=t.markers.insert();if(s){var o=s.previousSibling;!s.nextSibling&&s.parentNode&&"A"==s.parentNode.tagName?(s.parentNode.insertAdjacentHTML("afterend","&nbsp;"+e.FE.MARKERS),s.parentNode.removeChild(s)):(o&&o.nodeType==Node.TEXT_NODE&&1==o.textContent.length&&160==o.textContent.charCodeAt(0)?o.textContent=o.textContent+" ":s.insertAdjacentHTML("beforebegin","&nbsp;"),s.outerHTML=e.FE.MARKERS),t.selection.restore()}}}(i):n==e.FE.KEYCODE.TAB?function(e){if(t.opts.tabSpaces>0)if(t.selection.isCollapsed()){t.undo.saveStep(),e.preventDefault(),e.stopPropagation();for(var i="",n=0;n<t.opts.tabSpaces;n++)i+="&nbsp;";t.html.insert(i),t.placeholder.refresh(),t.undo.saveStep()}else e.preventDefault(),e.stopPropagation(),e.shiftKey?t.commands.outdent():t.commands.indent()}(i):a(i)||!c(i.which)||t.selection.isCollapsed()||i.ctrlKey||t.selection.remove():t.placeholder.isVisible()?(i.preventDefault(),i.stopPropagation()):function(e){e.preventDefault(),e.stopPropagation(),""===t.selection.text()?t.cursor.del():t.selection.remove(),t.placeholder.refresh()}(i):t.placeholder.isVisible()?(i.preventDefault(),i.stopPropagation()):function(e){t.selection.isCollapsed()?t.cursor.backspace()||(e.preventDefault(),e.stopPropagation(),h=!1):(e.preventDefault(),e.stopPropagation(),t.selection.remove(),t.html.fillEmptyBlocks(),h=!1),t.placeholder.refresh()}(i),t.events.enableBlur()}function r(i){if(m)return m=!1,!1;if(!t.selection.isCollapsed())return!0;if(i&&(i.which===e.FE.KEYCODE.META||i.which==e.FE.KEYCODE.CTRL))return!0;if(i&&l(i.which))return!0;i&&i.which==e.FE.KEYCODE.ENTER&&t.helpers.isIOS()&&function(){var i=t.selection.element(),n=t.node.blockParent(i);if(n&&"DIV"==n.tagName&&t.selection.info(n).atStart){var s=t.html.defaultTag();n.previousSibling&&"DIV"!=n.previousSibling.tagName&&s&&"div"!=s&&(t.selection.save(),e(n).replaceWith("<"+s+">"+n.innerHTML+"</"+s+">"),t.selection.restore())}}(),i&&(i.which==e.FE.KEYCODE.ENTER||i.which==e.FE.KEYCODE.BACKSPACE||i.which>=37&&i.which<=40&&!t.browser.msie)&&(i.which==e.FE.KEYCODE.BACKSPACE&&h||function(){if(!t.$wp)return!0;var i;t.opts.height||t.opts.heightMax?(i=t.position.getBoundingRect().top,t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i>t.$wp.offset().top-e(t.o_win).scrollTop()+t.$wp.height()-20&&t.$wp.scrollTop(i+t.$wp.scrollTop()-(t.$wp.height()+t.$wp.offset().top)+e(t.o_win).scrollTop()+20)):(i=t.position.getBoundingRect().top,t.opts.toolbarBottom&&(i+=t.opts.toolbarStickyOffset),t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),(i+=t.opts.toolbarStickyOffset)>t.o_win.innerHeight-20&&e(t.o_win).scrollTop(i+e(t.o_win).scrollTop()-t.o_win.innerHeight+20),i=t.position.getBoundingRect().top,t.opts.toolbarBottom||(i-=t.opts.toolbarStickyOffset),t.helpers.isIOS()&&(i-=e(t.o_win).scrollTop()),t.opts.iframe&&(i+=t.$iframe.offset().top),i<t.$tb.height()+20&&e(t.o_win).scrollTop(i+e(t.o_win).scrollTop()-t.$tb.height()-20))}()),t.html.cleanBRs(!0,!0);var n=t.selection.element();(function(e){if(!e)return!1;var t=e.innerHTML;return!!((t=t.replace(/<span[^>]*? class\s*=\s*["']?fr-marker["']?[^>]+>\u200b<\/span>/gi,""))&&/\u200B/.test(t)&&t.replace(/\u200B/gi,"").length>0)})(n)&&!t.node.hasClass(n,"fr-marker")&&"IFRAME"!=n.tagName&&function(e){return!t.helpers.isIOS()||0===((e.textContent||"").match(/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi)||[]).length}(n)&&(t.selection.save(),function(e){for(var i=t.doc.createTreeWalker(e,NodeFilter.SHOW_TEXT,t.node.filter(function(e){return/\u200B/gi.test(e.textContent)}),!1);i.nextNode();){var n=i.currentNode;n.textContent=n.textContent.replace(/\u200B/gi,"")}}(n),t.selection.restore())}function a(e){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(e.metaKey&&!e.altKey)return!0}else if(e.ctrlKey&&!e.altKey)return!0;return!1}function l(t){if(t>=e.FE.KEYCODE.ARROW_LEFT&&t<=e.FE.KEYCODE.ARROW_DOWN)return!0}function c(i){if(i>=e.FE.KEYCODE.ZERO&&i<=e.FE.KEYCODE.NINE)return!0;if(i>=e.FE.KEYCODE.NUM_ZERO&&i<=e.FE.KEYCODE.NUM_MULTIPLY)return!0;if(i>=e.FE.KEYCODE.A&&i<=e.FE.KEYCODE.Z)return!0;if(t.browser.webkit&&0===i)return!0;switch(i){case e.FE.KEYCODE.SPACE:case e.FE.KEYCODE.QUESTION_MARK:case e.FE.KEYCODE.NUM_PLUS:case e.FE.KEYCODE.NUM_MINUS:case e.FE.KEYCODE.NUM_PERIOD:case e.FE.KEYCODE.NUM_DIVISION:case e.FE.KEYCODE.SEMICOLON:case e.FE.KEYCODE.FF_SEMICOLON:case e.FE.KEYCODE.DASH:case e.FE.KEYCODE.EQUALS:case e.FE.KEYCODE.FF_EQUALS:case e.FE.KEYCODE.COMMA:case e.FE.KEYCODE.PERIOD:case e.FE.KEYCODE.SLASH:case e.FE.KEYCODE.APOSTROPHE:case e.FE.KEYCODE.SINGLE_QUOTE:case e.FE.KEYCODE.OPEN_SQUARE_BRACKET:case e.FE.KEYCODE.BACKSLASH:case e.FE.KEYCODE.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}function d(i){var n=i.which;return!!(a(i)||n>=37&&n<=40||!c(n)&&n!=e.FE.KEYCODE.DELETE&&n!=e.FE.KEYCODE.BACKSPACE&&n!=e.FE.KEYCODE.ENTER)||(p||(f=t.snapshot.get()),clearTimeout(p),void(p=setTimeout(function(){p=null,t.undo.saveStep()},Math.max(250,t.opts.typingTimer))))}function u(e){var i=e.which;return!!(a(e)||i>=37&&i<=40)||void(f&&p&&(t.undo.saveStep(f),f=null))}var h,p,f,m=!1;return{_init:function(){if(t.events.on("keydown",d),t.events.on("input",i),t.events.on("keyup input",u),t.events.on("keypress",s),t.events.on("keydown",o),t.events.on("keyup",r),t.events.on("html.inserted",r),t.events.on("cut",n),t.el.msGetInputContext)try{t.el.msGetInputContext().addEventListener("MSCandidateWindowShow",function(){m=!0}),t.el.msGetInputContext().addEventListener("MSCandidateWindowHide",function(){m=!1,r()})}catch(e){}},ctrlKey:a,isCharacter:c,isArrow:l,forceUndo:function(){p&&(clearTimeout(p),t.undo.saveStep(),f=null)},isIME:function(){return m},isBrowserAction:function(t){var i=t.which;return a(t)||i==e.FE.KEYCODE.F5}}},e.FE.MODULES.accessibility=function(t){function i(e){e&&e.length&&(e.data("blur-event-set")||e.parents(".fr-popup").length||(t.events.$on(e,"blur",function(i){var n=e.parents(".fr-toolbar, .fr-popup").data("instance")||t;n.events.blurActive()&&n.events.trigger("blur"),n.events.enableBlur()},!0),e.data("blur-event-set",!0)),t.events.disableBlur(),e.focus(),t.shared.$f_el=e)}function n(e,t){var n=t?"last":"first",s=e.find("button:visible:not(.fr-disabled), .fr-group span.fr-command:visible")[n]();if(s.length)return i(s),!0}function s(e){return e.is("input, textarea")&&r(),t.events.disableBlur(),e.focus(),!0}function o(e,i){var n=e.find("input, textarea, button, select").filter(":visible").not(":disabled").filter(i?":last":":first");if(n.length)return s(n);if(t.shared.with_kb){var o=e.find(".fr-active-item:visible:first");if(o.length)return s(o);var r=e.find("[tabIndex]:visible:first");if(r.length)return s(r)}}function r(){0===t.$el.find(".fr-marker").length&&t.core.hasFocus()&&t.selection.save()}function a(e){e.$el.find(".fr-marker").length&&(e.events.disableBlur(),e.selection.restore(),e.events.enableBlur())}function l(){var e=t.popups.areVisible();if(e){var i=e.find(".fr-buttons");return i.find("button:focus, .fr-group span:focus").length?!n(e.data("instance").$tb):!n(i)}return!n(t.$tb)}function c(){var e=null;return t.shared.$f_el.is(".fr-dropdown.fr-active")?e=t.shared.$f_el:t.shared.$f_el.closest(".fr-dropdown-menu").prev().is(".fr-dropdown.fr-active")&&(e=t.shared.$f_el.closest(".fr-dropdown-menu").prev()),e}function d(s,r,a){if(t.shared.$f_el){var l=c();l&&(t.button.click(l),t.shared.$f_el=l);var d=s.find("button:visible:not(.fr-disabled), .fr-group span.fr-command:visible"),u=d.index(t.shared.$f_el);if(0==u&&!a||u==d.length-1&&a){var h;if(r){if(s.parent().is(".fr-popup"))h=!o(s.parent().children().not(".fr-buttons"),!a);!1===h&&(t.shared.$f_el=null)}r&&!1===h||n(s,!a)}else i(e(d.get(u+(a?1:-1))));return!1}}function u(e,t){return d(e,t,!0)}function h(e,t){return d(e,t)}function p(e){if(t.shared.$f_el){var n;if(t.shared.$f_el.is(".fr-dropdown.fr-active"))return i(n=e?t.shared.$f_el.next().find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.next().find(".fr-command:not(.fr-disabled)").last()),!1;if(t.shared.$f_el.is("a.fr-command"))return(n=e?t.shared.$f_el.closest("li").nextAll(":visible:first").find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.closest("li").prevAll(":visible:first").find(".fr-command:not(.fr-disabled)").first()).length||(n=e?t.shared.$f_el.closest(".fr-dropdown-menu").find(".fr-command:not(.fr-disabled)").first():t.shared.$f_el.closest(".fr-dropdown-menu").find(".fr-command:not(.fr-disabled)").last()),i(n),!1}}function f(){if(t.shared.$f_el){if(t.shared.$f_el.hasClass("fr-dropdown"))t.button.click(t.shared.$f_el);else if(t.shared.$f_el.is("button.fr-back")){t.opts.toolbarInline&&(t.events.disableBlur(),t.events.focus());var e=t.popups.areVisible(t);e&&(t.shared.with_kb=!1),t.button.click(t.shared.$f_el),y(e)}else{if(t.events.disableBlur(),t.button.click(t.shared.$f_el),t.shared.$f_el.attr("data-popup")){var i=t.popups.areVisible(t);i&&i.data("popup-button",t.shared.$f_el)}else if(t.shared.$f_el.attr("data-modal")){var n=t.modals.areVisible(t);n&&n.data("modal-button",t.shared.$f_el)}t.shared.$f_el=null}return!1}}function m(){t.shared.$f_el&&(t.events.disableBlur(),t.shared.$f_el.blur(),t.shared.$f_el=null),t.events.disableBlur(),t.events.focus()}function g(e){if(t.shared.$f_el){var n=c();return n?(t.button.click(n),i(n)):e.parent().find(".fr-back:visible").length?(t.shared.with_kb=!1,t.opts.toolbarInline&&(t.events.disableBlur(),t.events.focus()),t.button.exec(e.parent().find(".fr-back:visible:first")),y(e.parent())):t.shared.$f_el.is("button, .fr-group span")&&(e.parent().is(".fr-popup")?(a(t),t.shared.$f_el=null,!1!==t.events.trigger("toolbar.esc")&&(t.popups.hide(e.parent()),t.opts.toolbarInline&&t.toolbar.showInline(null,!0),y(e.parent()))):m()),!1}}function v(i){i&&i.length&&(t.events.$on(i,"keydown",function(n){if(!e(n.target).is("a.fr-command, button.fr-command, .fr-group span.fr-command"))return!0;var s=i.parents(".fr-popup").data("instance")||i.data("instance")||t;t.shared.with_kb=!0;var o=s.accessibility.exec(n,i);return t.shared.with_kb=!1,o},!0),t.events.$on(i,"mouseenter","[tabIndex]",function(n){var s=i.parents(".fr-popup").data("instance")||i.data("instance")||t;if(!C)return n.stopPropagation(),void n.preventDefault();var o=e(n.currentTarget);s.shared.$f_el&&s.shared.$f_el.not(o)&&s.accessibility.focusEditor()},!0))}function b(i){var s=t.popups.get(i);return{_tiKeydown:function(r){var l=s.data("instance")||t;if(!1===l.events.trigger("popup.tab",[r]))return!1;var c=r.which,d=s.find(":focus:first");if(e.FE.KEYCODE.TAB==c){r.preventDefault();var u=s.children().not(".fr-buttons"),h=u.find("input, textarea, button, select").filter(":visible").not(".fr-no-touch input, .fr-no-touch textarea, .fr-no-touch button, .fr-no-touch select, :disabled").toArray(),p=h.indexOf(this)+(r.shiftKey?-1:1);if(0<=p&&p<h.length)return l.events.disableBlur(),e(h[p]).focus(),r.stopPropagation(),!1;var f=s.find(".fr-buttons");if(f.length&&n(f,!!r.shiftKey))return r.stopPropagation(),!1;if(o(u))return r.stopPropagation(),!1}else{if(e.FE.KEYCODE.ENTER!=c)return e.FE.KEYCODE.ESC==c?(r.preventDefault(),r.stopPropagation(),a(l),l.popups.isVisible(i)&&s.find(".fr-back:visible").length?(l.opts.toolbarInline&&(l.events.disableBlur(),l.events.focus()),l.button.exec(s.find(".fr-back:visible:first")),y(s)):l.popups.isVisible(i)&&s.find(".fr-dismiss:visible").length?l.button.exec(s.find(".fr-dismiss:visible:first")):(l.popups.hide(i),l.opts.toolbarInline&&l.toolbar.showInline(null,!0),y(s)),!1):e.FE.KEYCODE.SPACE==c&&(d.is(".fr-submit")||d.is(".fr-dismiss"))?(r.preventDefault(),r.stopPropagation(),l.events.disableBlur(),l.button.exec(d),!0):l.keys.isBrowserAction(r)?void r.stopPropagation():d.is("input[type=text], textarea")?void r.stopPropagation():e.FE.KEYCODE.SPACE==c&&(d.is(".fr-link-attr")||d.is("input[type=file]"))?void r.stopPropagation():(r.stopPropagation(),r.preventDefault(),!1);var m=null;s.find(".fr-submit:visible").length>0?m=s.find(".fr-submit:visible:first"):s.find(".fr-dismiss:visible").length&&(m=s.find(".fr-dismiss:visible:first")),m&&(r.preventDefault(),r.stopPropagation(),l.events.disableBlur(),l.button.exec(m))}},_tiMouseenter:function(e){w(s.data("instance")||t)}}}function y(e){var t=e.data("popup-button");t&&setTimeout(function(){i(t),e.data("popup-button",null)},0)}function w(e){var i=t.popups.areVisible(e);i&&i.data("popup-button",null)}function x(i){var n=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey;if(i.which==e.FE.KEYCODE.F10&&!n&&!i.shiftKey&&i.altKey){t.shared.with_kb=!0;var s=t.popups.areVisible(t),r=!1;return s&&(r=o(s.children().not(".fr-buttons"))),r||l(),t.shared.with_kb=!1,i.preventDefault(),i.stopPropagation(),!1}return!0}var C=!0;return{_init:function(){t.$wp?t.events.on("keydown",x,!0):t.events.$on(t.$win,"keydown",x,!0),t.events.on("mousedown",function(e){w(t),t.shared.$f_el&&(a(t),e.stopPropagation(),t.events.disableBlur(),t.shared.$f_el=null)},!0),t.events.on("blur",function(e){t.shared.$f_el=null,w(t)},!0)},registerPopup:function(e){var i=t.popups.get(e),n=b(e);v(i.find(".fr-buttons")),t.events.$on(i,"mouseenter","tabIndex",n._tiMouseenter,!0),t.events.$on(i.children().not(".fr-buttons"),"keydown","[tabIndex]",n._tiKeydown,!0),t.popups.onHide(e,function(){a(i.data("instance")||t)}),t.popups.onShow(e,function(){C=!1,setTimeout(function(){C=!0},0)})},registerToolbar:v,focusToolbarElement:i,focusToolbar:n,focusContent:o,focusPopup:function(e){var i=e.children().not(".fr-buttons");i.data("mouseenter-event-set")||(t.events.$on(i,"mouseenter","[tabIndex]",function(n){var s=e.data("instance")||t;if(!C)return n.stopPropagation(),void n.preventDefault();var o=i.find(":focus:first");o.length&&!o.is("input, button")&&(s.events.disableBlur(),o.blur(),s.events.disableBlur(),s.events.focus())}),i.data("mouseenter-event-set",!0)),!o(i)&&t.shared.with_kb&&n(e.find(".fr-buttons"))},focusEditor:m,focusPopupButton:y,focusModalButton:function(e){var t=e.data("modal-button");t&&setTimeout(function(){i(t),e.data("modal-button",null)},0)},hasFocus:function(){return null!=t.shared.$f_el},exec:function(i,n){var s=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,o=i.which,r=!1;return o!=e.FE.KEYCODE.TAB||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ARROW_RIGHT||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.TAB||s||!i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ARROW_LEFT||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ARROW_UP||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ARROW_DOWN||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ENTER||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.ESC||s||i.shiftKey||i.altKey?o!=e.FE.KEYCODE.F10||s||i.shiftKey||!i.altKey||(r=l()):r=g(n):r=f():r=t.shared.$f_el&&t.shared.$f_el.is(".fr-dropdown:not(.fr-active)")?f():p(!0):r=p():r=h(n):r=h(n,!0):r=u(n):r=u(n,!0),t.shared.$f_el||void 0!==r||(r=!0),!r&&t.keys.isBrowserAction(i)&&(r=!0),!!r||(i.preventDefault(),i.stopPropagation(),!1)},saveSelection:r,restoreSelection:a}},e.FE.MODULES.format=function(t){function i(e,t){var i="<"+e;for(var n in t)t.hasOwnProperty(n)&&(i+=" "+n+'="'+t[n]+'"');return i+">"}function n(e,t){var i=e;for(var n in t)t.hasOwnProperty(n)&&(e+="id"==n?"#"+t[n]:"class"==n?"."+t[n]:"["+n+'="'+t[n]+'"]');return i}function s(e,t){return!(!e||e.nodeType!=Node.ELEMENT_NODE)&&(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)}function o(n,s,r){if(n){if(t.node.isBlock(n))return o(n.firstChild,s,r),!1;for(var a=e(i(s,r)).insertBefore(n),l=n;l&&!e(l).is(".fr-marker")&&0==e(l).find(".fr-marker").length;){var c=l;l=l.nextSibling,a.append(c)}if(l)e(l).find(".fr-marker").length&&o(l.firstChild,s,r);else{for(var d=a.get(0).parentNode;d&&!d.nextSibling&&!t.node.isElement(d);)d=d.parentNode;if(d){var u=d.nextSibling;u&&(t.node.isBlock(u)?o(u.firstChild,s,r):o(u,s,r))}}a.is(":empty")&&a.remove()}}function r(r,a){if(void 0===a&&(a={}),a.style&&delete a.style,t.selection.isCollapsed()){t.markers.insert(),t.$el.find(".fr-marker").replaceWith(i(r,a)+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+function(e){return"</"+e+">"}(r)),t.selection.restore()}else{var l;t.selection.save(),o(t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling,r,a);do{(l=t.$el.find(n(r,a)+" > "+n(r,a))).each(function(){e(this).replaceWith(this.innerHTML)})}while(l.length);t.el.normalize();for(var c=t.el.querySelectorAll(".fr-marker"),d=0;d<c.length;d++){var u=e(c[d]);1==u.data("type")?s(u.get(0).nextSibling,n(r,a))&&u.next().prepend(u):s(u.get(0).previousSibling,n(r,a))&&u.prev().append(u)}t.selection.restore()}}function a(e,i,o,r){if(!r){var a=!1;if(!0===e.data("type"))for(;t.node.isFirstSibling(e.get(0))&&!e.parent().is(t.$el);)e.parent().before(e),a=!0;else if(!1===e.data("type"))for(;t.node.isLastSibling(e.get(0))&&!e.parent().is(t.$el);)e.parent().after(e),a=!0;if(a)return!0}if(e.parents(i).length||void 0===i){var l="",c="",d=e.parent();if(d.is(t.$el)||t.node.isBlock(d.get(0)))return!1;for(;void 0===i&&!t.node.isBlock(d.parent().get(0))||void 0!==i&&!s(d.get(0),n(i,o));)l+=t.node.closeTagString(d.get(0)),c=t.node.openTagString(d.get(0))+c,d=d.parent();var u=e.get(0).outerHTML;e.replaceWith('<span id="mark"></span>');var h=d.html().replace(/<span id="mark"><\/span>/,l+t.node.closeTagString(d.get(0))+c+u+l+t.node.openTagString(d.get(0))+c);return d.replaceWith(t.node.openTagString(d.get(0))+h+t.node.closeTagString(d.get(0))),!0}return!1}function l(i,o,r,a){for(var c=t.node.contents(i.get(0)),d=0;d<c.length;d++){var u=c[d];t.node.hasClass(u,"fr-marker")?o=(o+1)%2:o?e(u).find(".fr-marker").length>0?o=l(e(u),o,r,a):(e(e(u).find(r||"*").get().reverse()).each(function(){t.node.isBlock(this)||t.node.isVoid(this)||e(this).replaceWith(this.innerHTML)}),void 0===r&&u.nodeType==Node.ELEMENT_NODE&&!t.node.isVoid(u)&&!t.node.isBlock(u)||s(u,n(r,a))?e(u).replaceWith(u.innerHTML):void 0===r&&u.nodeType==Node.ELEMENT_NODE&&t.node.isBlock(u)&&e(u).removeAttr("style")):e(u).find(".fr-marker").length>0&&(o=l(e(u),o,r,a))}return o}function c(i,n){void 0===n&&(n={}),n.style&&delete n.style;var s=t.selection.isCollapsed();t.selection.save();for(var o=!0;o;){o=!1;for(var r=t.$el.find(".fr-marker"),c=0;c<r.length;c++)if(a(e(r[c]),i,n,s)){o=!0;break}}l(t.$el,0,i,n),s&&t.$el.find(".fr-marker").before(e.FE.INVISIBLE_SPACE).after(e.FE.INVISIBLE_SPACE),t.html.cleanEmptyTags(),t.el.normalize(),t.selection.restore()}function d(t,i){var n=e(t);n.css(i,""),""===n.attr("style")&&n.replaceWith(n.html())}function u(t,i){return 0===e(t).attr("style").indexOf(i+":")||e(t).attr("style").indexOf(";"+i+":")>=0||e(t).attr("style").indexOf("; "+i+":")>=0}function h(i,n){if(t.selection.isCollapsed()){t.markers.insert();var s=(h=t.$el.find(".fr-marker")).parent();if(t.node.openTagString(s.get(0))=='<span style="'+i+": "+s.css(i)+';">')if(t.node.isEmpty(s.get(0)))s.replaceWith('<span style="'+i+": "+n+';">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>");else{var r={};r[i]=n,a(h,"span",r,!0),(h=t.$el.find(".fr-marker")).replaceWith('<span style="'+i+": "+n+';">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>")}else t.node.isEmpty(s.get(0))&&s.is("span")?(h.replaceWith(e.FE.MARKERS),s.css(i,n)):h.replaceWith('<span style="'+i+": "+n+';">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>");t.selection.restore()}else{t.selection.save();for(var l=t.$el.find(".fr-marker"),c=0;c<l.length;c++){var h;if(!0===(h=e(l[c])).data("type"))for(;t.node.isFirstSibling(h.get(0))&&!h.parent().is(t.$el);)h.parent().before(h);else for(;t.node.isLastSibling(h.get(0))&&!h.parent().is(t.$el);)h.parent().after(h)}var p=t.$el.find('.fr-marker[data-type="true"]').get(0).nextSibling,f={class:"fr-unprocessed"};for(n&&(f.style=i+": "+n+";"),o(p,"span",f),t.$el.find(".fr-marker + .fr-unprocessed").each(function(){e(this).prepend(e(this).prev())}),t.$el.find(".fr-unprocessed + .fr-marker").each(function(){e(this).prev().append(this)});t.$el.find("span.fr-unprocessed").length>0;){var m=t.$el.find("span.fr-unprocessed:first").removeClass("fr-unprocessed");if(m.parent().get(0).normalize(),m.parent().is("span")&&1==m.parent().get(0).childNodes.length){m.parent().css(i,n);var g=m;m=m.parent(),g.replaceWith(g.html())}var v=m.find("span");for(c=v.length-1;c>=0;c--)d(v[c],i);var b=m.parentsUntil(t.$el,"span[style]").filter(function(){return u(this,i)});if(b.length){var y="",w="",x="",C="",E=m.get(0);do{E=E.parentNode,e(E).addClass("fr-split"),y+=t.node.closeTagString(E),w=t.node.openTagString(e(E).clone().addClass("fr-split").get(0))+w,b.get(0)!=E&&(x+=t.node.closeTagString(E),C=t.node.openTagString(e(E).clone().addClass("fr-split").get(0))+C)}while(b.get(0)!=E);var T=y+t.node.openTagString(e(b.get(0)).clone().css(i,n||"").get(0))+C+m.css(i,"").get(0).outerHTML+x+"</span>"+w;m.replaceWith('<span id="fr-break"></span>');var k=b.get(0).outerHTML;e(b.get(0)).replaceWith(k.replace(/<span id="fr-break"><\/span>/g,T))}}for(;t.$el.find(".fr-split:empty").length>0;)t.$el.find(".fr-split:empty").remove();t.$el.find(".fr-split").removeClass("fr-split"),t.$el.find('span[style=""]').removeAttr("style"),t.$el.find('span[class=""]').removeAttr("class"),t.html.cleanEmptyTags(),e(t.$el.find("span").get().reverse()).each(function(){this.attributes&&0!=this.attributes.length||e(this).replaceWith(this.innerHTML)}),t.el.normalize();var _=t.$el.find("span[style] + span[style]");for(c=0;c<_.length;c++){var S=e(_[c]),D=e(_[c]).prev();S.get(0).previousSibling==D.get(0)&&t.node.openTagString(S.get(0))==t.node.openTagString(D.get(0))&&(S.prepend(D.html()),D.remove())}t.el.normalize(),t.selection.restore()}}function p(e,i){void 0===i&&(i={}),i.style&&delete i.style;var o=t.selection.ranges(0),r=o.startContainer;r.nodeType==Node.ELEMENT_NODE&&r.childNodes.length>0&&r.childNodes[o.startOffset]&&(r=r.childNodes[o.startOffset]);for(var a=r;a&&a.nodeType==Node.ELEMENT_NODE&&!s(a,n(e,i));)a=a.firstChild;if(a&&a.nodeType==Node.ELEMENT_NODE&&s(a,n(e,i)))return!0;var l=r;for(l&&l.nodeType!=Node.ELEMENT_NODE&&(l=l.parentNode);l&&l.nodeType==Node.ELEMENT_NODE&&l!=t.el&&!s(l,n(e,i));)l=l.parentNode;return!(!l||l.nodeType!=Node.ELEMENT_NODE||l==t.el||!s(l,n(e,i)))}return{is:p,toggle:function(e,t){p(e,t)?c(e,t):r(e,t)},apply:r,remove:c,applyStyle:h,removeStyle:function(e){h(e,null)}}},e.FE.COMMANDS={bold:{title:"Bold",toggle:!0,refresh:function(e){var t=this.format.is("strong");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},italic:{title:"Italic",toggle:!0,refresh:function(e){var t=this.format.is("em");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},underline:{title:"Underline",toggle:!0,refresh:function(e){var t=this.format.is("u");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},strikeThrough:{title:"Strikethrough",toggle:!0,refresh:function(e){var t=this.format.is("s");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},subscript:{title:"Subscript",toggle:!0,refresh:function(e){var t=this.format.is("sub");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},superscript:{title:"Superscript",toggle:!0,refresh:function(e){var t=this.format.is("sup");e.toggleClass("fr-active",t).attr("aria-pressed",t)}},outdent:{title:"Decrease Indent"},indent:{title:"Increase Indent"},undo:{title:"Undo",undo:!1,forcedRefresh:!0,disabled:!0},redo:{title:"Redo",undo:!1,forcedRefresh:!0,disabled:!0},insertHR:{title:"Insert Horizontal Line"},clearFormatting:{title:"Clear Formatting"},selectAll:{title:"Select All",undo:!1}},e.FE.RegisterCommand=function(t,i){e.FE.COMMANDS[t]=i},e.FE.MODULES.commands=function(t){function i(i,n){if(!1!==t.events.trigger("commands.before",e.merge([i],n||[]))){var s=e.FE.COMMANDS[i]&&e.FE.COMMANDS[i].callback||r[i],o=!0,a=!1;e.FE.COMMANDS[i]&&(void 0!==e.FE.COMMANDS[i].focus&&(o=e.FE.COMMANDS[i].focus),void 0!==e.FE.COMMANDS[i].accessibilityFocus&&(a=e.FE.COMMANDS[i].accessibilityFocus)),(!t.core.hasFocus()&&o&&!t.popups.areVisible()||!t.core.hasFocus()&&a&&t.accessibility.hasFocus())&&t.events.focus(!0),e.FE.COMMANDS[i]&&!1!==e.FE.COMMANDS[i].undo&&(t.$el.find(".fr-marker").length&&(t.events.disableBlur(),t.selection.restore()),t.undo.saveStep()),s&&s.apply(t,e.merge([i],n||[])),t.events.trigger("commands.after",e.merge([i],n||[])),e.FE.COMMANDS[i]&&!1!==e.FE.COMMANDS[i].undo&&t.undo.saveStep()}}function n(e,i){t.format.toggle(i)}function s(i){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var n=t.selection.blocks(),s=0;s<n.length;s++)if("LI"!=n[s].tagName&&"LI"!=n[s].parentNode.tagName){var o=e(n[s]),r="rtl"==t.opts.direction||"rtl"==o.css("direction")?"margin-right":"margin-left",a=t.helpers.getPX(o.css(r));o.css(r,Math.max(a+20*i,0)||""),o.removeClass("fr-temp-div")}t.selection.save(),t.html.unwrap(),t.selection.restore()}function o(e){return function(){i(e)}}var r={bold:function(){n(0,"strong")},subscript:function(){n(0,"sub")},superscript:function(){n(0,"sup")},italic:function(){n(0,"em")},strikeThrough:function(){n(0,"s")},underline:function(){n(0,"u")},undo:function(){t.undo.run()},redo:function(){t.undo.redo()},indent:function(){s(1)},outdent:function(){s(-1)},show:function(){t.opts.toolbarInline&&t.toolbar.showInline(null,!0)},insertHR:function(){t.selection.remove();var e="";t.core.isEmpty()&&(e="<br>",t.html.defaultTag()&&(e="<"+t.html.defaultTag()+">"+e+"</"+t.html.defaultTag()+">")),t.html.insert('<hr id="fr-just">'+e);var i=t.$el.find("hr#fr-just");i.removeAttr("id"),t.selection.setAfter(i.get(0),!1)||t.selection.setBefore(i.get(0),!1),t.selection.restore()},clearFormatting:function(){t.format.remove()},selectAll:function(){t.doc.execCommand("selectAll",!1,!1)}},a={};for(var l in r)r.hasOwnProperty(l)&&(a[l]=o(l));return e.extend(a,{exec:i,_init:function(){t.events.on("keydown",function(e){var i=t.selection.element();if(i&&"HR"==i.tagName&&!t.keys.isArrow(e.which))return e.preventDefault(),!1}),t.events.on("keyup",function(i){var n=t.selection.element();if(n&&"HR"==n.tagName)if(i.which==e.FE.KEYCODE.ARROW_LEFT||i.which==e.FE.KEYCODE.ARROW_UP){if(n.previousSibling)return t.node.isBlock(n.previousSibling)?t.selection.setAtEnd(n.previousSibling):e(n).before(e.FE.MARKERS),t.selection.restore(),!1}else if((i.which==e.FE.KEYCODE.ARROW_RIGHT||i.which==e.FE.KEYCODE.ARROW_DOWN)&&n.nextSibling)return t.node.isBlock(n.nextSibling)?t.selection.setAtStart(n.nextSibling):e(n).after(e.FE.MARKERS),t.selection.restore(),!1}),t.events.on("mousedown",function(e){if(e.target&&"HR"==e.target.tagName)return e.preventDefault(),e.stopPropagation(),!1}),t.events.on("mouseup",function(i){var n=t.selection.element();n==t.selection.endElement()&&n&&"HR"==n.tagName&&(n.nextSibling&&(t.node.isBlock(n.nextSibling)?t.selection.setAtStart(n.nextSibling):e(n).after(e.FE.MARKERS)),t.selection.restore())})}})},e.FE.MODULES.data=function(e){function t(e){return e}function i(e){for(var t=e.toString(),i=0,n=0;n<t.length;n++)i+=parseInt(t.charAt(n),10);return i>10?i%9+1:i}function n(e,t,i){for(var n=Math.abs(i);n-- >0;)e-=t;return i<0&&(e+=123),e}function s(e){return!(!e||"none"!=e.css("display")||(e.remove(),0))}function o(){return!!e.$box&&(e.$box.append(d(t(d("")))),r=e.$box.find("> div:last"),a=r.find("> a"),void("rtl"==e.opts.direction&&r.css("left","auto").css("right",0)))}var r,a,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=function(){for(var e=0,t=document.domain,i=t.split("."),n="_gd"+(new Date).getTime();e<i.length-1&&-1==document.cookie.indexOf(n+"="+n);)t=i.slice(-1-++e).join("."),document.cookie=n+"="+n+";domain="+t+";";return document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+t+";",(t||"").replace(/(^\.*)|(\.*$)/g,"")}(),d=t(function(e){if(!e)return e;for(var s="",o=t("charCodeAt"),r=t("fromCharCode"),a=l.indexOf(e[0]),c=1;c<e.length-2;c++){for(var d=i(++a),u=e[o](c),h="";/[0-9-]/.test(e[c+1]);)h+=e[++c];u=n(u,d,h=parseInt(h,10)||0),u^=a-1&31,s+=String[r](u)}return s});return{_init:function(){var i=e.opts.key||[""];"string"==typeof i&&(i=[i]),e.ul=!0;for(var n=0;n<i.length;n++){var l=d(i[n])||"";if(!(l!==d(t(d("mcVRDoB1BGILD7YFe1BTXBA7B6==")))&&l.indexOf(c,l.length-c.length)<0&&[d("9qqG-7amjlwq=="),d("KA3B3C2A6D1D5H5H1A3=="),d("QzbzvxyB2yA-9m=="),d("naamngiA3dA-16xtE-11C-9B1H-8sc==")].indexOf(c)<0)){e.ul=!1;break}}!0===e.ul&&o(),e.events.on("contentChanged",function(){!0===e.ul&&(s(r)||s(a))&&o()}),e.events.on("destroy",function(){r&&r.length&&r.remove()},!0)}}},e.extend(e.FE.DEFAULTS,{pastePlain:!1,pasteDeniedTags:["colgroup","col"],pasteDeniedAttrs:["class","id","style"],pasteAllowLocalImages:!1}),e.FE.MODULES.paste=function(t){function i(i){e.FE.copied_html=t.html.getSelected(),e.FE.copied_text=e("<div>").html(e.FE.copied_html).text(),"cut"==i.type&&(t.undo.saveStep(),setTimeout(function(){t.selection.save(),t.html.wrap(),t.selection.restore(),t.events.focus(),t.undo.saveStep()},0))}function n(e){if(c)return!1;if(e.originalEvent&&(e=e.originalEvent),!1===t.events.trigger("paste.before",[e]))return e.preventDefault(),!1;if(t.$win.scrollTop(),e&&e.clipboardData&&e.clipboardData.getData){var i="",n=e.clipboardData.types;if(t.helpers.isArray(n))for(var r=0;r<n.length;r++)i+=n[r]+";";else i=n;if(a="",/text\/html/.test(i)?a=e.clipboardData.getData("text/html"):/text\/rtf/.test(i)&&t.browser.safari?a=e.clipboardData.getData("text/rtf"):/text\/plain/.test(i)&&!this.browser.mozilla&&(a=t.html.escapeEntities(e.clipboardData.getData("text/plain")).replace(/\n/g,"<br>")),""!==a)return o(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1;a=null}s()}function s(){t.selection.save(),t.events.disableBlur(),a=null,l?l.html(""):(l=e('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; word-break: break-all; overflow:hidden; z-index: 9999; line-height: 140%;" tabIndex="-1"></div>'),t.$box.after(l),t.events.on("destroy",function(){l.remove()})),l.focus(),t.win.setTimeout(o,1)}function o(){t.keys.forceUndo();var i=t.snapshot.get();null===a&&(a=l.get(0).innerHTML,t.selection.restore(),t.events.enableBlur());var n=t.events.chainTrigger("paste.beforeCleanup",a);"string"==typeof n&&(a=n);var s=!1;a.match(/(class=\"?Mso|class=\'?Mso|style=\"[^\"]*\bmso\-|style=\'[^\']*\bmso\-|w:WordDocument)/gi)&&(s=!0),a.indexOf("<body")>=0&&(a=a.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1"));var o=!1;if(a.indexOf('id="docs-internal-guid')>=0&&(a=a.replace(/^.* id="docs-internal-guid[^>]*>(.*)<\/b>.*$/,"$1"),o=!0),s)0===(a=a.replace(/^\n*/g,"").replace(/^ /g,"")).indexOf("<colgroup>")&&(a="<table>"+a+"</table>"),a=function(e){e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3</li></ul>")).replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3</li></ol>")).replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5</li>")).replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5</li>")).replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>")).replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>")).replace(/<p(.*?)class="?'?MsoListBullet"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>")).replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ul>")).replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ol>")).replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span")).replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,"")).replace(/<!\[if \!supportLists\]>([\s\S]*?)<!\[endif\]>/gi,"")).replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," ")).replace(/<!--[\s\S]*?-->/gi,"")).replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var i=["style","script","applet","embed","noframes","noscript"],n=0;n<i.length;n++){var s=new RegExp("<"+i[n]+".*?"+i[n]+"(.*?)>","gi");e=e.replace(s,"")}var o;e=(e=(e=e.replace(/&nbsp;/gi," ")).replace(/<td([^>]*)><\/td>/g,"<td$1><br></td>")).replace(/<th([^>]*)><\/th>/g,"<th$1><br></th>");do{o=e,e=e.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")}while(e!=o);e=(e=e.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>')).replace(/<lilevel1([^>]*)>/gi,"<li$1>"),e=(e=(e=t.clean.html(e,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs)).replace(/<a>(.[^<]+)<\/a>/gi,"$1")).replace(/<br> */g,"<br>");var r=t.doc.createElement("div");r.innerHTML=e;var a=r.querySelectorAll("li[data-indent]");for(n=0;n<a.length;n++){var l=a[n],c=l.previousElementSibling;if(c&&"LI"==c.tagName){var d=c.querySelector(":scope > ul, :scope > ol");d||(d=document.createElement("ul"),c.appendChild(d)),d.appendChild(l)}else l.removeAttribute("data-indent")}return t.html.cleanBlankSpaces(r),r.innerHTML}(a),a=r(a);else{t.opts.htmlAllowComments=!1,a=t.clean.html(a,t.opts.pasteDeniedTags,t.opts.pasteDeniedAttrs),t.opts.htmlAllowComments=!0,a=(a=r(a)).replace(/\r|\n|\t/g,"");var c=t.doc.createElement("div");c.innerHTML=a,e.FE.copied_text&&c.textContent.replace(/(\u00A0)/gi," ").replace(/\r|\n/gi,"")==e.FE.copied_text.replace(/(\u00A0)/gi," ").replace(/\r|\n/gi,"")&&(a=e.FE.copied_html),a=a.replace(/^ */g,"").replace(/ *$/g,"")}if(t.opts.pastePlain&&(a=function(e){var i=t.doc.createElement("div");i.innerHTML=e;for(var n=i.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote"),s=0;s<n.length;s++)(o=n[s]).outerHTML="<"+(t.html.defaultTag()||"DIV")+">"+o.innerHTML+"</"+(t.html.defaultTag()||"DIV")+">";for(s=(n=i.querySelectorAll("*:not("+"p, div, h1, h2, h3, h4, h5, h6, pre, blockquote, ul, ol, li, table, tbody, thead, tr, td, br, img".split(",").join("):not(")+")")).length-1;s>=0;s--){var o;(o=n[s]).outerHTML=o.innerHTML}var r=function(e){for(var i=t.node.contents(e),n=0;n<i.length;n++)i[n].nodeType!=Node.TEXT_NODE&&i[n].nodeType!=Node.ELEMENT_NODE?i[n].parentNode.removeChild(i[n]):r(i[n])};return r(i),i.innerHTML}(a)),"string"==typeof(n=t.events.chainTrigger("paste.afterCleanup",a))&&(a=n),""!==a){var d=t.o_doc.createElement("div");d.innerHTML=a,t.spaces.normalize(d);for(var u=d.getElementsByTagName("span"),h=0;h<u.length;h++){var p=u[h];0===p.attributes.length&&(p.outerHTML=p.innerHTML)}var f=d.children;if(1==f.length&&["OL","UL"].indexOf(f[0].tagName)&&(f[0].outerHTML=f[0].innerHTML),!o){var m=d.getElementsByTagName("br");for(h=0;h<m.length;h++){var g=m[h];t.node.isBlock(g.previousSibling)&&g.parentNode.removeChild(g)}}if(t.opts.enter==e.FE.ENTER_BR){var v=d.querySelectorAll("p, div");for(h=0;h<v.length;h++){(b=v[h]).outerHTML=b.innerHTML+(b.nextSibling&&!t.node.isEmpty(b)?"<br>":"")}}else if(t.opts.enter==e.FE.ENTER_DIV)for(v=d.getElementsByTagName("p"),h=0;h<v.length;h++){var b;(b=v[h]).outerHTML="<div>"+b.innerHTML+"</div>"}a=d.innerHTML,t.html.insert(a,!0)}t.events.trigger("paste.after"),t.undo.saveStep(i),t.undo.saveStep()}function r(e){var i=t.doc.createElement("div");i.innerHTML=e;for(var n=i.querySelectorAll("*:empty:not(br):not(img):not(td):not(th)");n.length;){for(var s=0;s<n.length;s++)n[s].parentNode.removeChild(n[s]);n=i.querySelectorAll("*:empty:not(br):not(img):not(td):not(th)")}for(var o=i.querySelectorAll(":scope > div:not([style]), td > div, th > div, li > div");o.length;){var r=o[o.length-1];if(t.html.defaultTag()&&"div"!=t.html.defaultTag())r.outerHTML="<"+t.html.defaultTag()+">"+r.innerHTML+"</"+t.html.defaultTag()+">";else{var a=r.querySelector("*:last");a&&"BR"==a.tagName?r.outerHTML=r.innerHTML:r.outerHTML=r.innerHTML+"<br>"}o=i.querySelectorAll(":scope > div:not([style]), td > div, th > div, li > div")}for(o=i.querySelectorAll("div:not([style])");o.length;){for(s=0;s<o.length;s++){var l=o[s],c=l.innerHTML.replace(/\u0009/gi,"").trim();l.outerHTML=c}o=i.querySelectorAll("div:not([style])")}return i.innerHTML}var a,l,c=!1;return{_init:function(){t.events.on("copy",i),t.events.on("cut",i),t.events.on("paste",n),t.browser.msie&&t.browser.version<11&&(t.events.on("mouseup",function(e){2==e.button&&(setTimeout(function(){c=!1},50),c=!0)},!0),t.events.on("beforepaste",n))}}},e.extend(e.FE.DEFAULTS,{shortcutsEnabled:["show","bold","italic","underline","strikeThrough","indent","outdent","undo","redo"],shortcutsHint:!0}),e.FE.SHORTCUTS_MAP={},e.FE.RegisterShortcut=function(t,i,n,s,o,r){e.FE.SHORTCUTS_MAP[(o?"^":"")+(r?"@":"")+t]={cmd:i,val:n,letter:s,shift:o,option:r},e.FE.DEFAULTS.shortcutsEnabled.push(i)},e.FE.RegisterShortcut(e.FE.KEYCODE.E,"show",null,"E",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.B,"bold",null,"B",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.I,"italic",null,"I",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.U,"underline",null,"U",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.S,"strikeThrough",null,"S",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.CLOSE_SQUARE_BRACKET,"indent",null,"]",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.OPEN_SQUARE_BRACKET,"outdent",null,"[",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.Z,"undo",null,"Z",!1,!1),e.FE.RegisterShortcut(e.FE.KEYCODE.Z,"redo",null,"Z",!0,!1),e.FE.MODULES.shortcuts=function(t){function i(i){if(!t.core.hasFocus())return!0;var n=i.which,o=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey;if("keyup"==i.type&&s&&n!=e.FE.KEYCODE.META)return s=!1,!1;"keydown"==i.type&&(s=!1);var r=(i.shiftKey?"^":"")+(i.altKey?"@":"")+n;if(o&&e.FE.SHORTCUTS_MAP[r]){var a=e.FE.SHORTCUTS_MAP[r].cmd;if(a&&t.opts.shortcutsEnabled.indexOf(a)>=0){var l,c=e.FE.SHORTCUTS_MAP[r].val;if(a&&!c?l=t.$tb.find('.fr-command[data-cmd="'+a+'"]'):a&&c&&(l=t.$tb.find('.fr-command[data-cmd="'+a+'"][data-param1="'+c+'"]')),l.length)return i.preventDefault(),i.stopPropagation(),l.parents(".fr-toolbar").data("instance",t),"keydown"==i.type&&(t.button.exec(l),s=!0),!1;if(a&&t.commands[a])return i.preventDefault(),i.stopPropagation(),"keydown"==i.type&&(t.commands[a](),s=!0),!1}}}var n=null,s=!1;return{_init:function(){t.events.on("keydown",i,!0),t.events.on("keyup",i,!0)},get:function(i){if(!t.opts.shortcutsHint)return null;if(!n)for(var s in n={},e.FE.SHORTCUTS_MAP)e.FE.SHORTCUTS_MAP.hasOwnProperty(s)&&t.opts.shortcutsEnabled.indexOf(e.FE.SHORTCUTS_MAP[s].cmd)>=0&&(n[e.FE.SHORTCUTS_MAP[s].cmd+"."+(e.FE.SHORTCUTS_MAP[s].val||"")]={shift:e.FE.SHORTCUTS_MAP[s].shift,option:e.FE.SHORTCUTS_MAP[s].option,letter:e.FE.SHORTCUTS_MAP[s].letter});var o=n[i];return o?(t.helpers.isMac()?String.fromCharCode(8984):"Ctrl+")+(o.shift?t.helpers.isMac()?String.fromCharCode(8679):"Shift+":"")+(o.option?t.helpers.isMac()?String.fromCharCode(8997):"Alt+":"")+o.letter:null}}},e.FE.MODULES.snapshot=function(e){function t(e){for(var t=e.parentNode.childNodes,i=0,n=null,s=0;s<t.length;s++){if(n){var o=t[s].nodeType===Node.TEXT_NODE&&""===t[s].textContent,r=n.nodeType===Node.TEXT_NODE&&t[s].nodeType===Node.TEXT_NODE;o||r||i++}if(t[s]==e)return i;n=t[s]}}function i(i){var n=[];if(!i.parentNode)return[];for(;!e.node.isElement(i);)n.push(t(i)),i=i.parentNode;return n.reverse()}function n(e,t){for(;e&&e.nodeType===Node.TEXT_NODE;){var i=e.previousSibling;i&&i.nodeType==Node.TEXT_NODE&&(t+=i.textContent.length),e=i}return t}function s(e){return{scLoc:i(e.startContainer),scOffset:n(e.startContainer,e.startOffset),ecLoc:i(e.endContainer),ecOffset:n(e.endContainer,e.endOffset)}}function o(t){for(var i=e.el,n=0;n<t.length;n++)i=i.childNodes[t[n]];return i}function r(t,i){try{var n=o(i.scLoc),s=i.scOffset,r=o(i.ecLoc),a=i.ecOffset,l=e.doc.createRange();l.setStart(n,s),l.setEnd(r,a),t.addRange(l)}catch(e){}}return{get:function(){var t={};if(e.events.trigger("snapshot.before"),t.html=(e.$wp?e.$el.html():e.$oel.get(0).outerHTML).replace(/ style=""/g,""),t.ranges=[],e.$wp&&e.selection.inEditor()&&e.core.hasFocus())for(var i=e.selection.ranges(),n=0;n<i.length;n++)t.ranges.push(s(i[n]));return e.events.trigger("snapshot.after"),t},restore:function(t){e.$el.html()!=t.html&&e.$el.html(t.html);var i=e.selection.get();e.selection.clear(),e.events.focus(!0);for(var n=0;n<t.ranges.length;n++)r(i,t.ranges[n])},equal:function(t,i){return t.html==i.html&&(!e.core.hasFocus()||JSON.stringify(t.ranges)==JSON.stringify(i.ranges))}}},e.FE.MODULES.undo=function(e){function t(t){var i=t.which;e.keys.ctrlKey(t)&&(90==i&&t.shiftKey&&t.preventDefault(),90==i&&t.preventDefault())}function i(){if(!e.undo_stack||e.undoing)return!1;for(;e.undo_stack.length>e.undo_index;)e.undo_stack.pop()}function n(){e.undo_index=0,e.undo_stack=[]}function s(){e.undo_stack=[]}var o=null;return{_init:function(){n(),e.events.on("initialized",function(){o=(e.$wp?e.$el.html():e.$oel.get(0).outerHTML).replace(/ style=""/g,"")}),e.events.on("blur",function(){e.el.querySelector(".fr-dragging")||e.undo.saveStep()}),e.events.on("keydown",t),e.events.on("destroy",s)},run:function(){if(e.undo_index>1){e.undoing=!0;var t=e.undo_stack[--e.undo_index-1];clearTimeout(e._content_changed_timer),e.snapshot.restore(t),o=t.html,e.popups.hideAll(),e.toolbar.enable(),e.events.trigger("contentChanged"),e.events.trigger("commands.undo"),e.undoing=!1}},redo:function(){if(e.undo_index<e.undo_stack.length){e.undoing=!0;var t=e.undo_stack[e.undo_index++];clearTimeout(e._content_changed_timer),e.snapshot.restore(t),o=t.html,e.popups.hideAll(),e.toolbar.enable(),e.events.trigger("contentChanged"),e.events.trigger("commands.redo"),e.undoing=!1}},canDo:function(){return!(0===e.undo_stack.length||e.undo_index<=1)},canRedo:function(){return e.undo_index!=e.undo_stack.length},dropRedo:i,reset:n,saveStep:function(t){return!(!e.undo_stack||e.undoing||e.el.querySelector(".fr-marker"))&&void(void 0===t?(t=e.snapshot.get(),e.undo_stack[e.undo_index-1]&&e.snapshot.equal(e.undo_stack[e.undo_index-1],t)||(i(),e.undo_stack.push(t),e.undo_index++,t.html!=o&&(e.events.trigger("contentChanged"),o=t.html))):(i(),e.undo_index>0?e.undo_stack[e.undo_index-1]=t:(e.undo_stack.push(t),e.undo_index++)))}}},e.FE.ICON_DEFAULT_TEMPLATE="font_awesome",e.FE.ICON_TEMPLATES={font_awesome:'<i class="fa fa-[NAME]" aria-hidden="true"></i>',text:'<span style="text-align: center;">[NAME]</span>',image:"<img src=[SRC] alt=[ALT] />",svg:'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">[PATH]</svg>'},e.FE.ICONS={bold:{NAME:"bold"},italic:{NAME:"italic"},underline:{NAME:"underline"},strikeThrough:{NAME:"strikethrough"},subscript:{NAME:"subscript"},superscript:{NAME:"superscript"},color:{NAME:"tint"},outdent:{NAME:"outdent"},indent:{NAME:"indent"},undo:{NAME:"rotate-left"},redo:{NAME:"rotate-right"},insertHR:{NAME:"minus"},clearFormatting:{NAME:"eraser"},selectAll:{NAME:"mouse-pointer"}},e.FE.DefineIconTemplate=function(t,i){e.FE.ICON_TEMPLATES[t]=i},e.FE.DefineIcon=function(t,i){e.FE.ICONS[t]=i},e.FE.MODULES.icon=function(t){return{create:function(t){var i=null,n=e.FE.ICONS[t];if(void 0!==n){var s=n.template||e.FE.ICON_DEFAULT_TEMPLATE;s&&(s=e.FE.ICON_TEMPLATES[s])&&(i=s.replace(/\[([a-zA-Z]*)\]/g,function(e,i){return"NAME"==i?n[i]||t:n[i]}))}return i||t},getTemplate:function(t){var i=e.FE.ICONS[t],n=e.FE.ICON_DEFAULT_TEMPLATE;return void 0!==i?n=i.template||e.FE.ICON_DEFAULT_TEMPLATE:n}}},e.extend(e.FE.DEFAULTS,{tooltips:!0}),e.FE.MODULES.tooltip=function(t){function i(){t.$tooltip&&t.$tooltip.removeClass("fr-visible").css("left","-3000px").css("position","fixed")}function n(i,n){if(i.data("title")||i.data("title",i.attr("title")),!i.data("title"))return!1;t.$tooltip||t.opts.tooltips&&!t.helpers.isMobile()&&(t.shared.$tooltip?t.$tooltip=t.shared.$tooltip:(t.shared.$tooltip=e('<div class="fr-tooltip"></div>'),t.$tooltip=t.shared.$tooltip,t.opts.theme&&t.$tooltip.addClass(t.opts.theme+"-theme"),e(t.o_doc).find("body").append(t.$tooltip)),t.events.on("shared.destroy",function(){t.$tooltip.html("").removeData().remove(),t.$tooltip=null},!0)),i.removeAttr("title"),t.$tooltip.text(i.data("title")),t.$tooltip.addClass("fr-visible");var s=i.offset().left+(i.outerWidth()-t.$tooltip.outerWidth())/2;s<0&&(s=0),s+t.$tooltip.outerWidth()>e(t.o_win).width()&&(s=e(t.o_win).width()-t.$tooltip.outerWidth()),void 0===n&&(n=t.opts.toolbarBottom);var o=n?i.offset().top-t.$tooltip.height():i.offset().top+i.outerHeight();t.$tooltip.css("position",""),t.$tooltip.css("left",s),t.$tooltip.css("top",Math.ceil(o)),"static"!=e(t.o_doc).find("body").css("position")?(t.$tooltip.css("margin-left",-e(t.o_doc).find("body").offset().left),t.$tooltip.css("margin-top",-e(t.o_doc).find("body").offset().top)):(t.$tooltip.css("margin-left",""),t.$tooltip.css("margin-top",""))}return{hide:i,to:n,bind:function(s,o,r){t.opts.tooltips&&!t.helpers.isMobile()&&(t.events.$on(s,"mouseenter",o,function(i){t.node.hasClass(i.currentTarget,"fr-disabled")||t.edit.isDisabled()||n(e(i.currentTarget),r)},!0),t.events.$on(s,"mouseleave "+t._mousedown+" "+t._mouseup,o,function(e){i()},!0))}}},e.FE.MODULES.button=function(t){function i(t){t.addClass("fr-blink"),setTimeout(function(){t.removeClass("fr-blink")},500);for(var i=t.data("cmd"),n=[];void 0!==t.data("param"+(n.length+1));)n.push(t.data("param"+(n.length+1)));var s=e(".fr-dropdown.fr-active");s.length&&(s.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0),s.parent(".fr-toolbar:not(.fr-inline)").css("zIndex","")),t.parents(".fr-popup, .fr-toolbar").data("instance").commands.exec(i,n)}function n(e){i(e)}function s(i){var s=i.parents(".fr-popup, .fr-toolbar").data("instance");if(0!=i.parents(".fr-popup").length||i.data("popup")||s.popups.hideAll(),s.popups.areVisible()&&!s.popups.areVisible(s)){for(var o=0;o<e.FE.INSTANCES.length;o++)e.FE.INSTANCES[o]!=s&&e.FE.INSTANCES[o].popups&&e.FE.INSTANCES[o].popups.areVisible()&&e.FE.INSTANCES[o].$el.find(".fr-marker").remove();s.popups.hideAll()}t.node.hasClass(i.get(0),"fr-dropdown")?function(i){var n=i.next(),s=t.node.hasClass(i.get(0),"fr-active"),o=(t.helpers.isMobile(),e(".fr-dropdown.fr-active").not(i)),r=i.parents(".fr-toolbar, .fr-popup").data("instance")||t;if(r.helpers.isIOS()&&!r.el.querySelector(".fr-marker")&&(r.selection.save(),r.selection.clear(),r.selection.restore()),!s){var a=i.data("cmd");n.find(".fr-command").removeClass("fr-active").attr("aria-selected",!1),e.FE.COMMANDS[a]&&e.FE.COMMANDS[a].refreshOnShow&&e.FE.COMMANDS[a].refreshOnShow.apply(r,[i,n]),n.css("left",i.offset().left-i.parent().offset().left-("rtl"==t.opts.direction?n.width()-i.outerWidth():0)),t.opts.toolbarBottom?n.css("bottom",t.$tb.height()-i.position().top):n.css("top",i.position().top+i.outerHeight())}i.addClass("fr-blink").toggleClass("fr-active"),i.hasClass("fr-active")?(n.attr("aria-hidden",!1),i.attr("aria-expanded",!0)):(n.attr("aria-hidden",!0),i.attr("aria-expanded",!1)),setTimeout(function(){i.removeClass("fr-blink")},300),n.offset().left+n.outerWidth()>e(t.opts.scrollableContainer).offset().left+e(t.opts.scrollableContainer).outerWidth()&&n.css("margin-left",-(n.offset().left+n.outerWidth()-e(t.opts.scrollableContainer).offset().left-e(t.opts.scrollableContainer).outerWidth())),o.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0),o.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""),0!=i.parents(".fr-popup").length||t.opts.toolbarInline||(t.node.hasClass(i.get(0),"fr-active")?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):t.$tb.css("zIndex",""));var l=n.find("a.fr-command.fr-active");l.length?t.accessibility.focusToolbarElement(l):t.accessibility.focusToolbarElement(i)}(i):(n(i),e.FE.COMMANDS[i.data("cmd")]&&0!=e.FE.COMMANDS[i.data("cmd")].refreshAfterCallback&&s.button.bulkRefresh())}function o(t){s(e(t.currentTarget))}function r(e){e.preventDefault(),e.stopPropagation()}function a(e){if(e.stopPropagation(),!t.helpers.isMobile())return!1}function l(e,i,n){if(t.helpers.isMobile()&&!1===i.showOnMobile)return"";var s,o=i.displaySelection;if("function"==typeof o&&(o=o(t)),o){var r="function"==typeof i.defaultSelection?i.defaultSelection(t):i.defaultSelection;s='<span style="width:'+(i.displaySelectionWidth||100)+'px">'+(r||t.language.translate(i.title))+"</span>"}else s=t.icon.create(i.icon||e),s+='<span class="fr-sr-only">'+(t.language.translate(i.title)||"")+"</span>";var a=i.popup?' data-popup="true"':"",l=i.modal?' data-modal="true"':"",c=t.shortcuts.get(e+".");c=c?" ("+c+")":"";var d=e+"-"+t.id,u='<button id="'+d+'"type="button" tabIndex="-1" role="button"'+(i.toggle?' aria-pressed="false"':"")+("dropdown"==i.type?' aria-controls="drop" aria-expanded="false" aria-haspopup="true"':"")+(i.disabled?' aria-disabled="true"':"")+' title="'+(t.language.translate(i.title)||"")+c+'" class="fr-command fr-btn'+("dropdown"==i.type?" fr-dropdown":"")+" fr-btn-"+t.icon.getTemplate(i.icon)+(i.displaySelection?" fr-selection":"")+(i.back?" fr-back":"")+(i.disabled?" fr-disabled":"")+(n?"":" fr-hidden")+'" data-cmd="'+e+'"'+a+l+">"+s+"</button>";if("dropdown"==i.type){var h='<div class="fr-dropdown-menu" role="listbox" aria-labelledby="'+d+'" aria-hidden="true"><div class="fr-dropdown-wrapper" role="presentation"><div class="fr-dropdown-content" role="presentation">';h+=function(e,i){var n="";if(i.html)n+="function"==typeof i.html?i.html.call(t):i.html;else{var s=i.options;for(var o in"function"==typeof s&&(s=s()),n+='<ul class="fr-dropdown-list" role="presentation">',s)if(s.hasOwnProperty(o)){var r=t.shortcuts.get(e+"."+o);r=r?'<span class="fr-shortcut">'+r+"</span>":"",n+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="'+e+'" data-param1="'+o+'" title="'+s[o]+'">'+t.language.translate(s[o])+"</a></li>"}n+="</ul>"}return n}(e,i),u+=h+="</div></div></div>"}return u}function c(i){var n=t.$tb&&t.$tb.data("instance")||t;return 0==t.events.trigger("buttons.refresh")||void setTimeout(function(){for(var s=n.selection.inEditor()&&n.core.hasFocus(),o=0;o<i.length;o++){var r=e(i[o]),a=r.data("cmd");0==r.parents(".fr-popup").length?s||e.FE.COMMANDS[a]&&e.FE.COMMANDS[a].forcedRefresh?n.button.refresh(r):t.node.hasClass(r.get(0),"fr-dropdown")||(r.removeClass("fr-active"),r.attr("aria-pressed")&&r.attr("aria-pressed",!1)):r.parents(".fr-popup").is(":visible")&&n.button.refresh(r)}},0)}function d(){c(h),c(p)}function u(){h=[],p=[]}var h=[];(t.opts.toolbarInline||t.opts.toolbarContainer)&&(t.shared.buttons||(t.shared.buttons=[]),h=t.shared.buttons);var p=[];return t.shared.popup_buttons||(t.shared.popup_buttons=[]),p=t.shared.popup_buttons,{_init:function(){t.opts.toolbarInline?t.events.on("toolbar.show",d):(t.events.on("mouseup",d),t.events.on("keyup",d),t.events.on("blur",d),t.events.on("focus",d),t.events.on("contentChanged",d)),t.events.on("shared.destroy",u)},buildList:function(i,n){for(var s="",o=0;o<i.length;o++){var r=i[o],a=e.FE.COMMANDS[r];a&&void 0!==a.plugin&&t.opts.pluginsEnabled.indexOf(a.plugin)<0||(a?s+=l(r,a,void 0===n||n.indexOf(r)>=0):"|"==r?s+='<div class="fr-separator fr-vs" role="separator" aria-orientation="vertical"></div>':"-"==r&&(s+='<div class="fr-separator fr-hs" role="separator" aria-orientation="horizontal"></div>'))}return s},bindCommands:function(i,n){t.events.bindClick(i,".fr-command:not(.fr-disabled)",o),t.events.$on(i,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu",r,!0),t.events.$on(i,t._mousedown+" "+t._mouseup+" "+t._move,".fr-dropdown-menu .fr-dropdown-wrapper",a,!0);var s=i.get(0).ownerDocument,l="defaultView"in s?s.defaultView:s.parentWindow,c=function(n){(!n||n.type==t._mouseup&&n.target!=e("html").get(0)||"keydown"==n.type&&(t.keys.isCharacter(n.which)&&!t.keys.ctrlKey(n)||n.which==e.FE.KEYCODE.ESC))&&function(e){var t=e.find(".fr-dropdown.fr-active");t.length&&(t.removeClass("fr-active").attr("aria-expanded",!1).next().attr("aria-hidden",!0),t.parent(".fr-toolbar:not(.fr-inline)").css("zIndex",""))}(i)};t.events.$on(e(l),t._mouseup+" resize keydown",c,!0),t.opts.iframe&&t.events.$on(t.$win,t._mouseup,c,!0),t.node.hasClass(i.get(0),"fr-popup")?e.merge(p,i.find(".fr-btn").toArray()):e.merge(h,i.find(".fr-btn").toArray()),t.tooltip.bind(i,".fr-btn, .fr-title",n)},refresh:function(i){var n,s=i.parents(".fr-popup, .fr-toolbar").data("instance")||t,o=i.data("cmd");t.node.hasClass(i.get(0),"fr-dropdown")?n=i.next():(i.removeClass("fr-active"),i.attr("aria-pressed")&&i.attr("aria-pressed",!1)),e.FE.COMMANDS[o]&&e.FE.COMMANDS[o].refresh?e.FE.COMMANDS[o].refresh.apply(s,[i,n]):t.refresh[o]&&s.refresh[o](i,n)},bulkRefresh:d,exec:i,click:s}},e.FE.MODULES.modals=function(t){function i(){for(var e in r){var t=r[e];t&&t.$modal&&t.$modal.removeData().remove()}o&&o.removeData().remove(),r={}}function n(e){if(r[e]){var i=r[e].$modal,n=i.data("instance")||t;n.events.enableBlur(),i.hide(),o.hide(),n.$doc.find("body").removeClass("prevent-scroll fr-mobile"),i.removeClass("fr-active"),t.accessibility.restoreSelection(n)}}function s(e){var i;if("string"==typeof e){if(!r[e])return;i=r[e].$modal}else i=e;return i&&t.node.hasClass(i,"fr-active")&&t.core.sameInstance(i)||!1}t.shared.modals||(t.shared.modals={});var o,r=t.shared.modals;return{_init:function(){t.events.on("shared.destroy",i,!0)},get:function(e){return r[e]},create:function(i,s,a){if(t.shared.$overlay||(t.shared.$overlay=e('<div class="fr-overlay">').appendTo("body")),o=t.shared.$overlay,t.opts.theme&&o.addClass(t.opts.theme+"-theme"),!r[i]){var l=function(i,n){var s='<div tabIndex="-1" class="fr-modal'+(t.opts.theme?" "+t.opts.theme+"-theme":"")+'"><div class="fr-modal-wrapper">';return s+='<div class="fr-modal-head">'+i+'<i title="'+t.language.translate("Cancel")+'" class="fa fa-times fr-modal-close"></i></div>',s+='<div tabIndex="-1" class="fr-modal-body">'+n+"</div>",e(s+="</div></div>")}(s,a);r[i]={$modal:l,$head:l.find(".fr-modal-head"),$body:l.find(".fr-modal-body")},t.helpers.isMobile()||l.addClass("fr-desktop"),l.appendTo("body"),t.events.bindClick(l,"i.fr-modal-close",function(){n(i)}),r[i].$body.css("margin-top",r[i].$head.outerHeight()),t.events.$on(l,"keydown",function(s){var o=s.which;return o==e.FE.KEYCODE.ESC?(n(i),t.accessibility.focusModalButton(l),!1):!(!e(s.currentTarget).is("input[type=text], textarea")&&o!=e.FE.KEYCODE.ARROW_UP&&o!=e.FE.KEYCODE.ARROW_DOWN&&(s.preventDefault(),s.stopPropagation(),1))},!0),n(i)}return r[i]},show:function(e){if(r[e]){var i=r[e].$modal;i.data("instance",t),i.show(),o.show(),t.$doc.find("body").addClass("prevent-scroll"),t.helpers.isMobile()&&t.$doc.find("body").addClass("fr-mobile"),i.addClass("fr-active"),t.core.hasFocus()||(t.events.disableBlur(),t.events.focus()),t.accessibility.saveSelection(),t.events.disableBlur(),t.$el.blur(),t.selection.clear(),t.events.disableBlur(),i.find("[tabIndex]:first").focus()}},hide:n,resize:function(e){if(r[e]){var i=r[e],n=i.$modal,s=i.$body,o=t.$win.height(),a=n.find(".fr-modal-wrapper"),l=o-a.outerHeight(!0)+(a.height()-(s.outerHeight(!0)-s.height())),c="auto";s.get(0).scrollHeight>l&&(c=l),s.height(c)}},isVisible:s,areVisible:function(e){for(var t in r)if(r.hasOwnProperty(t)&&s(t)&&(void 0===e||r[t].$modal.data("instance")==e))return r[t].$modal;return!1}}},e.FE.POPUP_TEMPLATES={"text.edit":"[_EDIT_]"},e.FE.RegisterTemplate=function(t,i){e.FE.POPUP_TEMPLATES[t]=i},e.FE.MODULES.popups=function(t){function i(i,n){n.is(":visible")||(n=e(t.opts.scrollableContainer)),n.is(f[i].data("container"))||(f[i].data("container",n),n.append(f[i]))}function n(e){return f[e]&&t.node.hasClass(f[e],"fr-active")&&t.core.sameInstance(f[e])||!1}function s(e){for(var t in f)if(f.hasOwnProperty(t)&&n(t)&&(void 0===e||f[t].data("instance")==e))return f[t];return!1}function o(e){var i=null;(i="string"!=typeof e?e:f[e])&&t.node.hasClass(i,"fr-active")&&(i.removeClass("fr-active fr-above"),t.events.trigger("popups.hide."+e),t.$tb&&(t.opts.zIndex>1?t.$tb.css("zIndex",t.opts.zIndex+1):t.$tb.css("zIndex","")),t.events.disableBlur(),i.find("input, textarea, button").filter(":focus").blur(),i.find("input, textarea").attr("disabled","disabled"))}function r(e){for(var t in void 0===e&&(e=[]),f)f.hasOwnProperty(t)&&e.indexOf(t)<0&&o(t)}function a(){t.shared.exit_flag=!0}function l(){t.shared.exit_flag=!1}function c(){return t.shared.exit_flag}function d(i,n){var s=function(i,n){var s=e.FE.POPUP_TEMPLATES[i];for(var o in"function"==typeof s&&(s=s.apply(t)),n)n.hasOwnProperty(o)&&(s=s.replace("[_"+o.toUpperCase()+"_]",n[o]));return s}(i,n),o=e('<div class="fr-popup'+(t.helpers.isMobile()?" fr-mobile":" fr-desktop")+(t.opts.toolbarInline?" fr-inline":"")+'"><span class="fr-arrow"></span>'+s+"</div>");t.opts.theme&&o.addClass(t.opts.theme+"-theme"),t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+2),"auto"!=t.opts.direction&&o.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),o.find("input, textarea").attr("dir",t.opts.direction).attr("disabled","disabled");var r=e("body");return r.append(o),o.data("container",r),f[i]=o,t.button.bindCommands(o,!1),o}function u(i){var s=f[i];return{_windowResize:function(){var e=s.data("instance")||t;!e.helpers.isMobile()&&s.is(":visible")&&(e.events.disableBlur(),e.popups.hide(i),e.events.enableBlur())},_inputFocus:function(i){var n=s.data("instance")||t,o=e(i.currentTarget);if(o.is("input:file")&&o.closest(".fr-layer").addClass("fr-input-focus"),i.preventDefault(),i.stopPropagation(),setTimeout(function(){n.events.enableBlur()},0),n.helpers.isMobile()){var r=e(n.o_win).scrollTop();setTimeout(function(){e(n.o_win).scrollTop(r)},0)}},_inputBlur:function(i){var n=s.data("instance")||t,o=e(i.currentTarget);o.is("input:file")&&o.closest(".fr-layer").removeClass("fr-input-focus"),document.activeElement!=this&&e(this).is(":visible")&&(n.events.blurActive()&&n.events.trigger("blur"),n.events.enableBlur())},_editorKeydown:function(o){var r=s.data("instance")||t;r.keys.ctrlKey(o)||o.which==e.FE.KEYCODE.ALT||o.which==e.FE.KEYCODE.ESC||(n(i)&&s.find(".fr-back:visible").length?r.button.exec(s.find(".fr-back:visible:first")):o.which!=e.FE.KEYCODE.ALT&&r.popups.hide(i))},_preventFocus:function(i){(s.data("instance")||t).events.disableBlur();var n=i.originalEvent?i.originalEvent.target||i.originalEvent.originalTarget:null,o="input, textarea, button, select, label, .fr-command";return n&&!e(n).is(o)&&0===e(n).parents(o).length?(i.stopPropagation(),!1):(n&&e(n).is(o)&&i.stopPropagation(),void l())},_editorMouseup:function(e){s.is(":visible")&&c()&&s.find("input:focus, textarea:focus, button:focus, select:focus").filter(":visible").length>0&&t.events.disableBlur()},_windowMouseup:function(e){if(!t.core.sameInstance(s))return!0;var n=s.data("instance")||t;s.is(":visible")&&c()&&(e.stopPropagation(),n.markers.remove(),n.popups.hide(i),l())},_windowKeydown:function(n){if(!t.core.sameInstance(s))return!0;var o=s.data("instance")||t,r=n.which;if(e.FE.KEYCODE.ESC==r){if(o.popups.isVisible(i)&&o.opts.toolbarInline)return n.stopPropagation(),o.popups.isVisible(i)&&(s.find(".fr-back:visible").length?(o.button.exec(s.find(".fr-back:visible:first")),o.accessibility.focusPopupButton(s)):s.find(".fr-dismiss:visible").length?o.button.exec(s.find(".fr-dismiss:visible:first")):(o.popups.hide(i),o.toolbar.showInline(null,!0),o.accessibility.FocusPopupButton(s))),!1;if(o.popups.isVisible(i))return s.find(".fr-back:visible").length?(o.button.exec(s.find(".fr-back:visible:first")),o.accessibility.focusPopupButton(s)):s.find(".fr-dismiss:visible").length?o.button.exec(s.find(".fr-dismiss:visible:first")):(o.popups.hide(i),o.accessibility.focusPopupButton(s)),!1}},_doPlaceholder:function(t){0==e(this).next().length&&e(this).attr("placeholder")&&e(this).after('<label for="'+e(this).attr("id")+'">'+e(this).attr("placeholder")+"</label>"),e(this).toggleClass("fr-not-empty",""!=e(this).val())},_repositionPopup:function(o){if(!t.opts.height&&!t.opts.heightMax||t.opts.toolbarInline)return!0;if(t.$wp&&n(i)&&s.parent().get(0)==e(t.opts.scrollableContainer).get(0)){var r=s.offset().top-t.$wp.offset().top,a=t.$wp.outerHeight();t.node.hasClass(s.get(0),"fr-above")&&(r+=s.outerHeight()),r>a||r<0?s.addClass("fr-hidden"):s.removeClass("fr-hidden")}}}}function h(e,i){t.events.on("mouseup",e._editorMouseup,!0),t.$wp&&t.events.on("keydown",e._editorKeydown),t.events.on("blur",function(e){s()&&t.markers.remove(),r()}),t.$wp&&!t.helpers.isMobile()&&t.events.$on(t.$wp,"scroll.popup"+i,e._repositionPopup),t.events.on("window.mouseup",e._windowMouseup,!0),t.events.on("window.keydown",e._windowKeydown,!0),f[i].data("inst"+t.id,!0),t.events.on("destroy",function(){t.core.sameInstance(f[i])&&f[i].removeClass("fr-active").appendTo("body")},!0)}function p(){for(var e in f)if(f.hasOwnProperty(e)){f[e].html("").removeData().remove(),f[e]=null}f=[]}t.shared.popups||(t.shared.popups={});var f=t.shared.popups;return t.shared.exit_flag=!1,{_init:function(){t.events.on("shared.destroy",p,!0),t.events.on("window.mousedown",a),t.events.on("window.touchmove",l),t.events.on("mousedown",function(e){s()&&(e.stopPropagation(),t.$el.find(".fr-marker").remove(),a(),t.events.disableBlur())})},create:function(i,n){var s=d(i,n),o=u(i);return h(o,i),t.events.$on(s,"mousedown mouseup touchstart touchend touch","*",o._preventFocus,!0),t.events.$on(s,"focus","input, textarea, button, select",o._inputFocus,!0),t.events.$on(s,"blur","input, textarea, button, select",o._inputBlur,!0),t.accessibility.registerPopup(i),t.events.$on(s,"keydown keyup change input","input, textarea",o._doPlaceholder,!0),t.helpers.isIOS()&&t.events.$on(s,"touchend","label",function(){e("#"+e(this).attr("for")).prop("checked",function(e,t){return!t})},!0),t.events.$on(e(t.o_win),"resize",o._windowResize,!0),s},get:function(e){var i=f[e];return i&&!i.data("inst"+t.id)&&h(u(e),e),i},show:function(o,a,c,d){if(s()&&t.$el.find(".fr-marker").length>0?(t.events.disableBlur(),t.selection.restore()):(t.events.disableBlur(),t.events.focus()),r([o]),!f[o])return!1;var h=e(".fr-dropdown.fr-active");h.removeClass("fr-active").attr("aria-expanded",!1).parent(".fr-toolbar").css("zIndex",""),h.next().attr("aria-hidden",!0),f[o].data("instance",t),t.$tb&&t.$tb.data("instance",t);var p=f[o].outerWidth(),m=(f[o].outerHeight(),n(o));f[o].addClass("fr-active").removeClass("fr-hidden").find("input, textarea").removeAttr("disabled");var g=f[o].data("container");t.opts.toolbarInline&&g&&t.$tb&&g.get(0)==t.$tb.get(0)&&(i(o,e(t.opts.scrollableContainer)),c=t.$tb.offset().top-t.helpers.getPX(t.$tb.css("margin-top")),a=t.$tb.offset().left+t.$tb.outerWidth()/2+(parseFloat(t.$tb.find(".fr-arrow").css("margin-left"))||0)+t.$tb.find(".fr-arrow").outerWidth()/2,t.node.hasClass(t.$tb.get(0),"fr-above")&&c&&(c+=t.$tb.outerHeight()),d=0),g=f[o].data("container"),!t.opts.iframe||d||m||(a&&(a-=t.$iframe.offset().left),c&&(c-=t.$iframe.offset().top)),g.is(t.$tb)?t.$tb.css("zIndex",(t.opts.zIndex||1)+4):f[o].css("zIndex",(t.opts.zIndex||1)+4),a&&(a-=p/2),t.opts.toolbarBottom&&g&&t.$tb&&g.get(0)==t.$tb.get(0)&&(f[o].addClass("fr-above"),c&&(c-=f[o].outerHeight())),f[o].removeClass("fr-active"),t.position.at(a,c,f[o],d||0),f[o].addClass("fr-active"),m||t.accessibility.focusPopup(f[o]),t.opts.toolbarInline&&t.toolbar.hide(),t.events.trigger("popups.show."+o),u(o)._repositionPopup(),l()},hide:o,onHide:function(e,i){t.events.on("popups.hide."+e,i)},hideAll:r,setContainer:i,refresh:function(i){t.events.trigger("popups.refresh."+i);for(var n=f[i].find(".fr-command"),s=0;s<n.length;s++){var o=e(n[s]);0==o.parents(".fr-dropdown-menu").length&&t.button.refresh(o)}},onRefresh:function(e,i){t.events.on("popups.refresh."+e,i)},onShow:function(e,i){t.events.on("popups.show."+e,i)},isVisible:n,areVisible:s}},e.FE.MODULES.position=function(t){function i(){var i,n=t.selection.ranges(0);if(n&&n.collapsed&&t.selection.inEditor()){var s=!1;0==t.$el.find(".fr-marker").length&&(t.selection.save(),s=!0);var o=t.$el.find(".fr-marker:first");o.css("display","inline"),o.css("line-height","");var r=o.offset(),a=o.outerHeight();o.css("display","none"),o.css("line-height",0),(i={}).left=r.left,i.width=0,i.height=a,i.top=r.top-(t.helpers.isIOS()?0:e(t.o_win).scrollTop()),i.right=1,i.bottom=1,i.ok=!0,s&&t.selection.restore()}else n&&(i=n.getBoundingClientRect());return i}function n(i,n,s){var o=i.outerHeight();if(!t.helpers.isMobile()&&t.$tb&&i.parent().get(0)!=t.$tb.get(0)){var r=(i.parent().height(),t.opts.toolbarBottom&&t.$tb.outerHeight(),i.parent().offset().top),a=n-o-(s||0);i.parent().get(0)==e(t.opts.scrollableContainer).get(0)&&(r-=i.parent().position().top);var l=e(t.opts.scrollableContainer).get(0).scrollHeight;r+n+o>e(t.opts.scrollableContainer).offset().top+l&&i.parent().offset().top+a>0?(n=a,i.addClass("fr-above")):i.removeClass("fr-above")}return n}function s(i,n){var s=i.outerWidth();return n+s>e(t.opts.scrollableContainer).width()-10&&(n=e(t.opts.scrollableContainer).width()-s-10),n<0&&(n=10),n}function o(e,i,o,r){var a=o.data("container");!a||a.is("body")&&"static"==a.css("position")||(e&&(e-=a.offset().left),i&&(i-=a.offset().top),"BODY"!=a.get(0).tagName?(e&&(e+=a.scrollLeft()),i&&(i+=a.scrollTop())):"absolute"==a.css("position")&&(e&&(e+=a.position().left),i&&(i+=a.position().top))),t.opts.iframe&&a&&t.$tb&&a.get(0)!=t.$tb.get(0)&&(e&&(e+=t.$iframe.offset().left),i&&(i+=t.$iframe.offset().top));var l=s(o,e);if(e){o.css("left",l);var c=o.find(".fr-arrow");c.data("margin-left")||c.data("margin-left",t.helpers.getPX(c.css("margin-left"))),c.css("margin-left",e-l+c.data("margin-left"))}i&&o.css("top",n(o,i,r))}function r(i){var n=e(i),s=n.is(".fr-sticky-on"),o=n.data("sticky-top"),r=n.data("sticky-scheduled");if(void 0===o){n.data("sticky-top",0);var a=e('<div class="fr-sticky-dummy" style="height: '+n.outerHeight()+'px;"></div>');t.$box.prepend(a)}else t.$box.find(".fr-sticky-dummy").css("height",n.outerHeight());if(t.core.hasFocus()||t.$tb.find("input:visible:focus").length>0){var l=e(window).scrollTop(),c=Math.min(Math.max(l-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-n.outerHeight());c!=o&&c!=r&&(clearTimeout(n.data("sticky-timeout")),n.data("sticky-scheduled",c),n.outerHeight()<l-t.$tb.parent().offset().top&&n.addClass("fr-opacity-0"),n.data("sticky-timeout",setTimeout(function(){var i=e(window).scrollTop(),s=Math.min(Math.max(i-t.$tb.parent().offset().top,0),t.$tb.parent().outerHeight()-n.outerHeight());s>0&&"BODY"==t.$tb.parent().get(0).tagName&&(s+=t.$tb.parent().position().top),s!=o&&(n.css("top",Math.max(s,0)),n.data("sticky-top",s),n.data("sticky-scheduled",s)),n.removeClass("fr-opacity-0")},100))),s||(n.css("top","0"),n.width(t.$tb.parent().width()),n.addClass("fr-sticky-on"),t.$box.addClass("fr-sticky-box"))}else clearTimeout(e(i).css("sticky-timeout")),n.css("top","0"),n.css("position",""),n.width(""),n.data("sticky-top",0),n.removeClass("fr-sticky-on"),t.$box.removeClass("fr-sticky-box")}function a(i){if(i.offsetWidth){var n,s,o=e(i),r=o.outerHeight(),a=o.data("sticky-position"),l=e("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer).outerHeight(),c=0,d=0;"body"!==t.opts.scrollableContainer&&(c=e(t.opts.scrollableContainer).offset().top,d=e(t.o_win).outerHeight()-c-l);var u="body"==t.opts.scrollableContainer?e(t.o_win).scrollTop():c,h=o.is(".fr-sticky-on");o.data("sticky-parent")||o.data("sticky-parent",o.parent());var p=o.data("sticky-parent"),f=p.offset().top,m=p.outerHeight();if(o.data("sticky-offset")||(o.data("sticky-offset",!0),o.after('<div class="fr-sticky-dummy" style="height: '+r+'px;"></div>')),!a){var g="auto"!==o.css("top")||"auto"!==o.css("bottom");g||o.css("position","fixed"),a={top:t.node.hasClass(o.get(0),"fr-top"),bottom:t.node.hasClass(o.get(0),"fr-bottom")},g||o.css("position",""),o.data("sticky-position",a),o.data("top",t.node.hasClass(o.get(0),"fr-top")?o.css("top"):"auto"),o.data("bottom",t.node.hasClass(o.get(0),"fr-bottom")?o.css("bottom"):"auto")}n=t.helpers.getPX(o.data("top")),s=t.helpers.getPX(o.data("bottom"));var v=a.top&&f<u+n&&f+m-r>=u+n,b=a.bottom&&f+r<u+l-s&&f+m>u+l-s;v||b?(o.css("width",p.width()+"px"),h||(o.addClass("fr-sticky-on"),o.removeClass("fr-sticky-off"),o.css("top")&&("auto"!=o.data("top")?o.css("top",t.helpers.getPX(o.data("top"))+c):o.data("top","auto")),o.css("bottom")&&("auto"!=o.data("bottom")?o.css("bottom",t.helpers.getPX(o.data("bottom"))+d):o.css("bottom","auto")))):t.node.hasClass(o.get(0),"fr-sticky-off")||(o.width(""),o.removeClass("fr-sticky-on"),o.addClass("fr-sticky-off"),o.css("top")&&"auto"!=o.data("top")&&a.top&&o.css("top",0),o.css("bottom")&&"auto"!=o.data("bottom")&&a.bottom&&o.css("bottom",0))}}function l(){var e=document.createElement("test").style;return e.cssText="position:"+["-webkit-","-moz-","-ms-","-o-",""].join("sticky; position:")+" sticky;",-1!==e.position.indexOf("sticky")&&!t.helpers.isIOS()&&!t.helpers.isAndroid()}function c(){for(var e=0;e<t._stickyElements.length;e++)a(t._stickyElements[e])}return{_init:function(){!function(){if(!l())if(t._stickyElements=[],t.helpers.isIOS()){var i=function(){t.helpers.requestAnimationFrame()(i);for(var e=0;e<t._stickyElements.length;e++)r(t._stickyElements[e])};i(),t.events.$on(e(t.o_win),"scroll",function(){if(t.core.hasFocus())for(var i=0;i<t._stickyElements.length;i++){var n=e(t._stickyElements[i]),s=n.parent(),o=e(window).scrollTop();n.outerHeight()<o-s.offset().top&&(n.addClass("fr-opacity-0"),n.data("sticky-top",-1),n.data("sticky-scheduled",-1))}},!0)}else t.events.$on(e("body"==t.opts.scrollableContainer?t.o_win:t.opts.scrollableContainer),"scroll",c,!0),t.events.$on(e(t.o_win),"resize",c,!0),t.events.on("initialized",c),t.events.on("focus",c),t.events.$on(e(t.o_win),"resize","textarea",c,!0);t.events.on("destroy",function(e){t._stickyElements=[]})}()},forSelection:function(n){var s=i();n.css("top",0).css("left",0);var r=s.top+s.height,a=s.left+s.width/2-n.outerWidth()/2+e(t.o_win).scrollLeft();t.opts.iframe||(r+=e(t.o_win).scrollTop()),o(a,r,n,s.height)},addSticky:function(e){e.addClass("fr-sticky"),t.helpers.isIOS()&&e.addClass("fr-sticky-ios"),l()||t._stickyElements.push(e.get(0))},refresh:c,at:o,getBoundingRect:i}},e.FE.MODULES.refresh=function(t){function i(e,t){e.toggleClass("fr-disabled",t).attr("aria-disabled",t)}return{undo:function(e){i(e,!t.undo.canDo())},redo:function(e){i(e,!t.undo.canRedo())},outdent:function(n){if(t.node.hasClass(n.get(0),"fr-no-refresh"))return!1;for(var s=t.selection.blocks(),o=0;o<s.length;o++){var r="rtl"==t.opts.direction||"rtl"==e(s[o]).css("direction")?"margin-right":"margin-left";if("LI"==s[o].tagName||"LI"==s[o].parentNode.tagName)return i(n,!1),!0;if(t.helpers.getPX(e(s[o]).css(r))>0)return i(n,!1),!0}i(n,!0)},indent:function(e){if(t.node.hasClass(e.get(0),"fr-no-refresh"))return!1;for(var n=t.selection.blocks(),s=0;s<n.length;s++){for(var o=n[s].previousSibling;o&&o.nodeType==Node.TEXT_NODE&&0===o.textContent.length;)o=o.previousSibling;if("LI"!=n[s].tagName||o)return i(e,!1),!0;i(e,!0)}}}},e.extend(e.FE.DEFAULTS,{editInPopup:!1}),e.FE.MODULES.textEdit=function(t){function i(){var i,n=t.popups.get("text.edit");i="INPUT"===t.$el.prop("tagName")?t.$el.attr("placeholder"):t.$el.text(),n.find("input").val(i).trigger("change"),t.popups.setContainer("text.edit",e("body")),t.popups.show("text.edit",t.$el.offset().left+t.$el.outerWidth()/2,t.$el.offset().top+t.$el.outerHeight(),t.$el.outerHeight())}return{_init:function(){t.opts.editInPopup&&(function(){var e={edit:'<div id="fr-text-edit-'+t.id+'" class="fr-layer fr-text-edit-layer"><div class="fr-input-line"><input type="text" placeholder="'+t.language.translate("Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="updateText" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>"};t.popups.create("text.edit",e)}(),t.events.$on(t.$el,t._mouseup,function(e){setTimeout(function(){i()},10)}))},update:function(){var e=t.popups.get("text.edit").find("input").val();0==e.length&&(e=t.opts.placeholderText),"INPUT"===t.$el.prop("tagName")?t.$el.attr("placeholder",e):t.$el.text(e),t.events.trigger("contentChanged"),t.popups.hide("text.edit")}}},e.FE.RegisterCommand("updateText",{focus:!1,undo:!1,callback:function(){this.textEdit.update()}}),e.extend(e.FE.DEFAULTS,{toolbarBottom:!1,toolbarButtons:["fullscreen","bold","italic","underline","strikeThrough","subscript","superscript","fontFamily","fontSize","|","color","emoticons","inlineStyle","paragraphStyle","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","insertHR","-","insertLink","insertImage","insertVideo","insertFile","insertTable","undo","redo","clearFormatting","selectAll","html","applyFormat","removeFormat","help"],toolbarButtonsXS:["bold","italic","fontFamily","fontSize","|","undo","redo","help"],toolbarButtonsSM:["bold","italic","underline","|","fontFamily","fontSize","insertLink","insertImage","table","|","undo","redo","help"],toolbarButtonsMD:["fullscreen","bold","italic","underline","fontFamily","fontSize","color","paragraphStyle","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","insertHR","-","insertLink","insertImage","insertVideo","insertFile","insertTable","undo","redo","clearFormatting","help"],toolbarContainer:null,toolbarInline:!1,toolbarSticky:!0,toolbarStickyOffset:0,toolbarVisibleWithoutSelection:!1}),e.FE.MODULES.toolbar=function(t){function i(e,t){for(var i=0;i<t.length;i++)"-"!=t[i]&&"|"!=t[i]&&e.indexOf(t[i])<0&&e.push(t[i])}function n(){var e=t.helpers.screenSize();return h[e]}function s(){var e=n();t.$tb.find(".fr-separator").remove(),t.$tb.find("> .fr-command").addClass("fr-hidden");for(var i=0;i<e.length;i++)if("|"==e[i]||"-"==e[i])t.$tb.append(t.button.buildList([e[i]]));else{var s=t.$tb.find('> .fr-command[data-cmd="'+e[i]+'"]'),o=null;t.node.hasClass(s.next().get(0),"fr-dropdown-menu")&&(o=s.next()),s.removeClass("fr-hidden").appendTo(t.$tb),o&&o.appendTo(t.$tb)}}function o(i,n){setTimeout(function(){if(i&&i.which==e.FE.KEYCODE.ESC);else if(t.selection.inEditor()&&t.core.hasFocus()&&!t.popups.areVisible()&&(t.opts.toolbarVisibleWithoutSelection&&i&&"keyup"!=i.type||!t.selection.isCollapsed()&&!t.keys.isIME()||n)){if(t.$tb.data("instance",t),0==t.events.trigger("toolbar.show",[i]))return!1;t.opts.toolbarContainer||t.position.forSelection(t.$tb),t.opts.zIndex>1?t.$tb.css("z-index",t.opts.zIndex+1):t.$tb.css("z-index",null),t.$tb.show()}},0)}function r(i){return!!e(".fr-dropdown.fr-active").next().find(t.o_doc.activeElement).length||void(!1!==t.events.trigger("toolbar.hide")&&t.$tb.hide())}function a(){t.events.on("window.mousedown",r),t.events.on("keydown",r),t.events.on("blur",r),t.events.on("window.mouseup",o),t.helpers.isMobile()?t.helpers.isIOS()||(t.events.on("window.touchend",o),t.browser.mozilla&&setInterval(o,200)):t.events.on("window.keyup",o),t.events.on("keydown",function(t){t&&t.which==e.FE.KEYCODE.ESC&&r()}),t.events.on("keydown",function(t){if(t.which==e.FE.KEYCODE.ALT)return t.stopPropagation(),!1},!0),t.events.$on(t.$wp,"scroll.toolbar",o),t.events.on("commands.after",o),t.helpers.isMobile()&&(t.events.$on(t.$doc,"selectionchange",o),t.events.$on(t.$doc,"orientationchange",o))}function l(){t.$tb.html("").removeData().remove(),t.$tb=null}function c(){t.$box.removeClass("fr-top fr-bottom fr-inline fr-basic"),t.$box.find(".fr-sticky-dummy").remove()}function d(){t.opts.theme&&t.$tb.addClass(t.opts.theme+"-theme"),t.opts.zIndex>1&&t.$tb.css("z-index",t.opts.zIndex+1),"auto"!=t.opts.direction&&t.$tb.removeClass("fr-ltr fr-rtl").addClass("fr-"+t.opts.direction),t.helpers.isMobile()?t.$tb.addClass("fr-mobile"):t.$tb.addClass("fr-desktop"),t.opts.toolbarContainer?(t.opts.toolbarInline&&(a(),r()),t.opts.toolbarBottom?t.$tb.addClass("fr-bottom"):t.$tb.addClass("fr-top")):t.opts.toolbarInline?(e(t.opts.scrollableContainer).append(t.$tb),t.$tb.data("container",e(t.opts.scrollableContainer)),t.$tb.addClass("fr-inline"),t.$tb.prepend('<span class="fr-arrow"></span>'),a(),t.opts.toolbarBottom=!1):(t.opts.toolbarBottom&&!t.helpers.isIOS()?(t.$box.append(t.$tb),t.$tb.addClass("fr-bottom"),t.$box.addClass("fr-bottom")):(t.opts.toolbarBottom=!1,t.$box.prepend(t.$tb),t.$tb.addClass("fr-top"),t.$box.addClass("fr-top")),t.$tb.addClass("fr-basic"),t.opts.toolbarSticky&&(t.opts.toolbarStickyOffset&&(t.opts.toolbarBottom?t.$tb.css("bottom",t.opts.toolbarStickyOffset):t.$tb.css("top",t.opts.toolbarStickyOffset)),t.position.addSticky(t.$tb))),u=t.$tb.get(0).ownerDocument,"defaultView"in u?u.defaultView:u.parentWindow,function(){var s=e.merge([],n());i(s,t.opts.toolbarButtonsXS||[]),i(s,t.opts.toolbarButtonsSM||[]),i(s,t.opts.toolbarButtonsMD||[]),i(s,t.opts.toolbarButtons);for(var o=s.length-1;o>=0;o--)"-"!=s[o]&&"|"!=s[o]&&s.indexOf(s[o])<o&&s.splice(o,1);var r=t.button.buildList(s,n());t.$tb.append(r),t.button.bindCommands(t.$tb)}(),t.events.$on(e(t.o_win),"resize",s),t.events.$on(e(t.o_win),"orientationchange",s),t.accessibility.registerToolbar(t.$tb),t.events.$on(t.$tb,t._mousedown+" "+t._mouseup,function(e){var i=e.originalEvent?e.originalEvent.target||e.originalEvent.originalTarget:null;if(i&&"INPUT"!=i.tagName&&!t.edit.isDisabled())return e.stopPropagation(),e.preventDefault(),!1},!0)}var u,h=[];h[e.FE.XS]=t.opts.toolbarButtonsXS||t.opts.toolbarButtons,h[e.FE.SM]=t.opts.toolbarButtonsSM||t.opts.toolbarButtons,h[e.FE.MD]=t.opts.toolbarButtonsMD||t.opts.toolbarButtons,h[e.FE.LG]=t.opts.toolbarButtons;var p=!1;return{_init:function(){return!!t.$wp&&(t.opts.toolbarContainer?(t.shared.$tb?(t.$tb=t.shared.$tb,t.opts.toolbarInline&&a()):(t.shared.$tb=e('<div class="fr-toolbar"></div>'),t.$tb=t.shared.$tb,e(t.opts.toolbarContainer).append(t.$tb),d(),t.$tb.data("instance",t)),t.opts.toolbarInline?t.$box.addClass("fr-inline"):t.$box.addClass("fr-basic"),t.events.on("focus",function(){t.$tb.data("instance",t)},!0),t.opts.toolbarInline=!1):t.opts.toolbarInline?(t.$box.addClass("fr-inline"),t.shared.$tb?(t.$tb=t.shared.$tb,a()):(t.shared.$tb=e('<div class="fr-toolbar"></div>'),t.$tb=t.shared.$tb,d())):(t.$box.addClass("fr-basic"),t.$tb=e('<div class="fr-toolbar"></div>'),d(),t.$tb.data("instance",t)),t.events.on("destroy",c,!0),void t.events.on(t.opts.toolbarInline||t.opts.toolbarContainer?"shared.destroy":"destroy",l,!0))},hide:r,show:function(){return 0!=t.events.trigger("toolbar.show")&&void t.$tb.show()},showInline:o,disable:function(){!p&&t.$tb&&(t.$tb.find("> .fr-command").addClass("fr-disabled fr-no-refresh").attr("aria-disabled",!0),p=!0)},enable:function(){p&&t.$tb&&(t.$tb.find("> .fr-command").removeClass("fr-disabled fr-no-refresh").attr("aria-disabled",!1),p=!1),t.button.bulkRefresh()}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.FE.PLUGINS.align=function(t){return{apply:function(i){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var n=t.selection.blocks(),s=0;s<n.length;s++)t.helpers.getAlignment(e(n[s].parentNode))==i?e(n[s]).css("text-align","").removeClass("fr-temp-div"):e(n[s]).css("text-align",i).removeClass("fr-temp-div"),""===e(n[s]).attr("class")&&e(n[s]).removeAttr("class"),""===e(n[s]).attr("style")&&e(n[s]).removeAttr("style");t.selection.save(),t.html.unwrap(),t.selection.restore()},refresh:function(i){var n=t.selection.blocks();if(n.length){var s=t.helpers.getAlignment(e(n[0]));i.find("> *:first").replaceWith(t.icon.create("align-"+s))}},refreshOnShow:function(i,n){var s=t.selection.blocks();if(s.length){var o=t.helpers.getAlignment(e(s[0]));n.find('a.fr-command[data-param1="'+o+'"]').addClass("fr-active").attr("aria-selected",!0)}}}},e.FE.DefineIcon("align",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"}),e.FE.RegisterCommand("align",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.align.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="align" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+'<span class="fr-sr-only">'+this.language.translate(i[n])+"</span></a></li>");return t+"</ul>"},callback:function(e,t){this.align.apply(t)},refresh:function(e){this.align.refresh(e)},refreshOnShow:function(e,t){this.align.refreshOnShow(e,t)},plugin:"align"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.FE.PLUGINS.codeBeautifier=function(){function e(e,t){function i(){return(y=e.charAt(++x))||""}function n(t){var n,s=x;return t&&r(),n=e.charAt(x+1)||"",x=s-1,i(),n}function s(t){for(var n=x;i();)if("\\"===y)i();else{if(-1!==t.indexOf(y))break;if("\n"===y)break}return e.substring(n,x+1)}function o(e){var t=x,n=s(e);return x=t-1,i(),n}function r(){for(var e="";w.test(n());)i(),e+=y;return e}function a(){var e="";for(y&&w.test(y)&&(e=y);w.test(i());)e+=y;return e}function l(t){var s=x;for(t="/"===n(),i();i();){if(!t&&"*"===y&&"/"===n()){i();break}if(t&&"\n"===y)return e.substring(s,x)}return e.substring(s,x)+y}function c(t){return e.substring(x-t.length,x).toLowerCase()===t}function d(){for(var t=0,i=x+1;i<e.length;i++){var n=e.charAt(i);if("{"===n)return!0;if("("===n)t+=1;else if(")"===n){if(0==t)return!1;t-=1}else if(";"===n||"}"===n)return!1}return!1}var u={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},h={"@media":!0,"@supports":!0,"@document":!0};t=t||{},e=(e=e||"").replace(/\r\n|[\r\u2028\u2029]/g,"\n");var p=t.indent_size||4,f=t.indent_char||" ",m=void 0===t.selector_separator_newline||t.selector_separator_newline,g=void 0!==t.end_with_newline&&t.end_with_newline,v=void 0===t.newline_between_rules||t.newline_between_rules,b=t.eol?t.eol:"\n";"string"==typeof p&&(p=parseInt(p,10)),t.indent_with_tabs&&(f="\t",p=1),b=b.replace(/\\r/,"\r").replace(/\\n/,"\n");for(var y,w=/^\s+$/,x=-1,C=0,E=e.match(/^[\t ]*/)[0],T=new Array(p+1).join(f),k=0,_=0,S={"{":function(e){S.singleSpace(),D.push(e),S.newLine()},"}":function(e){S.newLine(),D.push(e),S.newLine()},_lastCharWhitespace:function(){return w.test(D[D.length-1])},newLine:function(e){D.length&&(e||"\n"===D[D.length-1]||S.trim(),D.push("\n"),E&&D.push(E))},singleSpace:function(){D.length&&!S._lastCharWhitespace()&&D.push(" ")},preserveSingleSpace:function(){L&&S.singleSpace()},trim:function(){for(;S._lastCharWhitespace();)D.pop()}},D=[],$=!1,M=!1,A=!1,O="",F="";;){var N=a(),L=""!==N,R=-1!==N.indexOf("\n");if(F=O,O=y,!y)break;if("/"===y&&"*"===n()){var I=0===k;(R||I)&&S.newLine(),D.push(l()),S.newLine(),I&&S.newLine(!0)}else if("/"===y&&"/"===n())R||"{"===F||S.trim(),S.singleSpace(),D.push(l()),S.newLine();else if("@"===y){S.preserveSingleSpace(),D.push(y);var P=o(": ,;{}()[]/='\"");P.match(/[ :]$/)&&(i(),P=s(": ").replace(/\s$/,""),D.push(P),S.singleSpace()),(P=P.replace(/\s$/,""))in u&&(_+=1,P in h&&(A=!0))}else"#"===y&&"{"===n()?(S.preserveSingleSpace(),D.push(s("}"))):"{"===y?"}"===n(!0)?(r(),i(),S.singleSpace(),D.push("{}"),S.newLine(),v&&0===k&&S.newLine(!0)):(k++,E+=T,S["{"](y),A?(A=!1,$=k>_):$=k>=_):"}"===y?(k--,E=E.slice(0,-p),S["}"](y),$=!1,M=!1,_&&_--,v&&0===k&&S.newLine(!0)):":"===y?(r(),!$&&!A||c("&")||d()?":"===n()?(i(),D.push("::")):D.push(":"):(M=!0,D.push(":"),S.singleSpace())):'"'===y||"'"===y?(S.preserveSingleSpace(),D.push(s(y))):";"===y?(M=!1,D.push(y),S.newLine()):"("===y?c("url")?(D.push(y),r(),i()&&(")"!==y&&'"'!==y&&"'"!==y?D.push(s(")")):x--)):(C++,S.preserveSingleSpace(),D.push(y),r()):")"===y?(D.push(y),C--):","===y?(D.push(y),r(),m&&!M&&C<1?S.newLine():S.singleSpace()):"]"===y?D.push(y):"["===y?(S.preserveSingleSpace(),D.push(y)):"="===y?(r(),y="=",D.push(y)):(S.preserveSingleSpace(),D.push(y))}var B="";return E&&(B+=E),B+=D.join("").replace(/[\r\n\t ]+$/,""),g&&(B+="\n"),"\n"!=b&&(B=B.replace(/[\n]/g,b)),B}function t(e,t){for(var i=0;i<t.length;i+=1)if(t[i]===e)return!0;return!1}function i(e){return e.replace(/^\s+|\s+$/g,"")}function n(e){return e.replace(/^\s+/g,"")}function s(e,t){return new o(e,t).beautify()}function o(e,s){function o(e,t){var i=0;return e&&(i=e.indentation_level,!_.just_added_newline()&&e.line_indent_level>i&&(i=e.line_indent_level)),{mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:i,line_indent_level:e?e.line_indent_level:i,start_line_index:_.get_line_number(),ternary_depth:0}}function r(e){var t=e.newlines;if(P.keep_array_indentation&&v(F.mode))for(i=0;i<t;i+=1)h(i>0);else if(P.max_preserve_newlines&&t>P.max_preserve_newlines&&(t=P.max_preserve_newlines),P.preserve_newlines&&e.newlines>1){h();for(var i=1;i<t;i+=1)h(!0)}I[($=e).type]()}function u(e){if(e=void 0!==e&&e,!_.just_added_newline())if(P.preserve_newlines&&$.wanted_newline||e)h(!1,!0);else if(P.wrap_line_length){_.current_line.get_character_count()+$.text.length+(_.space_before_token?1:0)>=P.wrap_line_length&&h(!1,!0)}}function h(e,t){if(!t&&";"!==F.last_text&&","!==F.last_text&&"="!==F.last_text&&"TK_OPERATOR"!==M)for(;F.mode===d.Statement&&!F.if_block&&!F.do_block;)y();_.add_new_line(e)&&(F.multiline_frame=!0)}function p(){_.just_added_newline()&&(P.keep_array_indentation&&v(F.mode)&&$.wanted_newline?(_.current_line.push($.whitespace_before),_.space_before_token=!1):_.set_indent(F.indentation_level)&&(F.line_indent_level=F.indentation_level))}function f(e){return _.raw?void _.add_raw_token($):(P.comma_first&&"TK_COMMA"===M&&_.just_added_newline()&&","===_.previous_line.last()&&(_.previous_line.pop(),p(),_.add_token(","),_.space_before_token=!0),e=e||$.text,p(),void _.add_token(e))}function m(){F.indentation_level+=1}function g(e){F?(L.push(F),N=F):N=o(null,e),F=o(N,e)}function v(e){return e===d.ArrayLiteral}function b(e){return t(e,[d.Expression,d.ForInitializer,d.Conditional])}function y(){L.length>0&&(N=F,F=L.pop(),N.mode===d.Statement&&_.remove_redundant_indentation(N))}function w(){return F.parent.mode===d.ObjectLiteral&&F.mode===d.Statement&&(":"===F.last_text&&0===F.ternary_depth||"TK_RESERVED"===M&&t(F.last_text,["get","set"]))}function x(){return!!("TK_RESERVED"===M&&t(F.last_text,["var","let","const"])&&"TK_WORD"===$.type||"TK_RESERVED"===M&&"do"===F.last_text||"TK_RESERVED"===M&&"return"===F.last_text&&!$.wanted_newline||"TK_RESERVED"===M&&"else"===F.last_text&&("TK_RESERVED"!==$.type||"if"!==$.text)||"TK_END_EXPR"===M&&(N.mode===d.ForInitializer||N.mode===d.Conditional)||"TK_WORD"===M&&F.mode===d.BlockStatement&&!F.in_case&&"--"!==$.text&&"++"!==$.text&&"function"!==A&&"TK_WORD"!==$.type&&"TK_RESERVED"!==$.type||F.mode===d.ObjectLiteral&&(":"===F.last_text&&0===F.ternary_depth||"TK_RESERVED"===M&&t(F.last_text,["get","set"])))&&(g(d.Statement),m(),"TK_RESERVED"===M&&t(F.last_text,["var","let","const"])&&"TK_WORD"===$.type&&(F.declaration_statement=!0),w()||u("TK_RESERVED"===$.type&&t($.text,["do","for","if","while"])),!0)}function C(e,t){for(var n=0;n<e.length;n++){if(i(e[n]).charAt(0)!==t)return!1}return!0}function E(e){return t(e,["case","return","do","if","throw","else"])}function T(e){var t=S+(e||0);return t<0||t>=B.length?null:B[t]}function k(){("TK_RESERVED"===$.type&&F.mode!==d.ObjectLiteral&&t($.text,["set","get"])&&($.type="TK_WORD"),"TK_RESERVED"===$.type&&F.mode===d.ObjectLiteral)&&(":"==T(1).text&&($.type="TK_WORD"));if(x()||!$.wanted_newline||b(F.mode)||"TK_OPERATOR"===M&&"--"!==F.last_text&&"++"!==F.last_text||"TK_EQUALS"===M||!P.preserve_newlines&&"TK_RESERVED"===M&&t(F.last_text,["var","let","const","set","get"])||h(),F.do_block&&!F.do_while){if("TK_RESERVED"===$.type&&"while"===$.text)return _.space_before_token=!0,f(),_.space_before_token=!0,void(F.do_while=!0);h(),F.do_block=!1}if(F.if_block)if(F.else_block||"TK_RESERVED"!==$.type||"else"!==$.text){for(;F.mode===d.Statement;)y();F.if_block=!1,F.else_block=!1}else F.else_block=!0;if("TK_RESERVED"===$.type&&("case"===$.text||"default"===$.text&&F.in_case_statement))return h(),(F.case_body||P.jslint_happy)&&(F.indentation_level>0&&(!F.parent||F.indentation_level>F.parent.indentation_level)&&(F.indentation_level-=1),F.case_body=!1),f(),F.in_case=!0,void(F.in_case_statement=!0);if("TK_RESERVED"===$.type&&"function"===$.text&&((t(F.last_text,["}",";"])||_.just_added_newline()&&!t(F.last_text,["[","{",":","=",","]))&&(_.just_added_blankline()||$.comments_before.length||(h(),h(!0))),"TK_RESERVED"===M||"TK_WORD"===M?"TK_RESERVED"===M&&t(F.last_text,["get","set","new","return","export","async"])?_.space_before_token=!0:"TK_RESERVED"===M&&"default"===F.last_text&&"export"===A?_.space_before_token=!0:h():"TK_OPERATOR"===M||"="===F.last_text?_.space_before_token=!0:(F.multiline_frame||!b(F.mode)&&!v(F.mode))&&h()),"TK_COMMA"!==M&&"TK_START_EXPR"!==M&&"TK_EQUALS"!==M&&"TK_OPERATOR"!==M||w()||u(),"TK_RESERVED"===$.type&&t($.text,["function","get","set"]))return f(),void(F.last_word=$.text);if(R="NONE","TK_END_BLOCK"===M?"TK_RESERVED"===$.type&&t($.text,["else","catch","finally"])?"expand"===P.brace_style||"end-expand"===P.brace_style||"none"===P.brace_style&&$.wanted_newline?R="NEWLINE":(R="SPACE",_.space_before_token=!0):R="NEWLINE":"TK_SEMICOLON"===M&&F.mode===d.BlockStatement?R="NEWLINE":"TK_SEMICOLON"===M&&b(F.mode)?R="SPACE":"TK_STRING"===M?R="NEWLINE":"TK_RESERVED"===M||"TK_WORD"===M||"*"===F.last_text&&"function"===A?R="SPACE":"TK_START_BLOCK"===M?R="NEWLINE":"TK_END_EXPR"===M&&(_.space_before_token=!0,R="NEWLINE"),"TK_RESERVED"===$.type&&t($.text,D.line_starters)&&")"!==F.last_text&&(R="else"===F.last_text||"export"===F.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===$.type&&t($.text,["else","catch","finally"]))if("TK_END_BLOCK"!==M||"expand"===P.brace_style||"end-expand"===P.brace_style||"none"===P.brace_style&&$.wanted_newline)h();else{_.trim(!0),"}"!==_.current_line.last()&&h(),_.space_before_token=!0}else"NEWLINE"===R?"TK_RESERVED"===M&&E(F.last_text)?_.space_before_token=!0:"TK_END_EXPR"!==M?"TK_START_EXPR"===M&&"TK_RESERVED"===$.type&&t($.text,["var","let","const"])||":"===F.last_text||("TK_RESERVED"===$.type&&"if"===$.text&&"else"===F.last_text?_.space_before_token=!0:h()):"TK_RESERVED"===$.type&&t($.text,D.line_starters)&&")"!==F.last_text&&h():F.multiline_frame&&v(F.mode)&&","===F.last_text&&"}"===A?h():"SPACE"===R&&(_.space_before_token=!0);f(),F.last_word=$.text,"TK_RESERVED"===$.type&&"do"===$.text&&(F.do_block=!0),"TK_RESERVED"===$.type&&"if"===$.text&&(F.if_block=!0)}var _,S,D,$,M,A,O,F,N,L,R,I,P,B=[],H="";for(I={TK_START_EXPR:function(){x();var e=d.Expression;if("["===$.text){if("TK_WORD"===M||")"===F.last_text)return"TK_RESERVED"===M&&t(F.last_text,D.line_starters)&&(_.space_before_token=!0),g(e),f(),m(),void(P.space_in_paren&&(_.space_before_token=!0));e=d.ArrayLiteral,v(F.mode)&&("["!==F.last_text&&(","!==F.last_text||"]"!==A&&"}"!==A)||P.keep_array_indentation||h())}else"TK_RESERVED"===M&&"for"===F.last_text?e=d.ForInitializer:"TK_RESERVED"===M&&t(F.last_text,["if","while"])&&(e=d.Conditional);";"===F.last_text||"TK_START_BLOCK"===M?h():"TK_END_EXPR"===M||"TK_START_EXPR"===M||"TK_END_BLOCK"===M||"."===F.last_text?u($.wanted_newline):"TK_RESERVED"===M&&"("===$.text||"TK_WORD"===M||"TK_OPERATOR"===M?"TK_RESERVED"===M&&("function"===F.last_word||"typeof"===F.last_word)||"*"===F.last_text&&"function"===A?P.space_after_anon_function&&(_.space_before_token=!0):"TK_RESERVED"!==M||!t(F.last_text,D.line_starters)&&"catch"!==F.last_text||P.space_before_conditional&&(_.space_before_token=!0):_.space_before_token=!0,"("===$.text&&"TK_RESERVED"===M&&"await"===F.last_word&&(_.space_before_token=!0),"("===$.text&&("TK_EQUALS"!==M&&"TK_OPERATOR"!==M||w()||u()),g(e),f(),P.space_in_paren&&(_.space_before_token=!0),m()},TK_END_EXPR:function(){for(;F.mode===d.Statement;)y();F.multiline_frame&&u("]"===$.text&&v(F.mode)&&!P.keep_array_indentation),P.space_in_paren&&("TK_START_EXPR"!==M||P.space_in_empty_paren?_.space_before_token=!0:(_.trim(),_.space_before_token=!1)),"]"===$.text&&P.keep_array_indentation?(f(),y()):(y(),f()),_.remove_redundant_indentation(N),F.do_while&&N.mode===d.Conditional&&(N.mode=d.Expression,F.do_block=!1,F.do_while=!1)},TK_START_BLOCK:function(){var e=T(1),i=T(2);g(i&&(":"===i.text&&t(e.type,["TK_STRING","TK_WORD","TK_RESERVED"])||t(e.text,["get","set"])&&t(i.type,["TK_WORD","TK_RESERVED"]))?t(A,["class","interface"])?d.BlockStatement:d.ObjectLiteral:d.BlockStatement);var n=!e.comments_before.length&&"}"===e.text&&"function"===F.last_word&&"TK_END_EXPR"===M;"expand"===P.brace_style||"none"===P.brace_style&&$.wanted_newline?"TK_OPERATOR"!==M&&(n||"TK_EQUALS"===M||"TK_RESERVED"===M&&E(F.last_text)&&"else"!==F.last_text)?_.space_before_token=!0:h(!1,!0):"TK_OPERATOR"!==M&&"TK_START_EXPR"!==M?"TK_START_BLOCK"===M?h():_.space_before_token=!0:v(N.mode)&&","===F.last_text&&("}"===A?_.space_before_token=!0:h()),f(),m()},TK_END_BLOCK:function(){for(;F.mode===d.Statement;)y();var e="TK_START_BLOCK"===M;"expand"===P.brace_style?e||h():e||(v(F.mode)&&P.keep_array_indentation?(P.keep_array_indentation=!1,h(),P.keep_array_indentation=!0):h()),y(),f()},TK_WORD:k,TK_RESERVED:k,TK_SEMICOLON:function(){for(x()&&(_.space_before_token=!1);F.mode===d.Statement&&!F.if_block&&!F.do_block;)y();f()},TK_STRING:function(){x()?_.space_before_token=!0:"TK_RESERVED"===M||"TK_WORD"===M?_.space_before_token=!0:"TK_COMMA"===M||"TK_START_EXPR"===M||"TK_EQUALS"===M||"TK_OPERATOR"===M?w()||u():h(),f()},TK_EQUALS:function(){x(),F.declaration_statement&&(F.declaration_assignment=!0),_.space_before_token=!0,f(),_.space_before_token=!0},TK_OPERATOR:function(){if(x(),"TK_RESERVED"===M&&E(F.last_text))return _.space_before_token=!0,void f();if("*"!==$.text||"TK_DOT"!==M){if(":"===$.text&&F.in_case)return F.case_body=!0,m(),f(),h(),void(F.in_case=!1);if("::"!==$.text){"TK_OPERATOR"===M&&u();var e=!0,i=!0;t($.text,["--","++","!","~"])||t($.text,["-","+"])&&(t(M,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||t(F.last_text,D.line_starters)||","===F.last_text)?(e=!1,i=!1,!$.wanted_newline||"--"!==$.text&&"++"!==$.text||h(!1,!0),";"===F.last_text&&b(F.mode)&&(e=!0),"TK_RESERVED"===M?e=!0:"TK_END_EXPR"===M?e=!("]"===F.last_text&&("--"===$.text||"++"===$.text)):"TK_OPERATOR"===M&&(e=t($.text,["--","-","++","+"])&&t(F.last_text,["--","-","++","+"]),t($.text,["+","-"])&&t(F.last_text,["--","++"])&&(i=!0)),F.mode!==d.BlockStatement&&F.mode!==d.Statement||"{"!==F.last_text&&";"!==F.last_text||h()):":"===$.text?0===F.ternary_depth?e=!1:F.ternary_depth-=1:"?"===$.text?F.ternary_depth+=1:"*"===$.text&&"TK_RESERVED"===M&&"function"===F.last_text&&(e=!1,i=!1),_.space_before_token=_.space_before_token||e,f(),_.space_before_token=i}else f()}else f()},TK_COMMA:function(){return F.declaration_statement?(b(F.parent.mode)&&(F.declaration_assignment=!1),f(),void(F.declaration_assignment?(F.declaration_assignment=!1,h(!1,!0)):(_.space_before_token=!0,P.comma_first&&u()))):(f(),void(F.mode===d.ObjectLiteral||F.mode===d.Statement&&F.parent.mode===d.ObjectLiteral?(F.mode===d.Statement&&y(),h()):(_.space_before_token=!0,P.comma_first&&u())))},TK_BLOCK_COMMENT:function(){if(_.raw)return _.add_raw_token($),void($.directives&&"end"===$.directives.preserve&&(P.test_output_raw||(_.raw=!1)));if($.directives)return h(!1,!0),f(),"start"===$.directives.preserve&&(_.raw=!0),void h(!1,!0);if(!c.newline.test($.text)&&!$.wanted_newline)return _.space_before_token=!0,f(),void(_.space_before_token=!0);var e,t=function(e){for(var t=[],i=(e=e.replace(/\x0d/g,"")).indexOf("\n");-1!==i;)t.push(e.substring(0,i)),i=(e=e.substring(i+1)).indexOf("\n");return e.length&&t.push(e),t}($.text),i=!1,s=!1,o=$.whitespace_before,r=o.length;for(h(!1,!0),t.length>1&&(C(t.slice(1),"*")?i=!0:function(e,t){for(var i,n=0,s=e.length;n<s;n++)if((i=e[n])&&0!==i.indexOf(t))return!1;return!0}(t.slice(1),o)&&(s=!0)),f(t[0]),e=1;e<t.length;e++)h(!1,!0),i?f(" "+n(t[e])):s&&t[e].length>r?f(t[e].substring(r)):_.add_token(t[e]);h(!1,!0)},TK_COMMENT:function(){$.wanted_newline?h(!1,!0):_.trim(!0),_.space_before_token=!0,f(),h(!1,!0)},TK_DOT:function(){x(),"TK_RESERVED"===M&&E(F.last_text)?_.space_before_token=!0:u(")"===F.last_text&&P.break_chained_methods),f()},TK_UNKNOWN:function(){f(),"\n"===$.text[$.text.length-1]&&h()},TK_EOF:function(){for(;F.mode===d.Statement;)y()}},P={},void 0!==(s=s||{}).braces_on_own_line&&(P.brace_style=s.braces_on_own_line?"expand":"collapse"),P.brace_style=s.brace_style?s.brace_style:P.brace_style?P.brace_style:"collapse","expand-strict"===P.brace_style&&(P.brace_style="expand"),P.indent_size=s.indent_size?parseInt(s.indent_size,10):4,P.indent_char=s.indent_char?s.indent_char:" ",P.eol=s.eol?s.eol:"\n",P.preserve_newlines=void 0===s.preserve_newlines||s.preserve_newlines,P.break_chained_methods=void 0!==s.break_chained_methods&&s.break_chained_methods,P.max_preserve_newlines=void 0===s.max_preserve_newlines?0:parseInt(s.max_preserve_newlines,10),P.space_in_paren=void 0!==s.space_in_paren&&s.space_in_paren,P.space_in_empty_paren=void 0!==s.space_in_empty_paren&&s.space_in_empty_paren,P.jslint_happy=void 0!==s.jslint_happy&&s.jslint_happy,P.space_after_anon_function=void 0!==s.space_after_anon_function&&s.space_after_anon_function,P.keep_array_indentation=void 0!==s.keep_array_indentation&&s.keep_array_indentation,P.space_before_conditional=void 0===s.space_before_conditional||s.space_before_conditional,P.unescape_strings=void 0!==s.unescape_strings&&s.unescape_strings,P.wrap_line_length=void 0===s.wrap_line_length?0:parseInt(s.wrap_line_length,10),P.e4x=void 0!==s.e4x&&s.e4x,P.end_with_newline=void 0!==s.end_with_newline&&s.end_with_newline,P.comma_first=void 0!==s.comma_first&&s.comma_first,P.test_output_raw=void 0!==s.test_output_raw&&s.test_output_raw,P.jslint_happy&&(P.space_after_anon_function=!0),s.indent_with_tabs&&(P.indent_char="\t",P.indent_size=1),P.eol=P.eol.replace(/\\r/,"\r").replace(/\\n/,"\n"),O="";P.indent_size>0;)O+=P.indent_char,P.indent_size-=1;var U=0;if(e&&e.length){for(;" "===e.charAt(U)||"\t"===e.charAt(U);)H+=e.charAt(U),U+=1;e=e.substring(U)}M="TK_START_BLOCK",A="",(_=new a(O,H)).raw=P.test_output_raw,L=[],g(d.BlockStatement),this.beautify=function(){var t,i;for(D=new l(e,P,O),B=D.tokenize(),S=0;t=T();){for(var n=0;n<t.comments_before.length;n++)r(t.comments_before[n]);r(t),A=F.last_text,M=t.type,F.last_text=t.text,S+=1}return i=_.get_code(),P.end_with_newline&&(i+="\n"),"\n"!=P.eol&&(i=i.replace(/[\n]/g,P.eol)),i}}function r(e){var t=0,i=-1,n=[],s=!0;this.set_indent=function(n){t=e.baseIndentLength+n*e.indent_length,i=n},this.get_character_count=function(){return t},this.is_empty=function(){return s},this.last=function(){return this._empty?null:n[n.length-1]},this.push=function(e){n.push(e),t+=e.length,s=!1},this.pop=function(){var e=null;return s||(e=n.pop(),t-=e.length,s=0===n.length),e},this.remove_indent=function(){i>0&&(i-=1,t-=e.indent_length)},this.trim=function(){for(;" "===this.last();)n.pop(),t-=1;s=0===n.length},this.toString=function(){var t="";return this._empty||(i>=0&&(t=e.indent_cache[i]),t+=n.join("")),t}}function a(e,t){t=t||"",this.indent_cache=[t],this.baseIndentLength=t.length,this.indent_length=e.length,this.raw=!1;var i=[];this.baseIndentString=t,this.indent_string=e,this.previous_line=null,this.current_line=null,this.space_before_token=!1,this.add_outputline=function(){this.previous_line=this.current_line,this.current_line=new r(this),i.push(this.current_line)},this.add_outputline(),this.get_line_number=function(){return i.length},this.add_new_line=function(e){return!(1===this.get_line_number()&&this.just_added_newline()||!e&&this.just_added_newline()||(this.raw||this.add_outputline(),0))},this.get_code=function(){return i.join("\n").replace(/[\r\n\t ]+$/,"")},this.set_indent=function(e){if(i.length>1){for(;e>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);return this.current_line.set_indent(e),!0}return this.current_line.set_indent(0),!1},this.add_raw_token=function(e){for(var t=0;t<e.newlines;t++)this.add_outputline();this.current_line.push(e.whitespace_before),this.current_line.push(e.text),this.space_before_token=!1},this.add_token=function(e){this.add_space_before_token(),this.current_line.push(e)},this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" "),this.space_before_token=!1},this.remove_redundant_indentation=function(e){if(!e.multiline_frame&&e.mode!==d.ForInitializer&&e.mode!==d.Conditional)for(var t=e.start_line_index,n=i.length;t<n;)i[t].remove_indent(),t++},this.trim=function(n){for(n=void 0!==n&&n,this.current_line.trim(e,t);n&&i.length>1&&this.current_line.is_empty();)i.pop(),this.current_line=i[i.length-1],this.current_line.trim();this.previous_line=i.length>1?i[i.length-2]:null},this.just_added_newline=function(){return this.current_line.is_empty()},this.just_added_blankline=function(){return!!this.just_added_newline()&&(1===i.length||i[i.length-2].is_empty())}}function l(e,n,s){function o(e){if(!e.match(E))return null;var t={};T.lastIndex=0;for(var i=T.exec(e);i;)t[i[1]]=i[2],i=T.exec(e);return t}function r(){var s,r,E=[];if(f=0,m="",b>=y)return["","TK_EOF"];r=v.length?v[v.length-1]:new u("TK_START_BLOCK","{");var T=e.charAt(b);for(b+=1;t(T,a);){if(c.newline.test(T)?"\n"===T&&"\r"===e.charAt(b-2)||(f+=1,E=[]):E.push(T),b>=y)return["","TK_EOF"];T=e.charAt(b),b+=1}if(E.length&&(m=E.join("")),l.test(T)){var S=!0,D=!0,$=l;for("0"===T&&b<y&&/[Xxo]/.test(e.charAt(b))?(S=!1,D=!1,T+=e.charAt(b),b+=1,$=/[o]/.test(e.charAt(b))?d:h):(T="",b-=1);b<y&&$.test(e.charAt(b));)T+=e.charAt(b),b+=1,S&&b<y&&"."===e.charAt(b)&&(T+=e.charAt(b),b+=1,S=!1),D&&b<y&&/[Ee]/.test(e.charAt(b))&&(T+=e.charAt(b),(b+=1)<y&&/[+-]/.test(e.charAt(b))&&(T+=e.charAt(b),b+=1),D=!1,S=!1);return[T,"TK_WORD"]}if(c.isIdentifierStart(e.charCodeAt(b-1))){if(b<y)for(;c.isIdentifierChar(e.charCodeAt(b))&&(T+=e.charAt(b),(b+=1)!==y););return"TK_DOT"===r.type||"TK_RESERVED"===r.type&&t(r.text,["set","get"])||!t(T,w)?[T,"TK_WORD"]:"in"===T?[T,"TK_OPERATOR"]:[T,"TK_RESERVED"]}if("("===T||"["===T)return[T,"TK_START_EXPR"];if(")"===T||"]"===T)return[T,"TK_END_EXPR"];if("{"===T)return[T,"TK_START_BLOCK"];if("}"===T)return[T,"TK_END_BLOCK"];if(";"===T)return[T,"TK_SEMICOLON"];if("/"===T){var M="";if("*"===e.charAt(b)){var A;b+=1,x.lastIndex=b,M="/*"+(A=x.exec(e))[0],b+=A[0].length;var O=o(M);return O&&"start"===O.ignore&&(k.lastIndex=b,M+=(A=k.exec(e))[0],b+=A[0].length),[M=M.replace(c.lineBreak,"\n"),"TK_BLOCK_COMMENT",O]}if("/"===e.charAt(b))return b+=1,C.lastIndex=b,M="//"+(A=C.exec(e))[0],b+=A[0].length,[M,"TK_COMMENT"]}if("`"===T||"'"===T||'"'===T||("/"===T||n.e4x&&"<"===T&&e.slice(b-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/))&&("TK_RESERVED"===r.type&&t(r.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===r.type&&")"===r.text&&r.parent&&"TK_RESERVED"===r.parent.type&&t(r.parent.text,["if","while","for"])||t(r.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var F=T,N=!1,L=!1;if(s=T,"/"===F)for(var R=!1;b<y&&(N||R||e.charAt(b)!==F)&&!c.newline.test(e.charAt(b));)s+=e.charAt(b),N?N=!1:(N="\\"===e.charAt(b),"["===e.charAt(b)?R=!0:"]"===e.charAt(b)&&(R=!1)),b+=1;else if(n.e4x&&"<"===F){var I=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])(\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{.*?}))*\s*(\/?)\s*>/g,P=e.slice(b-1),B=I.exec(P);if(B&&0===B.index){for(var H=B[2],U=0;B;){var z=!!B[1],j=B[2],K=!!B[B.length-1]||"![CDATA["===j.slice(0,8);if(j!==H||K||(z?--U:++U),U<=0)break;B=I.exec(P)}var W=B?B.index+B[0].length:P.length;return P=P.slice(0,W),b+=W-1,[P=P.replace(c.lineBreak,"\n"),"TK_STRING"]}}else for(;b<y&&(N||e.charAt(b)!==F&&("`"===F||!c.newline.test(e.charAt(b))));)(N||"`"===F)&&c.newline.test(e.charAt(b))?("\r"===e.charAt(b)&&"\n"===e.charAt(b+1)&&(b+=1),s+="\n"):s+=e.charAt(b),N?("x"!==e.charAt(b)&&"u"!==e.charAt(b)||(L=!0),N=!1):N="\\"===e.charAt(b),b+=1;if(L&&n.unescape_strings&&(s=function(e){for(var t,i=!1,n="",s=0,o="",r=0;i||s<e.length;)if(t=e.charAt(s),s++,i){if(i=!1,"x"===t)o=e.substr(s,2),s+=2;else{if("u"!==t){n+="\\"+t;continue}o=e.substr(s,4),s+=4}if(!o.match(/^[0123456789abcdefABCDEF]+$/))return e;if((r=parseInt(o,16))>=0&&r<32){n+="x"===t?"\\x"+o:"\\u"+o;continue}if(34===r||39===r||92===r)n+="\\"+String.fromCharCode(r);else{if("x"===t&&r>126&&r<=255)return e;n+=String.fromCharCode(r)}}else"\\"===t?i=!0:n+=t;return n}(s)),b<y&&e.charAt(b)===F&&(s+=F,b+=1,"/"===F))for(;b<y&&c.isIdentifierStart(e.charCodeAt(b));)s+=e.charAt(b),b+=1;return[s,"TK_STRING"]}if("#"===T){if(0===v.length&&"!"===e.charAt(b)){for(s=T;b<y&&"\n"!==T;)s+=T=e.charAt(b),b+=1;return[i(s)+"\n","TK_UNKNOWN"]}var V="#";if(b<y&&l.test(e.charAt(b))){do{V+=T=e.charAt(b),b+=1}while(b<y&&"#"!==T&&"="!==T);return"#"===T||("["===e.charAt(b)&&"]"===e.charAt(b+1)?(V+="[]",b+=2):"{"===e.charAt(b)&&"}"===e.charAt(b+1)&&(V+="{}",b+=2)),[V,"TK_WORD"]}}if("<"===T&&("?"===e.charAt(b)||"%"===e.charAt(b))){_.lastIndex=b-1;var Y=_.exec(e);if(Y)return T=Y[0],b+=T.length-1,[T=T.replace(c.lineBreak,"\n"),"TK_STRING"]}if("<"===T&&"\x3c!--"===e.substring(b-1,b+3)){for(b+=3,T="\x3c!--";!c.newline.test(e.charAt(b))&&b<y;)T+=e.charAt(b),b++;return g=!0,[T,"TK_COMMENT"]}if("-"===T&&g&&"--\x3e"===e.substring(b-1,b+2))return g=!1,b+=2,["--\x3e","TK_COMMENT"];if("."===T)return[T,"TK_DOT"];if(t(T,p)){for(;b<y&&t(T+e.charAt(b),p)&&(T+=e.charAt(b),!((b+=1)>=y)););return","===T?[T,"TK_COMMA"]:"="===T?[T,"TK_EQUALS"]:[T,"TK_OPERATOR"]}return[T,"TK_UNKNOWN"]}var a="\n\r\t ".split(""),l=/[0-9]/,d=/[01234567]/,h=/[0123456789abcdefABCDEF]/,p="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: =>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var f,m,g,v,b,y,w=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof","yield","async","await"]),x=/([\s\S]*?)((?:\*\/)|$)/g,C=/([^\n\r\u2028\u2029]*)/g,E=/\/\* beautify( \w+[:]\w+)+ \*\//g,T=/ (\w+)[:](\w+)/g,k=/([\s\S]*?)((?:\/\*\sbeautify\signore:end\s\*\/)|$)/g,_=/((<\?php|<\?=)[\s\S]*?\?>)|(<%[\s\S]*?%>)/g;this.tokenize=function(){y=e.length,b=0,g=!1,v=[];for(var t,i,n,s=null,o=[],a=[];!i||"TK_EOF"!==i.type;){for(n=r(),t=new u(n[1],n[0],f,m);"TK_COMMENT"===t.type||"TK_BLOCK_COMMENT"===t.type||"TK_UNKNOWN"===t.type;)"TK_BLOCK_COMMENT"===t.type&&(t.directives=n[2]),a.push(t),n=r(),t=new u(n[1],n[0],f,m);a.length&&(t.comments_before=a,a=[]),"TK_START_BLOCK"===t.type||"TK_START_EXPR"===t.type?(t.parent=i,o.push(s),s=t):("TK_END_BLOCK"===t.type||"TK_END_EXPR"===t.type)&&s&&("]"===t.text&&"["===s.text||")"===t.text&&"("===s.text||"}"===t.text&&"{"===s.text)&&(t.parent=s.parent,s=o.pop()),v.push(t),i=t}return v}}var c={};!function(e){var t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",i=new RegExp("["+t+"]"),n=new RegExp("["+t+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]");e.newline=/[\n\r\u2028\u2029]/,e.lineBreak=new RegExp("\r\n|"+e.newline.source),e.allLineBreaks=new RegExp(e.lineBreak.source,"g"),e.isIdentifierStart=function(e){return e<65?36===e||64===e:e<91||(e<97?95===e:e<123||e>=170&&i.test(String.fromCharCode(e)))},e.isIdentifierChar=function(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>=170&&n.test(String.fromCharCode(e))))}}(c);var d={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},u=function(e,t,i,n,s,o){this.type=e,this.text=t,this.comments_before=[],this.newlines=i||0,this.wanted_newline=i>0,this.whitespace_before=n||"",this.parent=null,this.directives=null};return{run:function(t,i){function n(e){return e.replace(/\s+$/g,"")}var o,r,a,l,c,d,u,h,p,f,m,g,v,b;for(void 0!==(i=i||{}).wrap_line_length&&0!==parseInt(i.wrap_line_length,10)||void 0===i.max_char||0===parseInt(i.max_char,10)||(i.wrap_line_length=i.max_char),r=void 0!==i.indent_inner_html&&i.indent_inner_html,a=void 0===i.indent_size?4:parseInt(i.indent_size,10),l=void 0===i.indent_char?" ":i.indent_char,d=void 0===i.brace_style?"collapse":i.brace_style,c=0===parseInt(i.wrap_line_length,10)?32786:parseInt(i.wrap_line_length||250,10),u=i.unformatted||["a","span","img","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","address","pre"],h=void 0===i.preserve_newlines||i.preserve_newlines,p=h?isNaN(parseInt(i.max_preserve_newlines,10))?32786:parseInt(i.max_preserve_newlines,10):0,f=void 0!==i.indent_handlebars&&i.indent_handlebars,m=void 0===i.wrap_attributes?"auto":i.wrap_attributes,g=void 0===i.wrap_attributes_indent_size?a:parseInt(i.wrap_attributes_indent_size,10)||a,v=void 0!==i.end_with_newline&&i.end_with_newline,b=Array.isArray(i.extra_liners)?i.extra_liners.concat():"string"==typeof i.extra_liners?i.extra_liners.split(","):"head,body,/html".split(","),i.indent_with_tabs&&(l="\t",a=1),(o=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=r,this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,source,!doctype,basefont,base,area,hr,wbr,param,img,isindex,embed".split(","),extra_liners:b,in_array:function(e,t){for(var i=0;i<t.length;i++)if(e==t[i])return!0;return!1}},this.is_whitespace=function(e){for(;0<e.length;e++)if(!this.Utils.in_array(e.charAt(0),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var e="";if(e=this.input.charAt(this.pos),this.Utils.in_array(e,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(e,this.Utils.whitespace);)h&&"\n"==e&&this.newlines<=p&&(this.newlines+=1),this.pos++,e=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(e){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,e),this.print_indentation(e)):(this.line_char_count++,e.push(" "))},this.get_content=function(){for(var e="",t=[];"<"!=this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(t);else{if(f){var i=this.input.substr(this.pos,3);if("{{#"==i||"{{/"==i)break;if("{{!"==i)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"==this.input.substr(this.pos,2)&&"{{else}}"==this.get_tag(!0))break}e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",i=new RegExp("</"+e+"\\s*>","igm");i.lastIndex=this.pos;var n=i.exec(this.input),s=n?n.index:this.input.length;return this.pos<s&&(t=this.input.substring(this.pos,s),this.pos=s),t},this.record_tag=function(e){this.tags[e+"count"]?(this.tags[e+"count"]++,this.tags[e+this.tags[e+"count"]]=this.indent_level):(this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level),this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.indent_to_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!=t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]])}},this.get_tag=function(e){var t,i,n="",s=[],o="",r=!1,a=!0,c=this.pos,d=this.line_char_count;e=void 0!==e&&e;do{if(this.pos>=this.input.length)return e&&(this.pos=c,this.line_char_count=d),s.length?s.join(""):["","TK_EOF"];if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace))r=!0;else{if("'"!=n&&'"'!=n||(n+=this.get_unformatted(n),r=!0),"="==n&&(r=!1),s.length&&"="!=s[s.length-1]&&">"!=n&&r){if(this.space_or_wrap(s),r=!1,!a&&"force"==m&&"/"!=n){this.print_newline(!0,s),this.print_indentation(s);for(var h=0;h<g;h++)s.push(l)}for(var p=0;p<s.length;p++)if(" "==s[p]){a=!1;break}}if(f&&"<"==i&&n+this.input.charAt(this.pos)=="{{"&&(n+=this.get_unformatted("}}"),s.length&&" "!=s[s.length-1]&&"<"!=s[s.length-1]&&(n=" "+n),r=!0),"<"!=n||i||(t=this.pos-1,i="<"),f&&!i&&s.length>=2&&"{"==s[s.length-1]&&"{"==s[s.length-2]&&(t="#"==n||"/"==n||"!"==n?this.pos-3:this.pos-2,i="{"),this.line_char_count++,s.push(n),s[1]&&("!"==s[1]||"?"==s[1]||"%"==s[1])){s=[this.get_comment(t)];break}if(f&&s[1]&&"{"==s[1]&&s[2]&&"!"==s[2]){s=[this.get_comment(t)];break}if(f&&"{"==i&&s.length>2&&"}"==s[s.length-2]&&"}"==s[s.length-1])break}}while(">"!=n);var v,b,y=s.join("");v=-1!=y.indexOf(" ")?y.indexOf(" "):"{"==y[0]?y.indexOf("}"):y.indexOf(">"),b="<"!=y[0]&&f?"#"==y[2]?3:2:1;var w=y.substring(b,v).toLowerCase();return"/"==y.charAt(y.length-2)||this.Utils.in_array(w,this.Utils.single_token)?e||(this.tag_type="SINGLE"):f&&"{"==y[0]&&"else"==w?e||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(w,u)?(o=this.get_unformatted("</"+w+">",y),s.push(o),this.pos,this.tag_type="SINGLE"):"script"==w&&(-1==y.search("type")||y.search("type")>-1&&y.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?e||(this.record_tag(w),this.tag_type="SCRIPT"):"style"==w&&(-1==y.search("type")||y.search("type")>-1&&y.search("text/css")>-1)?e||(this.record_tag(w),this.tag_type="STYLE"):"!"==w.charAt(0)?e||(this.tag_type="SINGLE",this.traverse_whitespace()):e||("/"==w.charAt(0)?(this.retrieve_tag(w.substring(1)),this.tag_type="END"):(this.record_tag(w),"html"!=w.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(s),this.Utils.in_array(w,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!=this.output[this.output.length-2]&&this.print_newline(!0,this.output))),e&&(this.pos=c,this.line_char_count=d),s.join("")},this.get_comment=function(e){var t="",i=">",n=!1;this.pos=e;var s=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length&&((t+=s)[t.length-1]!=i[i.length-1]||-1==t.indexOf(i));)!n&&t.length<10&&(0===t.indexOf("<![if")?(i="<![endif]>",n=!0):0===t.indexOf("<![cdata[")?(i="]]>",n=!0):0===t.indexOf("<![")?(i="]>",n=!0):0===t.indexOf("\x3c!--")?(i="--\x3e",n=!0):0===t.indexOf("{{!")?(i="}}",n=!0):0===t.indexOf("<?")?(i="?>",n=!0):0===t.indexOf("<%")&&(i="%>",n=!0)),s=this.input.charAt(this.pos),this.pos++;return t},this.get_unformatted=function(e,t){if(t&&-1!=t.toLowerCase().indexOf(e))return"";var i="",n="",s=0,o=!0;do{if(this.pos>=this.input.length)return n;if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace)){if(!o){this.line_char_count--;continue}if("\n"==i||"\r"==i){n+="\n",this.line_char_count=0;continue}}n+=i,this.line_char_count++,o=!0,f&&"{"==i&&n.length&&"{"==n[n.length-2]&&(s=(n+=this.get_unformatted("}}")).length)}while(-1==n.toLowerCase().indexOf(e,s));return n},this.get_token=function(){var e;if("TK_TAG_SCRIPT"==this.last_token||"TK_TAG_STYLE"==this.last_token){var t=this.last_token.substr(7);return"string"!=typeof(e=this.get_contents_to(t))?e:[e,"TK_"+t]}return"CONTENT"==this.current_mode?"string"!=typeof(e=this.get_content())?e:[e,"TK_CONTENT"]:"TAG"==this.current_mode?"string"!=typeof(e=this.get_tag())?e:[e,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(e){return(e=this.indent_level+e||0)<1?"":new Array(e+1).join(this.indent_string)},this.is_unformatted=function(e,t){if(!this.Utils.in_array(e,t))return!1;if("a"!=e.toLowerCase()||!this.Utils.in_array("a",t))return!0;var i=(this.get_tag(!0)||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(i&&!this.Utils.in_array(i,t))},this.printer=function(e,t,i,s,o){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=i,this.brace_style=o,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var r=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){this.line_char_count=0,t&&t.length&&(e||"\n"!=t[t.length-1])&&("\n"!=t[t.length-1]&&(t[t.length-1]=n(t[t.length-1])),t.push("\n"))},this.print_indentation=function(e){for(var t=0;t<this.indent_level;t++)e.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){this.is_whitespace(e)&&!this.output.length||((e||""!==e)&&this.output.length&&"\n"==this.output[this.output.length-1]&&(this.print_indentation(this.output),e=function(e){return e.replace(/^\s+/g,"")}(e)),this.print_token_raw(e))},this.print_token_raw=function(e){this.newlines>0&&(e=n(e)),e&&""!==e&&(e.length>1&&"\n"==e[e.length-1]?(this.output.push(e.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(e));for(var t=0;t<this.newlines;t++)this.print_newline(t>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}).printer(t,l,a,c,d);;){var y=o.get_token();if(o.token_text=y[0],o.token_type=y[1],"TK_EOF"==o.token_type)break;switch(o.token_type){case"TK_TAG_START":o.print_newline(!1,o.output),o.print_token(o.token_text),o.indent_content&&(o.indent(),o.indent_content=!1),o.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"==o.last_token&&""===o.last_text){var w=o.token_text.match(/\w+/)[0],x=null;o.output.length&&(x=o.output[o.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null==x||x[1]!=w&&!o.Utils.in_array(x[1],u))&&o.print_newline(!1,o.output)}o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var C=o.token_text.match(/^\s*<([a-z-]+)/i);C&&o.Utils.in_array(C[1],u)||o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":o.print_token(o.token_text),o.indent_content&&(o.indent(),o.indent_content=!1),o.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":case"TK_CONTENT":o.print_token(o.token_text),o.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==o.token_text){o.print_newline(!1,o.output);var E,T=o.token_text,k=1;"TK_SCRIPT"==o.token_type?E=s:"TK_STYLE"==o.token_type&&(E=e),"keep"==i.indent_scripts?k=0:"separate"==i.indent_scripts&&(k=-o.indent_level);var _=o.get_full_indent(k);if(E)T=E(T.replace(/^\s*/,_),i);else{var S=T.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(o.indent_string).length-1,D=o.get_full_indent(k-S);T=T.replace(/^\s*/,_).replace(/\r\n|\r|\n/g,"\n"+D).replace(/\s+$/,"")}T&&(o.print_token_raw(T),o.print_newline(!0,o.output))}o.current_mode="TAG";break;default:""!==o.token_text&&o.print_token(o.token_text)}o.last_token=o.token_type,o.last_text=o.token_text}var $=o.output.join("").replace(/[\r\n\t ]+$/,"");return v&&($+="\n"),$}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{codeMirror:!0,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]}),e.FE.PLUGINS.codeView=function(t){function i(){return t.$box.hasClass("fr-code-view")}function n(){return d?d.getValue():c.val()}function s(e){var i=n();t.html.set(i),t.$el.blur(),t.$tb.find(" > .fr-command").not(e).removeClass("fr-disabled").attr("aria-disabled",!1),e.removeClass("fr-active").attr("aria-pressed",!1),t.events.focus(!0),t.placeholder.refresh(),t.undo.saveStep()}function o(i){c||(l(),!d&&t.opts.codeMirror&&"undefined"!=typeof CodeMirror?d=CodeMirror.fromTextArea(c.get(0),t.opts.codeMirrorOptions):t.events.$on(c,"keydown keyup change input",function(){if(t.opts.height)this.rows=null;else if(this.rows||(this.rows=1),0===this.value.length)this.rows=1;else{for(this.style.height="auto";this.rows>1&&this.scrollHeight<=this.offsetHeight;)this.rows-=1;for(;this.scrollHeight>this.offsetHeight&&(!t.opts.heightMax||this.offsetHeight<t.opts.heightMax);)this.rows+=1}})),t.undo.saveStep(),t.html.cleanEmptyTags(),t.html.cleanWhiteTags(!0),t.core.hasFocus()&&(t.core.isEmpty()||(t.selection.save(),t.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),t.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var n,s,o=t.html.get(!1,!0);if(t.$el.find("span.fr-tmp").remove(),t.$box.toggleClass("fr-code-view",!0),t.core.hasFocus()&&t.$el.blur(),o=(o=o.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM")).replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),t.codeBeautifier&&(o=t.codeBeautifier.run(o,t.opts.codeBeautifierOptions)),d){(n=o.indexOf("FROALA-SM"))>(s=o.indexOf("FROALA-EM"))?n=s:s-=9;var r=(o=o.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).substring(0,n).length-o.substring(0,n).replace(/\n/g,"").length,a=o.substring(0,s).length-o.substring(0,s).replace(/\n/g,"").length;n=o.substring(0,n).length-o.substring(0,o.substring(0,n).lastIndexOf("\n")+1).length,s=o.substring(0,s).length-o.substring(0,o.substring(0,s).lastIndexOf("\n")+1).length,d.setSize(null,t.opts.height?t.opts.height:"auto"),t.opts.heightMin&&t.$box.find(".CodeMirror-scroll").css("min-height",t.opts.heightMin),d.setValue(o),d.focus(),d.setSelection({line:r,ch:n},{line:a,ch:s}),d.refresh(),d.clearHistory()}else{n=o.indexOf("FROALA-SM"),s=o.indexOf("FROALA-EM")-9,t.opts.heightMin&&c.css("min-height",t.opts.heightMin),t.opts.height&&c.css("height",t.opts.height),t.opts.heightMax&&c.css("max-height",t.opts.height||t.opts.heightMax),c.val(o.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var u=e(t.o_doc).scrollTop();c.focus(),c.get(0).setSelectionRange(n,s),e(t.o_doc).scrollTop(u)}t.$tb.find(" > .fr-command").not(i).filter(function(){return t.opts.codeViewKeepActiveButtons.indexOf(e(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0),i.addClass("fr-active").attr("aria-pressed",!0),!t.helpers.isMobile()&&t.opts.toolbarInline&&t.toolbar.hide()}function r(e){void 0===e&&(e=!i());var n=t.$tb.find('.fr-command[data-cmd="html"]');e?(t.popups.hideAll(),o(n)):(t.$box.toggleClass("fr-code-view",!1),s(n))}function a(){i()&&r(t.$tb.find('button[data-cmd="html"]')),d&&d.toTextArea(),c.val("").removeData().remove(),c=null,u&&(u.remove(),u=null)}function l(){c=e('<textarea class="fr-code" tabIndex="-1">'),t.$wp.append(c),c.attr("dir",t.opts.direction),t.$box.hasClass("fr-basic")||(u=e('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(t.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"></i></button>'),t.$box.append(u),t.events.bindClick(t.$box,"a.html-switch",function(){r(!1)}));var s=function(){return!i()};t.events.on("buttons.refresh",s),t.events.on("copy",s,!0),t.events.on("cut",s,!0),t.events.on("paste",s,!0),t.events.on("destroy",a,!0),t.events.on("html.set",function(){i()&&r(!0)}),t.events.on("form.submit",function(){i()&&(t.html.set(n()),t.events.trigger("contentChanged",[],!0))},!0)}var c,d,u;return{_init:function(){if(!t.$wp)return!1},toggle:r,isActive:i,get:n}},e.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),e.FE.DefineIcon("html",{NAME:"code"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"colors.picker":"[_BUTTONS_][_TEXT_COLORS_][_BACKGROUND_COLORS_]"}),e.extend(e.FE.DEFAULTS,{colorsText:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsBackground:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorsDefaultTab:"text",colorsButtons:["colorsBack","|","-"]}),e.FE.PLUGINS.colors=function(t){function i(){t.popups.hide("colors.picker")}function n(){var e='<div class="fr-buttons fr-colors-buttons">';t.opts.toolbarInline&&t.opts.colorsButtons.length>0&&(e+=t.button.buildList(t.opts.colorsButtons));var i={buttons:e+=function(){var e='<div class="fr-colors-tabs fr-group">';return e+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"":"fr-selected-tab ")+'fr-command" tabIndex="-1" role="button" aria-pressed="'+("background"!=t.opts.colorsDefaultTab)+'" data-param1="text" data-cmd="colorChangeSet" title="'+t.language.translate("Text")+'">'+t.language.translate("Text")+"</span>",(e+='<span class="fr-colors-tab '+("background"==t.opts.colorsDefaultTab?"fr-selected-tab ":"")+'fr-command" tabIndex="-1" role="button" aria-pressed="'+("background"==t.opts.colorsDefaultTab)+'" data-param1="background" data-cmd="colorChangeSet" title="'+t.language.translate("Background")+'">'+t.language.translate("Background")+"</span>")+"</div>"}()+"</div>",text_colors:s("text"),background_colors:s("background")},n=t.popups.create("colors.picker",i);return o(n),n}function s(e){for(var i="text"==e?t.opts.colorsText:t.opts.colorsBackground,n='<div class="fr-color-set fr-'+e+"-color"+(t.opts.colorsDefaultTab==e||"text"!=t.opts.colorsDefaultTab&&"background"!=t.opts.colorsDefaultTab&&"text"==e?" fr-selected-set":"")+'">',s=0;s<i.length;s++)0!==s&&s%t.opts.colorsStep==0&&(n+="<br>"),n+="REMOVE"!=i[s]?'<span class="fr-command fr-select-color" style="background: '+i[s]+';" tabIndex="-1" aria-selected="false" role="button" data-cmd="'+e+'Color" data-param1="'+i[s]+'"><span class="fr-sr-only">'+t.language.translate("Color")+" "+i[s]+"&nbsp;&nbsp;&nbsp;</span></span>":'<span class="fr-command fr-select-color" data-cmd="'+e+'Color" tabIndex="-1" role="button" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'">'+t.icon.create("remove")+'<span class="fr-sr-only">'+t.language.translate("Clear Formatting")+"</span></span>";return n+"</div>"}function o(i){t.events.on("popup.tab",function(n){var s=e(n.currentTarget);if(!t.popups.isVisible("colors.picker")||!s.is("span"))return!0;var o=n.which,r=!0;if(e.FE.KEYCODE.TAB==o){var a=i.find(".fr-buttons");r=!t.accessibility.focusToolbar(a,!!n.shiftKey)}else if(e.FE.KEYCODE.ARROW_UP==o||e.FE.KEYCODE.ARROW_DOWN==o||e.FE.KEYCODE.ARROW_LEFT==o||e.FE.KEYCODE.ARROW_RIGHT==o){if(s.is("span.fr-select-color")){var l=s.parent().find("span.fr-select-color"),c=l.index(s),d=t.opts.colorsStep,u=Math.floor(l.length/d),h=c%d,p=Math.floor(c/d)*d+h,f=u*d;e.FE.KEYCODE.ARROW_UP==o?p=((p-d)%f+f)%f:e.FE.KEYCODE.ARROW_DOWN==o?p=(p+d)%f:e.FE.KEYCODE.ARROW_LEFT==o?p=((p-1)%f+f)%f:e.FE.KEYCODE.ARROW_RIGHT==o&&(p=(p+1)%f);var m=e(l.get(p));t.events.disableBlur(),m.focus(),r=!1}}else e.FE.KEYCODE.ENTER==o&&(t.button.exec(s),r=!1);return!1===r&&(n.preventDefault(),n.stopPropagation()),r},!0)}function r(i){var n,s=t.popups.get("colors.picker"),o=e(t.selection.element());n="background"==i?"background-color":"color";var r=s.find(".fr-"+i+"-color .fr-select-color");for(r.find(".fr-selected-color").remove(),r.removeClass("fr-active-item"),r.not('[data-param1="REMOVE"]').attr("aria-selected",!1);o.get(0)!=t.el;){if("transparent"!=o.css(n)&&"rgba(0, 0, 0, 0)"!=o.css(n)){var a=s.find(".fr-"+i+'-color .fr-select-color[data-param1="'+t.helpers.RGBToHex(o.css(n))+'"]');a.append('<span class="fr-selected-color" aria-hidden="true"></span>'),a.addClass("fr-active-item").attr("aria-selected",!0);break}o=o.parent()}}return{showColorsPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="color"]'),i=t.popups.get("colors.picker");if(i||(i=n()),!i.hasClass("fr-active"))if(t.popups.setContainer("colors.picker",t.$tb),r(i.find(".fr-selected-tab").attr("data-param1")),e.is(":visible")){var s=e.offset().left+e.outerWidth()/2,o=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("colors.picker",s,o,e.outerHeight())}else t.position.forSelection(i),t.popups.show("colors.picker")},hideColorsPopup:i,changeSet:function(e,i){e.hasClass("fr-selected-tab")||(e.siblings().removeClass("fr-selected-tab").attr("aria-pressed",!1),e.addClass("fr-selected-tab").attr("aria-pressed",!0),e.parents(".fr-popup").find(".fr-color-set").removeClass("fr-selected-set"),e.parents(".fr-popup").find(".fr-color-set.fr-"+i+"-color").addClass("fr-selected-set"),r(i)),t.accessibility.focusPopup(e.parents(".fr-popup"))},background:function(e){"REMOVE"!=e?t.format.applyStyle("background-color",t.helpers.HEXtoRGB(e)):t.format.removeStyle("background-color"),i()},text:function(e){"REMOVE"!=e?t.format.applyStyle("color",t.helpers.HEXtoRGB(e)):t.format.removeStyle("color"),i()},back:function(){t.popups.hide("colors.picker"),t.toolbar.showInline()}}},e.FE.DefineIcon("colors",{NAME:"tint"}),e.FE.RegisterCommand("color",{title:"Colors",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("colors.picker")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("colors.picker")):this.colors.showColorsPopup()},plugin:"colors"}),e.FE.RegisterCommand("textColor",{undo:!0,callback:function(e,t){this.colors.text(t)}}),e.FE.RegisterCommand("backgroundColor",{undo:!0,callback:function(e,t){this.colors.background(t)}}),e.FE.RegisterCommand("colorChangeSet",{undo:!1,focus:!1,callback:function(e,t){var i=this.popups.get("colors.picker").find('.fr-command[data-cmd="'+e+'"][data-param1="'+t+'"]');this.colors.changeSet(i,t)}}),e.FE.DefineIcon("colorsBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("colorsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.colors.back()}}),e.FE.DefineIcon("remove",{NAME:"eraser"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"file.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_PROGRESS_BAR_]"}),e.extend(e.FE.DEFAULTS,{fileUploadURL:"https://i.froala.com/upload",fileUploadParam:"file",fileUploadParams:{},fileUploadToS3:!1,fileUploadMethod:"POST",fileMaxSize:10485760,fileAllowedTypes:["*"],fileInsertButtons:["fileBack","|"],fileUseSelectedText:!1}),e.FE.PLUGINS.file=function(t){function i(){var e=t.popups.get("file.insert");e||(e=g()),e.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),e.find(".fr-file-progress-bar-layer").addClass("fr-active"),e.find(".fr-buttons").hide(),s("Uploading",0)}function n(e){var i=t.popups.get("file.insert");i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-file-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),e&&(t.events.focus(),t.popups.hide("file.insert")))}function s(e,i){var n=t.popups.get("file.insert");if(n){var s=n.find(".fr-file-progress-bar-layer");s.find("h3").text(e+(i?" "+i+"%":"")),s.removeClass("fr-error"),i?(s.find("div").removeClass("fr-indeterminate"),s.find("div > span").css("width",i+"%")):s.find("div").addClass("fr-indeterminate")}}function o(e,i,n){t.edit.on(),t.events.focus(!0),t.selection.restore(),t.opts.fileUseSelectedText&&t.selection.text().length&&(i=t.selection.text()),t.html.insert('<a href="'+e+'" id="fr-inserted-file" class="fr-file">'+i+"</a>");var s=t.$el.find("#fr-inserted-file");s.removeAttr("id"),t.popups.hide("file.insert"),t.undo.saveStep(),y(),t.events.trigger("file.inserted",[s,n])}function r(i){try{if(!1===t.events.trigger("file.uploaded",[i],!0))return t.edit.on(),!1;var n=e.parseJSON(i);return n.link?n:(u(x,i),!1)}catch(e){return u(E,i),!1}}function a(i){try{var n=e(i).find("Location").text(),s=e(i).find("Key").text();return!1===t.events.trigger("file.uploadedToS3",[n,s,i],!0)?(t.edit.on(),!1):n}catch(e){return u(E,i),!1}}function l(e){var i=this.status,n=this.response,s=this.responseXML,l=this.responseText;try{if(t.opts.fileUploadToS3)if(201==i){var c=a(s);c&&o(c,e,n||s)}else u(E,n||s);else if(i>=200&&i<300){var d=r(l);d&&o(d.link,e,n||l)}else u(C,n||l)}catch(e){u(E,n||l)}}function c(){u(E,this.response||this.responseText||this.responseXML)}function d(e){e.lengthComputable&&s("Uploading",e.loaded/e.total*100|0)}function u(e,n){t.edit.on(),function(e){i();var n=t.popups.get("file.insert").find(".fr-file-progress-bar-layer");n.addClass("fr-error");var s=n.find("h3");s.text(e),t.events.disableBlur(),s.focus()}(t.language.translate("Something went wrong. Please try again.")),t.events.trigger("file.error",[{code:e,message:_[e]},n])}function h(){t.edit.on(),n(!0)}function p(e){if(void 0!==e&&e.length>0){if(!1===t.events.trigger("file.beforeUpload",[e]))return!1;var n,s=e[0];if(s.size>t.opts.fileMaxSize)return u(T),!1;if(t.opts.fileAllowedTypes.indexOf("*")<0&&t.opts.fileAllowedTypes.indexOf(s.type.replace(/file\//g,""))<0)return u(k),!1;if(t.drag_support.formdata&&(n=t.drag_support.formdata?new FormData:null),n){var o;if(!1!==t.opts.fileUploadToS3)for(o in n.append("key",t.opts.fileUploadToS3.keyStart+(new Date).getTime()+"-"+(s.name||"untitled")),n.append("success_action_status","201"),n.append("X-Requested-With","xhr"),n.append("Content-Type",s.type),t.opts.fileUploadToS3.params)t.opts.fileUploadToS3.params.hasOwnProperty(o)&&n.append(o,t.opts.fileUploadToS3.params[o]);for(o in t.opts.fileUploadParams)t.opts.fileUploadParams.hasOwnProperty(o)&&n.append(o,t.opts.fileUploadParams[o]);n.append(t.opts.fileUploadParam,s);var r=t.opts.fileUploadURL;t.opts.fileUploadToS3&&(r=t.opts.fileUploadToS3.uploadURL?t.opts.fileUploadToS3.uploadURL:"https://"+t.opts.fileUploadToS3.region+".amazonaws.com/"+t.opts.fileUploadToS3.bucket);var a=t.core.getXHR(r,t.opts.fileUploadMethod);a.onload=function(){l.call(a,s.name)},a.onerror=c,a.upload.onprogress=d,a.onabort=h,i(),t.edit.off();var p=t.popups.get("file.insert");p&&p.off("abortUpload").on("abortUpload",function(){4!=a.readyState&&a.abort()}),a.send(n)}}}function f(i){t.events.$on(i,"dragover dragenter",".fr-file-upload-layer",function(){return e(this).addClass("fr-drop"),!1},!0),t.events.$on(i,"dragleave dragend",".fr-file-upload-layer",function(){return e(this).removeClass("fr-drop"),!1},!0),t.events.$on(i,"drop",".fr-file-upload-layer",function(n){n.preventDefault(),n.stopPropagation(),e(this).removeClass("fr-drop");var s=n.originalEvent.dataTransfer;s&&s.files&&(i.data("instance")||t).file.upload(s.files)},!0),t.events.$on(i,"change",'.fr-file-upload-layer input[type="file"]',function(){this.files&&(i.data("instance")||t).file.upload(this.files);e(this).val("")},!0)}function m(){n()}function g(e){if(e)return t.popups.onHide("file.insert",m),!0;var i={buttons:'<div class="fr-buttons">'+t.button.buildList(t.opts.fileInsertButtons)+"</div>",upload_layer:'<div class="fr-file-upload-layer fr-layer fr-active" id="fr-file-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop file")+"</strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" name="'+t.opts.fileUploadParam+'" accept="/*" tabIndex="-1" aria-labelledby="fr-file-upload-layer-'+t.id+'" role="button"></div></div>',progress_bar:'<div class="fr-file-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="fileDismissError" tabIndex="2" role="button">OK</button></div></div>'},n=t.popups.create("file.insert",i);return f(n),n}function v(e){if(t.node.hasClass(e,"fr-file"))return t.events.trigger("file.unlink",[e])}function b(n){var s=n.originalEvent.dataTransfer;if(s&&s.files&&s.files.length){var o=s.files[0];if(o&&void 0!==o.type&&o.type.indexOf("image")<0&&(t.opts.fileAllowedTypes.indexOf(o.type)>=0||t.opts.fileAllowedTypes.indexOf("*")>=0)){t.markers.remove(),t.markers.insertAtPoint(n.originalEvent),t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.popups.hideAll();var r=t.popups.get("file.insert");return r||(r=g()),t.popups.setContainer("file.insert",e(t.opts.scrollableContainer)),t.popups.show("file.insert",n.originalEvent.pageX,n.originalEvent.pageY),i(),p(s.files),n.preventDefault(),n.stopPropagation(),!1}}}function y(){var e,i=Array.prototype.slice.call(t.el.querySelectorAll("a.fr-file")),n=[];for(e=0;e<i.length;e++)n.push(i[e].getAttribute("href"));if(w)for(e=0;e<w.length;e++)n.indexOf(w[e].getAttribute("href"))<0&&t.events.trigger("file.unlink",[w[e]]);w=i}var w,x=2,C=3,E=4,T=5,k=6,_={};return _[1]="File cannot be loaded from the passed link.",_[x]="No link in upload response.",_[C]="Error during file upload.",_[E]="Parsing response failed.",_[T]="File is too large.",_[k]="File file type is invalid.",_[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",{_init:function(){t.events.on("drop",b),t.events.$on(t.$win,"keydown",function(i){var n=i.which,s=t.popups.get("file.insert");s&&n==e.FE.KEYCODE.ESC&&s.trigger("abortUpload")}),t.events.on("destroy",function(){var e=t.popups.get("file.insert");e&&e.trigger("abortUpload")}),t.events.on("link.beforeRemove",v),t.$wp&&(y(),t.events.on("contentChanged",y)),g(!0)},showInsertPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="insertFile"]'),i=t.popups.get("file.insert");if(i||(i=g()),n(),!i.hasClass("fr-active")){t.popups.refresh("file.insert"),t.popups.setContainer("file.insert",t.$tb);var s=e.offset().left+e.outerWidth()/2,o=e.offset().top+(t.opts.toolbarBottom?0:e.outerHeight());t.popups.show("file.insert",s,o,e.outerHeight())}},upload:p,insert:o,back:function(){t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("file.insert"),t.toolbar.showInline()},hideProgressBar:n}},e.FE.DefineIcon("insertFile",{NAME:"file"}),e.FE.RegisterCommand("insertFile",{title:"Upload File",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("file.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("file.insert")):this.file.showInsertPopup()},plugin:"file"}),e.FE.DefineIcon("fileBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("fileBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.file.back()},refresh:function(e){this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("fileDismissError",{title:"OK",callback:function(){this.file.hideProgressBar(!0)}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{emoticons:"[_BUTTONS_][_EMOTICONS_]"}),e.extend(e.FE.DEFAULTS,{emoticonsStep:8,emoticonsSet:[{code:"1f600",desc:"Grinning face"},{code:"1f601",desc:"Grinning face with smiling eyes"},{code:"1f602",desc:"Face with tears of joy"},{code:"1f603",desc:"Smiling face with open mouth"},{code:"1f604",desc:"Smiling face with open mouth and smiling eyes"},{code:"1f605",desc:"Smiling face with open mouth and cold sweat"},{code:"1f606",desc:"Smiling face with open mouth and tightly-closed eyes"},{code:"1f607",desc:"Smiling face with halo"},{code:"1f608",desc:"Smiling face with horns"},{code:"1f609",desc:"Winking face"},{code:"1f60a",desc:"Smiling face with smiling eyes"},{code:"1f60b",desc:"Face savoring delicious food"},{code:"1f60c",desc:"Relieved face"},{code:"1f60d",desc:"Smiling face with heart-shaped eyes"},{code:"1f60e",desc:"Smiling face with sunglasses"},{code:"1f60f",desc:"Smirking face"},{code:"1f610",desc:"Neutral face"},{code:"1f611",desc:"Expressionless face"},{code:"1f612",desc:"Unamused face"},{code:"1f613",desc:"Face with cold sweat"},{code:"1f614",desc:"Pensive face"},{code:"1f615",desc:"Confused face"},{code:"1f616",desc:"Confounded face"},{code:"1f617",desc:"Kissing face"},{code:"1f618",desc:"Face throwing a kiss"},{code:"1f619",desc:"Kissing face with smiling eyes"},{code:"1f61a",desc:"Kissing face with closed eyes"},{code:"1f61b",desc:"Face with stuck out tongue"},{code:"1f61c",desc:"Face with stuck out tongue and winking eye"},{code:"1f61d",desc:"Face with stuck out tongue and tightly-closed eyes"},{code:"1f61e",desc:"Disappointed face"},{code:"1f61f",desc:"Worried face"},{code:"1f620",desc:"Angry face"},{code:"1f621",desc:"Pouting face"},{code:"1f622",desc:"Crying face"},{code:"1f623",desc:"Persevering face"},{code:"1f624",desc:"Face with look of triumph"},{code:"1f625",desc:"Disappointed but relieved face"},{code:"1f626",desc:"Frowning face with open mouth"},{code:"1f627",desc:"Anguished face"},{code:"1f628",desc:"Fearful face"},{code:"1f629",desc:"Weary face"},{code:"1f62a",desc:"Sleepy face"},{code:"1f62b",desc:"Tired face"},{code:"1f62c",desc:"Grimacing face"},{code:"1f62d",desc:"Loudly crying face"},{code:"1f62e",desc:"Face with open mouth"},{code:"1f62f",desc:"Hushed face"},{code:"1f630",desc:"Face with open mouth and cold sweat"},{code:"1f631",desc:"Face screaming in fear"},{code:"1f632",desc:"Astonished face"},{code:"1f633",desc:"Flushed face"},{code:"1f634",desc:"Sleeping face"},{code:"1f635",desc:"Dizzy face"},{code:"1f636",desc:"Face without mouth"},{code:"1f637",desc:"Face with medical mask"}],emoticonsButtons:["emoticonsBack","|"],emoticonsUseImage:!0}),e.FE.PLUGINS.emoticons=function(t){function i(){var e="";t.opts.toolbarInline&&t.opts.emoticonsButtons.length>0&&(e='<div class="fr-buttons fr-emoticons-buttons">'+t.button.buildList(t.opts.emoticonsButtons)+"</div>");var i={buttons:e,emoticons:n()},o=t.popups.create("emoticons",i);return t.tooltip.bind(o,".fr-emoticon"),s(o),o}function n(){for(var e='<div style="text-align: center">',i=0;i<t.opts.emoticonsSet.length;i++)0!==i&&i%t.opts.emoticonsStep==0&&(e+="<br>"),e+='<span class="fr-command fr-emoticon" tabIndex="-1" data-cmd="insertEmoticon" title="'+t.language.translate(t.opts.emoticonsSet[i].desc)+'" role="button" data-param1="'+t.opts.emoticonsSet[i].code+'">'+(t.opts.emoticonsUseImage?'<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/'+t.opts.emoticonsSet[i].code+'.svg"/>':"&#x"+t.opts.emoticonsSet[i].code+";")+'<span class="fr-sr-only">'+t.language.translate(t.opts.emoticonsSet[i].desc)+"&nbsp;&nbsp;&nbsp;</span></span>";return t.opts.emoticonsUseImage&&(e+='<p style="font-size: 12px; text-align: center; padding: 0 5px;">Emoji free by <a class="fr-link" tabIndex="-1" href="http://emojione.com/" target="_blank" rel="nofollow" role="link" aria-label="Open Emoji One website.">Emoji One</a></p>'),e+"</div>"}function s(i){t.events.on("popup.tab",function(n){var s=e(n.currentTarget);if(!t.popups.isVisible("emoticons")||!s.is("span, a"))return!0;var o,r,a,l=n.which;if(e.FE.KEYCODE.TAB==l){if(s.is("span.fr-emoticon")&&n.shiftKey||s.is("a")&&!n.shiftKey){var c=i.find(".fr-buttons");o=!t.accessibility.focusToolbar(c,!!n.shiftKey)}if(!1!==o){var d=i.find("span.fr-emoticon:focus:first, span.fr-emoticon:visible:first, a");s.is("span.fr-emoticon")&&(d=d.not("span.fr-emoticon:not(:focus)")),r=d.index(s),r=n.shiftKey?((r-1)%d.length+d.length)%d.length:(r+1)%d.length,a=d.get(r),t.events.disableBlur(),a.focus(),o=!1}}else if(e.FE.KEYCODE.ARROW_UP==l||e.FE.KEYCODE.ARROW_DOWN==l||e.FE.KEYCODE.ARROW_LEFT==l||e.FE.KEYCODE.ARROW_RIGHT==l){if(s.is("span.fr-emoticon")){var u=s.parent().find("span.fr-emoticon");r=u.index(s);var h=t.opts.emoticonsStep,p=Math.floor(u.length/h),f=r%h,m=Math.floor(r/h)*h+f,g=p*h;e.FE.KEYCODE.ARROW_UP==l?m=((m-h)%g+g)%g:e.FE.KEYCODE.ARROW_DOWN==l?m=(m+h)%g:e.FE.KEYCODE.ARROW_LEFT==l?m=((m-1)%g+g)%g:e.FE.KEYCODE.ARROW_RIGHT==l&&(m=(m+1)%g),a=e(u.get(m)),t.events.disableBlur(),a.focus(),o=!1}}else e.FE.KEYCODE.ENTER==l&&(s.is("a")?s[0].click():t.button.exec(s),o=!1);return!1===o&&(n.preventDefault(),n.stopPropagation()),o},!0)}return{_init:function(){var i=function(){for(var e=t.el.querySelectorAll(".fr-emoticon:not(.fr-deletable)"),i=0;i<e.length;i++)e[i].className+=" fr-deletable"};i(),t.events.on("html.set",i),t.events.on("html.get",function(i){for(var n=0;n<t.opts.emoticonsSet.length;n++){var s=t.opts.emoticonsSet[n],o=e("<div>").html(s.code).text();i=i.split(o).join(s.code)}return i});var n=function(){if(!t.selection.isCollapsed())return!1;var e=t.selection.element(),i=t.selection.endElement();if(e&&t.node.hasClass(e,"fr-emoticon"))return e;if(i&&t.node.hasClass(i,"fr-emoticon"))return i;var n=t.selection.ranges(0),s=n.startContainer;if(s.nodeType==Node.ELEMENT_NODE&&s.childNodes.length>0&&n.startOffset>0){var o=s.childNodes[n.startOffset-1];if(t.node.hasClass(o,"fr-emoticon"))return o}return!1};t.events.on("keydown",function(i){if(t.keys.isCharacter(i.which)&&t.selection.inEditor()){var s=t.selection.ranges(0),o=n();o&&(0===s.startOffset&&t.selection.element()===o?e(o).before(e.FE.MARKERS+e.FE.INVISIBLE_SPACE):e(o).after(e.FE.INVISIBLE_SPACE+e.FE.MARKERS),t.selection.restore())}}),t.events.on("keyup",function(i){for(var s=t.el.querySelectorAll(".fr-emoticon"),o=0;o<s.length;o++)void 0!==s[o].textContent&&0===s[o].textContent.replace(/\u200B/gi,"").length&&e(s[o]).remove();if(!(i.which>=e.FE.KEYCODE.ARROW_LEFT&&i.which<=e.FE.KEYCODE.ARROW_DOWN)){var r=n();t.node.hasClass(r,"fr-emoticon-img")&&(e(r).append(e.FE.MARKERS),t.selection.restore())}})},insert:function(i,n){t.html.insert('<span class="fr-emoticon fr-deletable'+(n?" fr-emoticon-img":"")+'"'+(n?' style="background: url('+n+');"':"")+">"+(n?"&nbsp;":i)+"</span>&nbsp;"+e.FE.MARKERS,!0)},showEmoticonsPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="emoticons"]'),n=t.popups.get("emoticons");if(n||(n=i()),!n.hasClass("fr-active")){t.popups.refresh("emoticons"),t.popups.setContainer("emoticons",t.$tb);var s=e.offset().left+e.outerWidth()/2,o=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("emoticons",s,o,e.outerHeight())}},hideEmoticonsPopup:function(){t.popups.hide("emoticons")},back:function(){t.popups.hide("emoticons"),t.toolbar.showInline()}}},e.FE.DefineIcon("emoticons",{NAME:"smile"}),e.FE.RegisterCommand("emoticons",{title:"Emoticons",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("emoticons")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("emoticons")):this.emoticons.showEmoticonsPopup()},plugin:"emoticons"}),e.FE.RegisterCommand("insertEmoticon",{callback:function(e,t){this.emoticons.insert("&#x"+t+";",this.opts.emoticonsUseImage?"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/"+t+".svg":null),this.emoticons.hideEmoticonsPopup()}}),e.FE.DefineIcon("emoticonsBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("emoticonsBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.emoticons.back()}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{dragInline:!0}),e.FE.PLUGINS.draggable=function(t){function i(i){return i.target&&"A"==i.target.tagName&&1==i.target.childNodes.length&&"IMG"==i.target.childNodes[0].tagName&&(i.target=i.target.childNodes[0]),e(i.target).hasClass("fr-draggable")?(t.undo.canDo()||t.undo.saveStep(),t.opts.dragInline?t.$el.attr("contenteditable",!0):t.$el.attr("contenteditable",!1),t.opts.toolbarInline&&t.toolbar.hide(),e(i.target).addClass("fr-dragging"),t.browser.msie||t.browser.edge||t.selection.clear(),void i.originalEvent.dataTransfer.setData("text","Froala")):(i.preventDefault(),!1)}function n(e){return!(e&&("HTML"==e.tagName||"BODY"==e.tagName||t.node.isElement(e)))}function s(e,i,n){t.opts.iframe&&(e+=t.$iframe.offset().top,i+=t.$iframe.offset().left),u.offset().top!=e&&u.css("top",e),u.offset().left!=i&&u.css("left",i),u.width()!=n&&u.css("width",n)}function o(i){var o=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset);if(!n(o)){for(var r=0,a=o;!n(a)&&a==o&&i.originalEvent.pageY-t.win.pageYOffset-r>0;)r++,a=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset-r);(!n(a)||u&&0===t.$el.find(a).length&&a!=u.get(0))&&(a=null);for(var l=0,c=o;!n(c)&&c==o&&i.originalEvent.pageY-t.win.pageYOffset+l<e(t.doc).height();)l++,c=t.doc.elementFromPoint(i.originalEvent.pageX-t.win.pageXOffset,i.originalEvent.pageY-t.win.pageYOffset+l);(!n(c)||u&&0===t.$el.find(c).length&&c!=u.get(0))&&(c=null),o=null==c&&a?a:c&&null==a?c:c&&a?r<l?a:c:null}if(e(o).hasClass("fr-drag-helper"))return!1;if(o&&!t.node.isBlock(o)&&(o=t.node.blockParent(o)),o&&["TD","TH","TR","THEAD","TBODY"].indexOf(o.tagName)>=0&&(o=e(o).parents("table").get(0)),o&&["LI"].indexOf(o.tagName)>=0&&(o=e(o).parents("UL, OL").get(0)),o&&!e(o).hasClass("fr-drag-helper")){var d;u||(e.FE.$draggable_helper||(e.FE.$draggable_helper=e('<div class="fr-drag-helper"></div>')),u=e.FE.$draggable_helper,t.events.on("shared.destroy",function(){u.html("").removeData().remove(),u=null},!0)),d=i.originalEvent.pageY<e(o).offset().top+e(o).outerHeight()/2;var h=e(o),p=0;d||0!==h.next().length?(d||(h=h.next()),"before"==u.data("fr-position")&&h.is(u.data("fr-tag"))||(h.prev().length>0&&(p=parseFloat(h.prev().css("margin-bottom"))||0),p=Math.max(p,parseFloat(h.css("margin-top"))||0),s(h.offset().top-p/2-t.$box.offset().top,h.offset().left-t.win.pageXOffset-t.$box.offset().left,h.width()),u.data("fr-position","before"))):"after"==u.data("fr-position")&&h.is(u.data("fr-tag"))||(p=parseFloat(h.css("margin-bottom"))||0,s(h.offset().top+e(o).height()+p/2-t.$box.offset().top,h.offset().left-t.win.pageXOffset-t.$box.offset().left,h.width()),u.data("fr-position","after")),u.data("fr-tag",h),u.addClass("fr-visible"),u.appendTo(t.$box)}else u&&t.$box.find(u).length>0&&u.removeClass("fr-visible")}function r(e){e.originalEvent.dataTransfer.dropEffect="move",t.opts.dragInline?c()||!t.browser.msie&&!t.browser.edge||e.preventDefault():(e.preventDefault(),o(e))}function a(e){e.originalEvent.dataTransfer.dropEffect="move",t.opts.dragInline||e.preventDefault()}function l(e){t.$el.attr("contenteditable",!0);var i=t.$el.find(".fr-dragging");u&&u.hasClass("fr-visible")&&t.$box.find(u).length?d(e):i.length&&(e.preventDefault(),e.stopPropagation()),u&&t.$box.find(u).length&&u.removeClass("fr-visible"),i.removeClass("fr-dragging")}function c(){for(var t=null,i=0;i<e.FE.INSTANCES.length;i++)if((t=e.FE.INSTANCES[i].$el.find(".fr-dragging")).length)return t.get(0)}function d(i){for(var n,s,o=0;o<e.FE.INSTANCES.length;o++)if((n=e.FE.INSTANCES[o].$el.find(".fr-dragging")).length){s=e.FE.INSTANCES[o];break}if(n.length){if(i.preventDefault(),i.stopPropagation(),u&&u.hasClass("fr-visible")&&t.$box.find(u).length)u.data("fr-tag")[u.data("fr-position")]('<span class="fr-marker"></span>'),u.removeClass("fr-visible");else if(!1===t.markers.insertAtPoint(i.originalEvent))return!1;n.removeClass("fr-dragging");var r=n;if(n.parent().is("A")&&(r=n.parent()),t.core.isEmpty())t.events.focus();else t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.selection.restore();if(s==t||t.undo.canDo()||t.undo.saveStep(),t.core.isEmpty())t.$el.html(r);else{var a=t.markers.insert();e(a).replaceWith(r),n.after(e.FE.MARKERS),t.selection.restore()}return t.popups.hideAll(),t.selection.save(),t.$el.find(t.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),t.html.wrap(),t.html.fillEmptyBlocks(),t.selection.restore(),t.undo.saveStep(),t.opts.iframe&&t.size.syncIframe(),s!=t&&(s.popups.hideAll(),s.$el.find(s.html.emptyBlockTagsQuery()).not("TD, TH, LI, .fr-inner").remove(),s.html.wrap(),s.html.fillEmptyBlocks(),s.undo.saveStep(),s.events.trigger("element.dropped"),s.opts.iframe&&s.size.syncIframe()),t.events.trigger("element.dropped",[r]),!1}}var u;return{_init:function(){t.opts.enter==e.FE.ENTER_BR&&(t.opts.dragInline=!0),t.events.on("dragstart",i,!0),t.events.on("dragover",r,!0),t.events.on("dragenter",a,!0),t.events.on("document.dragend",l,!0),t.events.on("document.drop",l,!0),t.events.on("drop",d,!0),t.events.on("html.get",function(e){return e.replace(/<(div)((?:[\w\W]*?))class="([\w\W]*?)fr-drag-helper([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/(div)>/g,"")})}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{fontSize:["8","9","10","11","12","14","18","24","30","36","48","60","72","96"],fontSizeSelection:!1,fontSizeDefaultSelection:"12"}),e.FE.PLUGINS.fontSize=function(t){return{apply:function(e){t.format.applyStyle("font-size",e)},refreshOnShow:function(i,n){var s=e(t.selection.element()).css("font-size");n.find(".fr-command.fr-active").removeClass("fr-active").attr("aria-selected",!1),n.find('.fr-command[data-param1="'+s+'"]').addClass("fr-active").attr("aria-selected",!0);var o=n.find(".fr-dropdown-list"),r=n.find(".fr-active").parent();r.length?o.parent().scrollTop(r.offset().top-o.offset().top-(o.parent().outerHeight()/2-r.outerHeight()/2)):o.parent().scrollTop(0)},refresh:function(i){if(t.opts.fontSizeSelection){var n=t.helpers.getPX(e(t.selection.element()).css("font-size"));i.find("> span").text(n)}}}},e.FE.RegisterCommand("fontSize",{type:"dropdown",title:"Font Size",displaySelection:function(e){return e.opts.fontSizeSelection},displaySelectionWidth:30,defaultSelection:function(e){return e.opts.fontSizeDefaultSelection},html:function(){for(var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.fontSize,i=0;i<t.length;i++){var n=t[i];e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="fontSize" data-param1="'+n+'px" title="'+n+'">'+n+"</a></li>"}return e+"</ul>"},callback:function(e,t){this.fontSize.apply(t)},refresh:function(e){this.fontSize.refresh(e)},refreshOnShow:function(e,t){this.fontSize.refreshOnShow(e,t)},plugin:"fontSize"}),e.FE.DefineIcon("fontSize",{NAME:"text-height"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{fontFamily:{"Arial,Helvetica,sans-serif":"Arial","Georgia,serif":"Georgia","Impact,Charcoal,sans-serif":"Impact","Tahoma,Geneva,sans-serif":"Tahoma","Times New Roman,Times,serif":"Times New Roman","Verdana,Geneva,sans-serif":"Verdana"},fontFamilySelection:!1,fontFamilyDefaultSelection:"Font Family"}),e.FE.PLUGINS.fontFamily=function(t){function i(t){var i=t.replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'| /g,"").split(",");return e.grep(i,function(e){return e.length>0})}function n(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(e[i]==t[n])return[i,n];return null}function s(){var s=i(e(t.selection.element()).css("font-family")),o=[];for(var r in t.opts.fontFamily)if(t.opts.fontFamily.hasOwnProperty(r)){var a=n(s,i(r));a&&o.push([r,a])}return 0===o.length?null:(o.sort(function(e,t){var i=e[1][0]-t[1][0];return 0===i?e[1][1]-t[1][1]:i}),o[0][0])}return{apply:function(e){t.format.applyStyle("font-family",e)},refreshOnShow:function(e,t){t.find(".fr-command.fr-active").removeClass("fr-active").attr("aria-selected",!1),t.find('.fr-command[data-param1="'+s()+'"]').addClass("fr-active").attr("aria-selected",!0);var i=t.find(".fr-dropdown-list"),n=t.find(".fr-active").parent();n.length?i.parent().scrollTop(n.offset().top-i.offset().top-(i.parent().outerHeight()/2-n.outerHeight()/2)):i.parent().scrollTop(0)},refresh:function(i){if(t.opts.fontFamilySelection){var n=e(t.selection.element()).css("font-family").replace(/(sans-serif|serif|monospace|cursive|fantasy)/gi,"").replace(/"|'|/g,"").split(",");i.find("> span").text(t.opts.fontFamily[s()]||n[0]||t.opts.fontFamilyDefaultSelection)}}}},e.FE.RegisterCommand("fontFamily",{type:"dropdown",displaySelection:function(e){return e.opts.fontFamilySelection},defaultSelection:function(e){return e.opts.fontFamilyDefaultSelection},displaySelectionWidth:120,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.fontFamily;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="fontFamily" data-param1="'+i+'" style="font-family: '+i+'" title="'+t[i]+'">'+t[i]+"</a></li>");return e+"</ul>"},title:"Font Family",callback:function(e,t){this.fontFamily.apply(t)},refresh:function(e){this.fontFamily.refresh(e)},refreshOnShow:function(e,t){this.fontFamily.refreshOnShow(e,t)},plugin:"fontFamily"}),e.FE.DefineIcon("fontFamily",{NAME:"font"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUploadURL:"https://i.froala.com/upload",imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif","svg+xml"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1}),e.FE.PLUGINS.image=function(t){function i(){var e=t.popups.get("image.insert").find(".fr-image-by-url-layer input");e.val(""),Z&&e.val(Z.attr("src")),e.trigger("change")}function n(){var i=t.popups.get("image.edit");if(i||(i=f()),i){t.popups.setContainer("image.edit",e(t.opts.scrollableContainer)),t.popups.refresh("image.edit");var n=Z.offset().left+Z.outerWidth()/2,s=Z.offset().top+Z.outerHeight();t.popups.show("image.edit",n,s,Z.outerHeight())}}function s(){g()}function o(e){if(!e.hasClass("fr-dii")&&!e.hasClass("fr-dib")){var i=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",i),t.opts.imageEditButtons.indexOf("imageAlign")>=0&&(0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fil"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fir")),e.addClass("fr-dib")):(e.css("float",i),t.opts.imageEditButtons.indexOf("imageAlign")>=0&&("left"==e.css("float")?e.addClass("fr-fil"):"right"==e.css("float")&&e.addClass("fr-fir")),e.addClass("fr-dii")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}}function r(){for(var i="IMG"==t.el.tagName?[t.el]:t.el.querySelectorAll("img"),n=0;n<i.length;n++){var s=e(i[n]);(t.opts.imageEditButtons.indexOf("imageAlign")>=0||t.opts.imageEditButtons.indexOf("imageDisplay")>=0)&&o(s),t.opts.imageTextNear||s.removeClass("fr-dii").addClass("fr-dib"),t.opts.iframe&&s.on("load",t.size.syncIframe)}}function a(){var i,n=Array.prototype.slice.call(t.el.querySelectorAll("img")),s=[];for(i=0;i<n.length;i++)s.push(n[i].getAttribute("src")),e(n[i]).toggleClass("fr-draggable",t.opts.imageMove),""===n[i].getAttribute("class")&&n[i].removeAttribute("class"),""===n[i].getAttribute("style")&&n[i].removeAttribute("style");if(de)for(i=0;i<de.length;i++)s.indexOf(de[i].getAttribute("src"))<0&&t.events.trigger("image.removed",[e(de[i])]);de=n}function l(){J||function(){var i;if(t.shared.$image_resizer?(J=t.shared.$image_resizer,te=t.shared.$img_overlay,t.events.on("destroy",function(){J.removeClass("fr-active").appendTo(e("body"))},!0)):(t.shared.$image_resizer=e('<div class="fr-image-resizer"></div>'),J=t.shared.$image_resizer,t.events.$on(J,"mousedown",function(e){e.stopPropagation()},!0),t.opts.imageResize&&(J.append(c("nw")+c("ne")+c("sw")+c("se")),t.shared.$img_overlay=e('<div class="fr-image-overlay"></div>'),te=t.shared.$img_overlay,i=J.get(0).ownerDocument,e(i).find("body").append(te))),t.events.on("shared.destroy",function(){J.html("").removeData().remove(),J=null,t.opts.imageResize&&(te.remove(),te=null)},!0),t.helpers.isMobile()||t.events.$on(e(t.o_win),"resize",function(){Z&&!Z.hasClass("fr-uploading")?V(!0):Z&&(l(),G(),m(!1))}),t.opts.imageResize){i=J.get(0).ownerDocument,t.events.$on(J,t._mousedown,".fr-handler",d),t.events.$on(e(i),t._mousemove,u),t.events.$on(e(i.defaultView||i.parentWindow),t._mouseup,h),t.events.$on(te,"mouseleave",h);var n=1,s=null,o=0;t.events.on("keydown",function(i){if(Z){var r=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,a=i.which;(a!==s||i.timeStamp-o>200)&&(n=1),(a==e.FE.KEYCODE.EQUALS||t.browser.mozilla&&a==e.FE.KEYCODE.FF_EQUALS)&&r&&!i.altKey?n=B.call(this,i,1,1,n):(a==e.FE.KEYCODE.HYPHEN||t.browser.mozilla&&a==e.FE.KEYCODE.FF_HYPHEN)&&r&&!i.altKey&&(n=B.call(this,i,2,-1,n)),s=a,o=i.timeStamp}},!0),t.events.on("keyup",function(){n=1})}}();var i=t.$wp||e(t.opts.scrollableContainer);i.append(J),J.data("instance",t);var n=i.scrollTop()-("static"!=i.css("position")?i.offset().top:0),s=i.scrollLeft()-("static"!=i.css("position")?i.offset().left:0);s-=t.helpers.getPX(i.css("border-left-width")),n-=t.helpers.getPX(i.css("border-top-width")),t.$el.is("img")&&(n=0,s=0),J.css("top",(t.opts.iframe?Z.offset().top:Z.offset().top+n)-1).css("left",(t.opts.iframe?Z.offset().left:Z.offset().left+s)-1).css("width",Z.get(0).getBoundingClientRect().width).css("height",Z.get(0).getBoundingClientRect().height).addClass("fr-active")}function c(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function d(i){if(!t.core.sameInstance(J))return!0;if(i.preventDefault(),i.stopPropagation(),t.$el.find("img.fr-error").left)return!1;t.undo.canDo()||t.undo.saveStep(),(ee=e(this)).data("start-x",i.pageX||i.originalEvent.touches[0].pageX),ee.data("start-width",Z.width()),ee.data("start-height",Z.height());var n=Z.width();if(t.opts.imageResizeWithPercent){var s=Z.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.el;Z.css("width",(n/e(s).outerWidth()*100).toFixed(2)+"%")}else Z.css("width",n);te.show(),t.popups.hideAll(),q()}function u(i){if(!t.core.sameInstance(J))return!0;if(ee&&Z){if(i.preventDefault(),t.$el.find("img.fr-error").left)return!1;var n=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null);if(!n)return!1;var s=n-ee.data("start-x"),o=ee.data("start-width");if((ee.hasClass("fr-hnw")||ee.hasClass("fr-hsw"))&&(s=0-s),t.opts.imageResizeWithPercent){var r=Z.parentsUntil(t.$el,t.html.blockTagsQuery()).get(0)||t.el;o=((o+s)/e(r).outerWidth()*100).toFixed(2),t.opts.imageRoundPercent&&(o=Math.round(o)),Z.css("width",o+"%"),Z.css("height","").removeAttr("height")}else o+s>=t.opts.imageMinWidth&&Z.css("width",o+s),Z.css("height",ee.data("start-height")*Z.width()/ee.data("start-width"));l(),t.events.trigger("image.resize",[Q()])}}function h(e){if(!t.core.sameInstance(J))return!0;if(ee&&Z){if(e&&e.stopPropagation(),t.$el.find("img.fr-error").left)return!1;ee=null,te.hide(),l(),n(),t.undo.saveStep(),t.events.trigger("image.resizeEnd",[Q()])}}function p(e,i){t.edit.on(),Z&&Z.addClass("fr-error"),function(e){m();var i=t.popups.get("image.insert").find(".fr-image-progress-bar-layer");i.addClass("fr-error");var n=i.find("h3");n.text(e),t.events.disableBlur(),n.focus()}(t.language.translate("Something went wrong. Please try again.")),t.events.trigger("image.error",[{code:e,message:ce[e]},i])}function f(e){if(e)return t.$wp&&t.events.$on(t.$wp,"scroll",function(){Z&&t.popups.isVisible("image.edit")&&n()}),!0;var i="";if(t.opts.imageEditButtons.length>0){i+='<div class="fr-buttons">',i+=t.button.buildList(t.opts.imageEditButtons);var s={buttons:i+="</div>"};return t.popups.create("image.edit",s)}return!1}function m(i){var n=t.popups.get("image.insert");if(n||(n=O()),n.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),n.find(".fr-image-progress-bar-layer").addClass("fr-active"),n.find(".fr-buttons").hide(),Z){t.popups.setContainer("image.insert",e(t.opts.scrollableContainer));var s=Z.offset().left+Z.width()/2,o=Z.offset().top+Z.height();t.popups.show("image.insert",s,o,Z.outerHeight())}void 0===i&&v("Uploading",0)}function g(e){var i=t.popups.get("image.insert");if(i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-image-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),e||t.$el.find("img.fr-error").length)){if(t.events.focus(),t.$el.find("img.fr-error").length&&(t.$el.find("img.fr-error").remove(),t.undo.saveStep(),t.undo.run(),t.undo.dropRedo()),!t.$wp&&Z){var n=Z;V(!0),t.selection.setAfter(n.get(0)),t.selection.restore()}t.popups.hide("image.insert")}}function v(e,i){var n=t.popups.get("image.insert");if(n){var s=n.find(".fr-image-progress-bar-layer");s.find("h3").text(e+(i?" "+i+"%":"")),s.removeClass("fr-error"),i?(s.find("div").removeClass("fr-indeterminate"),s.find("div > span").css("width",i+"%")):s.find("div").addClass("fr-indeterminate")}}function b(e){W.call(e.get(0))}function y(){var i=e(this);t.popups.hide("image.insert"),i.removeClass("fr-uploading"),i.next().is("br")&&i.next().remove(),b(i),t.events.trigger("image.loaded",[i])}function w(e,i,n,s,o){t.edit.off(),v("Loading image"),i&&(e=t.helpers.sanitizeURL(e));var r=new Image;r.onload=function(){var i,r;if(s){t.undo.canDo()||s.hasClass("fr-uploading")||t.undo.saveStep();var l=s.data("fr-old-src");t.$wp?((i=s.clone().removeData("fr-old-src").removeClass("fr-uploading")).off("load"),l&&s.attr("src",l),s.replaceWith(i)):i=s;for(var c=i.get(0).attributes,d=0;d<c.length;d++){var u=c[d];0===u.nodeName.indexOf("data-")&&i.removeAttr(u.nodeName)}if(void 0!==n)for(r in n)n.hasOwnProperty(r)&&"link"!=r&&i.attr("data-"+r,n[r]);i.on("load",y),i.attr("src",e),t.edit.on(),a(),t.undo.saveStep(),t.$el.blur(),t.events.trigger(l?"image.replaced":"image.inserted",[i,o])}else i=k(e,n,y),a(),t.undo.saveStep(),t.events.trigger("image.inserted",[i,o])},r.onerror=function(){p(ne)},m("Loading image"),r.src=e}function x(i){try{if(!1===t.events.trigger("image.uploaded",[i],!0))return t.edit.on(),!1;var n=e.parseJSON(i);return n.link?n:(p(se,i),!1)}catch(e){return p(re,i),!1}}function C(i){try{var n=e(i).find("Location").text(),s=e(i).find("Key").text();return!1===t.events.trigger("image.uploadedToS3",[n,s,i],!0)?(t.edit.on(),!1):n}catch(e){return p(re,i),!1}}function E(){p(re,this.response||this.responseText||this.responseXML)}function T(e){e.lengthComputable&&v("Uploading",e.loaded/e.total*100|0)}function k(i,n,s){var o,r="";if(n&&void 0!==n)for(o in n)n.hasOwnProperty(o)&&"link"!=o&&(r+=" data-"+o+'="'+n[o]+'"');var a=t.opts.imageDefaultWidth;a&&"auto"!=a&&(a+=t.opts.imageResizeWithPercent?"%":"px");var l=e('<img class="'+(t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign&&"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"")+'" src="'+i+'"'+r+(a?' style="width: '+a+';"':"")+">");return l.on("load",s),t.edit.on(),t.events.focus(!0),t.selection.restore(),t.undo.saveStep(),t.opts.imageSplitHTML?t.markers.split():t.markers.insert(),t.$el.find(".fr-marker").replaceWith(l),t.html.wrap(),t.selection.clear(),l}function _(){t.edit.on(),g(!0)}function S(i,n,s){function o(){var s=e(this);s.off("load"),s.addClass("fr-uploading"),s.next().is("br")&&s.next().remove(),t.placeholder.refresh(),s.is(Z)||b(s),l(),m(),t.edit.off(),i.onload=function(){(function(e){v("Loading image");var i=this.status,n=this.response,s=this.responseXML,o=this.responseText;try{if(t.opts.imageUploadToS3)if(201==i){var r=C(s);r&&w(r,!1,[],e,n||s)}else p(re,n||s);else if(i>=200&&i<300){var a=x(o);a&&w(a.link,!1,a,e,n||o)}else p(oe,n||o)}catch(e){p(re,n||o)}}).call(i,s)},i.onerror=E,i.upload.onprogress=T,i.onabort=_,s.off("abortUpload").on("abortUpload",function(){4!=i.readyState&&i.abort()}),i.send(n)}var r=new FileReader;r.addEventListener("load",function(){var e=r.result;if(r.result.indexOf("svg+xml")<0){for(var i=atob(r.result.split(",")[1]),n=[],s=0;s<i.length;s++)n.push(i.charCodeAt(s));e=window.URL.createObjectURL(new Blob([new Uint8Array(n)],{type:"image/jpeg"}))}Z?(Z.on("load",o),t.edit.on(),t.undo.saveStep(),Z.data("fr-old-src",Z.attr("src")),Z.attr("src",e)):k(e,null,o)},!1),r.readAsDataURL(s)}function D(e){if(void 0!==e&&e.length>0){if(!1===t.events.trigger("image.beforeUpload",[e]))return!1;var i,n=e[0];if(n.size>t.opts.imageMaxSize)return p(ae),!1;if(t.opts.imageAllowedTypes.indexOf(n.type.replace(/image\//g,""))<0)return p(le),!1;if(t.drag_support.formdata&&(i=t.drag_support.formdata?new FormData:null),i){var s;if(!1!==t.opts.imageUploadToS3)for(s in i.append("key",t.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(n.name||"untitled")),i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",n.type),t.opts.imageUploadToS3.params)t.opts.imageUploadToS3.params.hasOwnProperty(s)&&i.append(s,t.opts.imageUploadToS3.params[s]);for(s in t.opts.imageUploadParams)t.opts.imageUploadParams.hasOwnProperty(s)&&i.append(s,t.opts.imageUploadParams[s]);i.append(t.opts.imageUploadParam,n);var o=t.opts.imageUploadURL;t.opts.imageUploadToS3&&(o=t.opts.imageUploadToS3.uploadURL?t.opts.imageUploadToS3.uploadURL:"https://"+t.opts.imageUploadToS3.region+".amazonaws.com/"+t.opts.imageUploadToS3.bucket),S(t.core.getXHR(o,t.opts.imageUploadMethod),i,n)}}}function $(i){t.events.$on(i,"dragover dragenter",".fr-image-upload-layer",function(){return e(this).addClass("fr-drop"),!1}),t.events.$on(i,"dragleave dragend",".fr-image-upload-layer",function(){return e(this).removeClass("fr-drop"),!1}),t.events.$on(i,"drop",".fr-image-upload-layer",function(n){n.preventDefault(),n.stopPropagation(),e(this).removeClass("fr-drop");var s=n.originalEvent.dataTransfer;if(s&&s.files){var o=i.data("instance")||t;o.events.disableBlur(),o.image.upload(s.files),o.events.enableBlur()}}),t.events.$on(i,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var n=i.data("instance")||t;n.events.disableBlur(),i.find("input:focus").blur(),n.events.enableBlur(),n.image.upload(this.files)}e(this).val("")})}function M(i){var n=i.originalEvent.dataTransfer;if(n&&n.files&&n.files.length){var s=n.files[0];if(s&&s.type&&t.opts.imageAllowedTypes.indexOf(s.type.replace(/image\//g,""))>=0){t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.popups.hideAll();var o=t.popups.get("image.insert");return o||(o=O()),t.popups.setContainer("image.insert",e(t.opts.scrollableContainer)),t.popups.show("image.insert",i.originalEvent.pageX,i.originalEvent.pageY),m(),D(n.files),i.preventDefault(),i.stopPropagation(),!1}}}function A(){var i,n,s=t.selection.ranges(0);s.collapsed&&s.startContainer.nodeType==Node.ELEMENT_NODE&&(s.startContainer.childNodes.length==s.startOffset?(i=s.startContainer.childNodes[s.startOffset-1])&&"IMG"==i.tagName&&"block"==e(i).css("display")&&((n=t.node.blockParent(i))&&t.html.defaultTag()?n.nextSibling||(["TD","TH"].indexOf(n.tagName)<0?e(n).after("<"+t.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+t.html.defaultTag()+">"):e(i).after("<br>"+e.FE.MARKERS),t.selection.restore()):n||(e(i).after("<br>"+e.FE.MARKERS),t.selection.restore())):0===s.startOffset&&s.startContainer.childNodes.length>s.startOffset&&((i=s.startContainer.childNodes[s.startOffset])&&"IMG"==i.tagName&&"block"==e(i).css("display")&&((n=t.node.blockParent(i))&&t.html.defaultTag()?n.previousSibling||(["TD","TH"].indexOf(n.tagName)<0?e(n).before("<"+t.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+t.html.defaultTag()+">"):e(i).before("<br>"+e.FE.MARKERS),t.selection.restore()):n||(e(i).before(e.FE.MARKERS+"<br>"),t.selection.restore()))))}function O(e){if(e)return t.popups.onRefresh("image.insert",i),t.popups.onHide("image.insert",s),!0;var n,o="";t.opts.imageInsertButtons.length>1&&(o='<div class="fr-buttons">'+t.button.buildList(t.opts.imageInsertButtons)+"</div>");var r=t.opts.imageInsertButtons.indexOf("imageUpload"),a=t.opts.imageInsertButtons.indexOf("imageByURL"),l="";r>=0&&(n=" fr-active",a>=0&&r>a&&(n=""),l='<div class="fr-image-upload-layer'+n+' fr-layer" id="fr-image-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop image")+"</strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+t.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+t.id+'" role="button"></div></div>');var c="";a>=0&&(n=" fr-active",r>=0&&a>r&&(n=""),c='<div class="fr-image-by-url-layer'+n+' fr-layer" id="fr-image-by-url-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+t.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+t.language.translate("Insert")+"</button></div></div>");var d={buttons:o,upload_layer:l,by_url_layer:c,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>'},u=t.popups.create("image.insert",d);return t.$wp&&t.events.$on(t.$wp,"scroll",function(){Z&&t.popups.isVisible("image.insert")&&G()}),$(u),u}function F(){Z&&t.popups.get("image.alt").find("input").val(Z.attr("alt")||"").trigger("change")}function N(){var i=t.popups.get("image.alt");i||(i=L()),g(),t.popups.refresh("image.alt"),t.popups.setContainer("image.alt",e(t.opts.scrollableContainer));var n=Z.offset().left+Z.width()/2,s=Z.offset().top+Z.height();t.popups.show("image.alt",n,s,Z.outerHeight())}function L(e){if(e)return t.popups.onRefresh("image.alt",F),!0;var i={buttons:'<div class="fr-buttons">'+t.button.buildList(t.opts.imageAltButtons)+"</div>",alt_layer:'<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+t.id+'" type="text" placeholder="'+t.language.translate("Alternate Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+t.language.translate("Update")+"</button></div></div>"},n=t.popups.create("image.alt",i);return t.$wp&&t.events.$on(t.$wp,"scroll.image-alt",function(){Z&&t.popups.isVisible("image.alt")&&N()}),n}function R(){if(Z){var e=t.popups.get("image.size");e.find('input[name="width"]').val(Z.get(0).style.width).trigger("change"),e.find('input[name="height"]').val(Z.get(0).style.height).trigger("change")}}function I(){var i=t.popups.get("image.size");i||(i=P()),g(),t.popups.refresh("image.size"),t.popups.setContainer("image.size",e(t.opts.scrollableContainer));var n=Z.offset().left+Z.width()/2,s=Z.offset().top+Z.height();t.popups.show("image.size",n,s,Z.outerHeight())}function P(e){if(e)return t.popups.onRefresh("image.size",R),!0;var i={buttons:'<div class="fr-buttons">'+t.button.buildList(t.opts.imageSizeButtons)+"</div>",size_layer:'<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+t.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+t.id+'" type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+t.id+'" type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+t.language.translate("Update")+"</button></div></div>"},n=t.popups.create("image.size",i);return t.$wp&&t.events.$on(t.$wp,"scroll.image-size",function(){Z&&t.popups.isVisible("image.size")&&I()}),n}function B(e,t,i,n){return e.pageX=t,d.call(this,e),e.pageX=e.pageX+i*Math.floor(Math.pow(1.1,n)),u.call(this,e),h.call(this,e),n++}function H(i){(i=i||Z)&&!1!==t.events.trigger("image.beforeRemove",[i])&&(t.popups.hideAll(),X(),V(!0),t.undo.canDo()||t.undo.saveStep(),i.get(0)==t.el?i.removeAttr("src"):("A"==i.get(0).parentNode.tagName?(t.selection.setBefore(i.get(0).parentNode)||t.selection.setAfter(i.get(0).parentNode)||i.parent().after(e.FE.MARKERS),e(i.get(0).parentNode).remove()):(t.selection.setBefore(i.get(0))||t.selection.setAfter(i.get(0))||i.after(e.FE.MARKERS),i.remove()),t.html.fillEmptyBlocks(),t.selection.restore()),t.undo.saveStep())}function U(i){var n=i.which;if(Z&&(n==e.FE.KEYCODE.BACKSPACE||n==e.FE.KEYCODE.DELETE))return i.preventDefault(),i.stopPropagation(),H(),!1;if(Z&&n==e.FE.KEYCODE.ESC){var s=Z;return V(!0),t.selection.setAfter(s.get(0)),t.selection.restore(),i.preventDefault(),!1}if(Z&&(n==e.FE.KEYCODE.ARROW_LEFT||n==e.FE.KEYCODE.ARROW_RIGHT)){var o=Z.get(0);return V(!0),n==e.FE.KEYCODE.ARROW_LEFT?t.selection.setBefore(o):t.selection.setAfter(o),t.selection.restore(),i.preventDefault(),!1}return Z&&n!=e.FE.KEYCODE.F10&&!t.keys.isBrowserAction(i)?(i.preventDefault(),!1):void 0}function z(){t.opts.imagePaste?t.$el.find("img[data-fr-image-pasted]").each(function(i,s){if(t.opts.imagePasteProcess){var o=t.opts.imageDefaultWidth;o&&"auto"!=o&&(o+=t.opts.imageResizeWithPercent?"%":"px"),e(s).css("width",o),e(s).removeClass("fr-dii fr-dib fr-fir fr-fil").addClass((t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign&&"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:""))}if(0===s.src.indexOf("data:")){if(!1===t.events.trigger("image.beforePasteUpload",[s]))return!1;Z=e(s),l(),n(),G(),m(),t.edit.off();for(var r=atob(e(s).attr("src").split(",")[1]),a=[],c=0;c<r.length;c++)a.push(r.charCodeAt(c));D([new Blob([new Uint8Array(a)],{type:"image/jpeg"})]),e(s).removeAttr("data-fr-image-pasted")}else 0!==s.src.indexOf("http")?(t.selection.save(),e(s).remove(),t.selection.restore()):e(s).removeAttr("data-fr-image-pasted")}):t.$el.find("img[data-fr-image-pasted]").remove()}function j(e){if(e&&e.clipboardData&&e.clipboardData.items&&e.clipboardData.items[0]){var i=e.clipboardData.items[0].getAsFile();if(i){var n=new FileReader;return n.onload=function(e){var i=e.target.result,n=t.opts.imageDefaultWidth;n&&"auto"!=n&&(n+=t.opts.imageResizeWithPercent?"%":"px"),t.html.insert('<img data-fr-image-pasted="true" class="'+(t.opts.imageDefaultDisplay?"fr-di"+t.opts.imageDefaultDisplay[0]:"")+(t.opts.imageDefaultAlign&&"center"!=t.opts.imageDefaultAlign?" fr-fi"+t.opts.imageDefaultAlign[0]:"")+'" src="'+i+'"'+(n?' style="width: '+n+';"':"")+">"),t.events.trigger("paste.after")},n.readAsDataURL(i),!1}}}function K(e){return e.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function W(i){if("false"==e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable"))return!0;if(i&&"touchend"==i.type&&ue)return!0;if(i&&t.edit.isDisabled())return i.stopPropagation(),i.preventDefault(),!1;for(var s=0;s<e.FE.INSTANCES.length;s++)e.FE.INSTANCES[s]!=t&&e.FE.INSTANCES[s].events.trigger("image.hideResizer");t.toolbar.disable(),i&&(i.stopPropagation(),i.preventDefault()),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),t.opts.iframe&&t.size.syncIframe(),Z=e(this),X(),l(),n(),t.selection.clear(),t.button.bulkRefresh(),t.events.trigger("video.hideResizer")}function V(e){Z&&(he||!0===e)&&(t.toolbar.enable(),J.removeClass("fr-active"),t.popups.hide("image.edit"),Z=null,q())}function Y(){he=!0}function q(){he=!1}function G(){var i=t.popups.get("image.insert");i||(i=O()),t.popups.isVisible("image.insert")||(g(),t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",e(t.opts.scrollableContainer)));var n=Z.offset().left+Z.width()/2,s=Z.offset().top+Z.height();t.popups.show("image.insert",n,s,Z.outerHeight())}function X(){if(Z){t.selection.clear();var e=t.doc.createRange();e.selectNode(Z.get(0)),t.selection.get().addRange(e)}}function Q(){return Z}var Z,J,ee,te,ie=!1,ne=1,se=2,oe=3,re=4,ae=5,le=6,ce={};ce[ne]="Image cannot be loaded from the passed link.",ce[se]="No link in upload response.",ce[oe]="Error during file upload.",ce[re]="Parsing response failed.",ce[ae]="File is too large.",ce[le]="Image file type is invalid.",ce[7]="Files can be uploaded only to same domain in IE 8 and IE 9.";var de,ue,he=!1;return{_init:function(){var i;t.events.$on(t.$el,t._mousedown,"IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(i){return"false"==e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable")||(t.helpers.isMobile()||t.selection.clear(),ie=!0,t.popups.areVisible()&&t.events.disableBlur(),t.browser.msie&&(t.events.disableBlur(),t.$el.attr("contenteditable",!1)),t.draggable||i.preventDefault(),void i.stopPropagation())}),t.events.$on(t.$el,t._mouseup,"IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(i){return"false"==e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable")||void(ie&&(ie=!1,i.stopPropagation(),t.browser.msie&&(t.$el.attr("contenteditable",!0),t.events.enableBlur())))}),t.events.on("keyup",function(i){if(i.shiftKey&&""===t.selection.text().replace(/\n/g,"")){var n=t.selection.element(),s=t.selection.endElement();n&&"IMG"==n.tagName?b(e(n)):s&&"IMG"==s.tagName&&b(e(s))}},!0),t.events.on("drop",M),t.events.on("mousedown window.mousedown",Y),t.events.on("window.touchmove",q),t.events.on("mouseup window.mouseup",function(){if(Z)return V(),!1}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&V()}),t.events.on("mouseup",A),t.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){ie=!1,V(!0)}),"IMG"==t.el.tagName&&t.$el.addClass("fr-view"),t.events.$on(t.$el,t.helpers.isMobile()&&!t.helpers.isWindowsPhone()?"touchend":"click","IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',W),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","IMG"==t.el.tagName?null:'img:not([contenteditable="false"])',function(){ue=!1}),t.events.$on(t.$el,"touchmove",function(){ue=!0})),t.$wp?t.events.on("window.keydown keydown",U,!0):t.events.$on(t.$win,"keydown",U),t.events.on("toolbar.esc",function(){if(Z){if(t.$wp)t.events.disableBlur(),t.events.focus();else{var e=Z;V(!0),t.selection.setAfter(e.get(0)),t.selection.restore()}return!1}},!0),t.events.on("window.cut window.copy",function(i){Z&&(X(),e.FE.copied_text="\n",e.FE.copied_html=Z.get(0).outerHTML,"copy"==i.type?setTimeout(function(){b(Z)}):(V(!0),t.undo.saveStep(),setTimeout(function(){t.undo.saveStep()},0)))},!0),t.events.$on(e(t.o_win),"keydown",function(t){var i=t.which;if(Z&&i==e.FE.KEYCODE.BACKSPACE)return t.preventDefault(),!1}),t.events.$on(t.$win,"keydown",function(t){var i=t.which;Z&&Z.hasClass("fr-uploading")&&i==e.FE.KEYCODE.ESC&&Z.trigger("abortUpload")}),t.events.on("destroy",function(){Z&&Z.hasClass("fr-uploading")&&Z.trigger("abortUpload")}),t.events.on("paste.before",j),t.events.on("paste.beforeCleanup",K),t.events.on("paste.after",z),t.events.on("html.set",r),t.events.on("html.inserted",r),r(),t.events.on("destroy",function(){de=[]}),t.events.on("html.get",function(e){return e.replace(/<(img)((?:[\w\W]*?))class="([\w\W]*?)(fr-uploading|fr-error)([\w\W]*?)"((?:[\w\W]*?))>/g,"")}),t.opts.imageOutputSize&&(t.events.on("html.beforeGet",function(){i=t.el.querySelectorAll("img");for(var n=0;n<i.length;n++){var s=i[n].style.width||e(i[n]).width(),o=i[n].style.height||e(i[n]).height();s&&i[n].setAttribute("width",(""+s).replace(/px/,"")),o&&i[n].setAttribute("height",(""+o).replace(/px/,""))}}),t.events.on("html.afterGet",function(){for(var e=0;e<i.length;e++)i[e].removeAttribute("width"),i[e].removeAttribute("height")})),t.opts.iframe&&t.events.on("image.loaded",t.size.syncIframe),t.$wp&&(a(),t.events.on("contentChanged",a)),t.events.$on(e(t.o_win),"orientationchange.image",function(){setTimeout(function(){var e=Q();e&&b(e)},0)}),f(!0),O(!0),P(!0),L(!0),t.events.on("node.remove",function(e){if("IMG"==e.get(0).tagName)return H(e),!1})},showInsertPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="insertImage"]'),i=t.popups.get("image.insert");if(i||(i=O()),g(),!i.hasClass("fr-active"))if(t.popups.refresh("image.insert"),t.popups.setContainer("image.insert",t.$tb),e.is(":visible")){var n=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("image.insert",n,s,e.outerHeight())}else t.position.forSelection(i),t.popups.show("image.insert")},showLayer:function(e){var i,n,s=t.popups.get("image.insert");if(Z||t.opts.toolbarInline)Z&&(n=Z.offset().top+Z.outerHeight());else{var o=t.$tb.find('.fr-command[data-cmd="insertImage"]');i=o.offset().left+o.outerWidth()/2,n=o.offset().top+(t.opts.toolbarBottom?10:o.outerHeight()-10)}!Z&&t.opts.toolbarInline&&(n=s.offset().top-t.helpers.getPX(s.css("margin-top")),s.hasClass("fr-above")&&(n+=s.outerHeight())),s.find(".fr-layer").removeClass("fr-active"),s.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("image.insert",i,n,Z?Z.outerHeight():0),t.accessibility.focusPopup(s)},refreshUploadButton:function(e){t.popups.get("image.insert").find(".fr-image-upload-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},refreshByURLButton:function(e){t.popups.get("image.insert").find(".fr-image-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},upload:D,insertByURL:function(){var e=t.popups.get("image.insert").find(".fr-image-by-url-layer input");e.val().length>0&&(m(),v("Loading image"),w(e.val(),!0,[],Z),e.val(""),e.blur())},align:function(e){Z.removeClass("fr-fir fr-fil"),"left"==e?Z.addClass("fr-fil"):"right"==e&&Z.addClass("fr-fir"),l(),n()},refreshAlign:function(e){Z&&(Z.hasClass("fr-fil")?e.find("> *:first").replaceWith(t.icon.create("align-left")):Z.hasClass("fr-fir")?e.find("> *:first").replaceWith(t.icon.create("align-right")):e.find("> *:first").replaceWith(t.icon.create("align-justify")))},refreshAlignOnShow:function(e,t){if(Z){var i="justify";Z.hasClass("fr-fil")?i="left":Z.hasClass("fr-fir")&&(i="right"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active").attr("aria-selected",!0)}},display:function(e){Z.removeClass("fr-dii fr-dib"),"inline"==e?Z.addClass("fr-dii"):"block"==e&&Z.addClass("fr-dib"),l(),n()},refreshDisplayOnShow:function(e,t){var i="block";Z.hasClass("fr-dii")&&(i="inline"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active").attr("aria-selected",!0)},replace:G,back:function(){Z?(t.events.disableBlur(),e(".fr-popup input:focus").blur(),b(Z)):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("image.insert"),t.toolbar.showInline())},get:Q,insert:w,showProgressBar:m,remove:H,hideProgressBar:g,applyStyle:function(e,i,n){if(void 0===i&&(i=t.opts.imageStyles),void 0===n&&(n=t.opts.imageMultipleStyles),!Z)return!1;if(!n){var s=Object.keys(i);s.splice(s.indexOf(e),1),Z.removeClass(s.join(" "))}Z.toggleClass(e),b(Z)},showAltPopup:N,showSizePopup:I,setAlt:function(e){if(Z){var i=t.popups.get("image.alt");Z.attr("alt",e||i.find("input").val()||""),i.find("input:focus").blur(),b(Z)}},setSize:function(e,i){if(Z){var n=t.popups.get("image.size");Z.css("width",e||n.find('input[name="width"]').val()),Z.css("height",i||n.find('input[name="height"]').val()),n.find("input:focus").blur(),b(Z)}},exitEdit:V,edit:b}},e.FE.DefineIcon("insertImage",{NAME:"image"}),e.FE.RegisterShortcut(e.FE.KEYCODE.P,"insertImage",null,"P"),e.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),e.FE.DefineIcon("imageUpload",{NAME:"upload"}),e.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(e){this.image.refreshUploadButton(e)}}),e.FE.DefineIcon("imageByURL",{NAME:"link"}),e.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(e){this.image.refreshByURLButton(e)}}),e.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(e){this.image.get()?e.text(this.language.translate("Replace")):e.text(this.language.translate("Insert"))}}),e.FE.DefineIcon("imageDisplay",{NAME:"star"}),e.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.image.display(t)},refresh:function(e){this.opts.imageTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.image.refreshDisplayOnShow(e,t)}}),e.FE.ICONS.align||(e.FE.DefineIcon("align",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"})),e.FE.DefineIcon("imageAlign",{NAME:"align-center"}),e.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.imageAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+'<span class="fr-sr-only">'+this.language.translate(i[n])+"</span></a></li>");return t+"</ul>"},callback:function(e,t){this.image.align(t)},refresh:function(e){this.image.refreshAlign(e)},refreshOnShow:function(e,t){this.image.refreshAlignOnShow(e,t)}}),e.FE.DefineIcon("imageReplace",{NAME:"exchange"}),e.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),e.FE.DefineIcon("imageRemove",{NAME:"trash"}),e.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),e.FE.DefineIcon("imageBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(e){this.image.get()||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),e.FE.DefineIcon("imageStyle",{NAME:"magic"}),e.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.imageStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+i+'">'+this.language.translate(t[i])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.image.applyStyle(t)},refreshOnShow:function(t,i){var n=this.image.get();n&&i.find(".fr-command").each(function(){var t=e(this).data("param1"),i=n.hasClass(t);e(this).toggleClass("fr-active",i).attr("aria-selected",i)})}}),e.FE.DefineIcon("imageAlt",{NAME:"info"}),e.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternate Text",callback:function(){this.image.showAltPopup()}}),e.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),e.FE.DefineIcon("imageSize",{NAME:"arrows-alt"}),e.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}}),e.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){if(e.extend(e.FE.DEFAULTS,{imageManagerLoadURL:"https://i.froala.com/load-files",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:"",imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),e.FE.PLUGINS.imageManager=function(t){function i(){var t=e(window).outerWidth();return t<768?2:t<1200?3:4}function n(){E.empty();for(var e=0;e<$;e++)E.append('<div class="fr-list-column"></div>')}function s(){C.show(),E.find(".fr-list-column").empty(),t.opts.imageManagerLoadURL?e.ajax({url:t.opts.imageManagerLoadURL,method:t.opts.imageManagerLoadMethod,data:t.opts.imageManagerLoadParams,dataType:"json",crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e,i,n){t.events.trigger("imageManager.imagesLoaded",[e]),function(e,t){try{E.find(".fr-list-column").empty(),_=0,S=0,D=0,k=e,o()}catch(e){f(N,t)}}(e,n.response),C.hide()}).fail(function(){var e=this.xhr();f(O,e.response||e.responseText)}):f(F)}function o(){if(S<k.length&&(E.outerHeight()<=x.outerHeight()+t.opts.imageManagerScrollOffset||x.scrollTop()+t.opts.imageManagerScrollOffset>E.outerHeight()-x.outerHeight())){_++;for(var e=t.opts.imageManagerPageSize*(_-1);e<Math.min(k.length,t.opts.imageManagerPageSize*_);e++)r(k[e])}}function r(i){var n=new Image,s=e('<div class="fr-image-container fr-empty fr-image-'+D+++'" data-loading="'+t.language.translate("Loading")+'.." data-deleting="'+t.language.translate("Deleting")+'..">');d(!1),n.onload=function(){s.height(Math.floor(s.width()/n.width*n.height));var r=e("<img/>");if(i.thumb)r.attr("src",i.thumb);else{if(f(L,i),!i.url)return f(R,i),!1;r.attr("src",i.url)}if(i.url&&r.attr("data-url",i.url),i.tag)if(w.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),w.find(".fr-modal-tags").show(),i.tag.indexOf(",")>=0){for(var a=i.tag.split(","),u=0;u<a.length;u++)a[u]=a[u].trim(),0===T.find('a[title="'+a[u]+'"]').length&&T.append('<a role="button" title="'+a[u]+'">'+a[u]+"</a>");r.attr("data-tag",a.join())}else 0===T.find('a[title="'+i.tag.trim()+'"]').length&&T.append('<a role="button" title="'+i.tag.trim()+'">'+i.tag.trim()+"</a>"),r.attr("data-tag",i.tag.trim());for(var h in i.name&&r.attr("alt",i.name),i)i.hasOwnProperty(h)&&"thumb"!=h&&"url"!=h&&"tag"!=h&&r.attr("data-"+h,i[h]);s.append(r).append(e(t.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",t.language.translate("Delete"))).append(e(t.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",t.language.translate("Insert"))),T.find(".fr-selected-tag").each(function(e,t){v(r,t.text)||s.hide()}),r.on("load",function(){s.removeClass("fr-empty"),s.height("auto"),S++,c(l(parseInt(r.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1)),d(!1),S%t.opts.imageManagerPageSize==0&&o()}),t.events.trigger("imageManager.imageLoaded",[r])},n.onerror=function(){S++,s.remove(),c(l(parseInt(s.attr("class").match(/fr-image-(\d+)/)[1],10)+1)),f(A,i),S%t.opts.imageManagerPageSize==0&&o()},n.src=i.thumb||i.url,a().append(s)}function a(){var t,i;return E.find(".fr-list-column").each(function(n,s){var o=e(s);0===n?(i=o.outerHeight(),t=o):o.outerHeight()<i&&(i=o.outerHeight(),t=o)}),t}function l(t){void 0===t&&(t=0);for(var i=[],n=D-1;n>=t;n--){var s=E.find(".fr-image-"+n);s.length&&(i.push(s),e('<div id="fr-image-hidden-container">').append(s),E.find(".fr-image-"+n).remove())}return i}function c(e){for(var t=e.length-1;t>=0;t--)a().append(e[t])}function d(e){if(void 0===e&&(e=!0),!y.is(":visible"))return!0;var s=i();if(s!=$){$=s;var r=l();n(),c(r)}t.modals.resize(M),e&&o()}function u(e){var t={},i=e.data();for(var n in i)i.hasOwnProperty(n)&&"url"!=n&&"tag"!=n&&(t[n]=i[n]);return t}function h(i){var n=e(i.currentTarget).siblings("img"),s=y.data("instance")||t,o=y.data("current-image");if(t.modals.hide(M),s.image.showProgressBar(),o)o.data("fr-old-src",o.attr("src")),o.trigger("click");else{s.events.focus(!0),s.selection.restore();var r=s.position.getBoundingRect(),a=r.left+r.width/2,l=r.top+r.height;s.popups.setContainer("image.insert",s.$box||e("body")),s.popups.show("image.insert",a,l)}s.image.insert(n.data("url"),!1,u(n),o)}function p(i){var n=e(i.currentTarget).siblings("img"),s=t.language.translate("Are you sure? Image will be deleted.");confirm(s)&&(t.opts.imageManagerDeleteURL?!1!==t.events.trigger("imageManager.beforeDeleteImage",[n])&&(n.parent().addClass("fr-image-deleting"),e.ajax({method:t.opts.imageManagerDeleteMethod,url:t.opts.imageManagerDeleteURL,data:e.extend(e.extend({src:n.attr("src")},u(n)),t.opts.imageManagerDeleteParams),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e){t.events.trigger("imageManager.imageDeleted",[e]);var i=l(parseInt(n.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);n.parent().remove(),c(i),d(!0)}).fail(function(){var e=this.xhr();f(I,e.response||e.responseText)})):f(P))}function f(i,n){10<=i&&i<20?C.hide():20<=i&&i<30&&e(".fr-image-deleting").removeClass("fr-image-deleting"),t.events.trigger("imageManager.error",[{code:i,message:B[i]},n])}function m(){var e=w.find(".fr-modal-head-line").outerHeight(),t=T.outerHeight();w.toggleClass(".fr-show-tags"),w.hasClass(".fr-show-tags")?(w.css("height",e+t),T.find("a").css("opacity",1)):(w.css("height",e),T.find("a").css("opacity",0))}function g(i){i.preventDefault();var n=e(i.currentTarget);n.toggleClass("fr-selected-tag"),t.opts.imageManagerToggleTags&&n.siblings("a").removeClass("fr-selected-tag"),function(){var t=T.find(".fr-selected-tag");t.length>0?(E.find("img").parent().show(),t.each(function(t,i){E.find("img").each(function(t,n){var s=e(n);v(s,i.text)||s.parent().hide()})})):E.find("img").parent().show(),c(l()),o()}()}function v(e,t){for(var i=e.attr("data-tag").split(","),n=0;n<i.length;n++)if(i[n]==t)return!0;return!1}function b(){C=y.find("#fr-preloader"),E=y.find("#fr-image-list"),T=y.find("#fr-modal-tags"),$=i(),n(),w.css("height",w.find(".fr-modal-head-line").outerHeight()),t.events.$on(e(t.o_win),"resize",function(){d(!!k)}),t.helpers.isMobile()&&(t.events.bindClick(E,"div.fr-image-container",function(t){y.find(".fr-mobile-selected").removeClass("fr-mobile-selected"),e(t.currentTarget).addClass("fr-mobile-selected")}),y.on(t._mousedown,function(){y.find(".fr-mobile-selected").removeClass("fr-mobile-selected")})),t.events.bindClick(E,".fr-insert-img",h),t.events.bindClick(E,".fr-delete-img",p),y.on(t._mousedown+" "+t._mouseup,function(e){e.stopPropagation()}),y.on(t._mousedown,"*",function(){t.events.disableBlur()}),x.on("scroll",o),t.events.bindClick(y,"i#fr-modal-more-"+t.sid,m),t.events.bindClick(T,"a",g)}var y,w,x,C,E,T,k,_,S,D,$,M="image_manager",A=10,O=11,F=12,N=13,L=14,R=15,I=21,P=22,B={};return B[A]="Image cannot be loaded from the passed link.",B[O]="Error during load images request.",B[F]="Missing imageManagerLoadURL option.",B[N]="Parsing load response failed.",B[L]="Missing image thumb.",B[R]="Missing image URL.",B[I]="Error during delete image request.",B[P]="Missing imageManagerDeleteURL option.",{require:["image"],_init:function(){if(!t.$wp&&"IMG"!=t.el.tagName)return!1},show:function(){if(!y){var e='<div class="fr-modal-head-line"><i class="fa fa-bars fr-modal-more fr-not-available" id="fr-modal-more-'+t.sid+'" title="'+t.language.translate("Tags")+'"></i><h4 data-text="true">'+t.language.translate("Manage Images")+"</h4></div>";e+='<div class="fr-modal-tags" id="fr-modal-tags"></div>';var i='<img class="fr-preloader" id="fr-preloader" alt="'+t.language.translate("Loading")+'.." src="'+t.opts.imageManagerPreloader+'" style="display: none;">';i+='<div class="fr-image-list" id="fr-image-list"></div>';var n=t.modals.create(M,e,i);y=n.$modal,w=n.$head,x=n.$body}y.data("current-image",t.image.get()),t.modals.show(M),C||b(),s()},hide:function(){t.modals.hide(M)}}},!e.FE.PLUGINS.image)throw new Error("Image manager plugin requires image plugin.");e.FE.DEFAULTS.imageInsertButtons.push("imageManager"),e.FE.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,modal:!0,callback:function(){this.imageManager.show()},plugin:"imageManager"}),e.FE.DefineIcon("imageManager",{NAME:"folder"}),e.FE.DefineIcon("imageManagerInsert",{NAME:"plus"}),e.FE.DefineIcon("imageManagerDelete",{NAME:"trash"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video"],lineBreakerOffset:15}),e.FE.PLUGINS.lineBreaker=function(t){function i(i,n){var s,o,r,a,l,c,d,h;if(null==i)l=(a=n.parent()).offset().top,s=(d=n.offset().top)-Math.min((d-l)/2,t.opts.lineBreakerOffset),r=a.outerWidth(),o=a.offset().left;else if(null==n)c=(a=i.parent()).offset().top+a.outerHeight(),s=(h=i.offset().top+i.outerHeight())+Math.min((c-h)/2,t.opts.lineBreakerOffset),r=a.outerWidth(),o=a.offset().left;else{a=i.parent();var p=i.offset().top+i.height(),f=n.offset().top;if(p>f)return!1;s=(p+f)/2,r=a.outerWidth(),o=a.offset().left}t.opts.iframe&&(o+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),s+=t.$iframe.offset().top-e(t.o_win).scrollTop()),t.$box.append(u),u.css("top",s-t.win.pageYOffset),u.css("left",o-t.win.pageXOffset),u.css("width",r),u.data("tag1",i),u.data("tag2",n),u.addClass("fr-visible").data("instance",t)}function n(e,n){var o,r,a=e.offset().top,l=e.offset().top+e.outerHeight();if(Math.abs(l-n)<=t.opts.lineBreakerOffset||Math.abs(n-a)<=t.opts.lineBreakerOffset)if(Math.abs(l-n)<Math.abs(n-a)){for(var c=(r=e.get(0)).nextSibling;c&&c.nodeType==Node.TEXT_NODE&&0===c.textContent.length;)c=c.nextSibling;if(!c)return i(e,null),!0;if(o=s(c))return i(e,o),!0}else{if(!(r=e.get(0)).previousSibling)return i(null,e),!0;if(o=s(r.previousSibling))return i(o,e),!0}u.removeClass("fr-visible").removeData("instance")}function s(i){if(i){var n=e(i);if(0===t.$el.find(n).length)return null;if(i.nodeType!=Node.TEXT_NODE&&n.is(t.opts.lineBreakerTags.join(",")))return n;if(n.parents(t.opts.lineBreakerTags.join(",")).length>0)return i=n.parents(t.opts.lineBreakerTags.join(",")).get(0),e(i)}return null}function o(i){p=null;var o,r,a,l=null,c=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset);if(c&&("HTML"==c.tagName||"BODY"==c.tagName||t.node.isElement(c)))for(o=1;o<=t.opts.lineBreakerOffset;o++){if((r=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset-o))&&!t.node.isElement(r)&&r!=t.$wp.get(0)&&e(r).parents(t.$wp).length){l=s(r);break}if((a=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset+o))&&!t.node.isElement(a)&&a!=t.$wp.get(0)&&e(a).parents(t.$wp).length){l=s(a);break}}else l=s(c);l?n(l,i.pageY):t.core.sameInstance(u)&&u.removeClass("fr-visible").removeData("instance")}function r(e){return!(u.hasClass("fr-visible")&&!t.core.sameInstance(u))&&(t.popups.areVisible()||t.el.querySelector(".fr-selected-cell")?(u.removeClass("fr-visible"),!0):void(!1===h&&(p&&clearTimeout(p),p=setTimeout(o,30,e))))}function a(){p&&clearTimeout(p),u.hasClass("fr-visible")&&u.removeClass("fr-visible").removeData("instance")}function l(){h=!0,a()}function c(){h=!1}function d(i){if(!t.core.sameInstance(u))return!0;i.preventDefault(),u.removeClass("fr-visible").removeData("instance");var n=u.data("tag1"),s=u.data("tag2"),o=t.html.defaultTag();null==n?o&&"TD"!=s.parent().get(0).tagName?s.before("<"+o+">"+e.FE.MARKERS+"<br></"+o+">"):s.before(e.FE.MARKERS+"<br>"):o&&"TD"!=n.parent().get(0).tagName&&0===n.parents(o).length?n.after("<"+o+">"+e.FE.MARKERS+"<br></"+o+">"):n.after(e.FE.MARKERS+"<br>"),t.selection.restore()}var u,h,p;return{_init:function(){return!!t.$wp&&(t.shared.$line_breaker||(t.shared.$line_breaker=e('<div class="fr-line-breaker"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect x="21" y="11" width="2" height="8"/><rect x="14" y="17" width="7" height="2"/><path d="M14.000,14.000 L14.000,22.013 L9.000,18.031 L14.000,14.000 Z"/></svg></a></div>')),u=t.shared.$line_breaker,t.events.on("shared.destroy",function(){u.html("").removeData().remove(),u=null},!0),t.events.on("destroy",function(){u.removeData("instance").removeClass("fr-visible").appendTo("body"),clearTimeout(p)},!0),t.events.$on(u,"mouseleave",a,!0),t.events.$on(u,"mousemove",function(e){e.stopPropagation()},!0),t.events.$on(u,"mousedown","a",function(e){e.stopPropagation()},!0),t.events.$on(u,"click","a",d,!0),h=!1,t.events.$on(t.$win,"mousemove",r),t.events.$on(e(t.win),"scroll",a),t.events.on("popups.show.table.edit",a),t.events.on("commands.after",a),t.events.$on(e(t.win),"mousedown",l),void t.events.$on(e(t.win),"mouseup",c))}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"link.edit":"[_BUTTONS_]","link.insert":"[_BUTTONS_][_INPUT_LAYER_]"}),e.extend(e.FE.DEFAULTS,{linkEditButtons:["linkOpen","linkStyle","linkEdit","linkRemove"],linkInsertButtons:["linkBack","|","linkList"],linkAttributes:{},linkAutoPrefix:"http://",linkStyles:{"fr-green":"Green","fr-strong":"Thick"},linkMultipleStyles:!0,linkConvertEmailAddress:!0,linkAlwaysBlank:!1,linkAlwaysNoFollow:!1,linkList:[{text:"Froala",href:"https://froala.com",target:"_blank"},{text:"Google",href:"https://google.com",target:"_blank"},{displayText:"Facebook",href:"https://facebook.com"}],linkText:!0}),e.FE.PLUGINS.link=function(t){function i(){var i=t.image?t.image.get():null;if(!i&&t.$wp){var n=t.selection.ranges(0).commonAncestorContainer;if(n&&(n.contains&&n.contains(t.el)||!t.el.contains(n)||t.el==n)&&(n=null),n&&"A"===n.tagName)return n;var s=t.selection.element(),o=t.selection.endElement();return"A"==s.tagName||t.node.isElement(s)||(s=e(s).parentsUntil(t.$el,"a:first").get(0)),"A"==o.tagName||t.node.isElement(o)||(o=e(o).parentsUntil(t.$el,"a:first").get(0)),o&&(o.contains&&o.contains(t.el)||!t.el.contains(o)||t.el==o)&&(o=null),s&&(s.contains&&s.contains(t.el)||!t.el.contains(s)||t.el==s)&&(s=null),o&&o==s&&"A"==o.tagName?s:null}return"A"==t.el.tagName?t.el:i&&i.get(0).parentNode&&"A"==i.get(0).parentNode.tagName?i.get(0).parentNode:void 0}function n(){var e,i,n,s,o=t.image?t.image.get():null,r=[];if(o)"A"==o.get(0).parentNode.tagName&&r.push(o.get(0).parentNode);else if(t.win.getSelection){var a=t.win.getSelection();if(a.getRangeAt&&a.rangeCount){s=t.doc.createRange();for(var l=0;l<a.rangeCount;++l)if((i=(e=a.getRangeAt(l)).commonAncestorContainer)&&1!=i.nodeType&&(i=i.parentNode),i&&"a"==i.nodeName.toLowerCase())r.push(i);else{n=i.getElementsByTagName("a");for(var c=0;c<n.length;++c)s.selectNodeContents(n[c]),s.compareBoundaryPoints(e.END_TO_START,e)<1&&s.compareBoundaryPoints(e.START_TO_END,e)>-1&&r.push(n[c])}}}else if(t.doc.selection&&"Control"!=t.doc.selection.type)if("a"==(i=(e=t.doc.selection.createRange()).parentElement()).nodeName.toLowerCase())r.push(i);else{n=i.getElementsByTagName("a"),s=t.doc.body.createTextRange();for(var d=0;d<n.length;++d)s.moveToElementText(n[d]),s.compareEndPoints("StartToEnd",e)>-1&&s.compareEndPoints("EndToStart",e)<1&&r.push(n[d])}return r}function s(n){r(),setTimeout(function(){if(!n||n&&(1==n.which||"mouseup"!=n.type)){var s=i(),r=t.image?t.image.get():null;if(s&&!r){if(t.image){var a=t.node.contents(s);if(1==a.length&&"IMG"==a[0].tagName){var l=t.selection.ranges(0);return 0===l.startOffset&&0===l.endOffset?e(s).before(e.FE.MARKERS):e(s).after(e.FE.MARKERS),t.selection.restore(),!1}}n&&n.stopPropagation(),o(s)}}},t.helpers.isIOS()?100:0)}function o(i){var n=t.popups.get("link.edit");n||(n=a());var s=e(i);t.popups.isVisible("link.edit")||t.popups.refresh("link.edit"),t.popups.setContainer("link.edit",e(t.opts.scrollableContainer));var o=s.offset().left+e(i).outerWidth()/2,r=s.offset().top+s.outerHeight();t.popups.show("link.edit",o,r,s.outerHeight())}function r(){t.popups.hide("link.edit")}function a(){var e="";t.opts.linkEditButtons.length>1&&("A"==t.el.tagName&&t.opts.linkEditButtons.indexOf("linkRemove")>=0&&t.opts.linkEditButtons.splice(t.opts.linkEditButtons.indexOf("linkRemove"),1),e='<div class="fr-buttons">'+t.button.buildList(t.opts.linkEditButtons)+"</div>");var n={buttons:e},s=t.popups.create("link.edit",n);return t.$wp&&t.events.$on(t.$wp,"scroll.link-edit",function(){i()&&t.popups.isVisible("link.edit")&&o(i())}),s}function l(){}function c(){var n=t.popups.get("link.insert"),s=i();if(s){var o,r,a=e(s),l=n.find('input.fr-link-attr[type="text"]'),c=n.find('input.fr-link-attr[type="checkbox"]');for(o=0;o<l.length;o++)(r=e(l[o])).val(a.attr(r.attr("name")||""));for(c.prop("checked",!1),o=0;o<c.length;o++)r=e(c[o]),a.attr(r.attr("name"))==r.data("checked")&&r.prop("checked",!0);n.find('input.fr-link-attr[type="text"][name="text"]').val(a.text())}else n.find('input.fr-link-attr[type="text"]').val(""),n.find('input.fr-link-attr[type="checkbox"]').prop("checked",!1),n.find('input.fr-link-attr[type="text"][name="text"]').val(t.selection.text());n.find("input.fr-link-attr").trigger("change"),(t.image?t.image.get():null)?n.find('.fr-link-attr[name="text"]').parent().hide():n.find('.fr-link-attr[name="text"]').parent().show()}function d(e){if(e)return t.popups.onRefresh("link.insert",c),t.popups.onHide("link.insert",l),!0;var n="";t.opts.linkInsertButtons.length>=1&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.linkInsertButtons)+"</div>");var s="",o=0;for(var r in s='<div class="fr-link-insert-layer fr-layer fr-active" id="fr-link-insert-layer-'+t.id+'">',s+='<div class="fr-input-line"><input id="fr-link-insert-layer-url-'+t.id+'" name="href" type="text" class="fr-link-attr" placeholder="URL" tabIndex="'+ ++o+'"></div>',t.opts.linkText&&(s+='<div class="fr-input-line"><input id="fr-link-insert-layer-text-'+t.id+'" name="text" type="text" class="fr-link-attr" placeholder="'+t.language.translate("Text")+'" tabIndex="'+ ++o+'"></div>'),t.opts.linkAttributes)if(t.opts.linkAttributes.hasOwnProperty(r)){var a=t.opts.linkAttributes[r];s+='<div class="fr-input-line"><input name="'+r+'" type="text" class="fr-link-attr" placeholder="'+t.language.translate(a)+'" tabIndex="'+ ++o+'"></div>'}t.opts.linkAlwaysBlank||(s+='<div class="fr-checkbox-line"><span class="fr-checkbox"><input name="target" class="fr-link-attr" data-checked="_blank" type="checkbox" id="fr-link-target-'+t.id+'" tabIndex="'+ ++o+'"><span><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32"><path d="M27 4l-15 15-7-7-5 5 12 12 20-20z" fill="#FFF"></path></svg></span></span><label for="fr-link-target-'+t.id+'">'+t.language.translate("Open in new tab")+"</label></div>");var d={buttons:n,input_layer:s+='<div class="fr-action-buttons"><button class="fr-command fr-submit" role="button" data-cmd="linkInsert" href="#" tabIndex="'+ ++o+'" type="button">'+t.language.translate("Insert")+"</button></div></div>"},u=t.popups.create("link.insert",d);return t.$wp&&t.events.$on(t.$wp,"scroll.link-insert",function(){(t.image?t.image.get():null)&&t.popups.isVisible("link.insert")&&p(),i&&t.popups.isVisible("link.insert")&&h()}),u}function u(o,r,a){if(void 0===a&&(a={}),!1===t.events.trigger("link.beforeInsert",[o,r,a]))return!1;var l=t.image?t.image.get():null;l||"A"==t.el.tagName?"A"==t.el.tagName&&t.$el.focus():(t.selection.restore(),t.popups.hide("link.insert"));var c=o;if(t.opts.linkConvertEmailAddress){/^[\w._]+@[a-z\u00a1-\uffff0-9_-]+?\.[a-z\u00a1-\uffff0-9]{2,}$/i.test(o)&&!/^mailto:.*/i.test(o)&&(o="mailto:"+o)}if(""===t.opts.linkAutoPrefix||/^(mailto|tel|sms|notes|data):.*/i.test(o)||/^data:image.*/i.test(o)||/^(https?:|ftps?:|file:|)\/\//i.test(o)||["/","{","[","#","("].indexOf((o||"")[0])<0&&(o=t.opts.linkAutoPrefix+o),o=t.helpers.sanitizeURL(o),t.opts.linkAlwaysBlank&&(a.target="_blank"),t.opts.linkAlwaysNoFollow&&(a.rel="nofollow"),"_blank"==a.target&&(a.rel?a.rel+=" noopener noreferrer":a.rel="noopener noreferrer"),r=r||"",o===t.opts.linkAutoPrefix)return t.popups.get("link.insert").find('input[name="href"]').addClass("fr-error"),t.events.trigger("link.bad",[c]),!1;var d,u=i();if(u){d=e(u);var h=t.node.rawAttributes(u);for(var p in h)h.hasOwnProperty(p)&&"class"!=p&&"style"!=p&&"id"!=p&&"contenteditable"!=p&&d.removeAttr(p);d.attr("href",o),r.length>0&&d.text()!=r&&!l&&d.text(r),l||d.prepend(e.FE.START_MARKER).append(e.FE.END_MARKER),d.attr(a),l||t.selection.restore()}else{l?l.wrap('<a href="'+o+'"></a>'):(t.format.remove("a"),t.selection.isCollapsed()?(r=0===r.length?c:r,t.html.insert('<a href="'+o+'">'+e.FE.START_MARKER+r+e.FE.END_MARKER+"</a>"),t.selection.restore()):r.length>0&&r!=t.selection.text().replace(/\n/g,"")?(t.selection.remove(),t.html.insert('<a href="'+o+'">'+e.FE.START_MARKER+r+e.FE.END_MARKER+"</a>"),t.selection.restore()):(function(){if(!t.selection.isCollapsed()){t.selection.save();for(var i=t.$el.find(".fr-marker").addClass("fr-unprocessed").toArray();i.length;){var n=e(i.pop());n.removeClass("fr-unprocessed");var s=t.node.deepestParent(n.get(0));if(s){var o=n.get(0),r="",a="";do{o=o.parentNode,t.node.isBlock(o)||(r+=t.node.closeTagString(o),a=t.node.openTagString(o)+a)}while(o!=s);var l=t.node.openTagString(n.get(0))+n.html()+t.node.closeTagString(n.get(0));n.replaceWith('<span id="fr-break"></span>');var c=e(s).html();c=c.replace(/<span id="fr-break"><\/span>/g,r+l+a),e(s).html(c)}i=t.$el.find(".fr-marker.fr-unprocessed").toArray()}t.selection.restore()}}(),t.format.apply("a",{href:o})));for(var f=n(),m=0;m<f.length;m++)(d=e(f[m])).attr(a),d.removeAttr("_moz_dirty");1==f.length&&t.$wp&&!l&&(e(f[0]).prepend(e.FE.START_MARKER).append(e.FE.END_MARKER),t.selection.restore())}l?(t.popups.get("link.insert").find("input:focus").blur(),t.image.edit(l)):s()}function h(){r();var n=i();if(n){var s=t.popups.get("link.insert");s||(s=d()),t.popups.isVisible("link.insert")||(t.popups.refresh("link.insert"),t.selection.save(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur())),t.popups.setContainer("link.insert",e(t.opts.scrollableContainer));var o=(t.image?t.image.get():null)||e(n),a=o.offset().left+o.outerWidth()/2,l=o.offset().top+o.outerHeight();t.popups.show("link.insert",a,l,o.outerHeight())}}function p(){var i=t.image?t.image.get():null;if(i){var n=t.popups.get("link.insert");n||(n=d()),c(),t.popups.setContainer("link.insert",e(t.opts.scrollableContainer));var s=i.offset().left+i.outerWidth()/2,o=i.offset().top+i.outerHeight();t.popups.show("link.insert",s,o,i.outerHeight())}}return{_init:function(){t.events.on("keyup",function(t){t.which!=e.FE.KEYCODE.ESC&&s(t)}),t.events.on("window.mouseup",s),t.helpers.isMobile()&&t.events.$on(t.$doc,"selectionchange",s),d(!0),"A"==t.el.tagName&&t.$el.addClass("fr-view"),t.events.on("toolbar.esc",function(){if(t.popups.isVisible("link.edit"))return t.events.disableBlur(),t.events.focus(),!1},!0)},remove:function(){var n=i(),s=t.image?t.image.get():null;return!1!==t.events.trigger("link.beforeRemove",[n])&&void(s&&n?(s.unwrap(),t.image.edit(s)):n&&(t.selection.save(),e(n).replaceWith(e(n).html()),t.selection.restore(),r()))},showInsertPopup:function(){var i=t.$tb.find('.fr-command[data-cmd="insertLink"]'),n=t.popups.get("link.insert");if(n||(n=d()),!n.hasClass("fr-active"))if(t.popups.refresh("link.insert"),t.popups.setContainer("link.insert",t.$tb||e(t.opts.scrollableContainer)),i.is(":visible")){var s=i.offset().left+i.outerWidth()/2,o=i.offset().top+(t.opts.toolbarBottom?10:i.outerHeight()-10);t.popups.show("link.insert",s,o,i.outerHeight())}else t.position.forSelection(n),t.popups.show("link.insert")},usePredefined:function(i){var n,s,o=t.opts.linkList[i],r=t.popups.get("link.insert"),a=r.find('input.fr-link-attr[type="text"]'),l=r.find('input.fr-link-attr[type="checkbox"]');for(s=0;s<a.length;s++)o[(n=e(a[s])).attr("name")]?n.val(o[n.attr("name")]):"text"!=n.attr("name")&&n.val("");for(s=0;s<l.length;s++)(n=e(l[s])).prop("checked",n.data("checked")==o[n.attr("name")]);t.accessibility.focusPopup(r)},insertCallback:function(){var i,n,s=t.popups.get("link.insert"),o=s.find('input.fr-link-attr[type="text"]'),r=s.find('input.fr-link-attr[type="checkbox"]'),a=o.filter('[name="href"]').val(),l=o.filter('[name="text"]').val(),c={};for(n=0;n<o.length;n++)i=e(o[n]),["href","text"].indexOf(i.attr("name"))<0&&(c[i.attr("name")]=i.val());for(n=0;n<r.length;n++)(i=e(r[n])).is(":checked")?c[i.attr("name")]=i.data("checked"):c[i.attr("name")]=i.data("unchecked");var d=e(t.o_win).scrollTop();u(a,l,c),e(t.o_win).scrollTop(d)},insert:u,update:h,get:i,allSelected:n,back:function(){t.image&&t.image.get()?t.image.back():(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),i()&&t.$wp?(t.selection.restore(),r(),s()):"A"==t.el.tagName?(t.$el.focus(),s()):(t.popups.hide("link.insert"),t.toolbar.showInline()))},imageLink:p,applyStyle:function(n,o,r){void 0===r&&(r=t.opts.linkMultipleStyles),void 0===o&&(o=t.opts.linkStyles);var a=i();if(!a)return!1;if(!r){var l=Object.keys(o);l.splice(l.indexOf(n),1),e(a).removeClass(l.join(" "))}e(a).toggleClass(n),s()}}},e.FE.DefineIcon("insertLink",{NAME:"link"}),e.FE.RegisterShortcut(e.FE.KEYCODE.K,"insertLink",null,"K"),e.FE.RegisterCommand("insertLink",{title:"Insert Link",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("link.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("link.insert")):this.link.showInsertPopup()},plugin:"link"}),e.FE.DefineIcon("linkOpen",{NAME:"external-link"}),e.FE.RegisterCommand("linkOpen",{title:"Open Link",undo:!1,refresh:function(e){this.link.get()?e.removeClass("fr-hidden"):e.addClass("fr-hidden")},callback:function(){var e=this.link.get();e&&this.o_win.open(e.href)}}),e.FE.DefineIcon("linkEdit",{NAME:"edit"}),e.FE.RegisterCommand("linkEdit",{title:"Edit Link",undo:!1,refreshAfterCallback:!1,popup:!0,callback:function(){this.link.update()},refresh:function(e){this.link.get()?e.removeClass("fr-hidden"):e.addClass("fr-hidden")}}),e.FE.DefineIcon("linkRemove",{NAME:"unlink"}),e.FE.RegisterCommand("linkRemove",{title:"Unlink",callback:function(){this.link.remove()},refresh:function(e){this.link.get()?e.removeClass("fr-hidden"):e.addClass("fr-hidden")}}),e.FE.DefineIcon("linkBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("linkBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.link.back()},refresh:function(e){var t=this.link.get()&&this.doc.hasFocus();(this.image?this.image.get():null)||t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.DefineIcon("linkList",{NAME:"search"}),e.FE.RegisterCommand("linkList",{title:"Choose Link",type:"dropdown",focus:!1,undo:!1,refreshAfterCallback:!1,html:function(){for(var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.linkList,i=0;i<t.length;i++)e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkList" data-param1="'+i+'">'+(t[i].displayText||t[i].text)+"</a></li>";return e+"</ul>"},callback:function(e,t){this.link.usePredefined(t)}}),e.FE.RegisterCommand("linkInsert",{focus:!1,refreshAfterCallback:!1,callback:function(){this.link.insertCallback()},refresh:function(e){this.link.get()?e.text(this.language.translate("Update")):e.text(this.language.translate("Insert"))}}),e.FE.DefineIcon("imageLink",{NAME:"link"}),e.FE.RegisterCommand("imageLink",{title:"Insert Link",undo:!1,focus:!1,popup:!0,callback:function(){this.link.imageLink()},refresh:function(e){var t;this.link.get()?((t=e.prev()).hasClass("fr-separator")&&t.removeClass("fr-hidden"),e.addClass("fr-hidden")):((t=e.prev()).hasClass("fr-separator")&&t.addClass("fr-hidden"),e.removeClass("fr-hidden"))}}),e.FE.DefineIcon("linkStyle",{NAME:"magic"}),e.FE.RegisterCommand("linkStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.linkStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="linkStyle" data-param1="'+i+'">'+this.language.translate(t[i])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.link.applyStyle(t)},refreshOnShow:function(t,i){var n=this.link.get();if(n){var s=e(n);i.find(".fr-command").each(function(){var t=e(this).data("param1"),i=s.hasClass(t);e(this).toggleClass("fr-active",i).attr("aria-selected",i)})}}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.FE.PLUGINS.lists=function(t){function i(e){return'<span class="fr-open-'+e.toLowerCase()+'"></span>'}function n(e){return'<span class="fr-close-'+e.toLowerCase()+'"></span>'}function s(i,n){!function(t,i){for(var n=[],s=0;s<t.length;s++){var o=t[s].parentNode;"LI"==t[s].tagName&&o.tagName!=i&&n.indexOf(o)<0&&n.push(o)}for(s=n.length-1;s>=0;s--){var r=e(n[s]);r.replaceWith("<"+i.toLowerCase()+">"+r.html()+"</"+i.toLowerCase()+">")}}(i,n);for(var s=t.html.defaultTag(),o=0;o<i.length;o++)"LI"!=i[o].tagName&&(s&&i[o].tagName.toLowerCase()==s?e(i[o]).replaceWith("<"+n+"><li"+t.node.attributes(i[o])+">"+e(i[o]).html()+"</li></"+n+">"):e(i[o]).wrap("<"+n+"><li></li></"+n+">"));t.clean.lists()}function o(s){var o,r;for(o=s.length-1;o>=0;o--)for(r=o-1;r>=0;r--)if(e(s[r]).find(s[o]).length||s[r]==s[o]){s.splice(o,1);break}var a=[];for(o=0;o<s.length;o++){var l=e(s[o]),c=s[o].parentNode;l.before(n(c.tagName)),"LI"==c.parentNode.tagName?(l.before(n("LI")),l.after(i("LI"))):(t.node.isEmpty(l.get(0),!0)||0!==l.find(t.html.blockTagsQuery()).length||l.append("<br>"),l.append(i("LI")),l.prepend(n("LI"))),l.after(i(c.tagName)),"LI"==c.parentNode.tagName&&(c=c.parentNode.parentNode),a.indexOf(c)<0&&a.push(c)}for(o=0;o<a.length;o++){var d=e(a[o]),u=d.html();u=(u=u.replace(/<span class="fr-close-([a-z]*)"><\/span>/g,"</$1>")).replace(/<span class="fr-open-([a-z]*)"><\/span>/g,"<$1>"),d.replaceWith(t.node.openTagString(d.get(0))+u+t.node.closeTagString(d.get(0)))}t.$el.find("li:empty").remove(),t.$el.find("ul:empty, ol:empty").remove(),t.clean.lists(),t.html.wrap()}function r(i){t.selection.save();for(var n=0;n<i.length;n++){var s=i[n].previousSibling;if(s){var o=e(i[n]).find("> ul, > ol").last().get(0);if(o){for(var r=e("<li>").prependTo(e(o)),a=t.node.contents(i[n])[0];a&&!t.node.isList(a);){var l=a.nextSibling;r.append(a),a=l}e(s).append(e(o)),e(i[n]).remove()}else{var c=e(s).find("> ul, > ol").last().get(0);if(c)e(c).append(e(i[n]));else{var d=e("<"+i[n].parentNode.tagName+">");e(s).append(d),d.append(e(i[n]))}}}}t.clean.lists(),t.selection.restore()}function a(e){t.selection.save(),o(e),t.selection.restore()}function l(e){if("indent"==e||"outdent"==e){for(var i=!1,n=t.selection.blocks(),s=[],o=0;o<n.length;o++)"LI"==n[o].tagName?(i=!0,s.push(n[o])):"LI"==n[o].parentNode.tagName&&(i=!0,s.push(n[o].parentNode));i&&("indent"==e?r(s):a(s))}}return{_init:function(){t.events.on("commands.after",l),t.events.on("keydown",function(i){if(i.which==e.FE.KEYCODE.TAB){for(var n=t.selection.blocks(),s=[],o=0;o<n.length;o++)"LI"==n[o].tagName?s.push(n[o]):"LI"==n[o].parentNode.tagName&&s.push(n[o].parentNode);if(s.length>1||s.length&&(t.selection.info(s[0]).atStart||t.node.isEmpty(s[0])))return i.preventDefault(),i.stopPropagation(),i.shiftKey?a(s):r(s),!1}},!0)},format:function(e){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();for(var i=t.selection.blocks(),n=0;n<i.length;n++)"LI"!=i[n].tagName&&"LI"==i[n].parentNode.tagName&&(i[n]=i[n].parentNode);t.selection.save(),function(e,t){for(var i=!0,n=0;n<e.length;n++){if("LI"!=e[n].tagName)return!1;e[n].parentNode.tagName!=t&&(i=!1)}return i}(i,e)?o(i):s(i,e),t.html.unwrap(),t.selection.restore()},refresh:function(i,n){var s=e(t.selection.element());if(s.get(0)!=t.el){var o=s.get(0);"LI"!=o.tagName&&(o=s.parents("li").get(0)),o&&o.parentNode.tagName==n&&t.el.contains(o.parentNode)&&i.addClass("fr-active")}}}},e.FE.RegisterCommand("formatUL",{title:"Unordered List",refresh:function(e){this.lists.refresh(e,"UL")},callback:function(){this.lists.format("UL")},plugin:"lists"}),e.FE.RegisterCommand("formatOL",{title:"Ordered List",refresh:function(e){this.lists.refresh(e,"OL")},callback:function(){this.lists.format("OL")},plugin:"lists"}),e.FE.DefineIcon("formatUL",{NAME:"list-ul"}),e.FE.DefineIcon("formatOL",{NAME:"list-ol"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{paragraphFormat:{N:"Normal",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",PRE:"Code"},paragraphFormatSelection:!1}),e.FE.PLUGINS.paragraphFormat=function(t){function i(i,n){var s=t.html.defaultTag();if(n&&n.toLowerCase()!=s)if(i.find("ul, ol").length>0){var o=e("<"+n+">");i.prepend(o);for(var r=t.node.contents(i.get(0))[0];r&&["UL","OL"].indexOf(r.tagName)<0;){var a=r.nextSibling;o.append(r),r=a}}else i.html("<"+n+">"+i.html()+"</"+n+">")}function n(i,n){var s=t.html.defaultTag();n||(n='div class="fr-temp-div" data-empty="true"'),n.toLowerCase()==s?i.replaceWith(i.html()):i.replaceWith(e("<"+n+">").html(i.html()))}function s(i,n){var s=t.html.defaultTag();n||(n='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':"")),n.toLowerCase()==s?(t.node.isEmpty(i.get(0),!0)||i.append("<br/>"),i.replaceWith(i.html())):i.replaceWith(e("<"+n+">").html(i.html()))}function o(i,n){n||(n='div class="fr-temp-div"'+(t.node.isEmpty(i.get(0),!0)?' data-empty="true"':"")),i.replaceWith(e("<"+n+" "+t.node.attributes(i.get(0))+">").html(i.html()))}return{apply:function(r){"N"==r&&(r=t.html.defaultTag()),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();var a=t.selection.blocks();t.selection.save(),t.$el.find("pre").attr("skip",!0);for(var l=0;l<a.length;l++)if(a[l].tagName!=r&&!t.node.isList(a[l])){var c=e(a[l]);"LI"==a[l].tagName?i(c,r):"LI"==a[l].parentNode.tagName&&a[l]?n(c,r):["TD","TH"].indexOf(a[l].parentNode.tagName)>=0?s(c,r):o(c,r)}t.$el.find('pre:not([skip="true"]) + pre:not([skip="true"])').each(function(){e(this).prev().append("<br>"+e(this).html()),e(this).remove()}),t.$el.find("pre").removeAttr("skip"),t.html.unwrap(),t.selection.restore()},refreshOnShow:function(e,i){var n=t.selection.blocks();if(n.length){var s=n[0],o="N",r=t.html.defaultTag();s.tagName.toLowerCase()!=r&&s!=t.el&&(o=s.tagName),i.find('.fr-command[data-param1="'+o+'"]').addClass("fr-active").attr("aria-selected",!0)}else i.find('.fr-command[data-param1="N"]').addClass("fr-active").attr("aria-selected",!0)},refresh:function(e){if(t.opts.paragraphFormatSelection){var i=t.selection.blocks();if(i.length){var n=i[0],s="N",o=t.html.defaultTag();n.tagName.toLowerCase()!=o&&n!=t.el&&(s=n.tagName),["LI","TD","TH"].indexOf(s)>=0&&(s="N"),e.find("> span").text(t.opts.paragraphFormat[s])}else e.find("> span").text(t.opts.paragraphFormat.N)}}}},e.FE.RegisterCommand("paragraphFormat",{type:"dropdown",displaySelection:function(e){return e.opts.paragraphFormatSelection},defaultSelection:"Normal",displaySelectionWidth:100,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.paragraphFormat;for(var i in t)if(t.hasOwnProperty(i)){var n=this.shortcuts.get("paragraphFormat."+i);n=n?'<span class="fr-shortcut">'+n+"</span>":"",e+='<li role="presentation"><'+("N"==i?this.html.defaultTag()||"DIV":i)+' style="padding: 0 !important; margin: 0 !important;" role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="paragraphFormat" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></"+("N"==i?this.html.defaultTag()||"DIV":i)+"></li>"}return e+"</ul>"},title:"Paragraph Format",callback:function(e,t){this.paragraphFormat.apply(t)},refresh:function(e){this.paragraphFormat.refresh(e)},refreshOnShow:function(e,t){this.paragraphFormat.refreshOnShow(e,t)},plugin:"paragraphFormat"}),e.FE.DefineIcon("paragraphFormat",{NAME:"paragraph"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{paragraphStyles:{"fr-text-gray":"Gray","fr-text-bordered":"Bordered","fr-text-spaced":"Spaced","fr-text-uppercase":"Uppercase"},paragraphMultipleStyles:!0}),e.FE.PLUGINS.paragraphStyle=function(t){return{_init:function(){},apply:function(i,n,s){void 0===n&&(n=t.opts.paragraphStyles),void 0===s&&(s=t.opts.paragraphMultipleStyles);var o="";s||((o=Object.keys(n)).splice(o.indexOf(i),1),o=o.join(" ")),t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore();var r=t.selection.blocks();t.selection.save();for(var a=e(r[0]).hasClass(i),l=0;l<r.length;l++)e(r[l]).removeClass(o).toggleClass(i,!a),e(r[l]).hasClass("fr-temp-div")&&e(r[l]).removeClass("fr-temp-div"),""===e(r[l]).attr("class")&&e(r[l]).removeAttr("class");t.html.unwrap(),t.selection.restore()},refreshOnShow:function(i,n){var s=t.selection.blocks();if(s.length){var o=e(s[0]);n.find(".fr-command").each(function(){var t=e(this).data("param1"),i=o.hasClass(t);e(this).toggleClass("fr-active",i).attr("aria-selected",i)})}}}},e.FE.RegisterCommand("paragraphStyle",{type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.paragraphStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command '+i+'" tabIndex="-1" role="option" data-cmd="paragraphStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+"</ul>"},title:"Paragraph Style",callback:function(e,t){this.paragraphStyle.apply(t)},refreshOnShow:function(e,t){this.paragraphStyle.refreshOnShow(e,t)},plugin:"paragraphStyle"}),e.FE.DefineIcon("paragraphStyle",{NAME:"magic"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FE.DEFAULTS,{videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],videoEditButtons:["videoDisplay","videoAlign","videoSize","videoRemove"],videoResize:!0,videoSizeButtons:["videoBack","|"],videoSplitHTML:!1,videoTextNear:!0,videoDefaultAlign:"center",videoDefaultDisplay:"block",videoMove:!0}),e.FE.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}?wmode=opaque" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"//rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],e.FE.VIDEO_EMBED_REGEX=/^\W*((<iframe.*><\/iframe>)|(<embed.*>))\W*$/i,e.FE.PLUGINS.video=function(t){function i(){var e=t.popups.get("video.insert");e.find(".fr-video-by-url-layer input").val("").trigger("change"),e.find(".fr-video-embed-layer textarea").val("").trigger("change")}function n(){var i=t.popups.get("video.edit");if(i||(i=g()),i){t.popups.setContainer("video.edit",e(t.opts.scrollableContainer)),t.popups.refresh("video.edit");var n=_.find("iframe, embed, video"),s=n.offset().left+n.outerWidth()/2,o=n.offset().top+n.outerHeight();t.popups.show("video.edit",s,o,n.outerHeight())}}function s(e){if(e)return t.popups.onRefresh("video.insert",i),!0;var n="";t.opts.videoInsertButtons.length>1&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"</div>");var s="";t.opts.videoInsertButtons.indexOf("videoByURL")>=0&&(s='<div class="fr-video-by-url-layer fr-layer fr-active" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-video-by-url-layer-text-'+t.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2" role="button">'+t.language.translate("Insert")+"</button></div></div>");var o="";t.opts.videoInsertButtons.indexOf("videoEmbed")>=0&&(o='<div class="fr-video-embed-layer fr-layer" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea id="fr-video-embed-layer-text'+t.id+'" type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" aria-required="true" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2" role="button">'+t.language.translate("Insert")+"</button></div></div>");var r={buttons:n,by_url_layer:s,embed_layer:o};return t.popups.create("video.insert",r)}function o(e){t.events.focus(!0),t.selection.restore(),t.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'">'+e+"</span>",!1,t.opts.videoSplitHTML),t.popups.hide("video.insert");var i=t.$el.find(".fr-jiv");i.removeClass("fr-jiv"),i.toggleClass("fr-draggable",t.opts.videoMove),t.events.trigger("video.inserted",[i])}function r(i){if(!t.core.sameInstance(k))return!0;i.preventDefault(),i.stopPropagation();var n=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null),s=i.pageY||(i.originalEvent.touches?i.originalEvent.touches[0].pageY:null);return!(!n||!s)&&(t.undo.canDo()||t.undo.saveStep(),(T=e(this)).data("start-x",n),T.data("start-y",s),E.show(),t.popups.hideAll(),void m())}function a(e){if(!t.core.sameInstance(k))return!0;if(T){e.preventDefault();var i=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null),n=e.pageY||(e.originalEvent.touches?e.originalEvent.touches[0].pageY:null);if(!i||!n)return!1;var s=T.data("start-x"),o=T.data("start-y");T.data("start-x",i),T.data("start-y",n);var r=i-s,a=n-o,l=_.find("iframe, embed, video"),c=l.width(),d=l.height();(T.hasClass("fr-hnw")||T.hasClass("fr-hsw"))&&(r=0-r),(T.hasClass("fr-hnw")||T.hasClass("fr-hne"))&&(a=0-a),l.css("width",c+r),l.css("height",d+a),l.removeAttr("width"),l.removeAttr("height"),u()}}function l(e){return!t.core.sameInstance(k)||void(T&&_&&(e&&e.stopPropagation(),T=null,E.hide(),u(),n(),t.undo.saveStep()))}function c(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function d(e,t,i,n){return e.pageX=t,e.pageY=t,r.call(this,e),e.pageX=e.pageX+i*Math.floor(Math.pow(1.1,n)),e.pageY=e.pageY+i*Math.floor(Math.pow(1.1,n)),a.call(this,e),l.call(this,e),n++}function u(){k||function(){var i;if(t.shared.$video_resizer?(k=t.shared.$video_resizer,E=t.shared.$vid_overlay,t.events.on("destroy",function(){k.removeClass("fr-active").appendTo(e("body"))},!0)):(t.shared.$video_resizer=e('<div class="fr-video-resizer"></div>'),k=t.shared.$video_resizer,t.events.$on(k,"mousedown",function(e){e.stopPropagation()},!0),t.opts.videoResize&&(k.append(c("nw")+c("ne")+c("sw")+c("se")),t.shared.$vid_overlay=e('<div class="fr-video-overlay"></div>'),E=t.shared.$vid_overlay,i=k.get(0).ownerDocument,e(i).find("body").append(E))),t.events.on("shared.destroy",function(){k.html("").removeData().remove(),k=null,t.opts.videoResize&&(E.remove(),E=null)},!0),t.helpers.isMobile()||t.events.$on(e(t.o_win),"resize.video",function(){p(!0)}),t.opts.videoResize){i=k.get(0).ownerDocument,t.events.$on(k,t._mousedown,".fr-handler",r),t.events.$on(e(i),t._mousemove,a),t.events.$on(e(i.defaultView||i.parentWindow),t._mouseup,l),t.events.$on(E,"mouseleave",l);var n=null;t.events.on("keydown",function(i){if(_){var s=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,o=i.which;o!==n||i.timeStamp,(o==e.FE.KEYCODE.EQUALS||t.browser.mozilla&&o==e.FE.KEYCODE.FF_EQUALS)&&s&&!i.altKey?d.call(this,i,1,1):(o==e.FE.KEYCODE.HYPHEN||t.browser.mozilla&&o==e.FE.KEYCODE.FF_HYPHEN)&&s&&!i.altKey&&d.call(this,i,2,-1),n=o,i.timeStamp}}),t.events.on("keyup",function(){})}}(),(t.$wp||e(t.opts.scrollableContainer)).append(k),k.data("instance",t);var i=_.find("iframe, embed, video");k.css("top",(t.opts.iframe?i.offset().top-1:i.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?i.offset().left-1:i.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",i.outerWidth()).css("height",i.height()).addClass("fr-active")}function h(i){if(i&&"touchend"==i.type&&S)return!0;if(i.preventDefault(),i.stopPropagation(),t.edit.isDisabled())return!1;for(var s=0;s<e.FE.INSTANCES.length;s++)e.FE.INSTANCES[s]!=t&&e.FE.INSTANCES[s].events.trigger("video.hideResizer");t.toolbar.disable(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),_=e(this),e(this).addClass("fr-active"),t.opts.iframe&&t.size.syncIframe(),u(),n(),t.selection.clear(),t.button.bulkRefresh(),t.events.trigger("image.hideResizer")}function p(e){_&&(t.shared.vid_exit_flag||!0===e)&&(k.removeClass("fr-active"),t.toolbar.enable(),_.removeClass("fr-active"),_=null,m())}function f(){t.shared.vid_exit_flag=!0}function m(){t.shared.vid_exit_flag=!1}function g(){var e="";if(t.opts.videoEditButtons.length>0){e+='<div class="fr-buttons">',e+=t.button.buildList(t.opts.videoEditButtons);var i={buttons:e+="</div>"},s=t.popups.create("video.edit",i);return t.events.$on(t.$wp,"scroll.video-edit",function(){_&&t.popups.isVisible("video.edit")&&n()}),s}return!1}function v(){if(_){var e=t.popups.get("video.size"),i=_.find("iframe, embed, video");e.find('input[name="width"]').val(i.get(0).style.width||i.attr("width")).trigger("change"),e.find('input[name="height"]').val(i.get(0).style.height||i.attr("height")).trigger("change")}}function b(){var i=t.popups.get("video.size");i||(i=y()),t.popups.refresh("video.size"),t.popups.setContainer("video.size",e(t.opts.scrollableContainer));var n=_.find("iframe, embed, video"),s=n.offset().left+n.width()/2,o=n.offset().top+n.height();t.popups.show("video.size",s,o,n.height())}function y(e){if(e)return t.popups.onRefresh("video.size",v),!0;var i={buttons:'<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"</div>",size_layer:'<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input id="fr-video-size-layer-width-'+t.id+'" type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-video-size-layer-height-'+t.id+'" type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2" role="button">'+t.language.translate("Update")+"</button></div></div>"},n=t.popups.create("video.size",i);return t.events.$on(t.$wp,"scroll",function(){_&&t.popups.isVisible("video.size")&&b()}),n}function w(){if(_&&!1!==t.events.trigger("video.beforeRemove",[_])){var e=_;t.popups.hideAll(),p(!0),t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),e.remove(),t.selection.restore(),t.html.fillEmptyBlocks(),t.events.trigger("video.removed",[e])}}function x(e){if(!e.hasClass("fr-dvi")&&!e.hasClass("fr-dvb")){var i=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",i),0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fvl"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fvr"),e.addClass("fr-dvb")):(e.css("float",i),"left"==e.css("float")?e.addClass("fr-fvl"):"right"==e.css("float")&&e.addClass("fr-fvr"),e.addClass("fr-dvi")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}t.opts.videoTextNear||e.removeClass("fr-dvi").addClass("fr-dvb")}function C(){t.$el.find("video").filter(function(){return 0===e(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),t.$el.find("embed, iframe").filter(function(){if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),e(this).parents("span.fr-video").length>0)return!1;for(var i=e(this).attr("src"),n=0;n<e.FE.VIDEO_PROVIDERS.length;n++){if(e.FE.VIDEO_PROVIDERS[n].test_regex.test(i))return!0}return!1}).map(function(){return 0===e(this).parents("object").length?this:e(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var i=t.$el.find("span.fr-video"),n=0;n<i.length;n++)x(e(i[n]));i.toggleClass("fr-draggable",t.opts.videoMove)}var E,T,k,_,S;return t.shared.vid_exit_flag=!1,{_init:function(){t.events.on("mousedown window.mousedown",f),t.events.on("window.touchmove",m),t.events.on("mouseup window.mouseup",p),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&p()}),t.events.on("blur video.hideResizer commands.undo commands.redo element.dropped",function(){p(!0)}),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","span.fr-video",function(){S=!1}),t.events.$on(t.$el,"touchmove",function(){S=!0})),t.events.on("html.set",C),C(),t.events.$on(t.$el,"mousedown","span.fr-video",function(e){e.stopPropagation()}),t.events.$on(t.$el,"click touchend","span.fr-video",h),t.events.on("keydown",function(i){var n=i.which;return!_||n!=e.FE.KEYCODE.BACKSPACE&&n!=e.FE.KEYCODE.DELETE?_&&n==e.FE.KEYCODE.ESC?(p(!0),i.preventDefault(),!1):_&&n!=e.FE.KEYCODE.F10&&!t.keys.isBrowserAction(i)?(i.preventDefault(),!1):void 0:(i.preventDefault(),w(),!1)},!0),t.events.on("toolbar.esc",function(){if(_)return t.events.disableBlur(),t.events.focus(),!1},!0),t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()}),s(!0),y(!0)},showInsertPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=t.popups.get("video.insert");if(i||(i=s()),!i.hasClass("fr-active")){t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb);var n=e.offset().left+e.outerWidth()/2,o=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("video.insert",n,o,e.outerHeight())}},showLayer:function(e){var i,n,s=t.popups.get("video.insert");if(!_&&!t.opts.toolbarInline){var o=t.$tb.find('.fr-command[data-cmd="insertVideo"]');i=o.offset().left+o.outerWidth()/2,n=o.offset().top+(t.opts.toolbarBottom?10:o.outerHeight()-10)}t.opts.toolbarInline&&(n=s.offset().top-t.helpers.getPX(s.css("margin-top")),s.hasClass("fr-above")&&(n+=s.outerHeight())),s.find(".fr-layer").removeClass("fr-active"),s.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("video.insert",i,n,0),t.accessibility.focusPopup(s)},refreshByURLButton:function(e){t.popups.get("video.insert").find(".fr-video-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},refreshEmbedButton:function(e){t.popups.get("video.insert").find(".fr-video-embed-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},insertByURL:function(i){void 0===i&&(i=t.popups.get("video.insert").find('.fr-video-by-url-layer input[type="text"]').val()||"");var n=null;if(t.helpers.isURL(i))for(var s=0;s<e.FE.VIDEO_PROVIDERS.length;s++){var r=e.FE.VIDEO_PROVIDERS[s];if(r.test_regex.test(i)){n=i.replace(r.url_regex,r.url_text),n=r.html.replace(/\{url\}/,n);break}}n?o(n):t.events.trigger("video.linkError",[i])},insertEmbed:function(i){void 0===i&&(i=t.popups.get("video.insert").find(".fr-video-embed-layer textarea").val()||""),0!==i.length&&e.FE.VIDEO_EMBED_REGEX.test(i)?o(i):t.events.trigger("video.codeError",[i])},insert:o,align:function(e){_.removeClass("fr-fvr fr-fvl"),"left"==e?_.addClass("fr-fvl"):"right"==e&&_.addClass("fr-fvr"),u(),n()},refreshAlign:function(e){return!!_&&void(_.hasClass("fr-fvl")?e.find("> *:first").replaceWith(t.icon.create("align-left")):_.hasClass("fr-fvr")?e.find("> *:first").replaceWith(t.icon.create("align-right")):e.find("> *:first").replaceWith(t.icon.create("align-justify")))},refreshAlignOnShow:function(e,t){var i="justify";_.hasClass("fr-fvl")?i="left":_.hasClass("fr-fvr")&&(i="right"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active").attr("aria-selected",!0)},display:function(e){_.removeClass("fr-dvi fr-dvb"),"inline"==e?_.addClass("fr-dvi"):"block"==e&&_.addClass("fr-dvb"),u(),n()},refreshDisplayOnShow:function(e,t){var i="block";_.hasClass("fr-dvi")&&(i="inline"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active").attr("aria-selected",!0)},remove:w,showSizePopup:b,back:function(){_?(t.events.disableBlur(),_.trigger("click")):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("video.insert"),t.toolbar.showInline())},setSize:function(e,i){if(_){var n=t.popups.get("video.size"),s=_.find("iframe, embed, video");s.css("width",e||n.find('input[name="width"]').val()),s.css("height",i||n.find('input[name="height"]').val()),s.get(0).style.width&&s.removeAttr("width"),s.get(0).style.height&&s.removeAttr("height"),n.find("input:focus").blur(),setTimeout(function(){_.trigger("click")},t.helpers.isAndroid()?50:0)}},get:function(){return _}}},e.FE.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()},plugin:"video"}),e.FE.DefineIcon("insertVideo",{NAME:"video"}),e.FE.DefineIcon("videoByURL",{NAME:"link"}),e.FE.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-by-url")},refresh:function(e){this.video.refreshByURLButton(e)}}),e.FE.DefineIcon("videoEmbed",{NAME:"code"}),e.FE.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-embed")},refresh:function(e){this.video.refreshEmbedButton(e)}}),e.FE.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),e.FE.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),e.FE.DefineIcon("videoDisplay",{NAME:"star"}),e.FE.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.video.display(t)},refresh:function(e){this.opts.videoTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.video.refreshDisplayOnShow(e,t)}}),e.FE.DefineIcon("videoAlign",{NAME:"align-center"}),e.FE.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.videoAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="videoAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+'<span class="fr-sr-only">'+this.language.translate(i[n])+"</span></a></li>");return t+"</ul>"},callback:function(e,t){this.video.align(t)},refresh:function(e){this.video.refreshAlign(e)},refreshOnShow:function(e,t){this.video.refreshAlignOnShow(e,t)}}),e.FE.DefineIcon("videoRemove",{NAME:"trash"}),e.FE.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),e.FE.DefineIcon("videoSize",{NAME:"arrows-alt"}),e.FE.RegisterCommand("videoSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.video.showSizePopup()}}),e.FE.DefineIcon("videoBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(e){this.video.get()||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("videoSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.video.setSize()}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_]"}),e.extend(e.FE.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15}),e.FE.PLUGINS.table=function(t){function i(){var i=b();if(i){var n=t.popups.get("table.edit");n||(n=l()),t.popups.setContainer("table.edit",e(t.opts.scrollableContainer));var s=T(i),o=(s.left+s.right)/2,r=s.bottom;t.popups.show("table.edit",o,r,s.bottom-s.top),t.edit.isDisabled()&&(t.toolbar.disable(),t.$el.removeClass("fr-no-selection"),t.edit.on(),t.button.bulkRefresh()),t.selection.setAtEnd(t.$el.find(".fr-selected-cell:last").get(0)),t.$el.focus(),t.selection.restore()}}function n(){var i=b();if(i){var n=t.popups.get("table.colors");n||(n=c()),t.popups.setContainer("table.colors",e(t.opts.scrollableContainer));var s=T(i),o=(s.left+s.right)/2,r=s.bottom;(function(){var e=t.popups.get("table.colors"),i=t.$el.find(".fr-selected-cell:first");e.find(".fr-selected-color").removeClass("fr-selected-color fr-active-item"),e.find('span[data-param1="'+t.helpers.RGBToHex(i.css("background-color"))+'"]').addClass("fr-selected-color fr-active-item")})(),t.popups.show("table.colors",o,r,s.bottom-s.top)}}function s(){0===X().length&&t.toolbar.enable()}function o(i){if(i)return t.popups.onHide("table.insert",function(){t.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),!0;var n="";t.opts.tableInsertButtons.length>0&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.tableInsertButtons)+"</div>");var s={buttons:n,rows_columns:a()},o=t.popups.create("table.insert",s);return t.events.$on(o,"mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(t){r(e(t.currentTarget))},!0),function(i){t.events.$on(i,"focus","[tabIndex]",function(t){var i=e(t.currentTarget);r(i)}),t.events.on("popup.tab",function(i){var n=e(i.currentTarget);if(!t.popups.isVisible("table.insert")||!n.is("span, a"))return!0;var s,o=i.which;if(e.FE.KEYCODE.ARROW_UP==o||e.FE.KEYCODE.ARROW_DOWN==o||e.FE.KEYCODE.ARROW_LEFT==o||e.FE.KEYCODE.ARROW_RIGHT==o){if(n.is("span.fr-table-cell")){var a=n.parent().find("span.fr-table-cell"),l=a.index(n),c=t.opts.tableInsertMaxSize,d=l%c,u=Math.floor(l/c);e.FE.KEYCODE.ARROW_UP==o?u=Math.max(0,u-1):e.FE.KEYCODE.ARROW_DOWN==o?u=Math.min(t.opts.tableInsertMaxSize-1,u+1):e.FE.KEYCODE.ARROW_LEFT==o?d=Math.max(0,d-1):e.FE.KEYCODE.ARROW_RIGHT==o&&(d=Math.min(t.opts.tableInsertMaxSize-1,d+1));var h=u*c+d,p=e(a.get(h));r(p),t.events.disableBlur(),p.focus(),s=!1}}else e.FE.KEYCODE.ENTER==o&&(t.button.exec(n),s=!1);return!1===s&&(i.preventDefault(),i.stopPropagation()),s},!0)}(o),o}function r(e){var i=e.data("row"),n=e.data("col"),s=e.parent();s.siblings(".fr-table-size-info").html(i+" &times; "+n),s.find("> span").removeClass("hover fr-active-item");for(var o=1;o<=t.opts.tableInsertMaxSize;o++)for(var r=0;r<=t.opts.tableInsertMaxSize;r++){var a=s.find('> span[data-row="'+o+'"][data-col="'+r+'"]');o<=i&&r<=n?a.addClass("hover"):o<=i+1||o<=2&&!t.helpers.isMobile()?a.css("display","inline-block"):o>2&&!t.helpers.isMobile()&&a.css("display","none")}e.addClass("fr-active-item")}function a(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',i=1;i<=t.opts.tableInsertMaxSize;i++){for(var n=1;n<=t.opts.tableInsertMaxSize;n++){var s="inline-block";i>2&&!t.helpers.isMobile()&&(s="none");var o="fr-table-cell ";1==i&&1==n&&(o+=" hover"),e+='<span class="fr-command '+o+'" tabIndex="-1" data-cmd="tableInsert" data-row="'+i+'" data-col="'+n+'" data-param1="'+i+'" data-param2="'+n+'" style="display: '+s+';" role="button"><span></span><span class="fr-sr-only">'+i+" &times; "+n+"&nbsp;&nbsp;&nbsp;</span></span>"}e+='<div class="new-line"></div>'}return e+"</div></div>"}function l(e){if(e)return t.popups.onHide("table.edit",s),!0;var n="";t.opts.tableEditButtons.length>0&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.tableEditButtons)+"</div>");var o={buttons:n},r=t.popups.create("table.edit",o);return t.events.$on(t.$wp,"scroll.table-edit",function(){t.popups.isVisible("table.edit")&&i()}),r}function c(){var e="";t.opts.tableColorsButtons.length>0&&(e='<div class="fr-buttons fr-table-colors-buttons">'+t.button.buildList(t.opts.tableColorsButtons)+"</div>");var i={buttons:e,colors:d()},s=t.popups.create("table.colors",i);return t.events.$on(t.$wp,"scroll.table-colors",function(){t.popups.isVisible("table.colors")&&n()}),u(s),s}function d(){for(var e='<div class="fr-table-colors">',i=0;i<t.opts.tableColors.length;i++)0!==i&&i%t.opts.tableColorsStep==0&&(e+="<br>"),e+="REMOVE"!=t.opts.tableColors[i]?'<span class="fr-command" style="background: '+t.opts.tableColors[i]+';" tabIndex="-1" role="button" data-cmd="tableCellBackgroundColor" data-param1="'+t.opts.tableColors[i]+'"><span class="fr-sr-only">'+t.language.translate("Color")+" "+t.opts.tableColors[i]+"&nbsp;&nbsp;&nbsp;</span></span>":'<span class="fr-command" data-cmd="tableCellBackgroundColor" tabIndex="-1" role="button" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'"><i class="fa fa-eraser"></i><span class="fr-sr-only">'+t.language.translate("Clear Formatting")+"</span></span>";return e+"</div>"}function u(i){t.events.on("popup.tab",function(n){var s=e(n.currentTarget);if(!t.popups.isVisible("table.colors")||!s.is("span"))return!0;var o=n.which,r=!0;if(e.FE.KEYCODE.TAB==o){var a=i.find(".fr-buttons");r=!t.accessibility.focusToolbar(a,!!n.shiftKey)}else if(e.FE.KEYCODE.ARROW_UP==o||e.FE.KEYCODE.ARROW_DOWN==o||e.FE.KEYCODE.ARROW_LEFT==o||e.FE.KEYCODE.ARROW_RIGHT==o){var l=s.parent().find("span.fr-command"),c=l.index(s),d=t.opts.colorsStep,u=Math.floor(l.length/d),h=c%d,p=Math.floor(c/d)*d+h,f=u*d;e.FE.KEYCODE.ARROW_UP==o?p=((p-d)%f+f)%f:e.FE.KEYCODE.ARROW_DOWN==o?p=(p+d)%f:e.FE.KEYCODE.ARROW_LEFT==o?p=((p-1)%f+f)%f:e.FE.KEYCODE.ARROW_RIGHT==o&&(p=(p+1)%f);var m=e(l.get(p));t.events.disableBlur(),m.focus(),r=!1}else e.FE.KEYCODE.ENTER==o&&(t.button.exec(s),r=!1);return!1===r&&(n.preventDefault(),n.stopPropagation()),r},!0)}function h(){if(X().length>0){var e=Q();t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),t.selection.restore(),t.popups.hide("table.edit"),e.remove(),t.toolbar.enable()}}function p(n){var s=Q();if(s.length>0){if(t.$el.find("th.fr-selected-cell").length>0&&"above"==n)return;var o,r,a=b(),l=E(a);r="above"==n?l.min_i:l.max_i;var c="<tr>";for(o=0;o<a[r].length;o++)if("below"==n&&r<a.length-1&&a[r][o]==a[r+1][o]||"above"==n&&r>0&&a[r][o]==a[r-1][o]){if(0===o||o>0&&a[r][o]!=a[r][o-1]){var d=e(a[r][o]);d.attr("rowspan",parseInt(d.attr("rowspan"),10)+1)}}else c+="<td><br></td>";c+="</tr>";var u=e(s.find("tr").not(s.find("table tr")).get(r));"below"==n?u.after(c):"above"==n&&(u.before(c),t.popups.isVisible("table.edit")&&i())}}function f(e,t,i){var n,s,o,r,a,l=0,c=b(i);for(t=Math.min(t,c[0].length-1),s=e;s<=t;s++)if(!(s>e&&c[0][s]==c[0][s-1])&&((r=parseInt(c[0][s].getAttribute("colspan"),10)||1)>1&&c[0][s]==c[0][s+1]))for(l=r-1,n=1;n<c.length;n++)if(c[n][s]!=c[n-1][s]){for(o=s;o<s+r;o++)if((a=parseInt(c[n][o].getAttribute("colspan"),10)||1)>1&&c[n][o]==c[n][o+1])o+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&g(c,l,"colspan",0,c.length-1,e,t)}function m(e,t,i){var n,s,o,r,a,l=0,c=b(i);for(t=Math.min(t,c.length-1),n=e;n<=t;n++)if(!(n>e&&c[n][0]==c[n-1][0])&&((r=parseInt(c[n][0].getAttribute("rowspan"),10)||1)>1&&c[n][0]==c[n+1][0]))for(l=r-1,s=1;s<c[0].length;s++)if(c[n][s]!=c[n][s-1]){for(o=n;o<n+r;o++)if((a=parseInt(c[o][s].getAttribute("rowspan"),10)||1)>1&&c[o][s]==c[o+1][s])o+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&g(c,l,"rowspan",e,t,0,c[0].length-1)}function g(e,t,i,n,s,o,r){var a,l,c;for(a=n;a<=s;a++)for(l=o;l<=r;l++)a>n&&e[a][l]==e[a-1][l]||l>o&&e[a][l]==e[a][l-1]||(c=parseInt(e[a][l].getAttribute(i),10)||1)>1&&(c-t>1?e[a][l].setAttribute(i,c-t):e[a][l].removeAttribute(i))}function v(e,t,i,n,s){m(e,t,s),f(i,n,s)}function b(t){var i=[];if(null==(t=t||null)&&X().length>0&&(t=Q()),t)return t.find("tr").not(t.find("table tr")).each(function(t,n){var s=e(n),o=0;s.find("> th, > td").each(function(n,s){for(var r=e(s),a=parseInt(r.attr("colspan"),10)||1,l=parseInt(r.attr("rowspan"),10)||1,c=t;c<t+l;c++)for(var d=o;d<o+a;d++)i[c]||(i[c]=[]),i[c][d]?o++:i[c][d]=s;o+=a})}),i}function y(e,t){for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)if(t[i][n]==e)return{row:i,col:n}}function w(e,t,i){for(var n=e+1,s=t+1;n<i.length;){if(i[n][t]!=i[e][t]){n--;break}n++}for(n==i.length&&n--;s<i[e].length;){if(i[e][s]!=i[e][t]){s--;break}s++}return s==i[e].length&&s--,{row:n,col:s}}function x(){var i=t.$el.find(".fr-selected-cell");i.length>0&&i.each(function(){var t=e(this);t.removeClass("fr-selected-cell"),""===t.attr("class")&&t.removeAttr("class")}),t.el.querySelector(".fr-cell-fixed")&&(t.el.querySelector(".fr-cell-fixed").classList.remove("fr-cell-fixed"),t.el.querySelector(".fr-cell-handler").classList.remove("fr-cell-handler"))}function C(){setTimeout(function(){t.selection.clear(),t.$el.addClass("fr-no-selection"),t.$el.blur()},0)}function E(e){var i=t.$el.find(".fr-selected-cell");if(i.length>0){var n,s=e.length,o=0,r=e[0].length,a=0;for(n=0;n<i.length;n++){var l=y(i[n],e),c=w(l.row,l.col,e);s=Math.min(l.row,s),o=Math.max(c.row,o),r=Math.min(l.col,r),a=Math.max(c.col,a)}return{min_i:s,max_i:o,min_j:r,max_j:a}}return null}function T(t){var i=E(t),n=e(t[i.min_i][i.min_j]),s=e(t[i.min_i][i.max_j]),o=e(t[i.max_i][i.min_j]);return{left:n.offset().left,right:s.offset().left+s.outerWidth(),top:n.offset().top,bottom:o.offset().top+o.outerHeight()}}function k(i,n){if(e(i).is(n))x(),t.edit.on(),e(i).addClass("fr-selected-cell");else{C(),t.edit.off();var s=b(),o=y(i,s),r=y(n,s),a=function t(i,n,s,o,r){var a,l,c,d,u=i,h=n,p=s,f=o;for(a=u;a<=h;a++)((parseInt(e(r[a][p]).attr("rowspan"),10)||1)>1||(parseInt(e(r[a][p]).attr("colspan"),10)||1)>1)&&(d=w((c=y(r[a][p],r)).row,c.col,r),u=Math.min(c.row,u),h=Math.max(d.row,h),p=Math.min(c.col,p),f=Math.max(d.col,f)),((parseInt(e(r[a][f]).attr("rowspan"),10)||1)>1||(parseInt(e(r[a][f]).attr("colspan"),10)||1)>1)&&(d=w((c=y(r[a][f],r)).row,c.col,r),u=Math.min(c.row,u),h=Math.max(d.row,h),p=Math.min(c.col,p),f=Math.max(d.col,f));for(l=p;l<=f;l++)((parseInt(e(r[u][l]).attr("rowspan"),10)||1)>1||(parseInt(e(r[u][l]).attr("colspan"),10)||1)>1)&&(d=w((c=y(r[u][l],r)).row,c.col,r),u=Math.min(c.row,u),h=Math.max(d.row,h),p=Math.min(c.col,p),f=Math.max(d.col,f)),((parseInt(e(r[h][l]).attr("rowspan"),10)||1)>1||(parseInt(e(r[h][l]).attr("colspan"),10)||1)>1)&&(d=w((c=y(r[h][l],r)).row,c.col,r),u=Math.min(c.row,u),h=Math.max(d.row,h),p=Math.min(c.col,p),f=Math.max(d.col,f));return u==i&&h==n&&p==s&&f==o?{min_i:i,max_i:n,min_j:s,max_j:o}:t(u,h,p,f,r)}(Math.min(o.row,r.row),Math.max(o.row,r.row),Math.min(o.col,r.col),Math.max(o.col,r.col),s);x(),i.classList.add("fr-cell-fixed"),n.classList.add("fr-cell-handler");for(var l=a.min_i;l<=a.max_i;l++)for(var c=a.min_j;c<=a.max_j;c++)e(s[l][c]).addClass("fr-selected-cell")}}function _(i){var n=null,s=e(i.target);return"TD"==i.target.tagName||"TH"==i.target.tagName?n=i.target:s.closest("td").length>0?n=s.closest("td").get(0):s.closest("th").length>0&&(n=s.closest("th").get(0)),0===t.$el.find(n).length?null:n}function S(){x(),t.popups.hide("table.edit")}function D(i){var n=_(i);if(X().length>0&&!n&&S(),!t.edit.isDisabled()||t.popups.isVisible("table.edit"))if(1!=i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)(3==i.which||1==i.which&&t.helpers.isMac()&&i.ctrlKey)&&n&&S();else if(ne=!0,n){X().length>0&&!i.shiftKey&&S(),i.stopPropagation(),t.events.trigger("image.hideResizer"),t.events.trigger("video.hideResizer"),ie=!0;var s=n.tagName.toLowerCase();i.shiftKey&&t.$el.find(s+".fr-selected-cell").length>0?e(t.$el.find(s+".fr-selected-cell").closest("table")).is(e(n).closest("table"))?k(se,n):C():((t.keys.ctrlKey(i)||i.shiftKey)&&(X().length>1||0===e(n).find(t.selection.element()).length&&!e(n).is(t.selection.element()))&&C(),k(se=n,se))}}function $(n){if(ie||t.$tb.is(n.target)||t.$tb.is(e(n.target).closest(t.$tb.get(0)))||(X().length>0&&t.toolbar.enable(),x()),!(1!=n.which||1==n.which&&t.helpers.isMac()&&n.ctrlKey)){if(ne=!1,ie)ie=!1,_(n)||1!=X().length?X().length>0&&(t.selection.isCollapsed()?i():x()):x();if(re){re=!1,ee.removeClass("fr-moving"),t.$el.removeClass("fr-no-selection"),t.edit.on();var s=parseFloat(ee.css("left"))+t.opts.tableResizerOffset;t.opts.iframe&&(s-=t.$iframe.offset().left),ee.data("release-position",s),ee.removeData("max-left"),ee.removeData("max-right"),function(){var i=ee.data("origin"),n=ee.data("release-position");if(i!==n){var s=ee.data("first"),o=ee.data("second"),r=ee.data("table"),a=r.outerWidth();if(null!==s&&null!==o){var l,c,d,u=b(r),h=[],p=[],f=[],m=[];for(l=0;l<u.length;l++)c=e(u[l][s]),d=e(u[l][o]),h[l]=c.outerWidth(),f[l]=d.outerWidth(),p[l]=h[l]/a*100,m[l]=f[l]/a*100;for(l=0;l<u.length;l++){c=e(u[l][s]),d=e(u[l][o]);var g=(p[l]*(h[l]+n-i)/h[l]).toFixed(4);c.css("width",g+"%"),d.css("width",(p[l]+m[l]-g).toFixed(4)+"%")}}else{var v,y=r.parent(),w=a/y.width()*100;"rtl"==t.opts.direction?0===o?(v=(a+n-i)/a*w,r.css("margin-right","calc(100% - "+Math.round(v).toFixed(4)+"% - "+(parseInt(r.css("margin-left"),10)||0)+"px)")):(v=(a-n+i)/a*w,r.css("margin-left","calc(100% - "+Math.round(v).toFixed(4)+"% - "+(parseInt(r.css("margin-right"),10)||0)+"px)")):0===o?(v=(a-n+i)/a*w,r.css("margin-left","calc(100% - "+Math.round(v).toFixed(4)+"% - "+(parseInt(r.css("margin-right"),10)||0)+"px)")):(v=(a+n-i)/a*w,r.css("margin-right","calc(100% - "+Math.round(v).toFixed(4)+"% - "+(parseInt(r.css("margin-left"),10)||0)+"px)")),r.css("width",Math.round(v).toFixed(4)+"%")}t.selection.restore(),t.undo.saveStep()}ee.removeData("origin"),ee.removeData("release-position"),ee.removeData("first"),ee.removeData("second"),ee.removeData("table")}(),R()}}}function M(i){if(!0===ie){if(e(i.currentTarget).closest("table").is(Q())){if("TD"==i.currentTarget.tagName&&0===t.$el.find("th.fr-selected-cell").length)return void k(se,i.currentTarget);if("TH"==i.currentTarget.tagName&&0===t.$el.find("td.fr-selected-cell").length)return void k(se,i.currentTarget)}C()}}function A(i,n){for(var s=i;s&&"TABLE"!=s.tagName&&s.parentNode!=t.el;)s=s.parentNode;if(s&&"TABLE"==s.tagName){var o=b(e(s));"up"==n?F(y(i,o),s,o):"down"==n&&N(y(i,o),s,o)}}function O(e,i,n,s){for(var o,r=i;r!=t.el&&"TD"!=r.tagName&&"TH"!=r.tagName&&("up"==s?o=r.previousElementSibling:"down"==s&&(o=r.nextElementSibling),!o);)r=r.parentNode;"TD"==r.tagName||"TH"==r.tagName?A(r,s):o&&("up"==s&&t.selection.setAtEnd(o),"down"==s&&t.selection.setAtStart(o))}function F(e,i,n){e.row>0?t.selection.setAtEnd(n[e.row-1][e.col]):O(0,i,0,"up")}function N(e,i,n){var s=parseInt(n[e.row][e.col].getAttribute("rowspan"),10)||1;e.row<n.length-s?t.selection.setAtStart(n[e.row+s][e.col]):O(0,i,0,"down")}function L(i){var n=i.which,s=t.selection.blocks();if(s.length&&("TD"==(s=s[0]).tagName||"TH"==s.tagName)){for(var o=s;o&&"TABLE"!=o.tagName&&o.parentNode!=t.el;)o=o.parentNode;if(o&&"TABLE"==o.tagName&&(e.FE.KEYCODE.ARROW_LEFT==n||e.FE.KEYCODE.ARROW_UP==n||e.FE.KEYCODE.ARROW_RIGHT==n||e.FE.KEYCODE.ARROW_DOWN==n)&&(X().length>0&&S(),t.browser.webkit&&(e.FE.KEYCODE.ARROW_UP==n||e.FE.KEYCODE.ARROW_DOWN==n))){var r=t.selection.ranges(0).startContainer;if(r.nodeType==Node.TEXT_NODE&&(e.FE.KEYCODE.ARROW_UP==n&&r.previousSibling||e.FE.KEYCODE.ARROW_DOWN==n&&r.nextSibling))return;i.preventDefault(),i.stopPropagation();var a=b(e(o)),l=y(s,a);return e.FE.KEYCODE.ARROW_UP==n?F(l,o,a):e.FE.KEYCODE.ARROW_DOWN==n&&N(l,o,a),t.selection.restore(),!1}}}function R(){ee&&(ee.find("div").css("opacity",0),ee.css("top",0),ee.css("left",0),ee.css("height",0),ee.find("div").css("height",0),ee.hide())}function I(){te&&te.removeClass("fr-visible").css("left","-9999px")}function P(i,n){var s=e(n),o=s.closest("table"),r=o.parent();if(n&&"TD"!=n.tagName&&"TH"!=n.tagName&&(s.closest("td").length>0?n=s.closest("td"):s.closest("th").length>0&&(n=s.closest("th"))),!n||"TD"!=n.tagName&&"TH"!=n.tagName)ee&&s.get(0)!=ee.get(0)&&s.parent().get(0)!=ee.get(0)&&t.core.sameInstance(ee)&&R();else{if(s=e(n),0===t.$el.find(s).length)return!1;var a=s.offset().left-1,l=a+s.outerWidth();if(Math.abs(i.pageX-a)<=t.opts.tableResizerOffset||Math.abs(l-i.pageX)<=t.opts.tableResizerOffset){var c,d,u,h,p,f=b(o),m=y(n,f),g=w(m.row,m.col,f),v=o.offset().top,x=o.outerHeight()-1;"rtl"!=t.opts.direction?i.pageX-a<=t.opts.tableResizerOffset?(u=a,m.col>0?(h=a-K(m.col-1,f)+t.opts.tableResizingLimit,p=a+K(m.col,f)-t.opts.tableResizingLimit,c=m.col-1,d=m.col):(c=null,d=0,h=o.offset().left-1-parseInt(o.css("margin-left"),10),p=o.offset().left-1+o.width()-f[0].length*t.opts.tableResizingLimit)):l-i.pageX<=t.opts.tableResizerOffset&&(u=l,g.col<f[g.row].length&&f[g.row][g.col+1]?(h=l-K(g.col,f)+t.opts.tableResizingLimit,p=l+K(g.col+1,f)-t.opts.tableResizingLimit,c=g.col,d=g.col+1):(c=g.col,d=null,h=o.offset().left-1+f[0].length*t.opts.tableResizingLimit,p=r.offset().left-1+r.width()+parseFloat(r.css("padding-left")))):l-i.pageX<=t.opts.tableResizerOffset?(u=l,m.col>0?(h=l-K(m.col,f)+t.opts.tableResizingLimit,p=l+K(m.col-1,f)-t.opts.tableResizingLimit,c=m.col,d=m.col-1):(c=null,d=0,h=o.offset().left+f[0].length*t.opts.tableResizingLimit,p=r.offset().left-1+r.width()+parseFloat(r.css("padding-left")))):i.pageX-a<=t.opts.tableResizerOffset&&(u=a,g.col<f[g.row].length&&f[g.row][g.col+1]?(h=a-K(g.col+1,f)+t.opts.tableResizingLimit,p=a+K(g.col,f)-t.opts.tableResizingLimit,c=g.col+1,d=g.col):(c=g.col,d=null,h=r.offset().left+parseFloat(r.css("padding-left")),p=o.offset().left-1+o.width()-f[0].length*t.opts.tableResizingLimit)),ee||(t.shared.$table_resizer||(t.shared.$table_resizer=e('<div class="fr-table-resizer"><div></div></div>')),ee=t.shared.$table_resizer,t.events.$on(ee,"mousedown",function(e){return!t.core.sameInstance(ee)||(X().length>0&&S(),1==e.which?(t.selection.save(),re=!0,ee.addClass("fr-moving"),C(),t.edit.off(),ee.find("div").css("opacity",1),!1):void 0)}),t.events.$on(ee,"mousemove",function(e){return!t.core.sameInstance(ee)||void(re&&(t.opts.iframe&&(e.pageX-=t.$iframe.offset().left),V(e)))}),t.events.on("shared.destroy",function(){ee.html("").removeData().remove(),ee=null},!0),t.events.on("destroy",function(){t.$el.find(".fr-selected-cell").removeClass("fr-selected-cell"),ee.hide().appendTo(e("body"))},!0)),ee.data("table",o),ee.data("first",c),ee.data("second",d),ee.data("instance",t),t.$wp.append(ee);var E=u-t.win.pageXOffset-t.opts.tableResizerOffset,T=v-t.win.pageYOffset;t.opts.iframe&&(E+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),T+=t.$iframe.offset().top-e(t.o_win).scrollTop(),h+=t.$iframe.offset().left,p+=t.$iframe.offset().left),ee.data("max-left",h),ee.data("max-right",p),ee.data("origin",u-t.win.pageXOffset),ee.css("top",T),ee.css("left",E),ee.css("height",x),ee.find("div").css("height",x),ee.css("padding-left",t.opts.tableResizerOffset),ee.css("padding-right",t.opts.tableResizerOffset),ee.show()}else t.core.sameInstance(ee)&&R()}}function B(i,n){if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;te||q(),t.$box.append(te),te.data("instance",t);var s,o=e(n).find("tr:first"),r=i.pageX,a=0,l=0;t.opts.iframe&&(a+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),l+=t.$iframe.offset().top-e(t.o_win).scrollTop()),o.find("th, td").each(function(){var i=e(this);return i.offset().left<=r&&r<i.offset().left+i.outerWidth()/2?(s=parseInt(te.find("a").css("width"),10),te.css("top",l+i.offset().top-t.win.pageYOffset-s-5),te.css("left",a+i.offset().left-t.win.pageXOffset-s/2),te.data("selected-cell",i),te.data("position","before"),te.addClass("fr-visible"),!1):i.offset().left+i.outerWidth()/2<=r&&r<i.offset().left+i.outerWidth()?(s=parseInt(te.find("a").css("width"),10),te.css("top",l+i.offset().top-t.win.pageYOffset-s-5),te.css("left",a+i.offset().left+i.outerWidth()-t.win.pageXOffset-s/2),te.data("selected-cell",i),te.data("position","after"),te.addClass("fr-visible"),!1):void 0})}function H(i,n){if(t.$box.find(".fr-line-breaker").is(":visible"))return!1;te||q(),t.$box.append(te),te.data("instance",t);var s,o=e(n),r=i.pageY,a=0,l=0;t.opts.iframe&&(a+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),l+=t.$iframe.offset().top-e(t.o_win).scrollTop()),o.find("tr").each(function(){var i=e(this);return i.offset().top<=r&&r<i.offset().top+i.outerHeight()/2?(s=parseInt(te.find("a").css("width"),10),te.css("top",l+i.offset().top-t.win.pageYOffset-s/2),te.css("left",a+i.offset().left-t.win.pageXOffset-s-5),te.data("selected-cell",i.find("td:first")),te.data("position","above"),te.addClass("fr-visible"),!1):i.offset().top+i.outerHeight()/2<=r&&r<i.offset().top+i.outerHeight()?(s=parseInt(te.find("a").css("width"),10),te.css("top",l+i.offset().top+i.outerHeight()-t.win.pageYOffset-s/2),te.css("left",a+i.offset().left-t.win.pageXOffset-s-5),te.data("selected-cell",i.find("td:first")),te.data("position","below"),te.addClass("fr-visible"),!1):void 0})}function U(i,n){if(0===X().length){var s,o,r;if(n&&("HTML"==n.tagName||"BODY"==n.tagName||t.node.isElement(n)))for(s=1;s<=t.opts.tableInsertHelperOffset;s++){if(o=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset,i.pageY-t.win.pageYOffset+s),e(o).hasClass("fr-tooltip"))return!0;if(o&&("TH"==o.tagName||"TD"==o.tagName||"TABLE"==o.tagName)&&(e(o).parents(".fr-wrapper").length||t.opts.iframe))return B(i,e(o).closest("table")),!0;if(r=t.doc.elementFromPoint(i.pageX-t.win.pageXOffset+s,i.pageY-t.win.pageYOffset),e(r).hasClass("fr-tooltip"))return!0;if(r&&("TH"==r.tagName||"TD"==r.tagName||"TABLE"==r.tagName)&&(e(r).parents(".fr-wrapper").length||t.opts.iframe))return H(i,e(r).closest("table")),!0}t.core.sameInstance(te)&&I()}}function z(e){oe=null;var i=t.doc.elementFromPoint(e.pageX-t.win.pageXOffset,e.pageY-t.win.pageYOffset);t.opts.tableResizer&&(!t.popups.areVisible()||t.popups.areVisible()&&t.popups.isVisible("table.edit"))&&P(e,i),!t.opts.tableInsertHelper||t.popups.areVisible()||t.$tb.hasClass("fr-inline")&&t.$tb.is(":visible")||U(e,i)}function j(){if(re){var i=ee.data("table").offset().top-t.win.pageYOffset;t.opts.iframe&&(i+=t.$iframe.offset().top-e(t.o_win).scrollTop()),ee.css("top",i)}}function K(t,i){var n,s=e(i[0][t]).outerWidth();for(n=1;n<i.length;n++)s=Math.min(s,e(i[n][t]).outerWidth());return s}function W(e,t,i){var n,s=0;for(n=e;n<=t;n++)s+=K(n,i);return s}function V(e){if(X().length>1&&ne&&C(),!1===ne&&!1===ie&&!1===re)oe&&clearTimeout(oe),t.edit.isDisabled()&&!t.popups.isVisible("table.edit")||(oe=setTimeout(z,30,e));else if(re){var i=e.pageX-t.win.pageXOffset;t.opts.iframe&&(i+=t.$iframe.offset().left);var n=ee.data("max-left"),s=ee.data("max-right");i>=n&&i<=s?ee.css("left",i-t.opts.tableResizerOffset):i<n&&parseFloat(ee.css("left"),10)>n-t.opts.tableResizerOffset?ee.css("left",n-t.opts.tableResizerOffset):i>s&&parseFloat(ee.css("left"),10)<s-t.opts.tableResizerOffset&&ee.css("left",s-t.opts.tableResizerOffset)}else ne&&I()}function Y(i){t.node.isEmpty(i.get(0))?i.prepend(e.FE.MARKERS):i.prepend(e.FE.START_MARKER).append(e.FE.END_MARKER)}function q(){t.shared.$ti_helper||(t.shared.$ti_helper=e('<div class="fr-insert-helper"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+t.language.translate("Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a></div>'),t.events.bindClick(t.shared.$ti_helper,"a",function(){var e=te.data("selected-cell"),i=te.data("position"),n=te.data("instance")||t;"before"==i?(e.addClass("fr-selected-cell"),n.table.insertColumn(i),e.removeClass("fr-selected-cell")):"after"==i?(e.addClass("fr-selected-cell"),n.table.insertColumn(i),e.removeClass("fr-selected-cell")):"above"==i?(e.addClass("fr-selected-cell"),n.table.insertRow(i),e.removeClass("fr-selected-cell")):"below"==i&&(e.addClass("fr-selected-cell"),n.table.insertRow(i),e.removeClass("fr-selected-cell")),I()}),t.events.on("shared.destroy",function(){t.shared.$ti_helper.html("").removeData().remove(),t.shared.$ti_helper=null},!0),t.events.$on(t.shared.$ti_helper,"mousemove",function(e){e.stopPropagation()},!0),t.events.$on(e(t.o_win),"scroll",function(){I()},!0),t.events.$on(t.$wp,"scroll",function(){I()},!0)),te=t.shared.$ti_helper,t.events.on("destroy",function(){te=null}),t.tooltip.bind(t.$box,".fr-insert-helper > a.fr-floating-btn")}function G(){se=null,clearTimeout(oe)}function X(){return t.el.querySelectorAll(".fr-selected-cell")}function Q(){var i=X();if(i.length){for(var n=i[0];n&&"TABLE"!=n.tagName&&n.parentNode!=t.el;)n=n.parentNode;return e(n&&"TABLE"==n.tagName?n:[])}return e([])}function Z(n){if(n.altKey&&n.which==e.FE.KEYCODE.SPACE){var s,o=t.selection.element();if("TD"==o.tagName||"TH"==o.tagName?s=o:e(o).closest("td").length>0?s=e(o).closest("td").get(0):e(o).closest("th").length>0&&(s=e(o).closest("th").get(0)),s)return n.preventDefault(),k(s,s),i(),!1}}function J(i){var n=X();if(n.length>0){var s,o,r=b(),a=i.which;1==n.length?o=s=n[0]:(s=t.el.querySelector(".fr-cell-fixed"),o=t.el.querySelector(".fr-cell-handler"));var l=y(o,r);if(e.FE.KEYCODE.ARROW_RIGHT==a){if(l.col<r[0].length-1)return k(s,r[l.row][l.col+1]),!1}else if(e.FE.KEYCODE.ARROW_DOWN==a){if(l.row<r.length-1)return k(s,r[l.row+1][l.col]),!1}else if(e.FE.KEYCODE.ARROW_LEFT==a){if(l.col>0)return k(s,r[l.row][l.col-1]),!1}else if(e.FE.KEYCODE.ARROW_UP==a&&l.row>0)return k(s,r[l.row-1][l.col]),!1}}var ee,te,ie,ne,se,oe,re;return{_init:function(){if(!t.$wp)return!1;if(!t.helpers.isMobile()){ne=!1,ie=!1,re=!1,t.events.$on(t.$el,"mousedown",D),t.popups.onShow("image.edit",function(){x(),ne=!1,ie=!1}),t.popups.onShow("link.edit",function(){x(),ne=!1,ie=!1}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&x()}),t.events.$on(t.$el,"mouseenter","th, td",M),t.events.$on(t.$win,"mouseup",$),t.opts.iframe&&t.events.$on(e(t.o_win),"mouseup",$),t.events.$on(t.$win,"mousemove",V),t.events.$on(e(t.o_win),"scroll",j),t.events.on("contentChanged",function(){X().length>0&&(i(),t.$el.find("img").on("load.selected-cells",function(){e(this).off("load.selected-cells"),X().length>0&&i()}))}),t.events.$on(e(t.o_win),"resize",function(){x()}),t.events.on("toolbar.esc",function(){if(X().length>0)return t.events.disableBlur(),t.events.focus(),!1},!0),t.events.$on(t.$el,"keydown",function(e){e.shiftKey?!1===J(e)&&setTimeout(function(){i()},0):L(e)}),t.events.on("keydown",function(i){if(!1===function(i){if(i.which==e.FE.KEYCODE.TAB){var n;if(X().length>0)n=t.$el.find(".fr-selected-cell:last");else{var s=t.selection.element();"TD"==s.tagName||"TH"==s.tagName?n=e(s):e(s).closest("td").length>0?n=e(s).closest("td"):e(s).closest("th").length>0&&(n=e(s).closest("th"))}if(n)return i.preventDefault(),S(),i.shiftKey?n.prev().length>0?Y(n.prev()):n.closest("tr").length>0&&n.closest("tr").prev().length>0?Y(n.closest("tr").prev().find("td:last")):n.closest("tbody").length>0&&n.closest("table").find("thead tr").length>0&&Y(n.closest("table").find("thead tr th:last")):n.next().length>0?Y(n.next()):n.closest("tr").length>0&&n.closest("tr").next().length>0?Y(n.closest("tr").next().find("td:first")):n.closest("thead").length>0&&n.closest("table").find("tbody tr").length>0?Y(n.closest("table").find("tbody tr td:first")):(n.addClass("fr-selected-cell"),p("below"),x(),Y(n.closest("tr").next().find("td:first"))),t.selection.restore(),!1}}(i))return!1;var n=X();if(n.length>0){if(i.which==e.FE.KEYCODE.ESC&&t.popups.isVisible("table.edit"))return x(),t.popups.hide("table.edit"),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),n=[],!1;if(n.length>1&&i.which==e.FE.KEYCODE.BACKSPACE){t.undo.saveStep();for(var s=0;s<n.length;s++)e(n[s]).html("<br>"),s==n.length-1&&e(n[s]).prepend(e.FE.MARKERS);return t.selection.restore(),t.undo.saveStep(),n=[],!1}if(n.length>1&&i.which!=e.FE.KEYCODE.F10&&!t.keys.isBrowserAction(i))return i.preventDefault(),n=[],!1}else if(n=[],!1===Z(i))return!1},!0);var n=[];t.events.on("html.beforeGet",function(){n=X();for(var e=0;e<n.length;e++)n[e].className=(n[e].className||"").replace(/fr-selected-cell/g,"")}),t.events.on("html.get",function(e){return e.replace(/<(td|th)((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,"<$1$2$3>$4</$5>")}),t.events.on("html.afterGet",function(){for(var e=0;e<n.length;e++)n[e].className=(n[e].className?n[e].className.trim()+" ":"")+"fr-selected-cell";n=[]}),o(!0),l(!0)}t.events.on("destroy",G)},insert:function(i,n){var s,o,r='<table style="width: 100%;"><tbody>',a=100/n;for(s=0;s<i;s++){for(r+="<tr>",o=0;o<n;o++)r+='<td style="width: '+a.toFixed(4)+'%;">',0===s&&0===o&&(r+=e.FE.MARKERS),r+="<br></td>";r+="</tr>"}r+="</tbody></table>",t.html.insert(r),t.selection.restore()},remove:h,insertRow:p,deleteRow:function(){var i=Q();if(i.length>0){var n,s,o,r=b(),a=E(r);if(0===a.min_i&&a.max_i==r.length-1)h();else{for(n=a.max_i;n>=a.min_i;n--){for(o=e(i.find("tr").not(i.find("table tr")).get(n)),s=0;s<r[n].length;s++)if(0===s||r[n][s]!=r[n][s-1]){var l=e(r[n][s]);if(parseInt(l.attr("rowspan"),10)>1){var c=parseInt(l.attr("rowspan"),10)-1;1==c?l.removeAttr("rowspan"):l.attr("rowspan",c)}if(n<r.length-1&&r[n][s]==r[n+1][s]&&(0===n||r[n][s]!=r[n-1][s])){for(var d=r[n][s],u=s;u>0&&r[n][u]==r[n][u-1];)u--;0===u?e(i.find("tr").not(i.find("table tr")).get(n+1)).prepend(d):e(r[n+1][u-1]).after(d)}}var p=o.parent();o.remove(),0===p.find("tr").length&&p.remove(),r=b(i)}v(0,r.length-1,0,r[0].length-1,i),a.min_i>0?t.selection.setAtEnd(r[a.min_i-1][0]):t.selection.setAtEnd(r[0][0]),t.selection.restore(),t.popups.hide("table.edit")}}},insertColumn:function(n){var s=Q();if(s.length>0){var o,r=b(),a=E(r);o="before"==n?a.min_j:a.max_j;var l,c=100/r[0].length,d=100/(r[0].length+1);s.find("th, td").each(function(){(l=e(this)).data("old-width",l.outerWidth()/s.outerWidth()*100)}),s.find("tr").not(s.find("table tr")).each(function(t){for(var i,s=e(this),a=0,l=0;a-1<o;){if(!(i=s.find("> th, > td").get(l))){i=null;break}i==r[t][a]?(a+=parseInt(e(i).attr("colspan"),10)||1,l++):(a+=parseInt(e(r[t][a]).attr("colspan"),10)||1,"after"==n&&(i=0===l?-1:s.find("> th, > td").get(l-1)))}var u,h=e(i);if("after"==n&&a-1>o||"before"==n&&o>0&&r[t][o]==r[t][o-1]){if(0===t||t>0&&r[t][o]!=r[t-1][o]){var p=parseInt(h.attr("colspan"),10)+1;h.attr("colspan",p),h.css("width",(h.data("old-width")*d/c+d).toFixed(4)+"%"),h.removeData("old-width")}}else u=s.find("th").length>0?'<th style="width: '+d.toFixed(4)+'%;"><br></th>':'<td style="width: '+d.toFixed(4)+'%;"><br></td>',-1==i?s.prepend(u):null==i?s.append(u):"before"==n?h.before(u):"after"==n&&h.after(u)}),s.find("th, td").each(function(){(l=e(this)).data("old-width")&&(l.css("width",(l.data("old-width")*d/c).toFixed(4)+"%"),l.removeData("old-width"))}),t.popups.isVisible("table.edit")&&i()}},deleteColumn:function(){var i=Q();if(i.length>0){var n,s,o,r=b(),a=E(r);if(0===a.min_j&&a.max_j==r[0].length-1)h();else{var l=100/r[0].length,c=100/(r[0].length-a.max_j+a.min_j-1);for(i.find("th, td").each(function(){(o=e(this)).hasClass("fr-selected-cell")||o.data("old-width",o.outerWidth()/i.outerWidth()*100)}),s=a.max_j;s>=a.min_j;s--)for(n=0;n<r.length;n++)if(0===n||r[n][s]!=r[n-1][s])if(o=e(r[n][s]),(parseInt(o.attr("colspan"),10)||1)>1){var d=parseInt(o.attr("colspan"),10)-1;1==d?o.removeAttr("colspan"):o.attr("colspan",d),o.css("width",((o.data("old-width")-K(s,r))*c/l).toFixed(4)+"%"),o.removeData("old-width")}else{var u=e(o.parent().get(0));o.remove(),0===u.find("> th, > td").length&&(0===u.prev().length||0===u.next().length||u.prev().find("> th[rowspan], > td[rowspan]").length<u.prev().find("> th, > td").length)&&u.remove()}v(0,r.length-1,0,r[0].length-1,i),a.min_j>0?t.selection.setAtEnd(r[a.min_i][a.min_j-1]):t.selection.setAtEnd(r[a.min_i][0]),t.selection.restore(),t.popups.hide("table.edit"),i.find("th, td").each(function(){(o=e(this)).data("old-width")&&(o.css("width",(o.data("old-width")*c/l).toFixed(4)+"%"),o.removeData("old-width"))})}}},mergeCells:function(){if(X().length>1&&(0===t.$el.find("th.fr-selected-cell").length||0===t.$el.find("td.fr-selected-cell").length)){var n,s,o=E(b()),r=t.$el.find(".fr-selected-cell"),a=e(r[0]),l=a.parent().find(".fr-selected-cell"),c=a.closest("table"),d=a.html(),u=0;for(n=0;n<l.length;n++)u+=e(l[n]).outerWidth();for(a.css("width",(u/c.outerWidth()*100).toFixed(4)+"%"),o.min_j<o.max_j&&a.attr("colspan",o.max_j-o.min_j+1),o.min_i<o.max_i&&a.attr("rowspan",o.max_i-o.min_i+1),n=1;n<r.length;n++)"<br>"!=(s=e(r[n])).html()&&""!==s.html()&&(d+="<br>"+s.html()),s.remove();a.html(d),t.selection.setAtEnd(a.get(0)),t.selection.restore(),t.toolbar.enable(),m(o.min_i,o.max_i,c);var h=c.find("tr:empty");for(n=h.length-1;n>=0;n--)e(h[n]).remove();f(o.min_j,o.max_j,c),i()}},splitCellVertically:function(){if(1==X().length){var i=t.$el.find(".fr-selected-cell"),n=parseInt(i.attr("colspan"),10)||1,s=i.parent().outerWidth(),o=i.outerWidth(),r=i.clone().html("<br>"),a=b(),l=y(i.get(0),a);if(n>1){var c=Math.ceil(n/2);o=W(l.col,l.col+c-1,a)/s*100;var d=W(l.col+c,l.col+n-1,a)/s*100;c>1?i.attr("colspan",c):i.removeAttr("colspan"),n-c>1?r.attr("colspan",n-c):r.removeAttr("colspan"),i.css("width",o.toFixed(4)+"%"),r.css("width",d.toFixed(4)+"%")}else{var u;for(u=0;u<a.length;u++)if(0===u||a[u][l.col]!=a[u-1][l.col]){var h=e(a[u][l.col]);if(!h.is(i)){var p=(parseInt(h.attr("colspan"),10)||1)+1;h.attr("colspan",p)}}o=o/s*100/2,i.css("width",o.toFixed(4)+"%"),r.css("width",o.toFixed(4)+"%")}i.after(r),x(),t.popups.hide("table.edit")}},splitCellHorizontally:function(){if(1==X().length){var i=t.$el.find(".fr-selected-cell"),n=i.parent(),s=i.closest("table"),o=parseInt(i.attr("rowspan"),10),r=b(),a=y(i.get(0),r),l=i.clone().html("<br>");if(o>1){var c=Math.ceil(o/2);c>1?i.attr("rowspan",c):i.removeAttr("rowspan"),o-c>1?l.attr("rowspan",o-c):l.removeAttr("rowspan");for(var d=a.row+c,u=0===a.col?a.col:a.col-1;u>=0&&(r[d][u]==r[d][u-1]||d>0&&r[d][u]==r[d-1][u]);)u--;-1==u?e(s.find("tr").not(s.find("table tr")).get(d)).prepend(l):e(r[d][u]).after(l)}else{var h,p=e("<tr>").append(l);for(h=0;h<r[0].length;h++)if(0===h||r[a.row][h]!=r[a.row][h-1]){var f=e(r[a.row][h]);f.is(i)||f.attr("rowspan",(parseInt(f.attr("rowspan"),10)||1)+1)}n.after(p)}x(),t.popups.hide("table.edit")}},addHeader:function(){var t=Q();if(t.length>0&&0===t.find("th").length){var n,s="<thead><tr>",o=0;for(t.find("tr:first > td").each(function(){var t=e(this);o+=parseInt(t.attr("colspan"),10)||1}),n=0;n<o;n++)s+="<th><br></th>";s+="</tr></thead>",t.prepend(s),i()}},removeHeader:function(){var e=Q(),n=e.find("thead");if(n.length>0)if(0===e.find("tbody tr").length)h();else if(n.remove(),X().length>0)i();else{t.popups.hide("table.edit");var s=e.find("tbody tr:first td:first").get(0);s&&(t.selection.setAtEnd(s),t.selection.restore())}},setBackground:function(e){"REMOVE"!=e?t.$el.find(".fr-selected-cell").css("background-color",t.helpers.HEXtoRGB(e)):t.$el.find(".fr-selected-cell").css("background-color","")},showInsertPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="insertTable"]'),i=t.popups.get("table.insert");if(i||(i=o()),!i.hasClass("fr-active")){t.popups.refresh("table.insert"),t.popups.setContainer("table.insert",t.$tb);var n=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("table.insert",n,s,e.outerHeight())}},showEditPopup:i,showColorsPopup:n,back:function(){X().length>0?i():(t.popups.hide("table.insert"),t.toolbar.showInline())},verticalAlign:function(e){t.$el.find(".fr-selected-cell").css("vertical-align",e)},horizontalAlign:function(e){t.$el.find(".fr-selected-cell").css("text-align",e)},applyStyle:function(e,t,i,n){if(t.length>0){if(!i){var s=Object.keys(n);s.splice(s.indexOf(e),1),t.removeClass(s.join(" "))}t.toggleClass(e)}},selectedTable:Q,selectedCells:X}},e.FE.DefineIcon("insertTable",{NAME:"table"}),e.FE.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"}),e.FE.RegisterCommand("tableInsert",{callback:function(e,t,i){this.table.insert(t,i),this.popups.hide("table.insert")}}),e.FE.DefineIcon("tableHeader",{NAME:"header"}),e.FE.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,toggle:!0,callback:function(){this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]').hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.table.selectedTable();t.length>0&&(0===t.find("th").length?e.removeClass("fr-active").attr("aria-pressed",!1):e.addClass("fr-active").attr("aria-pressed",!0))}}),e.FE.DefineIcon("tableRows",{NAME:"bars"}),e.FE.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below",delete:"Delete row"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.tableRows.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableRows" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+"</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),e.FE.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),e.FE.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after",delete:"Delete column"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.tableColumns.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableColumns" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+"</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),e.FE.DefineIcon("tableCells",{NAME:"square-o"}),e.FE.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.tableCells.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCells" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(i[n])+"</a></li>");return t+"</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){this.$el.find(".fr-selected-cell").length>1?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="merge"]').removeClass("fr-disabled").attr("aria-disabled",!1)):(t.find('a[data-param1="merge"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled").attr("aria-disabled",!1),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled").attr("aria-disabled",!1))}}),e.FE.DefineIcon("tableRemove",{NAME:"trash"}),e.FE.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),e.FE.DefineIcon("tableStyle",{NAME:"paint-brush"}),e.FE.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(t,i){var n=this.$el.find(".fr-selected-cell").closest("table");n&&i.find(".fr-command").each(function(){var t=e(this).data("param1"),i=n.hasClass(t);e(this).toggleClass("fr-active",i).attr("aria-selected",i)})}}),e.FE.DefineIcon("tableCellBackground",{NAME:"tint"}),e.FE.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,popup:!0,callback:function(){this.table.showColorsPopup()}}),e.FE.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),e.FE.DefineIcon("tableBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.table.selectedCells().length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v"}),e.FE.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.tableCellVerticalAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellVerticalAlign" data-param1="'+n.toLowerCase()+'" title="'+this.language.translate(i[n])+'">'+this.language.translate(n)+"</a></li>");return t+"</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active").attr("aria-selected",!0)}}),e.FE.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),e.FE.DefineIcon("align-left",{NAME:"align-left"}),e.FE.DefineIcon("align-right",{NAME:"align-right"}),e.FE.DefineIcon("align-center",{NAME:"align-center"}),e.FE.DefineIcon("align-justify",{NAME:"align-justify"}),e.FE.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.tableCellHorizontalAlign.options;for(var n in i)i.hasOwnProperty(n)&&(t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="tableCellHorizontalAlign" data-param1="'+n+'" title="'+this.language.translate(i[n])+'">'+this.icon.create("align-"+n)+'<span class="fr-sr-only">'+this.language.translate(i[n])+"</span></a></li>");return t+"</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(t){var i=this.table.selectedCells();i.length&&t.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(e(i[0]))))},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active").attr("aria-selected",!0)}}),e.FE.DefineIcon("tableCellStyle",{NAME:"magic"}),e.FE.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableCellStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellStyle" data-param1="'+i+'" title="'+this.language.translate(t[i])+'">'+this.language.translate(t[i])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(t,i){var n=this.$el.find(".fr-selected-cell:first");n&&i.find(".fr-command").each(function(){var t=e(this).data("param1"),i=n.hasClass(t);e(this).toggleClass("fr-active",i).attr("aria-selected",i)})}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{}),e.FE.URLRegEx=/(\s|^|>)((http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+(\.[a-zA-Z]{2,3})?(:\d*)?(\/[^\s<]*)?)(\s|$|<)/gi,e.FE.PLUGINS.url=function(t){return{_init:function(){t.events.on("paste.afterCleanup",function(i){if(e.FE.URLRegEx.test(i))return i.replace(e.FE.URLRegEx,"$1<a"+(t.opts.linkAlwaysBlank?' target="_blank"':"")+(t.opts.linkAlwaysNoFollow?' rel="nofollow"':"")+' href="$2">$2</a>$7')}),t.events.on("keyup",function(i){var n=i.which;n!=e.FE.KEYCODE.ENTER&&n!=e.FE.KEYCODE.SPACE||function(){for(var i=t.doc.createTreeWalker(t.el,NodeFilter.SHOW_TEXT,t.node.filter(function(t){return e.FE.URLRegEx.test(t.textContent.replace(/&nbsp;/gi,""))&&!function(e){for(;e.parentNode;)if(e=e.parentNode,["A","BUTTON","TEXTAREA"].indexOf(e.tagName)>=0)return!0;return!1}(t)}),!1);i.nextNode();){var n=i.currentNode,s=null;t.opts.linkAlwaysNoFollow&&(s="nofollow"),t.opts.linkAlwaysBlank&&(s?s+=" noopener noreferrer":s="noopener noreferrer"),e(n).before(n.textContent.replace(e.FE.URLRegEx,"$1<a"+(t.opts.linkAlwaysBlank?' target="_blank"':"")+(s?' rel="'+s+'"':"")+' href="$2">$2</a>$7')),n.parentNode.removeChild(n)}}(t.node.contents(t.el))}),t.events.on("keydown",function(i){if(i.which==e.FE.KEYCODE.ENTER){var n=t.selection.element();if(("A"==n.tagName||e(n).parents("a").length)&&t.selection.info(n).atEnd)return i.stopImmediatePropagation(),"A"!==n.tagName&&(n=e(n).parents("a")[0]),e(n).after("&nbsp;"+e.FE.MARKERS),t.selection.restore(),!1}})}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{entities:"&quot;&#39;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;"}),e.FE.PLUGINS.entities=function(t){function i(e){var t=e.textContent;if(t.match(o)){for(var i="",n=0;n<t.length;n++)i+=r[t[n]]?r[t[n]]:t[n];e.textContent=i}}function n(e){if(e&&["STYLE","SCRIPT","svg"].indexOf(e.tagName)>=0)return!0;for(var s=t.node.contents(e),o=0;o<s.length;o++)s[o].nodeType==Node.TEXT_NODE?i(s[o]):n(s[o]);e.nodeType==Node.TEXT_NODE&&i(e)}function s(e){return 0===e.length?"":t.clean.exec(e,n).replace(/\&amp;/g,"&")}var o,r;return{_init:function(){t.opts.htmlSimpleAmpersand||(t.opts.entities=t.opts.entities+"&amp;");var i=e("<div>").html(t.opts.entities).text(),n=t.opts.entities.split(";");r={},o="";for(var a=0;a<i.length;a++){var l=i.charAt(a);r[l]=n[a]+";",o+="\\"+l+(a<i.length-1?"|":"")}o=new RegExp("("+o+")","g"),t.events.on("html.get",s,!0)}}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{charCounterMax:-1,charCounterCount:!0}),e.FE.PLUGINS.charCounter=function(t){function i(){return t.el.textContent.length}function n(e){if(t.opts.charCounterMax<0)return!0;if(i()<t.opts.charCounterMax)return!0;var n=e.which;return!(!t.keys.ctrlKey(e)&&t.keys.isCharacter(n)&&(e.preventDefault(),e.stopPropagation(),t.events.trigger("charCounter.exceeded"),1))}function s(n){return t.opts.charCounterMax<0?n:e("<div>").html(n).text().length+i()<=t.opts.charCounterMax?n:(t.events.trigger("charCounter.exceeded"),"")}function o(){if(t.opts.charCounterCount){var e=i()+(t.opts.charCounterMax>0?"/"+t.opts.charCounterMax:"");r.text(e),t.opts.toolbarBottom&&r.css("margin-bottom",t.$tb.outerHeight(!0));var n=t.$wp.get(0).offsetWidth-t.$wp.get(0).clientWidth;n>=0&&("rtl"==t.opts.direction?r.css("margin-left",n):r.css("margin-right",n))}}var r;return{_init:function(){return!!t.$wp&&!!t.opts.charCounterCount&&((r=e('<span class="fr-counter"></span>')).css("bottom",t.$wp.css("border-bottom-width")),t.$box.append(r),t.events.on("keydown",n,!0),t.events.on("paste.afterCleanup",s),t.events.on("keyup contentChanged input",function(){t.events.trigger("charCounter.update")}),t.events.on("charCounter.update",o),t.events.trigger("charCounter.update"),void t.events.on("destroy",function(){e(t.o_win).off("resize.char"+t.id),r.removeData().remove(),r=null}))},count:i}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{inlineStyles:{"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"}}),e.FE.PLUGINS.inlineStyle=function(t){return{apply:function(i){""!==t.selection.text()?t.html.insert(e.FE.START_MARKER+'<span style="'+i+'">'+t.selection.text()+"</span>"+e.FE.END_MARKER):t.html.insert('<span style="'+i+'">'+e.FE.INVISIBLE_SPACE+e.FE.MARKERS+"</span>")}}},e.FE.RegisterCommand("inlineStyle",{type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.inlineStyles;for(var i in t)t.hasOwnProperty(i)&&(e+='<li role="presentation"><span style="'+t[i]+'" role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="inlineStyle" data-param1="'+t[i]+'" title="'+this.language.translate(i)+'">'+this.language.translate(i)+"</a></span></li>");return e+"</ul>"},title:"Inline Style",callback:function(e,t){this.inlineStyle.apply(t)},plugin:"inlineStyle"}),e.FE.DefineIcon("inlineStyle",{NAME:"paint-brush"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.FE.PLUGINS.quote=function(t){function i(e){for(;e.parentNode&&e.parentNode!=t.el;)e=e.parentNode;return e}function n(){var n,s=t.selection.blocks();for(n=0;n<s.length;n++)s[n]=i(s[n]);t.selection.save();var o=e("<blockquote>");for(o.insertBefore(s[0]),n=0;n<s.length;n++)o.append(s[n]);t.html.unwrap(),t.selection.restore()}function s(){var i,n=t.selection.blocks();for(i=0;i<n.length;i++)"BLOCKQUOTE"!=n[i].tagName&&(n[i]=e(n[i]).parentsUntil(t.$el,"BLOCKQUOTE").get(0));for(t.selection.save(),i=0;i<n.length;i++)n[i]&&e(n[i]).replaceWith(n[i].innerHTML);t.html.unwrap(),t.selection.restore()}return{apply:function(e){t.selection.save(),t.html.wrap(!0,!0,!0,!0),t.selection.restore(),"increase"==e?n():"decrease"==e&&s()}}},e.FE.RegisterShortcut(e.FE.KEYCODE.SINGLE_QUOTE,"quote","increase","'"),e.FE.RegisterShortcut(e.FE.KEYCODE.SINGLE_QUOTE,"quote","decrease","'",!0),e.FE.RegisterCommand("quote",{title:"Quote",type:"dropdown",options:{increase:"Increase",decrease:"Decrease"},callback:function(e,t){this.quote.apply(t)},plugin:"quote"}),e.FE.DefineIcon("quote",{NAME:"quote-left"})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{saveInterval:1e4,saveURL:null,saveParams:{},saveParam:"body",saveMethod:"POST"}),e.FE.PLUGINS.save=function(t){function i(e,i){t.events.trigger("save.error",[{code:e,message:d[e]},i])}function n(n){if(void 0===n&&(n=t.html.get()),!1===t.events.trigger("save.before"))return!1;if(t.opts.saveURL){var s={};for(var o in t.opts.saveParams)if(t.opts.saveParams.hasOwnProperty(o)){var a=t.opts.saveParams[o];s[o]="function"==typeof a?a.call(this):a}var d={};d[t.opts.saveParam]=n,e.ajax({type:t.opts.saveMethod,url:t.opts.saveURL,data:e.extend(d,s),crossDomain:t.opts.requestWithCORS,xhrFields:{withCredentials:t.opts.requestWithCredentials},headers:t.opts.requestHeaders}).done(function(e){r=n,t.events.trigger("save.after",[e])}).fail(function(e){i(c,e.response||e.responseText)})}else i(l)}function s(){clearTimeout(o),o=setTimeout(function(){var e=t.html.get();(r!=e||a)&&(r=e,a=!1,n(e))},t.opts.saveInterval)}var o=null,r=null,a=!1,l=1,c=2,d={};return d[l]="Missing saveURL option.",d[c]="Something went wrong during save.",{_init:function(){t.opts.saveInterval&&(r=t.html.get(),t.events.on("contentChanged",s),t.events.on("keydown destroy",function(){clearTimeout(o)}))},save:n,reset:function(){s(),a=!1},force:function(){a=!0}}},e.FE.DefineIcon("save",{NAME:"floppy-o"}),e.FE.RegisterCommand("save",{title:"Save",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.save.save()},plugin:"save"})});var Cards={myLineChart:{},init:function(){$(".datepicker_trend").datepicker({changeMonth:!0,numberOfMonths:1,prevText:'<i class="fa fa-chevron-left"></i>',nextText:'<i class="fa fa-chevron-right"></i>',dateFormat:"yy-mm-dd",regional:["ru"],onClose:function(e){}}),$(".datepicker_trend").change(function(){var e=$(this).parents("article");Cards.updateData(e)}),$(".trends").each(function(e){var t=$(this).parents("article"),i=t.find("canvas"),n=t.attr("id");Cards.myLineChart[n]=new Chart(i,{type:"line",data:{labels:[],datasets:[{label:"Count",data:[],backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}}}}),Cards.updateData(t)})},updateData:function(e){var t=e.attr("id");$.ajax({url:"/admin/change-range-trend",method:"POST",data:{from:e.find("[name=trend_from]").val(),to:e.find("[name=trend_to]").val(),model:e.find("[name=trend_model]").val()},dataType:"json",success:function(e){Cards.myLineChart[t].data.labels=e.labels,Cards.myLineChart[t].data.datasets[0].data=e.values,Cards.myLineChart[t].update()}})}};Cards.init();
